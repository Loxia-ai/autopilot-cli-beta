const a0_0x37dc29=a0_0x3d4b;(function(_0x481b7d,_0x4351c4){const _0x1af7cd=a0_0x3d4b,_0x527dfd=_0x481b7d();while(!![]){try{const _0x495a84=-parseInt(_0x1af7cd(0x198))/0x1+-parseInt(_0x1af7cd(0x189))/0x2*(parseInt(_0x1af7cd(0x19b))/0x3)+parseInt(_0x1af7cd(0x18d))/0x4*(parseInt(_0x1af7cd(0x190))/0x5)+-parseInt(_0x1af7cd(0x19e))/0x6+parseInt(_0x1af7cd(0x195))/0x7+parseInt(_0x1af7cd(0x191))/0x8+-parseInt(_0x1af7cd(0x18a))/0x9*(-parseInt(_0x1af7cd(0x1a3))/0xa);if(_0x495a84===_0x4351c4)break;else _0x527dfd['push'](_0x527dfd['shift']());}catch(_0x3f72dd){_0x527dfd['push'](_0x527dfd['shift']());}}}(a0_0x2dec,0xd9018));function a0_0x3d4b(_0x3a611e,_0x2c21c8){const _0x2dec7c=a0_0x2dec();return a0_0x3d4b=function(_0x3d4b88,_0x435804){_0x3d4b88=_0x3d4b88-0x188;let _0x167c8c=_0x2dec7c[_0x3d4b88];if(a0_0x3d4b['PjslLa']===undefined){var _0x315129=function(_0x36dc3c){const _0xd0e440='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3ef497='',_0x1528ec='';for(let _0x526b34=0x0,_0x464f14,_0x2c9ff5,_0x3e4632=0x0;_0x2c9ff5=_0x36dc3c['charAt'](_0x3e4632++);~_0x2c9ff5&&(_0x464f14=_0x526b34%0x4?_0x464f14*0x40+_0x2c9ff5:_0x2c9ff5,_0x526b34++%0x4)?_0x3ef497+=String['fromCharCode'](0xff&_0x464f14>>(-0x2*_0x526b34&0x6)):0x0){_0x2c9ff5=_0xd0e440['indexOf'](_0x2c9ff5);}for(let _0x2fbd68=0x0,_0x252509=_0x3ef497['length'];_0x2fbd68<_0x252509;_0x2fbd68++){_0x1528ec+='%'+('00'+_0x3ef497['charCodeAt'](_0x2fbd68)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1528ec);};a0_0x3d4b['WAwvmV']=_0x315129,_0x3a611e=arguments,a0_0x3d4b['PjslLa']=!![];}const _0x49ccc1=_0x2dec7c[0x0],_0x10a756=_0x3d4b88+_0x49ccc1,_0x4f0743=_0x3a611e[_0x10a756];return!_0x4f0743?(_0x167c8c=a0_0x3d4b['WAwvmV'](_0x167c8c),_0x3a611e[_0x10a756]=_0x167c8c):_0x167c8c=_0x4f0743,_0x167c8c;},a0_0x3d4b(_0x3a611e,_0x2c21c8);}function a0_0x2dec(){const _0x5dfab8=['CgfYC2vnzxnZywDL','mZC1mJq0oerXEK5osG','ihDPDgGG','vxnLCIbqCM9TChq','CgfYC2vqCM9TChq','rxjYB3iGCgfYC2LUzYbTzxnZywDLihDPDgGGvgfNugfYC2vYoG','nZiYnJyWtfjltfLi','rxH0CMfJDgvKihbYB21WDdOG','CgfYC2vuB29Sq29TBwfUzhm','Dg9VBenVBw1HBMrZ','yxr0CMLIDxrLCW','AM9IlwrVBMu','ngHetvb1CW','mtGWz012qMTX','CxvLCNK','zxH0CMfJDenVBNrLBNq','mJC2mtzAvvjnqMu','y29UDgvUDa','CMvJAxbPzw50','nJvhAM5UEvG','mtaWotu2oevmwunVDa','rxH0CMfJDgvKihrVB2WGy29TBwfUzdOG','CMvWBgfJzq','rxH0CMfJDgvKigrPCMvJDcb0B29SignVBw1HBMq6ia','oti3mtu4nfrlBM5wyG','ChjVBxb0','Bg9Nz2vY','ndy4oteYA3LUt0nf','ChvZAa','Aw5MBW','mtuWmZKWnMHVCLrNvG','ugfYC2LUzYbTzxnZywDLihDPDgGGvgfNugfYC2vY'];a0_0x2dec=function(){return _0x5dfab8;};return a0_0x2dec();}import{TagParser}from'../utilities/tagParser.js';export class TagParserService{constructor(_0x36dc3c){const _0x26dda9=a0_0x3d4b;this[_0x26dda9(0x197)]=_0x36dc3c;}[a0_0x37dc29(0x19d)](_0xd0e440){const _0x5f1803=a0_0x37dc29;this['logger']['info'](_0x5f1803(0x19c));const _0x3ef497={'recipient':null,'content':_0xd0e440,'toolCommands':[],'prompt':null,'jobDone':null};try{const _0x1528ec=TagParser[_0x5f1803(0x18c)](_0xd0e440,_0x5f1803(0x188));_0x1528ec['length']>0x0&&(_0x3ef497['jobDone']=_0x1528ec[0x0]);const _0x526b34=TagParser[_0x5f1803(0x18b)](_0xd0e440,'message');if(_0x526b34['length']>0x0){const _0x464f14=_0x526b34[0x0];_0x3ef497['recipient']=_0x464f14[_0x5f1803(0x1a7)]['to'],_0x3ef497['content']=_0x464f14['content'],this[_0x5f1803(0x197)][_0x5f1803(0x19a)]('Message\x20to\x20recipient:\x20'+_0x3ef497[_0x5f1803(0x18f)]);}return this['parseToolCommands'](_0xd0e440,_0x3ef497),this['parsePrompt'](_0xd0e440,_0x3ef497),_0x3ef497;}catch(_0x2c9ff5){return this['logger']['error'](_0x5f1803(0x1a2),_0x2c9ff5),_0x3ef497;}}[a0_0x37dc29(0x1a5)](_0x3e4632,_0x2fbd68){const _0x51a400=a0_0x37dc29,_0x252509=TagParser['query'](_0x3e4632,'tools-commands');for(const _0x1c3b0d of _0x252509){const _0x274155=_0x1c3b0d['content'],_0x1e4123=TagParser[_0x51a400(0x18b)](_0x274155,'tool');for(const _0x10a9ef of _0x1e4123){const _0x56e017=_0x10a9ef[_0x51a400(0x1a7)]['id'];if(!_0x56e017)continue;const _0x3d4912=_0x10a9ef[_0x51a400(0x18e)];_0x2fbd68[_0x51a400(0x1a6)]['push']({'toolId':_0x56e017,'content':_0x3d4912,'rawTag':_0x10a9ef}),this[_0x51a400(0x197)]['info'](_0x51a400(0x192)+_0x56e017);}}if(_0x252509['length']===0x0&&_0x3e4632['includes']('[tool\x20id=')){const _0x2c47e1=TagParser[_0x51a400(0x18b)](_0x3e4632,'tool');for(const _0x2cd0ae of _0x2c47e1){const _0x1c05a4=_0x2cd0ae['attributes']['id'];if(!_0x1c05a4)continue;const _0xc3c3bf=_0x2cd0ae[_0x51a400(0x18e)];_0x2fbd68[_0x51a400(0x1a6)][_0x51a400(0x199)]({'toolId':_0x1c05a4,'content':_0xc3c3bf,'rawTag':_0x2cd0ae}),this[_0x51a400(0x197)]['info'](_0x51a400(0x194)+_0x1c05a4);}}}[a0_0x37dc29(0x1a1)](_0x408f0e,_0x5f5e0f){const _0x216fe2=a0_0x37dc29,_0x5e8d9a=TagParser[_0x216fe2(0x18b)](_0x408f0e,'prompt');if(_0x5e8d9a['length']>0x0){const _0x36038d=_0x5e8d9a[0x0],_0x3769fd=_0x36038d['attributes']['name']||_0x216fe2(0x1a0),_0x24e5dc=_0x36038d['content'],_0x787b5b=TagParser[_0x216fe2(0x18c)](_0x24e5dc,'option');_0x5f5e0f[_0x216fe2(0x196)]={'name':_0x3769fd,'text':_0x24e5dc[_0x216fe2(0x193)](/\[option\](.*?)\[\/option\]/gs,'')['trim'](),'options':_0x787b5b},this['logger']['info'](_0x216fe2(0x1a4)+_0x3769fd+_0x216fe2(0x19f)+_0x787b5b['length']+'\x20options');}}}