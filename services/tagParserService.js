const a0_0x4c3bc5=a0_0x4f28;(function(_0x480c51,_0x2078bc){const _0xf21685=a0_0x4f28,_0xec80a3=_0x480c51();while(!![]){try{const _0x59b459=parseInt(_0xf21685(0x173))/0x1*(parseInt(_0xf21685(0x18e))/0x2)+-parseInt(_0xf21685(0x190))/0x3*(-parseInt(_0xf21685(0x17d))/0x4)+-parseInt(_0xf21685(0x170))/0x5+parseInt(_0xf21685(0x178))/0x6*(parseInt(_0xf21685(0x179))/0x7)+-parseInt(_0xf21685(0x16f))/0x8*(parseInt(_0xf21685(0x16d))/0x9)+-parseInt(_0xf21685(0x180))/0xa+-parseInt(_0xf21685(0x17c))/0xb;if(_0x59b459===_0x2078bc)break;else _0xec80a3['push'](_0xec80a3['shift']());}catch(_0x27593e){_0xec80a3['push'](_0xec80a3['shift']());}}}(a0_0x1f4c,0xc9926));import{TagParser}from'../utilities/tagParser.js';function a0_0x1f4c(){const _0x5a866c=['nZC1otGXme5fuM1orG','rxH0CMfJDgvKihrVB2WGy29TBwfUzdOG','vxnLCIbqCM9TChq','Aw5JBhvKzxm','rxH0CMfJDgvKihbYB21WDdOG','Dg9VBhmTy29TBwfUzhm','CxvLCNK','CgfYC2vuB29Sq29TBwfUzhm','ihDPDgGG','Aw5MBW','CMvJAxbPzw50','rxH0CMfJDgvKigrPCMvJDcb0B29SignVBw1HBMq6ia','ChjVBxb0','ugfYC2LUzYbTzxnZywDLihDPDgGGvgfNugfYC2vY','mZiZmJzqC1nKs2m','BgvUz3rO','mti5EgrPywDg','mJe2mhPwBfnyvG','Bg9Nz2vY','mtq0mdH4vLfVrxO','mJi1nJK1ENn1rgHj','yxr0CMLIDxrLCW','Dg9VBenVBw1HBMrZ','mtvdrLjxrKO','BMfTzq','zxH0CMfJDenVBNrLBNq','CMvWBgfJzq','Dg9VBa','nNzoB1z0qW','nJuYntiZouTAvMzNDW','y29UDgvUDa','BwvZC2fNzq','ntC5odK4mePvrwTvAa','mtmZmty4r3LIsuTA','w3rVB2WGAwq9','CgfYC2vqCM9TChq'];a0_0x1f4c=function(){return _0x5a866c;};return a0_0x1f4c();}function a0_0x4f28(_0x5d8c54,_0x2d539c){const _0x1f4cb8=a0_0x1f4c();return a0_0x4f28=function(_0x4f281b,_0x212b55){_0x4f281b=_0x4f281b-0x16d;let _0x49c30e=_0x1f4cb8[_0x4f281b];if(a0_0x4f28['WnLqnd']===undefined){var _0x2140a6=function(_0x2c67ff){const _0xadb61d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x559bcf='',_0xc5585b='';for(let _0x1b3728=0x0,_0x23a30f,_0x2ed6d1,_0x45f90b=0x0;_0x2ed6d1=_0x2c67ff['charAt'](_0x45f90b++);~_0x2ed6d1&&(_0x23a30f=_0x1b3728%0x4?_0x23a30f*0x40+_0x2ed6d1:_0x2ed6d1,_0x1b3728++%0x4)?_0x559bcf+=String['fromCharCode'](0xff&_0x23a30f>>(-0x2*_0x1b3728&0x6)):0x0){_0x2ed6d1=_0xadb61d['indexOf'](_0x2ed6d1);}for(let _0xb502bf=0x0,_0x518e74=_0x559bcf['length'];_0xb502bf<_0x518e74;_0xb502bf++){_0xc5585b+='%'+('00'+_0x559bcf['charCodeAt'](_0xb502bf)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xc5585b);};a0_0x4f28['gzMNoe']=_0x2140a6,_0x5d8c54=arguments,a0_0x4f28['WnLqnd']=!![];}const _0x39b6ae=_0x1f4cb8[0x0],_0x2805e4=_0x4f281b+_0x39b6ae,_0x1d3bfd=_0x5d8c54[_0x2805e4];return!_0x1d3bfd?(_0x49c30e=a0_0x4f28['gzMNoe'](_0x49c30e),_0x5d8c54[_0x2805e4]=_0x49c30e):_0x49c30e=_0x1d3bfd,_0x49c30e;},a0_0x4f28(_0x5d8c54,_0x2d539c);}export class TagParserService{constructor(_0x2c67ff){this['logger']=_0x2c67ff;}['parseMessage'](_0xadb61d){const _0x30710e=a0_0x4f28;this['logger'][_0x30710e(0x189)](_0x30710e(0x18d));const _0x559bcf={'recipient':null,'content':_0xadb61d,'toolCommands':[],'prompt':null,'jobDone':null};try{const _0xc5585b=TagParser['extractContent'](_0xadb61d,'job-done');_0xc5585b['length']>0x0&&(_0x559bcf['jobDone']=_0xc5585b[0x0]);const _0x1b3728=TagParser['query'](_0xadb61d,_0x30710e(0x17b));if(_0x1b3728['length']>0x0){const _0x23a30f=_0x1b3728[0x0];_0x559bcf[_0x30710e(0x18a)]=_0x23a30f[_0x30710e(0x171)]['to'],_0x559bcf['content']=_0x23a30f[_0x30710e(0x17a)],this['logger']['info']('Message\x20to\x20recipient:\x20'+_0x559bcf['recipient']);}return this[_0x30710e(0x187)](_0xadb61d,_0x559bcf),this['parsePrompt'](_0xadb61d,_0x559bcf),_0x559bcf;}catch(_0x2ed6d1){return this[_0x30710e(0x16e)]['error']('Error\x20parsing\x20message\x20with\x20TagParser:',_0x2ed6d1),_0x559bcf;}}['parseToolCommands'](_0x45f90b,_0xb502bf){const _0x5d59a7=a0_0x4f28,_0x518e74=TagParser[_0x5d59a7(0x186)](_0x45f90b,_0x5d59a7(0x185));for(const _0x3304a3 of _0x518e74){const _0x6c8353=_0x3304a3['content'],_0x1ea679=TagParser['query'](_0x6c8353,_0x5d59a7(0x177));for(const _0x4b1dc2 of _0x1ea679){const _0xbcbba6=_0x4b1dc2['attributes']['id'];if(!_0xbcbba6)continue;const _0xce803e=_0x4b1dc2[_0x5d59a7(0x17a)];_0xb502bf[_0x5d59a7(0x172)]['push']({'toolId':_0xbcbba6,'content':_0xce803e,'rawTag':_0x4b1dc2}),this[_0x5d59a7(0x16e)][_0x5d59a7(0x189)](_0x5d59a7(0x181)+_0xbcbba6);}}if(_0x518e74['length']===0x0&&_0x45f90b[_0x5d59a7(0x183)](_0x5d59a7(0x17e))){const _0x5f03d2=TagParser['query'](_0x45f90b,'tool');for(const _0x36b036 of _0x5f03d2){const _0x1390f1=_0x36b036[_0x5d59a7(0x171)]['id'];if(!_0x1390f1)continue;const _0x4d0bb4=_0x36b036[_0x5d59a7(0x17a)];_0xb502bf[_0x5d59a7(0x172)]['push']({'toolId':_0x1390f1,'content':_0x4d0bb4,'rawTag':_0x36b036}),this[_0x5d59a7(0x16e)]['info'](_0x5d59a7(0x18b)+_0x1390f1);}}}[a0_0x4c3bc5(0x17f)](_0xefb8fb,_0x424a0e){const _0x3703fc=a0_0x4c3bc5,_0x1c2646=TagParser['query'](_0xefb8fb,_0x3703fc(0x18c));if(_0x1c2646[_0x3703fc(0x18f)]>0x0){const _0x2b6352=_0x1c2646[0x0],_0x4c6ba0=_0x2b6352[_0x3703fc(0x171)][_0x3703fc(0x174)]||_0x3703fc(0x182),_0x48cc26=_0x2b6352['content'],_0x345b75=TagParser[_0x3703fc(0x175)](_0x48cc26,'option');_0x424a0e['prompt']={'name':_0x4c6ba0,'text':_0x48cc26[_0x3703fc(0x176)](/\[option\](.*?)\[\/option\]/gs,'')['trim'](),'options':_0x345b75},this[_0x3703fc(0x16e)]['info'](_0x3703fc(0x184)+_0x4c6ba0+_0x3703fc(0x188)+_0x345b75['length']+'\x20options');}}}