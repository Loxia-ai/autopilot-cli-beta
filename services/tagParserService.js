function a0_0x47fc(_0x562d60,_0x4314b6){const _0x37ac64=a0_0x37ac();return a0_0x47fc=function(_0x47fc88,_0x13aca6){_0x47fc88=_0x47fc88-0x1df;let _0x579446=_0x37ac64[_0x47fc88];if(a0_0x47fc['wRGQrU']===undefined){var _0x1b1a1f=function(_0x585990){const _0x41e4bd='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x31bf72='',_0x3eff52='';for(let _0x44f43f=0x0,_0x3e4fba,_0x22cf3d,_0x2c4b0b=0x0;_0x22cf3d=_0x585990['charAt'](_0x2c4b0b++);~_0x22cf3d&&(_0x3e4fba=_0x44f43f%0x4?_0x3e4fba*0x40+_0x22cf3d:_0x22cf3d,_0x44f43f++%0x4)?_0x31bf72+=String['fromCharCode'](0xff&_0x3e4fba>>(-0x2*_0x44f43f&0x6)):0x0){_0x22cf3d=_0x41e4bd['indexOf'](_0x22cf3d);}for(let _0x2656af=0x0,_0x1088cf=_0x31bf72['length'];_0x2656af<_0x1088cf;_0x2656af++){_0x3eff52+='%'+('00'+_0x31bf72['charCodeAt'](_0x2656af)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3eff52);};a0_0x47fc['nVQYVs']=_0x1b1a1f,_0x562d60=arguments,a0_0x47fc['wRGQrU']=!![];}const _0x58de09=_0x37ac64[0x0],_0x3d1c6e=_0x47fc88+_0x58de09,_0x2d5920=_0x562d60[_0x3d1c6e];return!_0x2d5920?(_0x579446=a0_0x47fc['nVQYVs'](_0x579446),_0x562d60[_0x3d1c6e]=_0x579446):_0x579446=_0x2d5920,_0x579446;},a0_0x47fc(_0x562d60,_0x4314b6);}const a0_0x357901=a0_0x47fc;(function(_0x44c36d,_0x371cd2){const _0x29fe97=a0_0x47fc,_0x186984=_0x44c36d();while(!![]){try{const _0x44fe5b=parseInt(_0x29fe97(0x1f0))/0x1*(parseInt(_0x29fe97(0x1fa))/0x2)+parseInt(_0x29fe97(0x1ea))/0x3+parseInt(_0x29fe97(0x1eb))/0x4*(-parseInt(_0x29fe97(0x1e9))/0x5)+parseInt(_0x29fe97(0x1f1))/0x6*(-parseInt(_0x29fe97(0x1f4))/0x7)+-parseInt(_0x29fe97(0x1e1))/0x8*(parseInt(_0x29fe97(0x1f9))/0x9)+parseInt(_0x29fe97(0x200))/0xa+parseInt(_0x29fe97(0x1ef))/0xb;if(_0x44fe5b===_0x371cd2)break;else _0x186984['push'](_0x186984['shift']());}catch(_0x1eb954){_0x186984['push'](_0x186984['shift']());}}}(a0_0x37ac,0x83a27));import{TagParser}from'../utilities/tagParser.js';export class TagParserService{constructor(_0x585990){const _0xb39f37=a0_0x47fc;this[_0xb39f37(0x1e3)]=_0x585990;}[a0_0x357901(0x1ec)](_0x41e4bd){const _0x390d7b=a0_0x357901;this['logger'][_0x390d7b(0x1e4)](_0x390d7b(0x1f7));const _0x31bf72={'recipient':null,'content':_0x41e4bd,'toolCommands':[],'prompt':null,'jobDone':null};try{const _0x3eff52=TagParser['extractContent'](_0x41e4bd,'job-done');_0x3eff52['length']>0x0&&(_0x31bf72[_0x390d7b(0x1f8)]=_0x3eff52[0x0]);const _0x44f43f=TagParser['query'](_0x41e4bd,'message');if(_0x44f43f['length']>0x0){const _0x3e4fba=_0x44f43f[0x0];_0x31bf72[_0x390d7b(0x1f6)]=_0x3e4fba[_0x390d7b(0x1df)]['to'],_0x31bf72[_0x390d7b(0x1e0)]=_0x3e4fba['content'],this['logger'][_0x390d7b(0x1e4)](_0x390d7b(0x1fc)+_0x31bf72['recipient']);}return this[_0x390d7b(0x1f2)](_0x41e4bd,_0x31bf72),this[_0x390d7b(0x1e6)](_0x41e4bd,_0x31bf72),_0x31bf72;}catch(_0x22cf3d){return this[_0x390d7b(0x1e3)][_0x390d7b(0x1e5)]('Error\x20parsing\x20message\x20with\x20TagParser:',_0x22cf3d),_0x31bf72;}}[a0_0x357901(0x1f2)](_0x2c4b0b,_0x2656af){const _0x543f18=a0_0x357901,_0x1088cf=TagParser[_0x543f18(0x1f3)](_0x2c4b0b,'tools-commands');for(const _0x1fb00a of _0x1088cf){const _0x5b4a77=_0x1fb00a['content'],_0x5d3ddc=TagParser['query'](_0x5b4a77,'tool');for(const _0x22f60f of _0x5d3ddc){const _0x3572c9=_0x22f60f[_0x543f18(0x1df)]['id'];if(!_0x3572c9)continue;const _0x1022d0=_0x22f60f['content'];_0x2656af['toolCommands'][_0x543f18(0x1fb)]({'toolId':_0x3572c9,'content':_0x1022d0,'rawTag':_0x22f60f}),this[_0x543f18(0x1e3)]['info'](_0x543f18(0x1f5)+_0x3572c9);}}if(_0x1088cf['length']===0x0&&_0x2c4b0b[_0x543f18(0x1fd)](_0x543f18(0x1ee))){const _0x4c1311=TagParser['query'](_0x2c4b0b,_0x543f18(0x1e7));for(const _0x537357 of _0x4c1311){const _0x5b5268=_0x537357['attributes']['id'];if(!_0x5b5268)continue;const _0x473e14=_0x537357[_0x543f18(0x1e0)];_0x2656af['toolCommands']['push']({'toolId':_0x5b5268,'content':_0x473e14,'rawTag':_0x537357}),this[_0x543f18(0x1e3)]['info'](_0x543f18(0x1ff)+_0x5b5268);}}}[a0_0x357901(0x1e6)](_0x8aefda,_0x34acdc){const _0x4817a1=a0_0x357901,_0x8f85a3=TagParser[_0x4817a1(0x1f3)](_0x8aefda,_0x4817a1(0x201));if(_0x8f85a3['length']>0x0){const _0x82647c=_0x8f85a3[0x0],_0x354b0=_0x82647c[_0x4817a1(0x1df)][_0x4817a1(0x1ed)]||'User\x20Prompt',_0x4e8307=_0x82647c[_0x4817a1(0x1e0)],_0x26c76d=TagParser[_0x4817a1(0x1e8)](_0x4e8307,_0x4817a1(0x1fe));_0x34acdc[_0x4817a1(0x201)]={'name':_0x354b0,'text':_0x4e8307[_0x4817a1(0x1e2)](/\[option\](.*?)\[\/option\]/gs,'')['trim'](),'options':_0x26c76d},this['logger']['info']('Extracted\x20prompt:\x20'+_0x354b0+'\x20with\x20'+_0x26c76d['length']+'\x20options');}}}function a0_0x37ac(){const _0x4364f6=['CxvLCNK','mJfxqurMzeq','rxH0CMfJDgvKihrVB2WGy29TBwfUzdOG','CMvJAxbPzw50','ugfYC2LUzYbTzxnZywDLihDPDgGGvgfNugfYC2vY','AM9Irg9Uzq','mZy5CvLwvKvM','odm2otzzuwvPB0u','ChvZAa','twvZC2fNzsb0BYbYzwnPCgLLBNq6ia','Aw5JBhvKzxm','B3b0Aw9U','rxH0CMfJDgvKigrPCMvJDcb0B29SignVBw1HBMq6ia','mZe4mdK0mg1bu2vfBG','ChjVBxb0','yxr0CMLIDxrLCW','y29UDgvUDa','ntqXmtjbzNHHAei','CMvWBgfJzq','Bg9Nz2vY','Aw5MBW','zxjYB3i','CgfYC2vqCM9TChq','Dg9VBa','zxH0CMfJDenVBNrLBNq','mJGYnde1nxjNqNnArG','ntq2otu3su92qw1Z','nfnHvw5kyG','CgfYC2vnzxnZywDL','BMfTzq','w3rVB2WGAwq9','mta1otm5otbOvwXYBMK','ou9ruNDRAG','ote3nJeWrLDJzuXb','CgfYC2vuB29Sq29TBwfUzhm'];a0_0x37ac=function(){return _0x4364f6;};return a0_0x37ac();}