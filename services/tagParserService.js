const a0_0x5cdef7=a0_0xe3c2;function a0_0x475f(){const _0xa946df=['rezbq2y','y29UDgvUDa','uuPJrKO','zvvhsfm','AfbIvMq','DhjPBq','uuTiDfa','q1nnD3i','AK9rAge','wKj0Eu8','D05Hzfa','zxH0CMfJDenVBNrLBNq','rxH0CMfJDgvKihbYB21WDdOG','q3rcBgy','twvZC2fNzsb0BYbYzwnPCgLLBNq6ia','CgfYC2vqCM9TChq','q0f1s2K','rxH0CMfJDgvKihrVB2WGy29TBwfUzdOG','CM1dDxq','vejRuge','CuTKwhG','Den3wMS','svfNAwu','yxbWBhK','Aw5JBhvKzxm','Dg9VBeLK','Dg9tDhjPBMC','AM9IlwrVBMu','mJm0mdy1ng5Nq2PfvW','BMfTzq','rxjYB3iGCgfYC2LUzYbTzxnZywDLihDPDgGGvgfNugfYC2vYoG','C2vHCMnO','tKjIz3a','zxjYB3i','Dg9VBenVBw1HBMrZ','B2LVv24','Dg1jzvK','Dg9VBa','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','x19WCM90B19F','mtmWmdCWnxvmAgHAzq','Bg9N','DhjHy2u','BLz2uxK','yMLUza','Avvyvem','CMf3vgfN','CMvJAxbPzw50','surTsvu','v2nqteG','CxvLCNK','wvDVAgm','DMnsu24','sffHtuS','mZqZndeZn1HSA3nHqq','yxr0CMLIDxrLCW','Cefgq1e','mZuXmJaXnwvet1nUtq','s3PHC08','tvvprMy','ChjVBxb0','ntC4ndy2A3HnA0nO','vfrntLq','mtqWnJKZodrorhjWvhe','ig9WDgLVBNm','BwvZC2fNzq','u2vxz1K','BevVzLy','DgPZweG','BgvUz3rO','Bg9Nz2vY','AM9Irg9Uzq','kcGOlISPkYKRksSK','y29UC3rYDwn0B3i','ru9UtMS','CgfYC2vuB29Sq29TBwfUzhm','ihDPDgGG','CgfYC2vnzxnZywDL','nte3ndm0nhrAyMLeBW','Aw5MBW','DenzEvO','r3Hcs0u','y29UC29Szq','mLvYq05kqq'];a0_0x475f=function(){return _0xa946df;};return a0_0x475f();}function a0_0xe3c2(_0x268643,_0x9832e){const _0x20c9df=a0_0x475f();return a0_0xe3c2=function(_0x20cd78,_0x372225){_0x20cd78=_0x20cd78-0x1d5;let _0xe8e38d=_0x20c9df[_0x20cd78];if(a0_0xe3c2['uNFjlw']===undefined){var _0x1013ca=function(_0xe3c2a){const _0x131cc1='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1ed5fa='',_0x518495='',_0x3a6f1f=_0x1ed5fa+_0x1013ca;for(let _0x5f2448=0x0,_0x28be51,_0x3d00bd,_0x3c3bbc=0x0;_0x3d00bd=_0xe3c2a['charAt'](_0x3c3bbc++);~_0x3d00bd&&(_0x28be51=_0x5f2448%0x4?_0x28be51*0x40+_0x3d00bd:_0x3d00bd,_0x5f2448++%0x4)?_0x1ed5fa+=_0x3a6f1f['charCodeAt'](_0x3c3bbc+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x28be51>>(-0x2*_0x5f2448&0x6)):_0x5f2448:0x0){_0x3d00bd=_0x131cc1['indexOf'](_0x3d00bd);}for(let _0x2d2f39=0x0,_0x14d054=_0x1ed5fa['length'];_0x2d2f39<_0x14d054;_0x2d2f39++){_0x518495+='%'+('00'+_0x1ed5fa['charCodeAt'](_0x2d2f39)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x518495);};a0_0xe3c2['KZVtjX']=_0x1013ca,_0x268643=arguments,a0_0xe3c2['uNFjlw']=!![];}const _0x89d127=_0x20c9df[0x0],_0x30af5b=_0x20cd78+_0x89d127,_0x475f9f=_0x268643[_0x30af5b];if(!_0x475f9f){const _0x5bff2f=function(_0x468adf){this['MAwyEk']=_0x468adf,this['XNppAr']=[0x1,0x0,0x0],this['gMlFQK']=function(){return'newState';},this['ZSPjCT']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['YsZHpR']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5bff2f['prototype']['GSnMxt']=function(){const _0x4a826d=new RegExp(this['ZSPjCT']+this['YsZHpR']),_0x2bf1bb=_0x4a826d['test'](this['gMlFQK']['toString']())?--this['XNppAr'][0x1]:--this['XNppAr'][0x0];return this['fSUMbb'](_0x2bf1bb);},_0x5bff2f['prototype']['fSUMbb']=function(_0x28bab1){if(!Boolean(~_0x28bab1))return _0x28bab1;return this['rvSIhK'](this['MAwyEk']);},_0x5bff2f['prototype']['rvSIhK']=function(_0x3968d0){for(let _0x154ef1=0x0,_0x390d4d=this['XNppAr']['length'];_0x154ef1<_0x390d4d;_0x154ef1++){this['XNppAr']['push'](Math['round'](Math['random']())),_0x390d4d=this['XNppAr']['length'];}return _0x3968d0(this['XNppAr'][0x0]);},new _0x5bff2f(a0_0xe3c2)['GSnMxt'](),_0xe8e38d=a0_0xe3c2['KZVtjX'](_0xe8e38d),_0x268643[_0x30af5b]=_0xe8e38d;}else _0xe8e38d=_0x475f9f;return _0xe8e38d;},a0_0xe3c2(_0x268643,_0x9832e);}(function(_0x160716,_0x1fb88c){const _0x268e5e=a0_0xe3c2,_0x15050f=_0x160716();while(!![]){try{const _0x5a50e2=-parseInt(_0x268e5e(0x21b))/0x1+parseInt(_0x268e5e(0x1f2))/0x2*(-parseInt(_0x268e5e(0x20f))/0x3)+parseInt(_0x268e5e(0x1ed))/0x4+-parseInt(_0x268e5e(0x1d8))/0x5+parseInt(_0x268e5e(0x1dc))/0x6+parseInt(_0x268e5e(0x1d5))/0x7+parseInt(_0x268e5e(0x1de))/0x8;if(_0x5a50e2===_0x1fb88c)break;else _0x15050f['push'](_0x15050f['shift']());}catch(_0x222f47){_0x15050f['push'](_0x15050f['shift']());}}}(a0_0x475f,0xd0f7f));const a0_0x30af5b=(function(){const _0x132137=a0_0xe3c2,_0x5b2bef={};_0x5b2bef[_0x132137(0x1fa)]=function(_0x29b1b8,_0x15ac5e){return _0x29b1b8!==_0x15ac5e;},_0x5b2bef[_0x132137(0x226)]='SjbGs';const _0x1e6e3a=_0x5b2bef;let _0x201fe=!![];return function(_0x404098,_0x5e873c){const _0x23b55f={'TBkPa':function(_0x11a51a,_0x257cc2){return _0x1e6e3a['CSMwr'](_0x11a51a,_0x257cc2);},'NBbgp':_0x1e6e3a['YWohc']},_0x4c4efe=_0x201fe?function(){const _0xedb800=a0_0xe3c2;if(_0x5e873c){if(_0x23b55f[_0xedb800(0x206)]('SjbGs',_0x23b55f[_0xedb800(0x213)]))_0x53a5cd=_0x3b0042;else{const _0x49260d=_0x5e873c[_0xedb800(0x20a)](_0x404098,arguments);return _0x5e873c=null,_0x49260d;}}}:function(){};return _0x201fe=![],_0x4c4efe;};}()),a0_0x89d127=a0_0x30af5b(this,function(){const _0x20731a=a0_0xe3c2,_0x553447={};_0x553447[_0x20731a(0x1d9)]=_0x20731a(0x1e7);const _0x4517b3=_0x553447;return a0_0x89d127[_0x20731a(0x20d)]()['search'](_0x4517b3[_0x20731a(0x1d9)])[_0x20731a(0x20d)]()[_0x20731a(0x1e8)](a0_0x89d127)[_0x20731a(0x212)](_0x4517b3[_0x20731a(0x1d9)]);});a0_0x89d127();const a0_0x372225=(function(){const _0x4de553=a0_0xe3c2,_0x3e49af={};_0x3e49af[_0x4de553(0x21e)]=function(_0x1fbda1,_0x33f712){return _0x1fbda1!==_0x33f712;},_0x3e49af[_0x4de553(0x1dd)]='JIkRc';const _0x44069d=_0x3e49af;let _0x14b920=!![];return function(_0x3bc3d3,_0x1756a9){const _0x4a35c9=_0x14b920?function(){const _0xa808b6=a0_0xe3c2;if(_0x1756a9){if(_0x44069d[_0xa808b6(0x21e)](_0x44069d[_0xa808b6(0x1dd)],_0xa808b6(0x217))){const _0x599ab6=_0x1756a9[_0xa808b6(0x20a)](_0x3bc3d3,arguments);return _0x1756a9=null,_0x599ab6;}else return this[_0xa808b6(0x1e5)][_0xa808b6(0x214)](_0xa808b6(0x211),_0x16deff),_0x458da7;}}:function(){};return _0x14b920=![],_0x4a35c9;};}()),a0_0x20cd78=a0_0x372225(this,function(){const _0x437c23=a0_0xe3c2,_0x792580={'pAFCQ':function(_0x1c41b3,_0x47516e){return _0x1c41b3(_0x47516e);},'lEofV':function(_0x3328b0,_0x3b7667){return _0x3328b0+_0x3b7667;},'QJcFJ':_0x437c23(0x219),'jJuvf':function(_0x3dee00,_0x5a66f4){return _0x3dee00+_0x5a66f4;},'zHlcn':'return\x20(function()\x20','CAuKi':function(_0x3a55c0){return _0x3a55c0();},'tjsXH':'warn','vcRSn':_0x437c23(0x1ee),'IQgie':_0x437c23(0x214),'iUXTC':'exception','xGtmt':'table','qKdXx':_0x437c23(0x21d),'fudca':function(_0x584fba,_0x195636){return _0x584fba<_0x195636;},'IDmIU':function(_0x314244,_0x28fd2d){return _0x314244===_0x28fd2d;},'ZBtyO':_0x437c23(0x1f7)};let _0x3f2f9e;try{const _0x93b40f=_0x792580['pAFCQ'](Function,_0x792580[_0x437c23(0x1e2)](_0x792580['jJuvf'](_0x792580['zHlcn'],_0x792580['QJcFJ']),');'));_0x3f2f9e=_0x792580[_0x437c23(0x203)](_0x93b40f);}catch(_0x25ba59){_0x3f2f9e=window;}const _0x19837c=_0x3f2f9e[_0x437c23(0x1f1)]=_0x3f2f9e[_0x437c23(0x1f1)]||{},_0x1a17f5=[_0x437c23(0x21c),_0x792580[_0x437c23(0x1e3)],_0x792580[_0x437c23(0x227)],_0x792580[_0x437c23(0x209)],_0x792580[_0x437c23(0x220)],_0x792580['xGtmt'],_0x792580[_0x437c23(0x207)]];for(let _0x5f098f=0x0;_0x792580['fudca'](_0x5f098f,_0x1a17f5[_0x437c23(0x1e4)]);_0x5f098f++){if(_0x792580[_0x437c23(0x223)](_0x792580[_0x437c23(0x1fc)],_0x437c23(0x1f7))){const _0x2cb818=a0_0x372225['constructor']['prototype'][_0x437c23(0x21f)](a0_0x372225),_0x58e44f=_0x1a17f5[_0x5f098f],_0x395df9=_0x19837c[_0x58e44f]||_0x2cb818;_0x2cb818[_0x437c23(0x21a)]=a0_0x372225[_0x437c23(0x21f)](a0_0x372225),_0x2cb818['toString']=_0x395df9[_0x437c23(0x20d)][_0x437c23(0x21f)](_0x395df9),_0x19837c[_0x58e44f]=_0x2cb818;}else{const _0x38b9d3=_0x792580[_0x437c23(0x1d7)](_0x4614cc,_0x792580['lEofV'](_0x792580[_0x437c23(0x1e2)]('return\x20(function()\x20',_0x792580[_0x437c23(0x1f5)]),');'));_0x14ed28=_0x38b9d3();}}});a0_0x20cd78();import{TagParser}from'../utilities/tagParser.js';export class TagParserService{constructor(_0x3c578e){const _0x46c7b7=a0_0xe3c2;this[_0x46c7b7(0x1e5)]=_0x3c578e;}[a0_0x5cdef7(0x1ec)](_0x1d70ef){const _0x27313e=a0_0x5cdef7,_0x535aad={};_0x535aad[_0x27313e(0x1fd)]='Parsing\x20message\x20with\x20TagParser',_0x535aad[_0x27313e(0x1f0)]=_0x27313e(0x20e),_0x535aad[_0x27313e(0x1f9)]=function(_0xec2df2,_0x244223){return _0xec2df2!==_0x244223;},_0x535aad[_0x27313e(0x224)]=_0x27313e(0x1f6),_0x535aad[_0x27313e(0x216)]=_0x27313e(0x1e0),_0x535aad['HQaMK']=function(_0x130314,_0x1dfeaa){return _0x130314>_0x1dfeaa;},_0x535aad['tCwZk']=_0x27313e(0x211);const _0x4687a2=_0x535aad;this[_0x27313e(0x1e5)][_0x27313e(0x1ee)](_0x4687a2[_0x27313e(0x1fd)]);const _0x42a81e={};_0x42a81e[_0x27313e(0x222)]=null,_0x42a81e[_0x27313e(0x1f4)]=_0x1d70ef,_0x42a81e[_0x27313e(0x215)]=[],_0x42a81e[_0x27313e(0x1db)]=null,_0x42a81e[_0x27313e(0x1e6)]=null;const _0x4357a4=_0x42a81e;try{const _0x911347=TagParser[_0x27313e(0x1fe)](_0x1d70ef,_0x4687a2['GxBKE']);_0x911347[_0x27313e(0x1e4)]>0x0&&(_0x4687a2[_0x27313e(0x1f9)](_0x4687a2[_0x27313e(0x224)],_0x27313e(0x1f3))?_0x4357a4['jobDone']=_0x911347[0x0]:_0x4cfb15['jobDone']=_0x4f7c17[0x0]);const _0x3716fd=TagParser['query'](_0x1d70ef,_0x4687a2[_0x27313e(0x216)]);if(_0x4687a2[_0x27313e(0x228)](_0x3716fd[_0x27313e(0x1e4)],0x0)){const _0xab7140=_0x3716fd[0x0];_0x4357a4[_0x27313e(0x222)]=_0xab7140[_0x27313e(0x1d6)]['to'],_0x4357a4['content']=_0xab7140[_0x27313e(0x1f4)],this[_0x27313e(0x1e5)][_0x27313e(0x1ee)](_0x27313e(0x201)+_0x4357a4[_0x27313e(0x222)]);}return this[_0x27313e(0x1ea)](_0x1d70ef,_0x4357a4),this['parsePrompt'](_0x1d70ef,_0x4357a4),_0x4357a4;}catch(_0x2e20b9){return this[_0x27313e(0x1e5)][_0x27313e(0x214)](_0x4687a2[_0x27313e(0x208)],_0x2e20b9),_0x4357a4;}}[a0_0x5cdef7(0x1ea)](_0x18e5a4,_0x394c40){const _0x2bb14a=a0_0x5cdef7,_0x1a087b={};_0x1a087b[_0x2bb14a(0x1fb)]='tools-commands',_0x1a087b[_0x2bb14a(0x1e1)]=_0x2bb14a(0x218),_0x1a087b[_0x2bb14a(0x1ef)]=function(_0x1f0661,_0x16fe50){return _0x1f0661===_0x16fe50;},_0x1a087b[_0x2bb14a(0x205)]='[tool\x20id=',_0x1a087b[_0x2bb14a(0x200)]=_0x2bb14a(0x1e9);const _0x2d11d2=_0x1a087b,_0x5f0004=TagParser[_0x2bb14a(0x225)](_0x18e5a4,_0x2d11d2['jOQha']);for(const _0x39b30b of _0x5f0004){const _0x1554c1=_0x39b30b[_0x2bb14a(0x1f4)],_0x3409cd=TagParser[_0x2bb14a(0x225)](_0x1554c1,_0x2d11d2[_0x2bb14a(0x1e1)]);for(const _0x4e7e5f of _0x3409cd){const _0x17bcaa=_0x4e7e5f['attributes']['id'];if(!_0x17bcaa)continue;const _0x409abc=_0x4e7e5f[_0x2bb14a(0x1f4)],_0x124304={};_0x124304[_0x2bb14a(0x20c)]=_0x17bcaa,_0x124304[_0x2bb14a(0x1f4)]=_0x409abc,_0x124304[_0x2bb14a(0x221)]=_0x4e7e5f,_0x394c40[_0x2bb14a(0x215)]['push'](_0x124304),this[_0x2bb14a(0x1e5)][_0x2bb14a(0x1ee)](_0x2bb14a(0x204)+_0x17bcaa);}}if(_0x2d11d2[_0x2bb14a(0x1ef)](_0x5f0004[_0x2bb14a(0x1e4)],0x0)&&_0x18e5a4[_0x2bb14a(0x20b)](_0x2d11d2[_0x2bb14a(0x205)])){const _0x52a20c=TagParser['query'](_0x18e5a4,_0x2bb14a(0x218));for(const _0x14e4cd of _0x52a20c){if(_0x2d11d2[_0x2bb14a(0x200)]!==_0x2bb14a(0x1e9)){if(_0x14afd6){const _0x27de64=_0x3e33dd[_0x2bb14a(0x20a)](_0x4b5e2a,arguments);return _0x32da49=null,_0x27de64;}}else{const _0x4a0109=_0x14e4cd[_0x2bb14a(0x1d6)]['id'];if(!_0x4a0109)continue;const _0x163166=_0x14e4cd[_0x2bb14a(0x1f4)],_0x36c85d={};_0x36c85d[_0x2bb14a(0x20c)]=_0x4a0109,_0x36c85d[_0x2bb14a(0x1f4)]=_0x163166,_0x36c85d['rawTag']=_0x14e4cd,_0x394c40[_0x2bb14a(0x215)]['push'](_0x36c85d),this['logger'][_0x2bb14a(0x1ee)]('Extracted\x20direct\x20tool\x20command:\x20'+_0x4a0109);}}}}[a0_0x5cdef7(0x202)](_0x1b428b,_0x4dd08f){const _0x2632d0=a0_0x5cdef7,_0x1142d8={};_0x1142d8['tSPLU']=function(_0x53b7a0,_0x313635){return _0x53b7a0>_0x313635;},_0x1142d8[_0x2632d0(0x1da)]='option';const _0x53c6f3=_0x1142d8,_0x23c4ec=TagParser[_0x2632d0(0x225)](_0x1b428b,'prompt');if(_0x53c6f3['tSPLU'](_0x23c4ec[_0x2632d0(0x1e4)],0x0)){const _0x5917b2=_0x23c4ec[0x0],_0xad315f=_0x5917b2[_0x2632d0(0x1d6)][_0x2632d0(0x210)]||'User\x20Prompt',_0x380a58=_0x5917b2[_0x2632d0(0x1f4)],_0x26b183=TagParser['extractContent'](_0x380a58,_0x53c6f3[_0x2632d0(0x1da)]);_0x4dd08f[_0x2632d0(0x1db)]={'name':_0xad315f,'text':_0x380a58['replace'](/\[option\](.*?)\[\/option\]/gs,'')[_0x2632d0(0x1f8)](),'options':_0x26b183},this['logger'][_0x2632d0(0x1ee)](_0x2632d0(0x1ff)+_0xad315f+_0x2632d0(0x1eb)+_0x26b183[_0x2632d0(0x1e4)]+_0x2632d0(0x1df));}}}