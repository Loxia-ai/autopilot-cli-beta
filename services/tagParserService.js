function a0_0x3497(_0x490784,_0x58e0e3){const _0x5b2183=a0_0x5b21();return a0_0x3497=function(_0x3497b5,_0x32f434){_0x3497b5=_0x3497b5-0x157;let _0x5604ae=_0x5b2183[_0x3497b5];if(a0_0x3497['MJnlWM']===undefined){var _0x4f39cb=function(_0x47f4cc){const _0x448962='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3d45d3='',_0x6cb066='';for(let _0x43db8b=0x0,_0x1567e8,_0x3fc92e,_0x523152=0x0;_0x3fc92e=_0x47f4cc['charAt'](_0x523152++);~_0x3fc92e&&(_0x1567e8=_0x43db8b%0x4?_0x1567e8*0x40+_0x3fc92e:_0x3fc92e,_0x43db8b++%0x4)?_0x3d45d3+=String['fromCharCode'](0xff&_0x1567e8>>(-0x2*_0x43db8b&0x6)):0x0){_0x3fc92e=_0x448962['indexOf'](_0x3fc92e);}for(let _0x122580=0x0,_0x39966f=_0x3d45d3['length'];_0x122580<_0x39966f;_0x122580++){_0x6cb066+='%'+('00'+_0x3d45d3['charCodeAt'](_0x122580)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x6cb066);};a0_0x3497['cUMpKv']=_0x4f39cb,_0x490784=arguments,a0_0x3497['MJnlWM']=!![];}const _0xe8fce=_0x5b2183[0x0],_0x33ca45=_0x3497b5+_0xe8fce,_0x4ab5b0=_0x490784[_0x33ca45];return!_0x4ab5b0?(_0x5604ae=a0_0x3497['cUMpKv'](_0x5604ae),_0x490784[_0x33ca45]=_0x5604ae):_0x5604ae=_0x4ab5b0,_0x5604ae;},a0_0x3497(_0x490784,_0x58e0e3);}const a0_0x19bf21=a0_0x3497;(function(_0x2d0166,_0x1bd8cc){const _0x59e9c6=a0_0x3497,_0x3d38fc=_0x2d0166();while(!![]){try{const _0x74545d=-parseInt(_0x59e9c6(0x16b))/0x1*(parseInt(_0x59e9c6(0x176))/0x2)+parseInt(_0x59e9c6(0x179))/0x3*(parseInt(_0x59e9c6(0x177))/0x4)+parseInt(_0x59e9c6(0x15b))/0x5*(parseInt(_0x59e9c6(0x16c))/0x6)+-parseInt(_0x59e9c6(0x158))/0x7*(parseInt(_0x59e9c6(0x15a))/0x8)+-parseInt(_0x59e9c6(0x163))/0x9*(-parseInt(_0x59e9c6(0x170))/0xa)+parseInt(_0x59e9c6(0x162))/0xb+parseInt(_0x59e9c6(0x165))/0xc*(-parseInt(_0x59e9c6(0x15f))/0xd);if(_0x74545d===_0x1bd8cc)break;else _0x3d38fc['push'](_0x3d38fc['shift']());}catch(_0x36676d){_0x3d38fc['push'](_0x3d38fc['shift']());}}}(a0_0x5b21,0xbdb60));function a0_0x5b21(){const _0x19dff3=['ig9WDgLVBNm','yxr0CMLIDxrLCW','nZbcrwnoru4','rxH0CMfJDgvKigrPCMvJDcb0B29SignVBw1HBMq6ia','y29UDgvUDa','AM9Irg9Uzq','Aw5JBhvKzxm','ihDPDgGG','mMLYsgXwuW','mJHNsvj0vwS','twvZC2fNzsb0BYbYzwnPCgLLBNq6ia','nJeXmdeZv3Dny0rW','zxH0CMfJDenVBNrLBNq','nJq2mZi4mLHrzNreCa','ugfYC2LUzYbTzxnZywDLihDPDgGGvgfNugfYC2vY','ofDXBez3zW','mtbHs0XQC08','Bg9Nz2vY','CMvWBgfJzq','Aw5MBW','mtmXndnlrgjoBMq','BwvZC2fNzq','w3rVB2WGAwq9','mty5odqXnJvRsxHnyvK','mtu2ndG0ohvhue5nCq','BgvUz3rO','mJCZotzpA2noq0y','AM9IlwrVBMu','CMvJAxbPzw50','ChjVBxb0','rxH0CMfJDgvKihrVB2WGy29TBwfUzdOG','ChvZAa','mZuZmtC5vxHHu3Ld','nti0ntC0uLzptMPm','CgfYC2vqCM9TChq'];a0_0x5b21=function(){return _0x19dff3;};return a0_0x5b21();}import{TagParser}from'../utilities/tagParser.js';export class TagParserService{constructor(_0x47f4cc){const _0x41b249=a0_0x3497;this[_0x41b249(0x15c)]=_0x47f4cc;}['parseMessage'](_0x448962){const _0x5d9c7c=a0_0x3497;this[_0x5d9c7c(0x15c)][_0x5d9c7c(0x15e)](_0x5d9c7c(0x159));const _0x3d45d3={'recipient':null,'content':_0x448962,'toolCommands':[],'prompt':null,'jobDone':null};try{const _0x6cb066=TagParser[_0x5d9c7c(0x157)](_0x448962,_0x5d9c7c(0x166));_0x6cb066['length']>0x0&&(_0x3d45d3[_0x5d9c7c(0x173)]=_0x6cb066[0x0]);const _0x43db8b=TagParser['query'](_0x448962,_0x5d9c7c(0x160));if(_0x43db8b['length']>0x0){const _0x1567e8=_0x43db8b[0x0];_0x3d45d3['recipient']=_0x1567e8[_0x5d9c7c(0x16f)]['to'],_0x3d45d3['content']=_0x1567e8['content'],this[_0x5d9c7c(0x15c)]['info'](_0x5d9c7c(0x178)+_0x3d45d3[_0x5d9c7c(0x167)]);}return this['parseToolCommands'](_0x448962,_0x3d45d3),this['parsePrompt'](_0x448962,_0x3d45d3),_0x3d45d3;}catch(_0x3fc92e){return this['logger']['error']('Error\x20parsing\x20message\x20with\x20TagParser:',_0x3fc92e),_0x3d45d3;}}['parseToolCommands'](_0x523152,_0x122580){const _0x239425=a0_0x3497,_0x39966f=TagParser['query'](_0x523152,'tools-commands');for(const _0x5b3171 of _0x39966f){const _0x41cacb=_0x5b3171[_0x239425(0x172)],_0x14332a=TagParser['query'](_0x41cacb,'tool');for(const _0x51c1f9 of _0x14332a){const _0x245611=_0x51c1f9[_0x239425(0x16f)]['id'];if(!_0x245611)continue;const _0x5ceb15=_0x51c1f9['content'];_0x122580['toolCommands'][_0x239425(0x16a)]({'toolId':_0x245611,'content':_0x5ceb15,'rawTag':_0x51c1f9}),this[_0x239425(0x15c)][_0x239425(0x15e)](_0x239425(0x169)+_0x245611);}}if(_0x39966f['length']===0x0&&_0x523152[_0x239425(0x174)](_0x239425(0x161))){const _0x5a74d9=TagParser['query'](_0x523152,'tool');for(const _0x5e56b6 of _0x5a74d9){const _0x18326c=_0x5e56b6[_0x239425(0x16f)]['id'];if(!_0x18326c)continue;const _0x21bef9=_0x5e56b6[_0x239425(0x172)];_0x122580['toolCommands'][_0x239425(0x16a)]({'toolId':_0x18326c,'content':_0x21bef9,'rawTag':_0x5e56b6}),this['logger']['info'](_0x239425(0x171)+_0x18326c);}}}[a0_0x19bf21(0x16d)](_0x5d1abe,_0x1aa316){const _0x4873bd=a0_0x19bf21,_0x144a5f=TagParser['query'](_0x5d1abe,'prompt');if(_0x144a5f['length']>0x0){const _0xfc12d6=_0x144a5f[0x0],_0x983972=_0xfc12d6[_0x4873bd(0x16f)]['name']||'User\x20Prompt',_0x461bb9=_0xfc12d6['content'],_0xf2f194=TagParser[_0x4873bd(0x157)](_0x461bb9,'option');_0x1aa316[_0x4873bd(0x168)]={'name':_0x983972,'text':_0x461bb9[_0x4873bd(0x15d)](/\[option\](.*?)\[\/option\]/gs,'')['trim'](),'options':_0xf2f194},this['logger'][_0x4873bd(0x15e)]('Extracted\x20prompt:\x20'+_0x983972+_0x4873bd(0x175)+_0xf2f194[_0x4873bd(0x164)]+_0x4873bd(0x16e));}}}