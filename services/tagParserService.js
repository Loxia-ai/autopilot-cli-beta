const a0_0x48f7bb=a0_0x47e4;(function(_0x3ecf81,_0x2367bf){const _0x3beaee=a0_0x47e4,_0x256de8=_0x3ecf81();while(!![]){try{const _0x223622=-parseInt(_0x3beaee(0x1b2))/0x1+-parseInt(_0x3beaee(0x1af))/0x2*(-parseInt(_0x3beaee(0x1b9))/0x3)+-parseInt(_0x3beaee(0x1bc))/0x4*(-parseInt(_0x3beaee(0x1ad))/0x5)+-parseInt(_0x3beaee(0x1aa))/0x6*(parseInt(_0x3beaee(0x1b7))/0x7)+-parseInt(_0x3beaee(0x1b6))/0x8*(-parseInt(_0x3beaee(0x1b0))/0x9)+-parseInt(_0x3beaee(0x1bd))/0xa*(parseInt(_0x3beaee(0x1ba))/0xb)+parseInt(_0x3beaee(0x1a4))/0xc;if(_0x223622===_0x2367bf)break;else _0x256de8['push'](_0x256de8['shift']());}catch(_0xce16a7){_0x256de8['push'](_0x256de8['shift']());}}}(a0_0x312f,0x4a34b));function a0_0x47e4(_0x201d74,_0x221a2a){const _0x312f13=a0_0x312f();return a0_0x47e4=function(_0x47e457,_0x2c0b28){_0x47e457=_0x47e457-0x1a0;let _0x524bff=_0x312f13[_0x47e457];if(a0_0x47e4['HNjHYe']===undefined){var _0x59fe8c=function(_0xd929d4){const _0x117d69='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x105b8f='',_0x2e09ed='';for(let _0x179e40=0x0,_0x5ac572,_0x1fe718,_0x55c791=0x0;_0x1fe718=_0xd929d4['charAt'](_0x55c791++);~_0x1fe718&&(_0x5ac572=_0x179e40%0x4?_0x5ac572*0x40+_0x1fe718:_0x1fe718,_0x179e40++%0x4)?_0x105b8f+=String['fromCharCode'](0xff&_0x5ac572>>(-0x2*_0x179e40&0x6)):0x0){_0x1fe718=_0x117d69['indexOf'](_0x1fe718);}for(let _0x459bfc=0x0,_0x58f546=_0x105b8f['length'];_0x459bfc<_0x58f546;_0x459bfc++){_0x2e09ed+='%'+('00'+_0x105b8f['charCodeAt'](_0x459bfc)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2e09ed);};a0_0x47e4['gCZpCF']=_0x59fe8c,_0x201d74=arguments,a0_0x47e4['HNjHYe']=!![];}const _0x1eef93=_0x312f13[0x0],_0x1f8d24=_0x47e457+_0x1eef93,_0x283e7b=_0x201d74[_0x1f8d24];return!_0x283e7b?(_0x524bff=a0_0x47e4['gCZpCF'](_0x524bff),_0x201d74[_0x1f8d24]=_0x524bff):_0x524bff=_0x283e7b,_0x524bff;},a0_0x47e4(_0x201d74,_0x221a2a);}function a0_0x312f(){const _0x186907=['mtmZnJm1nK5OAKH5tG','CMvWBgfJzq','nta0ndyYEKTOrMjP','CxvLCNK','twvZC2fNzsb0BYbYzwnPCgLLBNq6ia','AM9Irg9Uzq','mZjYCNzOzfy','nJa4otnPqK1WBfu','ugfYC2LUzYbTzxnZywDLihDPDgGGvgfNugfYC2vY','mtGYmdeWAw1RuwXI','mJqYzfLmvgD5','ChvZAa','mJm1otzKshrWshm','mta4odKWAMrSCgHz','Aw5MBW','ChjVBxb0','CgfYC2vuB29Sq29TBwfUzhm','Dg9VBenVBw1HBMrZ','CMvJAxbPzw50','rxH0CMfJDgvKigrPCMvJDcb0B29SignVBw1HBMq6ia','mZi0otq0ngjTCNvfEq','rxjYB3iGCgfYC2LUzYbTzxnZywDLihDPDgGGvgfNugfYC2vYoG','DhjPBq','BgvUz3rO','Bg9Nz2vY','zxH0CMfJDenVBNrLBNq','nJzwzwDRyuG','yxr0CMLIDxrLCW','ig9WDgLVBNm','mtG1EKDlsLzO','y29UDgvUDa','mMXICgDezq'];a0_0x312f=function(){return _0x186907;};return a0_0x312f();}import{TagParser}from'../utilities/tagParser.js';export class TagParserService{constructor(_0xd929d4){const _0x5055d1=a0_0x47e4;this[_0x5055d1(0x1a8)]=_0xd929d4;}['parseMessage'](_0x117d69){const _0x69a726=a0_0x47e4;this[_0x69a726(0x1a8)]['info'](_0x69a726(0x1b8));const _0x105b8f={'recipient':null,'content':_0x117d69,'toolCommands':[],'prompt':null,'jobDone':null};try{const _0x2e09ed=TagParser[_0x69a726(0x1a9)](_0x117d69,'job-done');_0x2e09ed['length']>0x0&&(_0x105b8f[_0x69a726(0x1b5)]=_0x2e09ed[0x0]);const _0x179e40=TagParser['query'](_0x117d69,'message');if(_0x179e40[_0x69a726(0x1a7)]>0x0){const _0x5ac572=_0x179e40[0x0];_0x105b8f[_0x69a726(0x1a2)]=_0x5ac572[_0x69a726(0x1ab)]['to'],_0x105b8f['content']=_0x5ac572['content'],this['logger']['info'](_0x69a726(0x1b4)+_0x105b8f[_0x69a726(0x1a2)]);}return this[_0x69a726(0x1a0)](_0x117d69,_0x105b8f),this['parsePrompt'](_0x117d69,_0x105b8f),_0x105b8f;}catch(_0x1fe718){return this[_0x69a726(0x1a8)]['error'](_0x69a726(0x1a5),_0x1fe718),_0x105b8f;}}[a0_0x48f7bb(0x1a0)](_0x55c791,_0x459bfc){const _0x37b5ce=a0_0x48f7bb,_0x58f546=TagParser['query'](_0x55c791,'tools-commands');for(const _0x5e2a4e of _0x58f546){const _0x46a559=_0x5e2a4e['content'],_0x3f3afc=TagParser[_0x37b5ce(0x1b3)](_0x46a559,'tool');for(const _0x3fa4c6 of _0x3f3afc){const _0x3c1ba=_0x3fa4c6['attributes']['id'];if(!_0x3c1ba)continue;const _0x56ff73=_0x3fa4c6['content'];_0x459bfc[_0x37b5ce(0x1a1)][_0x37b5ce(0x1bb)]({'toolId':_0x3c1ba,'content':_0x56ff73,'rawTag':_0x3fa4c6}),this['logger'][_0x37b5ce(0x1be)]('Extracted\x20tool\x20command:\x20'+_0x3c1ba);}}if(_0x58f546[_0x37b5ce(0x1a7)]===0x0&&_0x55c791['includes']('[tool\x20id=')){const _0xd23909=TagParser[_0x37b5ce(0x1b3)](_0x55c791,'tool');for(const _0x33fb5a of _0xd23909){const _0x5938de=_0x33fb5a[_0x37b5ce(0x1ab)]['id'];if(!_0x5938de)continue;const _0x1fc527=_0x33fb5a[_0x37b5ce(0x1ae)];_0x459bfc[_0x37b5ce(0x1a1)][_0x37b5ce(0x1bb)]({'toolId':_0x5938de,'content':_0x1fc527,'rawTag':_0x33fb5a}),this[_0x37b5ce(0x1a8)][_0x37b5ce(0x1be)](_0x37b5ce(0x1a3)+_0x5938de);}}}['parsePrompt'](_0x2ce017,_0x3322b5){const _0x26754=a0_0x48f7bb,_0x37c71d=TagParser[_0x26754(0x1b3)](_0x2ce017,_0x26754(0x1bf));if(_0x37c71d[_0x26754(0x1a7)]>0x0){const _0x44f5e1=_0x37c71d[0x0],_0x5756ca=_0x44f5e1['attributes']['name']||'User\x20Prompt',_0x37922f=_0x44f5e1[_0x26754(0x1ae)],_0x18eaaf=TagParser['extractContent'](_0x37922f,'option');_0x3322b5['prompt']={'name':_0x5756ca,'text':_0x37922f[_0x26754(0x1b1)](/\[option\](.*?)\[\/option\]/gs,'')[_0x26754(0x1a6)](),'options':_0x18eaaf},this['logger'][_0x26754(0x1be)]('Extracted\x20prompt:\x20'+_0x5756ca+'\x20with\x20'+_0x18eaaf['length']+_0x26754(0x1ac));}}}