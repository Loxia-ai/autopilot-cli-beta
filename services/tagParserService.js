const a0_0x5d32e3=a0_0x3014;(function(_0x32dce3,_0x1b578d){const _0x4d38b8=a0_0x3014,_0x310a46=_0x32dce3();while(!![]){try{const _0x54ebc1=parseInt(_0x4d38b8(0x1de))/0x1+parseInt(_0x4d38b8(0x1e2))/0x2*(parseInt(_0x4d38b8(0x1db))/0x3)+parseInt(_0x4d38b8(0x1df))/0x4+-parseInt(_0x4d38b8(0x1e8))/0x5+parseInt(_0x4d38b8(0x1eb))/0x6+parseInt(_0x4d38b8(0x1ee))/0x7*(-parseInt(_0x4d38b8(0x1d6))/0x8)+-parseInt(_0x4d38b8(0x1d8))/0x9;if(_0x54ebc1===_0x1b578d)break;else _0x310a46['push'](_0x310a46['shift']());}catch(_0x5bee63){_0x310a46['push'](_0x310a46['shift']());}}}(a0_0x3585,0xafee5));function a0_0x3585(){const _0x582f3e=['mte1mdmYz1rUqwjn','Dg9VBa','BgvUz3rO','mJfNwunQBvC','CxvLCNK','rxH0CMfJDgvKihrVB2WGy29TBwfUzdOG','mtaZode4nenLB1zHra','Bg9Nz2vY','nJaYndiYmKPiEurHCa','CgfYC2vqCM9TChq','B3b0Aw9U','mtm4ndK1rKTlrNvf','Aw5JBhvKzxm','y29UDgvUDa','mZCYodC3whP1Eevp','mtK2nJGWwfLvvNzz','ChjVBxb0','CMvJAxbPzw50','nJbSu05dzxO','yxr0CMLIDxrLCW','Aw5MBW','w3rVB2WGAwq9','CgfYC2vuB29Sq29TBwfUzhm','zxH0CMfJDenVBNrLBNq','mJm0mZK1vxn4sw9V','DhjPBq','BMfTzq'];a0_0x3585=function(){return _0x582f3e;};return a0_0x3585();}function a0_0x3014(_0x558478,_0xd6297b){const _0x3585ab=a0_0x3585();return a0_0x3014=function(_0x301447,_0x360b9){_0x301447=_0x301447-0x1d6;let _0x1bcb8a=_0x3585ab[_0x301447];if(a0_0x3014['BRDCBB']===undefined){var _0x5c2947=function(_0x4b47c1){const _0xb44eb8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x6ab94b='',_0x20293f='';for(let _0x206405=0x0,_0x321abe,_0x420b53,_0x1500f9=0x0;_0x420b53=_0x4b47c1['charAt'](_0x1500f9++);~_0x420b53&&(_0x321abe=_0x206405%0x4?_0x321abe*0x40+_0x420b53:_0x420b53,_0x206405++%0x4)?_0x6ab94b+=String['fromCharCode'](0xff&_0x321abe>>(-0x2*_0x206405&0x6)):0x0){_0x420b53=_0xb44eb8['indexOf'](_0x420b53);}for(let _0x102d60=0x0,_0x2eb249=_0x6ab94b['length'];_0x102d60<_0x2eb249;_0x102d60++){_0x20293f+='%'+('00'+_0x6ab94b['charCodeAt'](_0x102d60)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x20293f);};a0_0x3014['KPNDbw']=_0x5c2947,_0x558478=arguments,a0_0x3014['BRDCBB']=!![];}const _0x5b8239=_0x3585ab[0x0],_0x47a654=_0x301447+_0x5b8239,_0x38672a=_0x558478[_0x47a654];return!_0x38672a?(_0x1bcb8a=a0_0x3014['KPNDbw'](_0x1bcb8a),_0x558478[_0x47a654]=_0x1bcb8a):_0x1bcb8a=_0x38672a,_0x1bcb8a;},a0_0x3014(_0x558478,_0xd6297b);}import{TagParser}from'../utilities/tagParser.js';export class TagParserService{constructor(_0x4b47c1){this['logger']=_0x4b47c1;}['parseMessage'](_0xb44eb8){const _0x135dc6=a0_0x3014;this['logger'][_0x135dc6(0x1e4)]('Parsing\x20message\x20with\x20TagParser');const _0x6ab94b={'recipient':null,'content':_0xb44eb8,'toolCommands':[],'prompt':null,'jobDone':null};try{const _0x20293f=TagParser[_0x135dc6(0x1e7)](_0xb44eb8,'job-done');_0x20293f['length']>0x0&&(_0x6ab94b['jobDone']=_0x20293f[0x0]);const _0x206405=TagParser['query'](_0xb44eb8,'message');if(_0x206405[_0x135dc6(0x1ed)]>0x0){const _0x321abe=_0x206405[0x0];_0x6ab94b[_0x135dc6(0x1e1)]=_0x321abe[_0x135dc6(0x1e3)]['to'],_0x6ab94b['content']=_0x321abe['content'],this['logger'][_0x135dc6(0x1e4)]('Message\x20to\x20recipient:\x20'+_0x6ab94b['recipient']);}return this['parseToolCommands'](_0xb44eb8,_0x6ab94b),this[_0x135dc6(0x1d9)](_0xb44eb8,_0x6ab94b),_0x6ab94b;}catch(_0x420b53){return this['logger']['error']('Error\x20parsing\x20message\x20with\x20TagParser:',_0x420b53),_0x6ab94b;}}[a0_0x5d32e3(0x1e6)](_0x1500f9,_0x102d60){const _0x1df0b6=a0_0x5d32e3,_0x2eb249=TagParser['query'](_0x1500f9,'tools-commands');for(const _0x269d7e of _0x2eb249){const _0x4fed82=_0x269d7e[_0x1df0b6(0x1dd)],_0x23e3f4=TagParser[_0x1df0b6(0x1ef)](_0x4fed82,_0x1df0b6(0x1ec));for(const _0x5d20d2 of _0x23e3f4){const _0x115745=_0x5d20d2['attributes']['id'];if(!_0x115745)continue;const _0x4decd1=_0x5d20d2[_0x1df0b6(0x1dd)];_0x102d60['toolCommands']['push']({'toolId':_0x115745,'content':_0x4decd1,'rawTag':_0x5d20d2}),this[_0x1df0b6(0x1d7)][_0x1df0b6(0x1e4)](_0x1df0b6(0x1f0)+_0x115745);}}if(_0x2eb249['length']===0x0&&_0x1500f9[_0x1df0b6(0x1dc)](_0x1df0b6(0x1e5))){const _0x144b1e=TagParser[_0x1df0b6(0x1ef)](_0x1500f9,_0x1df0b6(0x1ec));for(const _0x467fa9 of _0x144b1e){const _0x60a1aa=_0x467fa9[_0x1df0b6(0x1e3)]['id'];if(!_0x60a1aa)continue;const _0x59c6d2=_0x467fa9['content'];_0x102d60['toolCommands']['push']({'toolId':_0x60a1aa,'content':_0x59c6d2,'rawTag':_0x467fa9}),this['logger'][_0x1df0b6(0x1e4)]('Extracted\x20direct\x20tool\x20command:\x20'+_0x60a1aa);}}}['parsePrompt'](_0xee6d4c,_0x36883c){const _0x502504=a0_0x5d32e3,_0x6ad4c6=TagParser[_0x502504(0x1ef)](_0xee6d4c,'prompt');if(_0x6ad4c6['length']>0x0){const _0x4a7e70=_0x6ad4c6[0x0],_0x38097e=_0x4a7e70[_0x502504(0x1e3)][_0x502504(0x1ea)]||'User\x20Prompt',_0x5adc5=_0x4a7e70[_0x502504(0x1dd)],_0x4b21cb=TagParser['extractContent'](_0x5adc5,_0x502504(0x1da));_0x36883c[_0x502504(0x1e0)]={'name':_0x38097e,'text':_0x5adc5['replace'](/\[option\](.*?)\[\/option\]/gs,'')[_0x502504(0x1e9)](),'options':_0x4b21cb},this[_0x502504(0x1d7)][_0x502504(0x1e4)]('Extracted\x20prompt:\x20'+_0x38097e+'\x20with\x20'+_0x4b21cb['length']+'\x20options');}}}