const a0_0x432adc=a0_0x889b;(function(_0x1a062a,_0x43744a){const _0x365b54=a0_0x889b,_0x2cb31f=_0x1a062a();while(!![]){try{const _0x9af014=-parseInt(_0x365b54(0x20c))/0x1+-parseInt(_0x365b54(0x202))/0x2*(parseInt(_0x365b54(0x203))/0x3)+-parseInt(_0x365b54(0x1f9))/0x4*(parseInt(_0x365b54(0x212))/0x5)+parseInt(_0x365b54(0x20a))/0x6*(-parseInt(_0x365b54(0x204))/0x7)+-parseInt(_0x365b54(0x215))/0x8*(-parseInt(_0x365b54(0x213))/0x9)+-parseInt(_0x365b54(0x209))/0xa+parseInt(_0x365b54(0x206))/0xb;if(_0x9af014===_0x43744a)break;else _0x2cb31f['push'](_0x2cb31f['shift']());}catch(_0x314aa5){_0x2cb31f['push'](_0x2cb31f['shift']());}}}(a0_0x30a0,0x347e4));import{TagParser}from'../utilities/tagParser.js';function a0_0x889b(_0x444f4c,_0x5a0b90){const _0x30a055=a0_0x30a0();return a0_0x889b=function(_0x889b29,_0x4ba8d5){_0x889b29=_0x889b29-0x1f4;let _0x3e2254=_0x30a055[_0x889b29];if(a0_0x889b['KmrsMq']===undefined){var _0x40b9e8=function(_0xebb13c){const _0x1f36bb='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x42fbac='',_0x212071='';for(let _0x3ff99e=0x0,_0x41efca,_0x16a2ba,_0x1b5a8b=0x0;_0x16a2ba=_0xebb13c['charAt'](_0x1b5a8b++);~_0x16a2ba&&(_0x41efca=_0x3ff99e%0x4?_0x41efca*0x40+_0x16a2ba:_0x16a2ba,_0x3ff99e++%0x4)?_0x42fbac+=String['fromCharCode'](0xff&_0x41efca>>(-0x2*_0x3ff99e&0x6)):0x0){_0x16a2ba=_0x1f36bb['indexOf'](_0x16a2ba);}for(let _0x5a89d5=0x0,_0x23962f=_0x42fbac['length'];_0x5a89d5<_0x23962f;_0x5a89d5++){_0x212071+='%'+('00'+_0x42fbac['charCodeAt'](_0x5a89d5)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x212071);};a0_0x889b['qGzTTN']=_0x40b9e8,_0x444f4c=arguments,a0_0x889b['KmrsMq']=!![];}const _0x4ba651=_0x30a055[0x0],_0x4dc477=_0x889b29+_0x4ba651,_0x5be2cb=_0x444f4c[_0x4dc477];return!_0x5be2cb?(_0x3e2254=a0_0x889b['qGzTTN'](_0x3e2254),_0x444f4c[_0x4dc477]=_0x3e2254):_0x3e2254=_0x5be2cb,_0x3e2254;},a0_0x889b(_0x444f4c,_0x5a0b90);}export class TagParserService{constructor(_0xebb13c){const _0x2c5029=a0_0x889b;this[_0x2c5029(0x1fb)]=_0xebb13c;}[a0_0x432adc(0x205)](_0x1f36bb){const _0x42bae7=a0_0x432adc;this[_0x42bae7(0x1fb)][_0x42bae7(0x207)](_0x42bae7(0x208));const _0x42fbac={'recipient':null,'content':_0x1f36bb,'toolCommands':[],'prompt':null,'jobDone':null};try{const _0x212071=TagParser[_0x42bae7(0x1f4)](_0x1f36bb,_0x42bae7(0x1fe));_0x212071[_0x42bae7(0x1f5)]>0x0&&(_0x42fbac[_0x42bae7(0x200)]=_0x212071[0x0]);const _0x3ff99e=TagParser['query'](_0x1f36bb,_0x42bae7(0x201));if(_0x3ff99e['length']>0x0){const _0x41efca=_0x3ff99e[0x0];_0x42fbac[_0x42bae7(0x1fc)]=_0x41efca[_0x42bae7(0x20f)]['to'],_0x42fbac['content']=_0x41efca[_0x42bae7(0x20b)],this['logger'][_0x42bae7(0x207)]('Message\x20to\x20recipient:\x20'+_0x42fbac['recipient']);}return this['parseToolCommands'](_0x1f36bb,_0x42fbac),this['parsePrompt'](_0x1f36bb,_0x42fbac),_0x42fbac;}catch(_0x16a2ba){return this[_0x42bae7(0x1fb)]['error']('Error\x20parsing\x20message\x20with\x20TagParser:',_0x16a2ba),_0x42fbac;}}[a0_0x432adc(0x1f8)](_0x1b5a8b,_0x5a89d5){const _0x6844f6=a0_0x432adc,_0x23962f=TagParser['query'](_0x1b5a8b,_0x6844f6(0x1ff));for(const _0x532020 of _0x23962f){const _0x52219e=_0x532020[_0x6844f6(0x20b)],_0x27522d=TagParser['query'](_0x52219e,'tool');for(const _0x3ebdc9 of _0x27522d){const _0x54bac0=_0x3ebdc9['attributes']['id'];if(!_0x54bac0)continue;const _0x10ba8a=_0x3ebdc9['content'];_0x5a89d5[_0x6844f6(0x214)][_0x6844f6(0x1f6)]({'toolId':_0x54bac0,'content':_0x10ba8a,'rawTag':_0x3ebdc9}),this[_0x6844f6(0x1fb)]['info']('Extracted\x20tool\x20command:\x20'+_0x54bac0);}}if(_0x23962f['length']===0x0&&_0x1b5a8b['includes'](_0x6844f6(0x211))){const _0x91b522=TagParser[_0x6844f6(0x20e)](_0x1b5a8b,'tool');for(const _0x2ad2da of _0x91b522){const _0x2b366b=_0x2ad2da[_0x6844f6(0x20f)]['id'];if(!_0x2b366b)continue;const _0x52dd1d=_0x2ad2da[_0x6844f6(0x20b)];_0x5a89d5[_0x6844f6(0x214)]['push']({'toolId':_0x2b366b,'content':_0x52dd1d,'rawTag':_0x2ad2da}),this[_0x6844f6(0x1fb)][_0x6844f6(0x207)](_0x6844f6(0x20d)+_0x2b366b);}}}['parsePrompt'](_0x362a2d,_0xbbf7af){const _0xbb356a=a0_0x432adc,_0x1ca6f0=TagParser['query'](_0x362a2d,'prompt');if(_0x1ca6f0['length']>0x0){const _0x5df8a5=_0x1ca6f0[0x0],_0x2ba27b=_0x5df8a5[_0xbb356a(0x20f)][_0xbb356a(0x210)]||_0xbb356a(0x1fd),_0x156b0f=_0x5df8a5[_0xbb356a(0x20b)],_0x331f13=TagParser[_0xbb356a(0x1f4)](_0x156b0f,'option');_0xbbf7af['prompt']={'name':_0x2ba27b,'text':_0x156b0f[_0xbb356a(0x1fa)](/\[option\](.*?)\[\/option\]/gs,'')[_0xbb356a(0x1f7)](),'options':_0x331f13},this[_0xbb356a(0x1fb)][_0xbb356a(0x207)]('Extracted\x20prompt:\x20'+_0x2ba27b+'\x20with\x20'+_0x331f13[_0xbb356a(0x1f5)]+'\x20options');}}}function a0_0x30a0(){const _0x2dff69=['y29UDgvUDa','mtu1nZG0DfLVugD3','rxH0CMfJDgvKigrPCMvJDcb0B29SignVBw1HBMq6ia','CxvLCNK','yxr0CMLIDxrLCW','BMfTzq','w3rVB2WGAwq9','mtvWsMrhzK0','mZK1mxvnuNzrsa','Dg9VBenVBw1HBMrZ','mZuXmNjVDNbmwa','zxH0CMfJDenVBNrLBNq','BgvUz3rO','ChvZAa','DhjPBq','CgfYC2vuB29Sq29TBwfUzhm','mJaYmJiWBuvNuhfz','CMvWBgfJzq','Bg9Nz2vY','CMvJAxbPzw50','vxnLCIbqCM9TChq','AM9IlwrVBMu','Dg9VBhmTy29TBwfUzhm','AM9Irg9Uzq','BwvZC2fNzq','mMXIteLfuW','mZyZndCXBKTMvMTZ','ndeZsfH1ELnr','CgfYC2vnzxnZywDL','otm0mZK1merKvxPwCa','Aw5MBW','ugfYC2LUzYbTzxnZywDLihDPDgGGvgfNugfYC2vY','mJiZmtaWyujKyLjP','mZGYnJj4DvLtEhG'];a0_0x30a0=function(){return _0x2dff69;};return a0_0x30a0();}