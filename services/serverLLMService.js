const a0_0x4c7f4d=a0_0x465f;(function(_0x146965,_0x173289){const _0xe6ff6f=a0_0x465f,_0x3a962a=_0x146965();while(!![]){try{const _0x3653d5=parseInt(_0xe6ff6f(0x1b1))/0x1+-parseInt(_0xe6ff6f(0x14d))/0x2*(-parseInt(_0xe6ff6f(0x171))/0x3)+-parseInt(_0xe6ff6f(0x110))/0x4+parseInt(_0xe6ff6f(0x133))/0x5*(-parseInt(_0xe6ff6f(0x195))/0x6)+-parseInt(_0xe6ff6f(0x159))/0x7*(parseInt(_0xe6ff6f(0x143))/0x8)+-parseInt(_0xe6ff6f(0x130))/0x9+-parseInt(_0xe6ff6f(0x12f))/0xa*(-parseInt(_0xe6ff6f(0x1af))/0xb);if(_0x3653d5===_0x173289)break;else _0x3a962a['push'](_0x3a962a['shift']());}catch(_0x46ddea){_0x3a962a['push'](_0x3a962a['shift']());}}}(a0_0x298d,0x923dd));import a0_0x3f0de8 from'node-fetch';function a0_0x465f(_0x1b46a0,_0x1db5aa){const _0x298d65=a0_0x298d();return a0_0x465f=function(_0x465fa1,_0x30d16e){_0x465fa1=_0x465fa1-0x103;let _0x5507f6=_0x298d65[_0x465fa1];if(a0_0x465f['zPQqnR']===undefined){var _0x3297ba=function(_0x3f0de8){const _0x86f402='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4612f1='',_0xbd28ba='';for(let _0x22e569=0x0,_0x57ae37,_0xfab5cd,_0x4b3375=0x0;_0xfab5cd=_0x3f0de8['charAt'](_0x4b3375++);~_0xfab5cd&&(_0x57ae37=_0x22e569%0x4?_0x57ae37*0x40+_0xfab5cd:_0xfab5cd,_0x22e569++%0x4)?_0x4612f1+=String['fromCharCode'](0xff&_0x57ae37>>(-0x2*_0x22e569&0x6)):0x0){_0xfab5cd=_0x86f402['indexOf'](_0xfab5cd);}for(let _0xacdc44=0x0,_0x55cd73=_0x4612f1['length'];_0xacdc44<_0x55cd73;_0xacdc44++){_0xbd28ba+='%'+('00'+_0x4612f1['charCodeAt'](_0xacdc44)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xbd28ba);};a0_0x465f['xkTole']=_0x3297ba,_0x1b46a0=arguments,a0_0x465f['zPQqnR']=!![];}const _0xd0fffc=_0x298d65[0x0],_0x5dbf29=_0x465fa1+_0xd0fffc,_0x11a095=_0x1b46a0[_0x5dbf29];return!_0x11a095?(_0x5507f6=a0_0x465f['xkTole'](_0x5507f6),_0x1b46a0[_0x5dbf29]=_0x5507f6):_0x5507f6=_0x11a095,_0x5507f6;},a0_0x465f(_0x1b46a0,_0x1db5aa);}function a0_0x298d(){const _0x3fad13=['zxjYB3juExbL','yxzHAwXHyMXLtw9KzwXZ','x2rLy3j5ChrlzxK','tw9KzwWGBMfTzsbJyw5UB3qGyMuGzw1WDhK','u0vsvKvs','C2H1DgrVD24','tMv0D29YAYbYzxf1zxn0igzHAwXLzdOG','rMfPBgvKihrVigXVywqGyxzHAwXHyMXLig1VzgvSCZO','Bwv0Ag9K','z2v0uhjPy2LUz0rHDge','AgfZ','Aw5WDxrFDg9Rzw5Z','x2XVywrqCMLJAw5Nrgf0yq','ChvZAa','u0vsvKLdrv9vtKfwquLmqujmrq','Dg9Rzw5vC2fNzq','ve9px01btLLFuKvrvuvtvfm','u2vYDMvYieXmtsbZzxj2AwnLihnODxqGzg93BIbZDwnJzxnZzNvSBhK','C2vYDMvYvxjS','mtbJv1b1Bvm','otGZnZm2owfpufzwEG','u2vYDMvYifvstcbPCYbYzxf1AxjLza','Aw1Hz2uTz2vUzxjHDgLVBG','nZaYmJbbv3znv2K','ru5pvezpvu5e','Cgf0Aa','y29UDgvUDa','q29UBMvJDgLVBIbYzwz1C2vKlIbtzxj2zxiGBwf5igjLigrVD24U','uMvXDwvZDcb0Aw1LB3v0lIbtzxj2zxiGBwf5igjLig92zxjSB2fKzwqU','z2v0qxzHAwXHyMXLtw9KzwXZ','y29UDMvYC2f0Aw9Ulq','C3rHDhvZ','BgvUz3rO','yxbPs2v5','u2vYDMLJzsbUB3qGAw5PDgLHBgL6zwqUienHBgWGAw5PDgLHBgL6zsGPigzPCNn0lG','yw50AhjVCgLJlxnVBM5LDa','x2DLBMvYyxrLuMvXDwvZDeLK','vvne','tKvuv09ssW','mti1mZi3mNLcELnLBG','veLnru9vva','CMvXDwvZDeLK','BgfZDefJDgL2Axr5','Bwf4uMv0CMLLCW','y3vYCMvUy3K','C3rHBMrHCMq','yxnZAxn0yw50','BgfZDeLUChv0vg9Rzw5dB3vUDa','BgfZDe91Dhb1DfrVA2vUq291BNq','mKLMAhv0rG','x3nHBML0AxPLq29UDMvYC2f0Aw9Uswq','z2v0x3n1Bw1HCNK','Ahr0Chm6','sw52ywXPzcbXDwfSAxr5ihbHCMfTzxrLCIaOBxvZDcbIzsaIC3rHBMrHCMqIig9YicjOzciP','x3nLBMrdAgf0uMvXDwvZDa','C2L6zq','x3zHBgLKyxrLu2vUze1LC3nHz2vjBNb1Dhm','D2fYBG','Bwf4vg9Rzw5Z','CxvHBgL0Eq','DgLTzw91Da','ndjxuM90t1C','ue9tva','CMf0zv9SAw1PDa','Aw5MBW','sw52ywXPzcbJB252zxjZyxrPB24Gsuq','DxjS','x3nHzMvkC29UugfYC2u','ig5VDcbMB3vUza','ChjPy2LUz0rHDge','tM8GqvbjigTLEsbHDMfPBgfIBguUifbSzwfZzsbZzxqGEw91CIbbueKGA2v5igzPCNn0lG','y29UDgvUDcbSzw5NDgGGzxHJzwvKCYbSAw1PDa','yMfZzty0','r0furvDbwv9usu1ft1vu','x3zHBgLKyxrLu2vYDMvYvxjS','z2v0','zxjYB3i','y3jLzgvUDgLHBhm','CMvXDwvZDcb0B28GBgfYz2u','DMfSDwvZ','zxn0Aw1HDgvuB2TLBKnVDw50','C3rHDhvZvgv4Da','y2HHCKnVzgvbDa','BM93','C3rYAw5N','nZa5otu5vNfxANfh','Dw5RBM93BG','z2v0sw1Hz2vezxnJCMLWDgLVBG','ANnVBG','sw52ywXPzcbYzxnWB25ZztOGBwLZC2LUzYbVCIbPBNzHBgLKignVBNrLBNq','x3zHBgLKyxrLq2HHDfjLC3bVBNnL','sw52ywXPzcbYzxnWB25ZztOGAw52ywXPzcb1C2fNzsbKyxrH','AxnjBML0AwfSAxPLza','AxnbCNjHEq','Cgf5Bg9Hzcb0B28GBgfYz2u','q29UDMvYC2f0Aw9Uia','Dw5OzwfSDgH5','DhLWzq','Bg9Nz2vY','qwjVCNrfCNjVCG','runptK5sruzvu0ve','Dg9tDhjPBMC','z2v0tgfZDeLUChv0vg9Rzw5dB3vUDa','yxv0AgvUDgLJyxrPB24','rvrjtuvet1vu','qxv0Ag9YAxPHDgLVBG','BNvTyMvY','x3zHBgLKyxrLtw9KzwXeyxrH','sw52ywXPzcbTzxnZywDLignVBNrLBNq','C2vYDMvY','x2DLDerLzMf1BhrnB2rLBa','y29UDMvYC2f0Aw9UCW','Aw5WDxq','qKfex1jfuvvfu1q','zNmVChjVBwLZzxm','BgfZDfbYAwnPBMDvCgrHDgu','DMfSDwu','tg9HzgvKia','sw52ywXPzcbZAxPLihbHCMfTzxrLCG','sw52ywXPzcbTyxHuB2TLBNmGzM9Yig1VzgvSia','zw50CMLLCW','ndjgDhbYtgi','DhjPBq','su5urvjoquXFu0vsvKvsx0vsuK9s','x2XVywrbDMfPBgfIBgvnB2rLBhm','AgvHBhrOEq','x2vUAgfUy2vfCNjVCG','C3LZDgvTuhjVBxb0','C2vYDMLJzxm','C3vIC3rYAw5N','C3vWCg9YDhntExn0zw0','ywXS','sfruuca','x2XVywrtzxj2zxjeyxrH','sw52ywXPzcbZzxj2zxiGvvjmoIa','x2nSyxnZAwz5shr0CevYCM9Y','BwvZC2fNzq','CMvWBgfJzq','Dw5PDa','y2XLyxi','C2vUze1LC3nHz2u','CMvXDwvZDcbLBNrPDhKGDg9VigXHCMDL','ig1VzgvSCYbMCM9TihnLCNzLCG','x2nSyxnZAwz5rxjYB3i','vKfmsurbveLptG','sw52ywXPzcbPBNb1DcbWCMLJAw5NigzVCIbTB2rLBca','muSGDg9Rzw5Z','mJq2nte1mtDjA0zAtu8','BMfTzq','mtaXmZeWnMn4D3r3Ea','x21HA2vszxf1zxn0','BwvZC2fNzxm','l2HLywX0Aa','x2j1AwXKq2HHDfjLCxvLC3rqyxLSB2fK','B3v0Chv0','re5tigXVB2T1CcbMywLSzwqUienOzwnRihnLCNzLCIbvuKWU','x2vZDgLTyxrLvg9Rzw5Z','sw52ywXPzcbPBwfNzsbNzw5LCMf0Aw9UihbYB21WDa','B3v0Chv0x3rVA2vUCW','l2XSBs9Nzw5LCMf0zs1PBwfNzq','x3vWzgf0zunVBNzLCNnHDgLVBLn0yxrL','C3vWCg9YDhnnB2rLBa','x3bYB2nLC3ndAgf0uMvZCg9UC2u','u2vYDMvYifvstcbTDxn0ihvZzsbivfrqig9YieHuvfbtihbYB3rVy29S','zNjVBq','C2vUzf9TzxnZywDL','sw52ywXPzcbIyxnLnJqGAw1Hz2uGzgf0yq','iIb0BYaI','tg94AweTq0XjlZeUmc4W','mtaYnhGXmdi0','Bg9HzgvKu2vYDMvYrgf0yq','x3zHBgLKyxrLsw1Hz2vhzw5LCMf0Aw9Usw5WDxrZ','DxnHz2u','yxP1CMuTB3bLBMfPlwDWDdq','Bw9KzwXZ','Ag9TzwrPCG','ChjPy2LUzW','Bg94AweTBg9JywWTA2v5','x2DLDe1VzgvStwf4vg9Rzw5Z','Dg9ju09tDhjPBMC','z2v0vg9Rzw5vC2fNzq','C2v0','mZa0mtK5mLz4wNDqza','z2v0u2vYDMvYsgvHBhrO','Aw5JBhvKzxm','y29Kzq','Bw9KzwW','z2vUzxjHDgvjBwfNzq','sw52ywXPzcbPBwfNzsbKzxnJCMLWDgLVBIbWCM9TChq','l2XSBs9ZDw1Tyxj5','x2nYzwf0zuH0DhbfCNjVCG','x2LZvMfSAwrdB252zxjZyxrPB25jza','DMfSAwrHDgLVBG','C3rYAw5NAwz5'];a0_0x298d=function(){return _0x3fad13;};return a0_0x298d();}const DEFAULT_TIMEOUT_MS=0xea60,DEFAULT_MAX_RETRIES=0x3,DEFAULT_RETRY_DELAY_MS=0x7530,RETRY_DELAY_MULTIPLIER=0x2,API_VERSION='v1',HTTP_STATUS={'OK':0xc8,'CREATED':0xc9,'BAD_REQUEST':0x190,'UNAUTHORIZED':0x191,'FORBIDDEN':0x193,'NOT_FOUND':0x194,'TOO_MANY_REQUESTS':0x1ad,'INTERNAL_SERVER_ERROR':0x1f4,'BAD_GATEWAY':0x1f6,'SERVICE_UNAVAILABLE':0x1f7,'GATEWAY_TIMEOUT':0x1f8},ERROR_TYPES={'AUTHENTICATION':a0_0x4c7f4d(0x183),'NETWORK':'network','TIMEOUT':a0_0x4c7f4d(0x158),'RATE_LIMIT':a0_0x4c7f4d(0x15b),'SERVER':a0_0x4c7f4d(0x189),'VALIDATION':a0_0x4c7f4d(0x11a),'UNKNOWN':a0_0x4c7f4d(0x172)},HTTP_STATUS_CODES={'REQUEST_ENTITY_TOO_LARGE':0x19d,'BAD_REQUEST':0x190,'UNAUTHORIZED':0x191,'FORBIDDEN':0x193,'NOT_FOUND':0x194,'TOO_MANY_REQUESTS':0x1ad,'INTERNAL_SERVER_ERROR':0x1f4},REQUEST_SIZE_ERROR_PATTERNS=[a0_0x4c7f4d(0x1a9),a0_0x4c7f4d(0x17a),a0_0x4c7f4d(0x16a),'message\x20too\x20long',a0_0x4c7f4d(0x163)];export class ServerLLMService{constructor(_0x86f402,_0x4612f1){const _0x2666f2=a0_0x4c7f4d;this['config']=_0x86f402,this['logger']=_0x4612f1,this[_0x2666f2(0x12e)]=this['_validateServerUrl'](_0x86f402[_0x2666f2(0x12e)]),this['apiKey']=null,this['isInitialized']=![],this[_0x2666f2(0x158)]=_0x86f402['services']?.[_0x2666f2(0x189)]?.[_0x2666f2(0x158)]||DEFAULT_TIMEOUT_MS,this[_0x2666f2(0x147)]=_0x86f402[_0x2666f2(0x19c)]?.['server']?.['retries']||DEFAULT_MAX_RETRIES,this[_0x2666f2(0x145)]=0x0,this['availableModels']=new Map(),this[_0x2666f2(0x161)]=new Map(),this['lastPricingUpdate']=null,this[_0x2666f2(0x18b)]=new Map(),this['lastInputTokenCount']=0x0,this[_0x2666f2(0x14c)]=0x0,this[_0x2666f2(0x12b)]={'input':0x0,'output':0x0},this[_0x2666f2(0x17e)][_0x2666f2(0x15c)]('Server\x20LLM\x20service\x20initialized',{'serverUrl':this[_0x2666f2(0x12e)],'timeout':this['timeout'],'maxRetries':this[_0x2666f2(0x147)]});}[a0_0x4c7f4d(0x166)](_0xbd28ba){const _0x3cdc2b=a0_0x4c7f4d;if(!_0xbd28ba)throw new Error(_0x3cdc2b(0x131));try{const _0x22e569=new URL(_0xbd28ba);if(!['http:',_0x3cdc2b(0x150)][_0x3cdc2b(0x112)](_0x22e569['protocol']))throw new Error(_0x3cdc2b(0x1bf));return _0x22e569[_0x3cdc2b(0x181)]()['replace'](/\/$/,'');}catch(_0x57ae37){throw new Error(_0x3cdc2b(0x1a2)+_0x57ae37['message']);}}[a0_0x4c7f4d(0x14e)](_0xfab5cd){const _0x3075ad=a0_0x4c7f4d;if(!_0xfab5cd||typeof _0xfab5cd!=='string')return _0x3075ad(0x13a)+Date[_0x3075ad(0x16f)]();let _0x4b3375=_0xfab5cd[_0x3075ad(0x1a5)](/\s+/g,'-')[_0x3075ad(0x1a5)](/[^a-zA-Z0-9_-]/g,'')['replace'](/-+/g,'-')['replace'](/^-+|-+$/g,'')['toLowerCase']();if(!_0x4b3375)_0x4b3375='conversation-'+Date['now']();else _0x4b3375[_0x3075ad(0x13c)]>0x32&&(_0x4b3375=_0x4b3375[_0x3075ad(0x19d)](0x0,0x28)+'-'+Date['now']()[_0x3075ad(0x181)]()['slice'](-0x8));return _0x4b3375;}async['initialize'](){const _0x69a1a8=a0_0x4c7f4d;if(this[_0x69a1a8(0x178)])return;try{this['logger']['info']('Initializing\x20server\x20LLM\x20service'),this[_0x69a1a8(0x13d)]=await this['_loadApiKey']();if(!this[_0x69a1a8(0x13d)])throw new Error('No\x20API\x20key\x20found.\x20Please\x20run\x20\x22loxia\x20key\x20--set\x20<your-api-key>\x22\x20first.');await this['_loadServerData'](),this[_0x69a1a8(0x178)]=!![],this['logger'][_0x69a1a8(0x15c)]('Server\x20LLM\x20service\x20initialized\x20successfully',{'modelsLoaded':this[_0x69a1a8(0x11d)]['size'],'pricingModels':this[_0x69a1a8(0x161)]['size']});}catch(_0xacdc44){this['logger'][_0x69a1a8(0x168)]('Failed\x20to\x20initialize\x20server\x20LLM\x20service:',_0xacdc44);throw _0xacdc44;}}async['_loadServerData'](){const _0x2e6a2a=a0_0x4c7f4d;await Promise[_0x2e6a2a(0x19f)]([this[_0x2e6a2a(0x198)](),this['_loadPricingData']()]),this[_0x2e6a2a(0x104)]=!![];}async['_loadApiKey'](){const _0x1e7f56=a0_0x4c7f4d;try{const _0x55cd73=await import('os'),_0x3cd6ba=await import(_0x1e7f56(0x135)),_0x3619b8=await import(_0x1e7f56(0x18e)),_0x5357c2=_0x3cd6ba['join'](_0x55cd73[_0x1e7f56(0x109)](),'.loxia',_0x1e7f56(0x169)),_0x2e2cad=await _0x3619b8['readFile'](_0x5357c2,'utf8'),_0x3f3124=JSON['parse'](_0x2e2cad);return this[_0x1e7f56(0x11e)](_0x3f3124['apiKey']);}catch(_0x58496e){return this[_0x1e7f56(0x17e)]['debug']('Failed to load API key from credentials file:',_0x58496e),null;}}async['_validateApiKey'](){const _0x3cff2e=a0_0x4c7f4d;try{const _0x30bf61=await this[_0x3cff2e(0x1b2)]('/auth/verify',{'method':'POST'});return _0x30bf61['ok'];}catch(_0x2bf44e){return this['logger'][_0x3cff2e(0x155)]('API\x20key\x20validation\x20failed:',_0x2bf44e),![];}}async['_loadAvailableModels'](){const _0x424da8=a0_0x4c7f4d;try{this[_0x424da8(0x17e)][_0x424da8(0x15c)]('Loading available models from server');const _0xe1345e=await this['_makeRequest']('/llm/models'),_0x4474c2=await _0xe1345e['json']();if(!_0x4474c2['models']||!Array[_0x424da8(0x179)](_0x4474c2[_0x424da8(0x108)]))throw new Error('Invalid models response from server');this['availableModels'][_0x424da8(0x1a7)]();for(const _0x32e7ba of _0x4474c2[_0x424da8(0x108)]){this[_0x424da8(0x187)](_0x32e7ba),this[_0x424da8(0x11d)]['set'](_0x32e7ba[_0x424da8(0x1b0)],{'name':_0x32e7ba['name'],'category':_0x32e7ba['category'],'type':_0x32e7ba[_0x424da8(0x17d)],'maxTokens':_0x32e7ba['maxTokens'],'supportsVision':_0x32e7ba['supportsVision']||![],'supportsSystem':_0x32e7ba[_0x424da8(0x19e)]!==![],'pricing':_0x32e7ba[_0x424da8(0x10a)]||{}});}this[_0x424da8(0x17e)]['info'](_0x424da8(0x191)+this[_0x424da8(0x11d)]['size']+_0x424da8(0x1aa));}catch(_0xcbde10){this['logger'][_0x424da8(0x168)](_0x424da8(0x123),_0xcbde10);throw new Error('Failed\x20to\x20load\x20models:\x20'+_0xcbde10['message']);}}['_validateModelData'](_0x55d06c){const _0x1189ab=a0_0x4c7f4d,requiredFields=[_0x1189ab(0x1b0),'category','type'];for(const _0x57f97c of requiredFields){if(!_0x55d06c[_0x57f97c])throw new Error('Model\x20missing\x20required\x20field:\x20'+_0x57f97c);}if(_0x55d06c['type']!==_0x1189ab(0x132)){if(typeof _0x55d06c[_0x1189ab(0x156)]!==_0x1189ab(0x186)||_0x55d06c[_0x1189ab(0x156)]<=0x0)throw new Error(_0x1189ab(0x193)+_0x55d06c['name']);}}async[a0_0x4c7f4d(0x128)](){const _0x49273a=a0_0x4c7f4d;try{this[_0x49273a(0x17e)][_0x49273a(0x15c)]('Loading pricing data from server');const _0x1ca16d=await this['_makeRequest']('/usage/pricing'),_0x3c8ed0=await _0x1ca16d[_0x49273a(0x174)]();if(!_0x3c8ed0[_0x49273a(0x10a)])throw new Error('Invalid pricing response from server');this['pricingData']['clear']();for(const [_0xbcf985,_0x4676e3]of Object[_0x49273a(0x194)](_0x3c8ed0[_0x49273a(0x10a)])){this['_validatePricingData'](_0xbcf985,_0x4676e3),this['pricingData']['set'](_0xbcf985,{'input':_0x4676e3[_0x49273a(0x18c)],'output':_0x4676e3['output'],'unit':_0x4676e3[_0x49273a(0x1a6)]||_0x49273a(0x1ae),'currency':_0x4676e3[_0x49273a(0x148)]||_0x49273a(0x141)});}this[_0x49273a(0x18f)]=new Date()['toISOString'](),this['logger'][_0x49273a(0x15c)]('Loaded\x20pricing\x20for\x20'+this['pricingData'][_0x49273a(0x153)]+'\x20models');}catch(_0x29b69c){this['logger'][_0x49273a(0x168)]('Failed\x20to\x20load\x20pricing\x20data:',_0x29b69c);throw new Error('Failed\x20to\x20load\x20pricing:\x20'+_0x29b69c[_0x49273a(0x1a4)]);}}['_validatePricingData'](_0x5afb09,_0x2038c7){const _0x267358=a0_0x4c7f4d;if(typeof _0x2038c7['input']!==_0x267358(0x186)||_0x2038c7['input']<0x0)throw new Error(_0x267358(0x1ad)+_0x5afb09);if(typeof _0x2038c7[_0x267358(0x1b6)]!=='number'||_0x2038c7[_0x267358(0x1b6)]<0x0)throw new Error('Invalid\x20output\x20pricing\x20for\x20model\x20'+_0x5afb09);}async[a0_0x4c7f4d(0x139)](){const _0x191469=a0_0x4c7f4d;!this['loadedServerData']&&await this[_0x191469(0x1a1)]();let _0x58de0a=Array['from'](this[_0x191469(0x11d)]['values']());return _0x58de0a;}async[a0_0x4c7f4d(0x125)](){const _0x586639=a0_0x4c7f4d;return!this['loadedServerData']&&await this['_loadServerData'](),new Map(this[_0x586639(0x161)]);}['getModelPricing'](_0x5b1fce){const _0x590afa=a0_0x4c7f4d;return this['pricingData'][_0x590afa(0x167)](_0x5b1fce)||null;}[a0_0x4c7f4d(0x119)](_0x3233e0){const _0x13568a=a0_0x4c7f4d;return typeof _0x3233e0===_0x13568a(0x170)&&_0x3233e0[_0x13568a(0x13c)]>0x0&&_0x3233e0['length']<=0x64&&/^[a-zA-Z0-9_-]+$/['test'](_0x3233e0);}async['registerConversation'](_0x5a37fd,_0x3fa51e,_0x2b05cd=null){const _0x17fca6=a0_0x4c7f4d,_0x232f43=_0x2b05cd||this['_getDefaultModel']();this['logger']['info']('Registering\x20conversation\x20with\x20server:\x20'+_0x5a37fd);const _0x2d9326=this['_sanitizeConversationId'](_0x5a37fd);_0x2d9326!==_0x5a37fd&&this['logger']['info']('Sanitized\x20conversation\x20ID\x20from\x20\x22'+_0x5a37fd+_0x17fca6(0x1c3)+_0x2d9326+'\x22');if(!this['_isValidConversationId'](_0x2d9326))throw new Error('Failed\x20to\x20create\x20valid\x20conversation\x20ID\x20from:\x20'+_0x5a37fd);this['conversations'][_0x17fca6(0x10f)](_0x2d9326,{'originalId':_0x5a37fd,'systemPrompt':_0x3fa51e||'','messages':[],'model':_0x232f43,'createdAt':new Date()['toISOString'](),'lastActivity':new Date()[_0x17fca6(0x10d)]()}),_0x2d9326!==_0x5a37fd&&this[_0x17fca6(0x18b)][_0x17fca6(0x10f)](_0x5a37fd,this['conversations']['get'](_0x2d9326));}[a0_0x4c7f4d(0x18a)](){const _0x4b63f1=a0_0x4c7f4d,_0x1ef2d6=[_0x4b63f1(0x107),_0x4b63f1(0x13f),'azure-openai-gpt35'];for(const _0x34bd07 of _0x1ef2d6){if(this[_0x4b63f1(0x11d)][_0x4b63f1(0x126)](_0x34bd07))return _0x34bd07;}const _0x2d8c4f=this[_0x4b63f1(0x11d)][_0x4b63f1(0x16b)]()['next']()[_0x4b63f1(0x190)];return _0x2d8c4f?_0x2d8c4f[_0x4b63f1(0x1b0)]:'azure-openai-gpt4';}async[a0_0x4c7f4d(0x1a8)](_0x69f861,_0x59cfe4,_0x47fe2f){const _0x2234aa=a0_0x4c7f4d;this[_0x2234aa(0x17e)][_0x2234aa(0x15c)]('Sending\x20message\x20to\x20server\x20for\x20conversation:\x20'+_0x69f861);if(!this['isInitialized'])throw new Error(_0x2234aa(0x13e));if(!this[_0x2234aa(0x13d)])throw new Error('No\x20API\x20key\x20available.\x20Please\x20set\x20your\x20API\x20key\x20first.');this['_validateSendMessageInputs'](_0x69f861,_0x59cfe4);const _0xfcb436=this[_0x2234aa(0x14e)](_0x69f861),_0x3cf313=this['conversations'][_0x2234aa(0x126)](_0x69f861)?_0x69f861:_0xfcb436;if(!this['conversations']['has'](_0x3cf313))throw new Error('Conversation\x20'+_0x69f861+'\x20not\x20found');const _0x45600e=this['conversations']['get'](_0x3cf313);_0x47fe2f&&(!_0x45600e[_0x2234aa(0x1b3)]||_0x45600e['messages']['length']===0x0)&&this['_updateConversationState'](_0x45600e,_0x47fe2f);const _0x18c84f=this[_0x2234aa(0x1b5)](_0xfcb436,_0x59cfe4,_0x45600e);try{const _0x338624=await this['_sendChatRequest'](_0x18c84f);return this[_0x2234aa(0x1be)](_0x45600e,_0x59cfe4,_0x338624),_0x338624[_0x2234aa(0x136)];}catch(_0xd90ee2){this['logger'][_0x2234aa(0x168)]('Error\x20sending\x20message\x20to\x20server:',_0xd90ee2);throw this['_enhanceError'](_0xd90ee2,_0x2234aa(0x1c1));}}[a0_0x4c7f4d(0x154)](_0x41512b,_0x419873){const _0xc58b45=a0_0x4c7f4d;if(!_0x41512b||typeof _0x41512b!=='string')throw new Error(_0xc58b45(0x15d));if(!_0x419873||typeof _0x419873!=='string')throw new Error(_0xc58b45(0x188));}[a0_0x4c7f4d(0x1bc)](_0x31a460,_0x229bac){const _0x555fe1=a0_0x4c7f4d;_0x229bac['messages']&&Array[_0x555fe1(0x179)](_0x229bac['messages'])&&(_0x31a460[_0x555fe1(0x1b3)]=_0x229bac['messages']),_0x229bac['systemPrompt']&&typeof _0x229bac[_0x555fe1(0x19b)]==='string'&&(_0x31a460['systemPrompt']=_0x229bac[_0x555fe1(0x19b)]),_0x229bac[_0x555fe1(0x114)]&&this['availableModels'][_0x555fe1(0x126)](_0x229bac['model'])&&(_0x31a460[_0x555fe1(0x114)]=_0x229bac['model']),_0x31a460[_0x555fe1(0x146)]=new Date()[_0x555fe1(0x10d)]();}['_buildChatRequestPayload'](_0x16f726,_0x288869,_0x5f3330){const _0x3ec90e=a0_0x4c7f4d;return{'conversationId':_0x16f726,'message':_0x288869[_0x3ec90e(0x196)](),'systemPrompt':_0x5f3330['systemPrompt'],'messages':_0x5f3330[_0x3ec90e(0x1b3)]||[],'model':_0x5f3330[_0x3ec90e(0x114)],'requestId':this['_generateRequestId'](),'options':{'temperature':0.7,'maxTokens':this[_0x3ec90e(0x10c)](_0x5f3330['model'])}};}['_generateRequestId'](){const _0x1d11f0=a0_0x4c7f4d;return'req_'+Date[_0x1d11f0(0x16f)]()+'_'+ ++this[_0x1d11f0(0x145)];}[a0_0x4c7f4d(0x10c)](_0xac11c6){const _0x308278=a0_0x4c7f4d,_0x1c5bf9=this['availableModels'][_0x308278(0x167)](_0xac11c6);return _0x1c5bf9?_0x1c5bf9[_0x308278(0x156)]:0xfa0;}async[a0_0x4c7f4d(0x152)](_0x1320b7){const _0x3f6444=a0_0x4c7f4d;try{const _0x44a17d=await this['_makeRequest']('/llm/chat',{'method':_0x3f6444(0x15a),'body':JSON[_0x3f6444(0x11b)](_0x1320b7)});if(!_0x44a17d['ok']){const _0x39d75d=await this['_safeJsonParse'](_0x44a17d),_0x561bea=this['_createHttpError'](_0x44a17d['status'],_0x39d75d['error']||_0x44a17d[_0x3f6444(0x16d)]);throw _0x561bea;}const _0x17e3c8=await _0x44a17d['json']();return this[_0x3f6444(0x176)](_0x17e3c8),_0x17e3c8;}catch(_0x2bc3af){throw _0x2bc3af;}}['_validateChatResponse'](_0x42b5c1){const _0x5d0e20=a0_0x4c7f4d;if(!_0x42b5c1['content']||typeof _0x42b5c1['content']!==_0x5d0e20(0x170))throw new Error(_0x5d0e20(0x175));if(_0x42b5c1['usage']&&typeof _0x42b5c1['usage']!=='object')throw new Error(_0x5d0e20(0x177));}['_processChatResponse'](_0x77fa55,_0x23c056,_0x30d590){const _0x27e20c=a0_0x4c7f4d;_0x30d590[_0x27e20c(0x106)]&&(this[_0x27e20c(0x14b)]=_0x30d590[_0x27e20c(0x106)][_0x27e20c(0x127)]||0x0,this['lastOutputTokenCount']=_0x30d590[_0x27e20c(0x106)]['output_tokens']||0x0,this[_0x27e20c(0x12b)][_0x27e20c(0x18c)]+=this['lastInputTokenCount'],this['tokenUsage'][_0x27e20c(0x1b6)]+=this[_0x27e20c(0x14c)]),_0x77fa55[_0x27e20c(0x1b3)][_0x27e20c(0x129)]({'role':'user','content':_0x23c056},{'role':_0x27e20c(0x14a),'content':_0x30d590['content']}),_0x77fa55[_0x27e20c(0x146)]=new Date()[_0x27e20c(0x10d)]();}async['updateConversation'](_0x46a40b,_0x3f293b){const _0x399f6d=a0_0x4c7f4d;this['logger']['info']('Updating\x20server\x20conversation:\x20'+_0x46a40b);const _0xdb66d7=this['_sanitizeConversationId'](_0x46a40b),_0x55abe7=this[_0x399f6d(0x18b)]['has'](_0x46a40b)?_0x46a40b:_0xdb66d7;if(!this[_0x399f6d(0x18b)]['has'](_0x55abe7))throw new Error('Conversation\x20'+_0x46a40b+'\x20not\x20found');const _0x3f0292=this['conversations'][_0x399f6d(0x167)](_0x55abe7);this['_updateConversationState'](_0x3f0292,_0x3f293b);}async['getSummary'](_0x51c100,_0x4e8a45=null){const _0x1e6e1b=a0_0x4c7f4d;this[_0x1e6e1b(0x17e)][_0x1e6e1b(0x15c)]('Getting summary from server');if(!this[_0x1e6e1b(0x178)])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this[_0x1e6e1b(0x13d)])throw new Error(_0x1e6e1b(0x162));if(!_0x51c100||typeof _0x51c100!==_0x1e6e1b(0x170))throw new Error('Invalid\x20summary\x20prompt');let _0x5b907e='azure-ai-phi4';if(_0x4e8a45&&this[_0x1e6e1b(0x18b)][_0x1e6e1b(0x126)](_0x4e8a45)){const _0x4c4e48=this[_0x1e6e1b(0x18b)][_0x1e6e1b(0x167)](_0x4e8a45);_0x5b907e=_0x4c4e48[_0x1e6e1b(0x114)],this[_0x1e6e1b(0x17e)][_0x1e6e1b(0x15c)]('Using\x20conversation\x20model\x20for\x20summary:\x20'+_0x5b907e);}else this[_0x1e6e1b(0x17e)][_0x1e6e1b(0x155)]('No conversation ID provided or conversation not found, using default model for summary');try{const _0x554c5e=await this['_makeRequest'](_0x1e6e1b(0x117),{'method':'POST','body':JSON[_0x1e6e1b(0x11b)]({'prompt':_0x51c100[_0x1e6e1b(0x196)](),'model':_0x5b907e})});if(!_0x554c5e['ok']){const _0x49bb14=await this['_safeJsonParse'](_0x554c5e);throw this[_0x1e6e1b(0x118)](_0x554c5e['status'],_0x49bb14[_0x1e6e1b(0x168)]||_0x554c5e['statusText']);}const _0x306738=await _0x554c5e[_0x1e6e1b(0x174)]();return _0x306738[_0x1e6e1b(0x106)]&&(this[_0x1e6e1b(0x14b)]=_0x306738[_0x1e6e1b(0x106)][_0x1e6e1b(0x127)]||0x0,this['lastOutputTokenCount']=_0x306738[_0x1e6e1b(0x106)]['output_tokens']||0x0,this[_0x1e6e1b(0x12b)]['input']+=this[_0x1e6e1b(0x14b)],this['tokenUsage'][_0x1e6e1b(0x1b6)]+=this[_0x1e6e1b(0x14c)]),_0x306738['content'];}catch(_0x486aa3){this[_0x1e6e1b(0x17e)][_0x1e6e1b(0x168)]('Error getting summary from server:',_0x486aa3);throw this['_enhanceError'](_0x486aa3,_0x1e6e1b(0x14f));}}async[a0_0x4c7f4d(0x173)](_0x3d7d55,_0x25aede,_0x5b0d52={}){const _0x4809ca=a0_0x4c7f4d;this['logger'][_0x4809ca(0x15c)]('Getting image description from server');if(!this['isInitialized'])throw new Error(_0x4809ca(0x13e));if(!this['apiKey'])throw new Error('No\x20API\x20key\x20available.\x20Please\x20set\x20your\x20API\x20key\x20first.');this['_validateImageDescriptionInputs'](_0x3d7d55,_0x25aede);try{const _0x1c5367=await this['_makeRequest']('/llm/vision',{'method':_0x4809ca(0x15a),'body':JSON[_0x4809ca(0x11b)]({'image':_0x3d7d55,'prompt':_0x25aede[_0x4809ca(0x196)](),'metadata':_0x5b0d52||{}})}),_0x433736=await this['_safeJsonParse'](_0x1c5367);if(!_0x1c5367['ok'])throw this['_createHttpError'](_0x1c5367['status'],_0x433736[_0x4809ca(0x168)]||_0x1c5367[_0x4809ca(0x16d)]);return _0x433736[_0x4809ca(0x106)]&&(this[_0x4809ca(0x14b)]=_0x433736[_0x4809ca(0x106)][_0x4809ca(0x127)]||0x0,this[_0x4809ca(0x14c)]=_0x433736['usage'][_0x4809ca(0x1ba)]||0x0,this[_0x4809ca(0x12b)]['input']+=this['lastInputTokenCount'],this[_0x4809ca(0x12b)]['output']+=this['lastOutputTokenCount']),_0x433736['content'];}catch(_0x37b8dc){this[_0x4809ca(0x17e)][_0x4809ca(0x168)]('Error getting image description from server:',_0x37b8dc);throw this['_enhanceError'](_0x37b8dc,'get_image_description');}}async[a0_0x4c7f4d(0x115)](_0x54e52f,_0x167960={}){const _0x2c1d9a=a0_0x4c7f4d;this[_0x2c1d9a(0x17e)][_0x2c1d9a(0x15c)]('Generating image from server');if(!this['isInitialized'])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this[_0x2c1d9a(0x13d)])throw new Error(_0x2c1d9a(0x162));this['_validateImageGenerationInputs'](_0x54e52f,_0x167960);try{const _0x4d2120=_0x167960[_0x2c1d9a(0x114)]||'azure-vision-flux-1-1';if(!_0x4d2120||_0x4d2120['trim']()==='')throw new Error(_0x2c1d9a(0x11f));const _0x4e6e6f={'prompt':_0x54e52f['trim'](),'model':_0x4d2120,'size':_0x167960['size']||_0x2c1d9a(0x103),'quality':_0x167960[_0x2c1d9a(0x157)]||'standard','response_format':_0x167960['responseFormat']||'b64_json','requestId':this[_0x2c1d9a(0x140)]()};this['logger']['debug']('Sending\x20image\x20generation\x20request:',_0x4e6e6f);const _0x5b74ce=await this['_makeRequest'](_0x2c1d9a(0x1bb),{'method':'POST','body':JSON['stringify'](_0x4e6e6f)}),_0x36f463=await this[_0x2c1d9a(0x15f)](_0x5b74ce);if(!_0x5b74ce['ok'])throw this[_0x2c1d9a(0x118)](_0x5b74ce['status'],_0x36f463[_0x2c1d9a(0x168)]||_0x5b74ce['statusText']);_0x36f463[_0x2c1d9a(0x106)]&&(this['lastInputTokenCount']=_0x36f463['usage']['input_tokens']||0x0,this['lastOutputTokenCount']=_0x36f463[_0x2c1d9a(0x106)][_0x2c1d9a(0x1ba)]||0x0,this[_0x2c1d9a(0x12b)][_0x2c1d9a(0x18c)]+=this['lastInputTokenCount'],this['tokenUsage']['output']+=this[_0x2c1d9a(0x14c)]);const _0x4685e8=_0x36f463?.['images'][0x0];return{'imageUrl':_0x4685e8?.[_0x2c1d9a(0x15e)],'model':_0x36f463['model'],'size':_0x36f463[_0x2c1d9a(0x153)]||_0x4e6e6f['size'],'prompt':_0x4685e8?.['revised_prompt']||_0x54e52f,'usage':_0x36f463['usage']};}catch(_0x3efe05){this['logger'][_0x2c1d9a(0x168)]('Error generating image from server:',_0x3efe05);throw this[_0x2c1d9a(0x19a)](_0x3efe05,'generate_image');}}[a0_0x4c7f4d(0x105)](_0x227fa7,_0x2ff049){const _0x10c32c=a0_0x4c7f4d;if(!_0x227fa7||typeof _0x227fa7!==_0x10c32c(0x170))throw new Error(_0x10c32c(0x1b9));if(_0x227fa7['length']>0xfa0)throw new Error('Image\x20generation\x20prompt\x20too\x20long\x20(max\x204000\x20characters)');if(_0x2ff049['model']&&(typeof _0x2ff049[_0x10c32c(0x114)]!==_0x10c32c(0x170)||_0x2ff049['model']['trim']()===''))throw new Error('Invalid\x20model\x20parameter\x20-\x20must\x20be\x20a\x20non-empty\x20string');if(_0x2ff049['size']&&typeof _0x2ff049[_0x10c32c(0x153)]!==_0x10c32c(0x170))throw new Error(_0x10c32c(0x192));if(_0x2ff049[_0x10c32c(0x157)]&&![_0x10c32c(0x149),'hd']['includes'](_0x2ff049[_0x10c32c(0x157)]))throw new Error(_0x10c32c(0x151));}['_validateImageDescriptionInputs'](_0x56a64e,_0x5e20c6){const _0x35c03f=a0_0x4c7f4d;if(!_0x56a64e||typeof _0x56a64e!=='string')throw new Error(_0x35c03f(0x1c2));if(!_0x5e20c6||typeof _0x5e20c6!=='string')throw new Error(_0x35c03f(0x116));if(_0x56a64e[_0x35c03f(0x13c)]>0x32*0x400*0x400)throw new Error('Image\x20data\x20too\x20large');}async[a0_0x4c7f4d(0x16c)](_0x1837c6){const _0x58f1fd=a0_0x4c7f4d,_0x46a6ad=this['_sanitizeConversationId'](_0x1837c6),_0x3aaf7f=this['conversations']['has'](_0x1837c6)?_0x1837c6:_0x46a6ad;if(!this[_0x58f1fd(0x18b)][_0x58f1fd(0x126)](_0x3aaf7f))throw new Error(_0x58f1fd(0x17b)+_0x1837c6+_0x58f1fd(0x160));const _0x38210d=this[_0x58f1fd(0x18b)]['get'](_0x3aaf7f);let _0x567aad=this[_0x58f1fd(0x1b8)](_0x38210d[_0x58f1fd(0x19b)]);for(const _0x5262fc of _0x38210d['messages']){_0x567aad+=this['_estimateTokens'](_0x5262fc['content']);}return _0x567aad;}[a0_0x4c7f4d(0x1b8)](_0x1a2333){const _0x3bc9fb=a0_0x4c7f4d;if(!_0x1a2333||typeof _0x1a2333!==_0x3bc9fb(0x170))return 0x0;return Math['ceil'](_0x1a2333[_0x3bc9fb(0x13c)]/0x4);}[a0_0x4c7f4d(0x1bd)](_0x372d86){const _0x14ae79=a0_0x4c7f4d;return this['availableModels'][_0x14ae79(0x126)](_0x372d86);}['getMaxContextSize'](){const _0x306942=a0_0x4c7f4d;let _0x364163=0x0;for(const _0x185bce of this[_0x306942(0x11d)][_0x306942(0x16b)]()){_0x185bce[_0x306942(0x156)]>_0x364163&&(_0x364163=_0x185bce[_0x306942(0x156)]);}return _0x364163||0x186a0;}[a0_0x4c7f4d(0x182)](){return this['lastInputTokenCount'];}['getLastOutputTokenCount'](){const _0x5a278a=a0_0x4c7f4d;return this[_0x5a278a(0x14c)];}[a0_0x4c7f4d(0x10e)](){return{...this['tokenUsage']};}async['refreshPricingData'](){const _0x58e4fd=a0_0x4c7f4d;this[_0x58e4fd(0x17e)][_0x58e4fd(0x15c)]('Refreshing pricing data from server'),await this['_loadPricingData']();}async[a0_0x4c7f4d(0x111)](){const _0x19b057=a0_0x4c7f4d;try{const _0x453e99=await this[_0x19b057(0x1b2)](_0x19b057(0x1b4));if(!_0x453e99['ok'])return{'status':_0x19b057(0x17c),'error':'HTTP\x20'+_0x453e99['status']+':\x20'+_0x453e99[_0x19b057(0x16d)]};const _0x56054a=await _0x453e99['json']();return{'status':_0x19b057(0x199),..._0x56054a};}catch(_0x7095e7){return{'status':'unhealthy','error':_0x7095e7[_0x19b057(0x1a4)]};}}async[a0_0x4c7f4d(0x121)](){const _0x290077=a0_0x4c7f4d;this[_0x290077(0x17e)][_0x290077(0x15c)]('Shutting\x20down\x20server\x20LLM\x20service'),this['conversations']['clear'](),this[_0x290077(0x11d)][_0x290077(0x1a7)](),this[_0x290077(0x161)][_0x290077(0x1a7)](),this['isInitialized']=![],this['apiKey']=null,this[_0x290077(0x17e)][_0x290077(0x15c)](_0x290077(0x12d));}async['_makeRequest'](_0x379121,_0x5e1995={}){const _0x1dcd24=a0_0x4c7f4d,_0x1ca969=''+this['serverUrl']+_0x379121,_0x16591b={'method':_0x5e1995[_0x1dcd24(0x124)]||'GET','headers':{'Content-Type':'application/json','User-Agent':_0x1dcd24(0x1c4),..._0x5e1995['headers']},'timeout':this[_0x1dcd24(0x158)],..._0x5e1995};this[_0x1dcd24(0x13d)]&&(_0x16591b['headers'][_0x1dcd24(0x185)]='Bearer\x20'+this['apiKey']);try{const _0x29f683=await a0_0x3f0de8(_0x1ca969,_0x16591b);return _0x29f683;}catch(_0x4520b4){throw this['_createNetworkError'](_0x4520b4,_0x1ca969);}}async[a0_0x4c7f4d(0x15f)](_0x32142d){const _0xf26353=a0_0x4c7f4d;try{return await _0x32142d[_0xf26353(0x174)]();}catch(_0xff8a4d){return{};}}['_enhanceError'](_0x2b7b57,_0x47f53a){const _0x3423a9=a0_0x4c7f4d,_0x2971e6=new Error(_0x47f53a+'\x20failed:\x20'+_0x2b7b57[_0x3423a9(0x1a4)]);return _0x2971e6['operation']=_0x47f53a,_0x2971e6['originalError']=_0x2b7b57,_0x2971e6['errorType']=this['_classifyError'](_0x2b7b57),_0x2971e6;}['_createHttpError'](_0x3063b7,_0x4c9888){const _0x4490f7=a0_0x4c7f4d,_0x261f89=new Error(_0x4490f7(0x1a0)+_0x3063b7+':\x20'+_0x4c9888);return _0x261f89['status']=_0x3063b7,_0x261f89[_0x4490f7(0x11c)]=this[_0x4490f7(0x1a3)](_0x3063b7),_0x261f89;}['_createNetworkError'](_0x8a7f58,_0x2f1561){const _0x35caf7=a0_0x4c7f4d,_0x1de305=new Error(_0x35caf7(0x122)+_0x8a7f58['message']);_0x1de305['url']=_0x2f1561,_0x1de305['originalError']=_0x8a7f58,_0x1de305[_0x35caf7(0x11c)]=ERROR_TYPES[_0x35caf7(0x142)];if(_0x8a7f58['code']===_0x35caf7(0x180))_0x1de305[_0x35caf7(0x1a4)]=_0x35caf7(0x137);else{if(_0x8a7f58[_0x35caf7(0x113)]==='ENOTFOUND')_0x1de305[_0x35caf7(0x1a4)]=_0x35caf7(0x1b7);else(_0x8a7f58['code']==='ETIMEDOUT'||_0x8a7f58['name']==='AbortError')&&(_0x1de305['message']=_0x35caf7(0x138),_0x1de305[_0x35caf7(0x11c)]=ERROR_TYPES[_0x35caf7(0x144)]);}return _0x1de305;}[a0_0x4c7f4d(0x1ab)](_0x16f1f4){const _0x39dec5=a0_0x4c7f4d;if(_0x16f1f4['status'])return this['_classifyHttpError'](_0x16f1f4[_0x39dec5(0x13b)]);if(_0x16f1f4['code']==='ECONNREFUSED'||_0x16f1f4['code']===_0x39dec5(0x134))return ERROR_TYPES['NETWORK'];if(_0x16f1f4[_0x39dec5(0x113)]===_0x39dec5(0x184)||_0x16f1f4['name']===_0x39dec5(0x17f))return ERROR_TYPES[_0x39dec5(0x144)];return ERROR_TYPES['UNKNOWN'];}[a0_0x4c7f4d(0x1a3)](_0x2889ed){const _0x5ca20b=a0_0x4c7f4d;switch(_0x2889ed){case HTTP_STATUS['UNAUTHORIZED']:case HTTP_STATUS['FORBIDDEN']:return ERROR_TYPES['AUTHENTICATION'];case HTTP_STATUS[_0x5ca20b(0x18d)]:return ERROR_TYPES[_0x5ca20b(0x1ac)];case HTTP_STATUS[_0x5ca20b(0x12c)]:return ERROR_TYPES['RATE_LIMIT'];case HTTP_STATUS[_0x5ca20b(0x197)]:case HTTP_STATUS['BAD_GATEWAY']:case HTTP_STATUS[_0x5ca20b(0x12a)]:case HTTP_STATUS[_0x5ca20b(0x165)]:return ERROR_TYPES[_0x5ca20b(0x120)];default:return ERROR_TYPES['UNKNOWN'];}}['_isNonRetryableError'](_0x2df882){const _0x158e10=a0_0x4c7f4d,_0x2dea35=[ERROR_TYPES['AUTHENTICATION'],ERROR_TYPES[_0x158e10(0x1ac)]],_0x4719e7=[HTTP_STATUS[_0x158e10(0x18d)],HTTP_STATUS['UNAUTHORIZED'],HTTP_STATUS['FORBIDDEN'],HTTP_STATUS['NOT_FOUND']];return _0x2dea35['includes'](_0x2df882['errorType'])||_0x4719e7['includes'](_0x2df882[_0x158e10(0x13b)]);}['_delay'](_0x135b97){return new Promise(_0x668dc7=>setTimeout(_0x668dc7,_0x135b97));}['_decryptKey'](_0x106f26){const _0x10dbc7=a0_0x4c7f4d,_0x1d9088=_0x10dbc7(0x10b),_0x6af406=Buffer[_0x10dbc7(0x1c0)](_0x106f26,_0x10dbc7(0x164))['toString']();let _0x549558='';for(let _0x469e87=0x0;_0x469e87<_0x6af406[_0x10dbc7(0x13c)];_0x469e87++){_0x549558+=String['fromCharCode'](_0x6af406[_0x10dbc7(0x16e)](_0x469e87)^_0x1d9088[_0x10dbc7(0x16e)](_0x469e87%_0x1d9088[_0x10dbc7(0x13c)]));}return _0x549558;}}