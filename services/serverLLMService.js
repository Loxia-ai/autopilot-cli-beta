const a0_0x3c8487=a0_0x28f4;(function(_0x47d2ee,_0x3386ad){const _0x13cc4a=a0_0x28f4,_0x58dfa5=_0x47d2ee();while(!![]){try{const _0x2a5f1f=parseInt(_0x13cc4a(0xdb))/0x1*(parseInt(_0x13cc4a(0x90))/0x2)+-parseInt(_0x13cc4a(0xe7))/0x3*(-parseInt(_0x13cc4a(0xbe))/0x4)+-parseInt(_0x13cc4a(0x115))/0x5+parseInt(_0x13cc4a(0x8f))/0x6*(parseInt(_0x13cc4a(0x6d))/0x7)+parseInt(_0x13cc4a(0x81))/0x8*(-parseInt(_0x13cc4a(0xfd))/0x9)+parseInt(_0x13cc4a(0xc1))/0xa+-parseInt(_0x13cc4a(0xac))/0xb;if(_0x2a5f1f===_0x3386ad)break;else _0x58dfa5['push'](_0x58dfa5['shift']());}catch(_0x183d6f){_0x58dfa5['push'](_0x58dfa5['shift']());}}}(a0_0x4a1c,0xe2fdf));import a0_0x1e5213 from'node-fetch';function a0_0x28f4(_0x48f361,_0x59a18c){const _0x4a1c0a=a0_0x4a1c();return a0_0x28f4=function(_0x28f4b6,_0x47f02f){_0x28f4b6=_0x28f4b6-0x68;let _0x339f44=_0x4a1c0a[_0x28f4b6];if(a0_0x28f4['clmaFr']===undefined){var _0x42f63a=function(_0x1e5213){const _0x30272a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xcbb762='',_0x5ef891='';for(let _0x5f41b1=0x0,_0x5e83f2,_0x5ef3ad,_0x392796=0x0;_0x5ef3ad=_0x1e5213['charAt'](_0x392796++);~_0x5ef3ad&&(_0x5e83f2=_0x5f41b1%0x4?_0x5e83f2*0x40+_0x5ef3ad:_0x5ef3ad,_0x5f41b1++%0x4)?_0xcbb762+=String['fromCharCode'](0xff&_0x5e83f2>>(-0x2*_0x5f41b1&0x6)):0x0){_0x5ef3ad=_0x30272a['indexOf'](_0x5ef3ad);}for(let _0x4ce85f=0x0,_0x3caa54=_0xcbb762['length'];_0x4ce85f<_0x3caa54;_0x4ce85f++){_0x5ef891+='%'+('00'+_0xcbb762['charCodeAt'](_0x4ce85f)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5ef891);};a0_0x28f4['cIcYbb']=_0x42f63a,_0x48f361=arguments,a0_0x28f4['clmaFr']=!![];}const _0x4e5b44=_0x4a1c0a[0x0],_0x5e3512=_0x28f4b6+_0x4e5b44,_0x42d66c=_0x48f361[_0x5e3512];return!_0x42d66c?(_0x339f44=a0_0x28f4['cIcYbb'](_0x339f44),_0x48f361[_0x5e3512]=_0x339f44):_0x339f44=_0x42d66c,_0x339f44;},a0_0x28f4(_0x48f361,_0x59a18c);}function a0_0x4a1c(){const _0x268863=['Bw9KzwXZ','C3vIC3rYAw5N','sw52ywXPzcbZzxj2zxiGvvjmoIa','sw52ywXPzcbZDw1Tyxj5ihbYB21WDa','C2vYDMLJzxm','rvrjtuvet1vu','ntm0DerJDxzj','mLPpu3nmzW','BgvUz3rO','y2HHCKnVzgvbDa','q29UDMvYC2f0Aw9Uia','yxbPs2v5','zxjYB3juExbL','y29UDMvYC2f0Aw9Ulq','DgLTzw91Da','ChvZAa','rMfPBgvKihrVigXVywqGyxzHAwXHyMXLig1VzgvSCZO','uKfurv9msu1jva','AxnjBML0AwfSAxPLza','x3zHBgLKyxrLtw9KzwXeyxrH','CMvNAxn0zxjdB252zxjZyxrPB24','B3jPz2LUywXfCNjVCG','z2v0twf4q29UDgv4DfnPEMu','Dw5OzwfSDgH5','x2rLy3j5ChrlzxK','Aw5MBW','Bg9HzgvKu2vYDMvYrgf0yq','qMvHCMvYia','x3vWzgf0zunVBNzLCNnHDgLVBLn0yxrL','Ag9TzwrPCG','AM9PBG','CMvXDwvZDcb0B28GBgfYz2u','B3bLCMf0Aw9U','C2vUzf9TzxnZywDL','r0vu','mti1mtaYmtjlCejQtMW','BgfZDfbYAwnPBMDvCgrHDgu','x3nLBMrdAgf0uMvXDwvZDa','BNvTyMvY','l2XSBs9TB2rLBhm','sw5PDgLHBgL6Aw5NihnLCNzLCIbmte0GC2vYDMLJzq','Bwf4vg9Rzw5Z','y3jLzgvUDgLHBhm','x3zHBgLKyxrLuhjPy2LUz0rHDge','x3nHzMvkC29UugfYC2u','y3vYCMvUy3K','B3v0Chv0','BMv0D29YAW','rMfPBgvKihrVigXVywqGBw9KzwXZoIa','u2vYDMvYifvstcbTDxn0ihvZzsbivfrqig9YieHuvfbtihbYB3rVy29S','x3zHBgLKyxrLsw1Hz2vezxnJCMLWDgLVBKLUChv0CW','x2nSyxnZAwz5rxjYB3i','CMf0zv9SAw1PDa','ndr5BLrmBuS','Cgf5Bg9Hzcb0B28GBgfYz2u','Bg9Nz2vY','otC2mJK3mevyCeX4tG','qxv0Ag9YAxPHDgLVBG','qwjVCNrfCNjVCG','x2LZtM9UuMv0CNLHyMXLrxjYB3i','Aw5PDgLHBgL6zq','ANnVBG','C2vYDMvYvxjS','Aw5JBhvKzxm','C2vUze1LC3nHz2u','Bg94AweTBg9JywWTA2v5','C3rHDhvZ','BgfZDefJDgL2Axr5','AgfZ','x2rLBgf5','yxP1CMuTB3bLBMfPlwDWDdq','uMvXDwvZDcb0Aw1LB3v0lIbtzxj2zxiGBwf5igjLig92zxjSB2fKzwqU','C3LZDgvTuhjVBxb0','BgfZDe91Dhb1DfrVA2vUq291BNq','BwvZC2fNzxm','u2vYDMvYieXmtsbZzxj2AwnLigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEq','l2XSBs92AxnPB24','x3zHBgLKyxrLu2vYDMvYvxjS','x21HA2vszxf1zxn0','Aw5WDxq','x3zHBgLKyxrLsw1Hz2vhzw5LCMf0Aw9Usw5WDxrZ','DhjPBq','ode2ntHnEejfsxO','x2DLDe1VzgvStwf4vg9Rzw5Z','u2vYDMLJzsbUB3qGAw5PDgLHBgL6zwqUienHBgWGAw5PDgLHBgL6zsGPigzPCNn0lG','C3rYAw5NAwz5','tKvuv09ssW','x2nYzwf0zuH0DhbfCNjVCG','tg94AweTq0XjlZeUmc4W','sw52ywXPzcbZAxPLihbHCMfTzxrLCG','zNjVBq','Bw9KzwW','yxbWBgLJyxrPB24VANnVBG','ve9px01btLLFuKvrvuvtvfm','ndeWotC5re5dAK9r','CxvHBgL0Eq','sw52ywXPzcbIyxnLnJqGAw1Hz2uGzgf0yq','ChjPy2LUz0rHDge','yJy0x2PZB24','y2f0zwDVCNK','DxnHz2u','x3zHBgLKyxrLu2vUze1LC3nHz2vjBNb1Dhm','u0vsvKvs','DMfSDwvZ','mtaYnhGXmdi0','rxjYB3iGC2vUzgLUzYbTzxnZywDLihrVihnLCNzLCJO','sw52ywXPzcbVDxrWDxqGChjPy2LUzYbMB3iGBw9KzwWG','Dg9ju09tDhjPBMC','x3zHBgLKyxrLqxbPs2v5','zxjYB3i','qKfex1jfuvvfu1q','BM93','BwvZC2fNzq','x2DLBMvYyxrLuMvXDwvZDeLK','veLnru9vva','z2v0','owDnExPdsq','x2XVywrbDMfPBgfIBgvnB2rLBhm','Dw5PDa','zNjVBunOyxjdB2rL','y29Kzq','z2vUzxjHDgvjBwfNzq','yxP1CMuTywKTCgHPna','CMvXDwvZDeLK','l2XSBs9Nzw5LCMf0zs1PBwfNzq','y29UDgvUDa','C3rHBMrHCMq','sw52ywXPzcbTyxHuB2TLBNmGzM9Yig1VzgvSia','DhLWzq','ChjPy2LUzW','CMvWBgfJzq','sfruuca','DMfSAwrHDgLVBG','C2v0','x3zHBgLKyxrLq2HHDfjLC3bVBNnL','Dg9tDhjPBMC','x3bYB2nLC3ndAgf0uMvZCg9UC2u','C3rHDhvZvgv4Da','yxzHAwXHyMXLtw9KzwXZ','yw50AhjVCgLJlxnVBM5LDa','mtGWmJi3nvLnqKD3sa','B3v0Chv0x3rVA2vUCW','tMv0D29YAYbYzxf1zxn0igzHAwXLzdOG','Bwf4uMv0CMLLCW','zNmVChjVBwLZzxm','x2vZDgLTyxrLvg9Rzw5Z','z2v0qxzHAwXHyMXLtw9KzwXZ','BMfTzq','rMfPBgvKihrVigXVywqGChjPy2LUzZOG','qvbjigTLEsb2ywXPzgf0Aw9UigzHAwXLzdO','u2H1DhrPBMCGzg93BIbZzxj2zxiGteXnihnLCNzPy2u','AgvHzgvYCW','yMfZzty0','x2XVywrqCMLJAw5Nrgf0yq','sw52ywXPzcbJB252zxjZyxrPB24Gsuq','zw50CMLLCW','Aw5WDxrFDg9Rzw5Z','zgvIDwC','l2f1DgGVDMvYAwz5','Ahr0CdO','CgfYC2u','x2nYzwf0zu5LDhDVCMTfCNjVCG','rK9sqKLerevo','z2vUzxjHDgvFAw1Hz2u','yxv0AgvUDgLJyxrPB24','C2L6zq','tM8GqvbjigTLEsbHDMfPBgfIBguUifbSzwfZzsbZzxqGEw91CIbbueKGA2v5igzPCNn0lG','igzHAwXLzdOG','runptK5sruzvu0ve','x2XVywrbCgLlzxK','CMvZCg9UC2vgB3jTyxq','ig5VDcbMB3vUza','z2v0vg9Rzw5vC2fNzq','Dg9Rzw5vC2fNzq','ntC0nJnKtKLrzuy','vu5ltK9xtG','u0vsvKLdrv9vtKfwquLmqujmrq','y29UzMLN','zxn0Aw1HDgvuB2TLBKnVDw50','yxP1CMuTB3bLBMfPlwDWDdm1','CMvHzezPBgu','x2XVywrtzxj2zxjeyxrH','C3rYAw5N','ue9tva','x2DLDerLzMf1BhrnB2rLBa','x2vUAgfUy2vfCNjVCG','sw52ywXPzcbTB2rLBcbWyxjHBwv0zxiGlsbTDxn0igjLigeGBM9UlwvTChr5ihn0CMLUzW','D2fYBG','u2vYDMvYieXmtsbZzxj2AwnLigLUAxrPywXPEMvK','BgfZDeLUChv0vg9Rzw5dB3vUDa','x3nHBML0AxPLq29UDMvYC2f0Aw9Uswq','u2vUzgLUzYbTzxnZywDLihrVihnLCNzLCIbMB3iGy29UDMvYC2f0Aw9UoIa','x2nSyxnZAwz5shr0CevYCM9Y','u2vUzgLUzYbPBwfNzsbNzw5LCMf0Aw9UihjLCxvLC3q6','nJK0mZC4nhbhr3zizW','vxbKyxrPBMCGC2vYDMvYignVBNzLCNnHDgLVBJOG','sw1Hz2uGzgf0ysb0B28GBgfYz2u','qvvusevoveLdqvrjt04','AgvHBhrOEq','y2XLyxi','yxP1CMuTB3bLBMfPlwrHBgXLmW','y29UDMvYC2f0Aw9UCW'];a0_0x4a1c=function(){return _0x268863;};return a0_0x4a1c();}const DEFAULT_TIMEOUT_MS=0xea60,DEFAULT_MAX_RETRIES=0x3,DEFAULT_RETRY_DELAY_MS=0x7530,RETRY_DELAY_MULTIPLIER=0x2,API_VERSION='v1',HTTP_STATUS={'OK':0xc8,'CREATED':0xc9,'BAD_REQUEST':0x190,'UNAUTHORIZED':0x191,'FORBIDDEN':0x193,'NOT_FOUND':0x194,'TOO_MANY_REQUESTS':0x1ad,'INTERNAL_SERVER_ERROR':0x1f4,'BAD_GATEWAY':0x1f6,'SERVICE_UNAVAILABLE':0x1f7,'GATEWAY_TIMEOUT':0x1f8},ERROR_TYPES={'AUTHENTICATION':a0_0x3c8487(0x12d),'NETWORK':a0_0x3c8487(0xb8),'TIMEOUT':a0_0x3c8487(0x97),'RATE_LIMIT':a0_0x3c8487(0xbd),'SERVER':'server','VALIDATION':a0_0x3c8487(0x10d),'UNKNOWN':'unknown'},HTTP_STATUS_CODES={'REQUEST_ENTITY_TOO_LARGE':0x19d,'BAD_REQUEST':0x190,'UNAUTHORIZED':0x191,'FORBIDDEN':0x193,'NOT_FOUND':0x194,'TOO_MANY_REQUESTS':0x1ad,'INTERNAL_SERVER_ERROR':0x1f4},REQUEST_SIZE_ERROR_PATTERNS=['request\x20entity\x20too\x20large',a0_0x3c8487(0xbf),a0_0x3c8487(0xa8),'message\x20too\x20long','content\x20length\x20exceeds\x20limit'];export class ServerLLMService{constructor(_0x30272a,_0xcbb762){const _0x283ab2=a0_0x3c8487;this[_0x283ab2(0x70)]=_0x30272a,this['logger']=_0xcbb762,this[_0x283ab2(0xc7)]=this[_0x283ab2(0xd6)](_0x30272a['serverUrl']),this[_0x283ab2(0x94)]=null,this['isInitialized']=![],this[_0x283ab2(0x97)]=_0x30272a[_0x283ab2(0x8d)]?.['server']?.['timeout']||DEFAULT_TIMEOUT_MS,this['maxRetries']=_0x30272a[_0x283ab2(0x8d)]?.['server']?.['retries']||DEFAULT_MAX_RETRIES,this[_0x283ab2(0x104)]=0x0,this[_0x283ab2(0x113)]=new Map(),this['pricingData']=new Map(),this[_0x283ab2(0xad)]=null,this['conversations']=new Map(),this['lastInputTokenCount']=0x0,this[_0x283ab2(0xd2)]=0x0,this[_0x283ab2(0x6c)]={'input':0x0,'output':0x0},this['logger']['info'](_0x283ab2(0x7b),{'serverUrl':this['serverUrl'],'timeout':this[_0x283ab2(0x97)],'maxRetries':this[_0x283ab2(0x118)]});}['_validateServerUrl'](_0x5ef891){const _0x4d1613=a0_0x3c8487;if(!_0x5ef891)throw new Error('Server\x20URL\x20is\x20required');try{const _0x5f41b1=new URL(_0x5ef891);if(![_0x4d1613(0x128),'https:']['includes'](_0x5f41b1['protocol']))throw new Error(_0x4d1613(0xba));return _0x5f41b1['toString']()[_0x4d1613(0x10b)](/\/$/,'');}catch(_0x5e83f2){throw new Error(_0x4d1613(0x8b)+_0x5e83f2[_0x4d1613(0xf9)]);}}['_sanitizeConversationId'](_0x5ef3ad){const _0x1ce94b=a0_0x3c8487;if(!_0x5ef3ad||typeof _0x5ef3ad!==_0x1ce94b(0x75))return _0x1ce94b(0x96)+Date['now']();let _0x392796=_0x5ef3ad['replace'](/\s+/g,'-')['replace'](/[^a-zA-Z0-9_-]/g,'')[_0x1ce94b(0x10b)](/-+/g,'-')['replace'](/^-+|-+$/g,'')['toLowerCase']();if(!_0x392796)_0x392796=_0x1ce94b(0x96)+Date['now']();else _0x392796[_0x1ce94b(0x91)]>0x32&&(_0x392796=_0x392796[_0x1ce94b(0x8a)](0x0,0x28)+'-'+Date[_0x1ce94b(0xf8)]()['toString']()['slice'](-0x8));return _0x392796;}async[a0_0x3c8487(0xc5)](){const _0x164390=a0_0x3c8487;if(this['isInitialized'])return;try{this['logger']['info'](_0x164390(0xb1)),this[_0x164390(0x94)]=await this[_0x164390(0x68)]();if(!this['apiKey'])throw new Error('No\x20API\x20key\x20found.\x20Please\x20run\x20\x22loxia\x20key\x20--set\x20<your-api-key>\x22\x20first.');await this['_loadServerData'](),this[_0x164390(0x9b)]=!![],this[_0x164390(0xc0)][_0x164390(0xa2)](_0x164390(0xd4),{'modelsLoaded':this[_0x164390(0x113)]['size'],'pricingModels':this[_0x164390(0xea)][_0x164390(0x12e)]});}catch(_0x4ce85f){this['logger'][_0x164390(0xf6)]('Failed\x20to\x20initialize\x20server\x20LLM\x20service:',_0x4ce85f);throw _0x4ce85f;}}async[a0_0x3c8487(0x74)](){const _0x4588ec=a0_0x3c8487;await Promise['all']([this['_loadAvailableModels'](),this[_0x4588ec(0x122)]()]),this[_0x4588ec(0xa3)]=!![];}async[a0_0x3c8487(0x68)](){const _0x1ad559=a0_0x3c8487;try{const _0x3caa54=await import('os'),_0x50a83d=await import('path'),_0x4b00ec=await import(_0x1ad559(0x119)),_0x3acabb=_0x50a83d[_0x1ad559(0xa7)](_0x3caa54[_0x1ad559(0xa6)](),'.loxia',_0x1ad559(0xb3)),_0x580653=await _0x4b00ec[_0x1ad559(0x73)](_0x3acabb,'utf8'),_0xc734e9=JSON[_0x1ad559(0x129)](_0x580653);return this[_0x1ad559(0xa1)](_0xc734e9[_0x1ad559(0x94)]);}catch(_0x2d2c95){return this[_0x1ad559(0xc0)]['debug']('Failed to load API key from credentials file:',_0x2d2c95),null;}}async[a0_0x3c8487(0xf5)](){const _0x4d56bd=a0_0x3c8487;try{const _0x2d1377=await this['_makeRequest'](_0x4d56bd(0x127),{'method':'POST'});return _0x2d1377['ok'];}catch(_0x605f4d){return this['logger']['warn'](_0x4d56bd(0x11e),_0x605f4d),![];}}async[a0_0x3c8487(0xfe)](){const _0xd1a1cb=a0_0x3c8487;try{this['logger']['info']('Loading available models from server');const _0x92ab5e=await this[_0xd1a1cb(0xd7)](_0xd1a1cb(0xb0)),_0x1c5cd9=await _0x92ab5e[_0xd1a1cb(0xc6)]();if(!_0x1c5cd9[_0xd1a1cb(0x89)]||!Array['isArray'](_0x1c5cd9[_0xd1a1cb(0x89)]))throw new Error('Invalid models response from server');this[_0xd1a1cb(0x113)]['clear']();for(const _0x1c75a0 of _0x1c5cd9[_0xd1a1cb(0x89)]){this[_0xd1a1cb(0x9c)](_0x1c75a0),this[_0xd1a1cb(0x113)]['set'](_0x1c75a0[_0xd1a1cb(0x11c)],{'name':_0x1c75a0[_0xd1a1cb(0x11c)],'category':_0x1c75a0[_0xd1a1cb(0xec)],'type':_0x1c75a0['type'],'maxTokens':_0x1c75a0['maxTokens'],'supportsVision':_0x1c75a0['supportsVision']||![],'supportsSystem':_0x1c75a0['supportsSystem']!==![],'pricing':_0x1c75a0['pricing']||{}});}this[_0xd1a1cb(0xc0)][_0xd1a1cb(0xa2)]('Loaded\x20'+this[_0xd1a1cb(0x113)][_0xd1a1cb(0x12e)]+'\x20models\x20from\x20server');}catch(_0x4c1f86){this['logger']['error'](_0xd1a1cb(0x99),_0x4c1f86);throw new Error(_0xd1a1cb(0xb9)+_0x4c1f86[_0xd1a1cb(0xf9)]);}}['_validateModelData'](_0x56866f){const _0x57d071=a0_0x3c8487,requiredFields=[_0x57d071(0x11c),'category',_0x57d071(0x109)];for(const _0x4539ab of requiredFields){if(!_0x56866f[_0x4539ab])throw new Error('Model\x20missing\x20required\x20field:\x20'+_0x4539ab);}if(_0x56866f['type']!=='image-generation'){if(typeof _0x56866f['maxTokens']!==_0x57d071(0xaf)||_0x56866f['maxTokens']<=0x0)throw new Error(_0x57d071(0x108)+_0x56866f[_0x57d071(0x11c)]);}}async['_loadPricingData'](){const _0x20657f=a0_0x3c8487;try{this['logger'][_0x20657f(0xa2)]('Loading pricing data from server');const _0xfd9f66=await this['_makeRequest']('/usage/pricing'),_0x3c6ace=await _0xfd9f66['json']();if(!_0x3c6ace['pricing'])throw new Error('Invalid pricing response from server');this['pricingData'][_0x20657f(0x86)]();for(const [_0x136c3d,_0x22787b]of Object[_0x20657f(0x124)](_0x3c6ace[_0x20657f(0x10a)])){this['_validatePricingData'](_0x136c3d,_0x22787b),this['pricingData']['set'](_0x136c3d,{'input':_0x22787b[_0x20657f(0xd8)],'output':_0x22787b['output'],'unit':_0x22787b[_0x20657f(0xff)]||'1K\x20tokens','currency':_0x22787b[_0x20657f(0xb6)]||'USD'});}this[_0x20657f(0xad)]=new Date()['toISOString'](),this[_0x20657f(0xc0)][_0x20657f(0xa2)]('Loaded\x20pricing\x20for\x20'+this[_0x20657f(0xea)][_0x20657f(0x12e)]+'\x20models');}catch(_0x2b9e39){this[_0x20657f(0xc0)]['error']('Failed\x20to\x20load\x20pricing\x20data:',_0x2b9e39);throw new Error(_0x20657f(0x11d)+_0x2b9e39['message']);}}[a0_0x3c8487(0xb4)](_0x5305e0,_0x1b7e5f){const _0x1b16aa=a0_0x3c8487;if(typeof _0x1b7e5f['input']!==_0x1b16aa(0xaf)||_0x1b7e5f[_0x1b16aa(0xd8)]<0x0)throw new Error('Invalid\x20input\x20pricing\x20for\x20model\x20'+_0x5305e0);if(typeof _0x1b7e5f[_0x1b16aa(0xb7)]!=='number'||_0x1b7e5f[_0x1b16aa(0xb7)]<0x0)throw new Error(_0x1b16aa(0xf3)+_0x5305e0);}async[a0_0x3c8487(0x11b)](){const _0x5b35d2=a0_0x3c8487;!this[_0x5b35d2(0xa3)]&&await this[_0x5b35d2(0x74)]();let _0x22d3f3=Array[_0x5b35d2(0xe3)](this['availableModels'][_0x5b35d2(0xf0)]());return _0x22d3f3;}async['getPricingData'](){const _0x1308f2=a0_0x3c8487;return!this[_0x1308f2(0xa3)]&&await this['_loadServerData'](),new Map(this['pricingData']);}['getModelPricing'](_0x4f3ada){const _0x166440=a0_0x3c8487;return this[_0x166440(0xea)][_0x166440(0xfc)](_0x4f3ada)||null;}['_isValidConversationId'](_0x9a4b6f){const _0x222877=a0_0x3c8487;return typeof _0x9a4b6f==='string'&&_0x9a4b6f['length']>0x0&&_0x9a4b6f[_0x222877(0x91)]<=0x64&&/^[a-zA-Z0-9_-]+$/['test'](_0x9a4b6f);}async[a0_0x3c8487(0x9d)](_0x178098,_0xbe5749,_0x51037e=null){const _0x443d97=a0_0x3c8487,_0x3a192d=_0x51037e||this['_getDefaultModel']();this['logger'][_0x443d97(0xa2)]('Registering\x20conversation\x20with\x20server:\x20'+_0x178098);const _0x2f77e3=this['_sanitizeConversationId'](_0x178098);_0x2f77e3!==_0x178098&&this[_0x443d97(0xc0)]['info']('Sanitized\x20conversation\x20ID\x20from\x20\x22'+_0x178098+'\x22\x20to\x20\x22'+_0x2f77e3+'\x22');if(!this['_isValidConversationId'](_0x2f77e3))throw new Error('Failed\x20to\x20create\x20valid\x20conversation\x20ID\x20from:\x20'+_0x178098);this[_0x443d97(0x88)][_0x443d97(0x10e)](_0x2f77e3,{'originalId':_0x178098,'systemPrompt':_0xbe5749||'','messages':[],'model':_0x3a192d,'createdAt':new Date()['toISOString'](),'lastActivity':new Date()[_0x443d97(0xf4)]()}),_0x2f77e3!==_0x178098&&this['conversations']['set'](_0x178098,this[_0x443d97(0x88)][_0x443d97(0xfc)](_0x2f77e3));}[a0_0x3c8487(0x77)](){const _0x4b36f0=a0_0x3c8487,_0x5d3a6a=[_0x4b36f0(0xcf),_0x4b36f0(0x114),_0x4b36f0(0x72)];for(const _0xde7b49 of _0x5d3a6a){if(this[_0x4b36f0(0x113)]['has'](_0xde7b49))return _0xde7b49;}const _0x2e366c=this['availableModels'][_0x4b36f0(0xf0)]()['next']()['value'];return _0x2e366c?_0x2e366c[_0x4b36f0(0x11c)]:'azure-openai-gpt4';}async[a0_0x3c8487(0xc9)](_0xb25f43,_0x2babb1,_0x3bc09a){const _0x5a7340=a0_0x3c8487;this['logger'][_0x5a7340(0xa2)](_0x5a7340(0x7e)+_0xb25f43);if(!this['isInitialized'])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this[_0x5a7340(0x94)])throw new Error(_0x5a7340(0x12f));this[_0x5a7340(0xee)](_0xb25f43,_0x2babb1);const _0x17a3bd=this[_0x5a7340(0x7d)](_0xb25f43),_0x5b2f4c=this['conversations'][_0x5a7340(0xcd)](_0xb25f43)?_0xb25f43:_0x17a3bd;if(!this['conversations'][_0x5a7340(0xcd)](_0x5b2f4c))throw new Error('Conversation\x20'+_0xb25f43+'\x20not\x20found');const _0x4b8064=this['conversations'][_0x5a7340(0xfc)](_0x5b2f4c);_0x3bc09a&&(!_0x4b8064['messages']||_0x4b8064[_0x5a7340(0xd3)]['length']===0x0)&&this['_updateConversationState'](_0x4b8064,_0x3bc09a);const _0x491312=this['_buildChatRequestPayload'](_0x17a3bd,_0x2babb1,_0x4b8064);try{const _0x14f1e1=await this[_0x5a7340(0xae)](_0x491312);return this[_0x5a7340(0x111)](_0x4b8064,_0x2babb1,_0x14f1e1),_0x14f1e1[_0x5a7340(0x106)];}catch(_0x3a0422){this['logger']['error'](_0x5a7340(0xf2),_0x3a0422);throw this['_enhanceError'](_0x3a0422,_0x5a7340(0xaa));}}['_validateSendMessageInputs'](_0x2e25b8,_0x573661){const _0x41a1e1=a0_0x3c8487;if(!_0x2e25b8||typeof _0x2e25b8!==_0x41a1e1(0x75))throw new Error(_0x41a1e1(0x123));if(!_0x573661||typeof _0x573661!=='string')throw new Error('Invalid\x20message\x20content');}[a0_0x3c8487(0xa5)](_0x279f75,_0x24d4b0){const _0x56439b=a0_0x3c8487;_0x24d4b0['messages']&&Array['isArray'](_0x24d4b0['messages'])&&(_0x279f75[_0x56439b(0xd3)]=_0x24d4b0['messages']),_0x24d4b0['systemPrompt']&&typeof _0x24d4b0['systemPrompt']===_0x56439b(0x75)&&(_0x279f75['systemPrompt']=_0x24d4b0[_0x56439b(0xd1)]),_0x24d4b0['model']&&this[_0x56439b(0x113)]['has'](_0x24d4b0[_0x56439b(0xe4)])&&(_0x279f75[_0x56439b(0xe4)]=_0x24d4b0[_0x56439b(0xe4)]),_0x279f75[_0x56439b(0xcc)]=new Date()['toISOString']();}['_buildChatRequestPayload'](_0x228b32,_0x257a20,_0x16efd6){const _0x60f118=a0_0x3c8487;return{'conversationId':_0x228b32,'message':_0x257a20['trim'](),'systemPrompt':_0x16efd6['systemPrompt'],'messages':_0x16efd6['messages']||[],'model':_0x16efd6['model'],'requestId':this['_generateRequestId'](),'options':{'temperature':0.7,'maxTokens':this[_0x60f118(0xdc)](_0x16efd6[_0x60f118(0xe4)])}};}['_generateRequestId'](){const _0x2e3efb=a0_0x3c8487;return'req_'+Date[_0x2e3efb(0xf8)]()+'_'+ ++this['requestId'];}[a0_0x3c8487(0xdc)](_0x104df3){const _0x2c06b7=this['availableModels']['get'](_0x104df3);return _0x2c06b7?_0x2c06b7['maxTokens']:0xfa0;}async['_sendChatRequest'](_0x48bf73){const _0x25fb2e=a0_0x3c8487;try{const _0x234102=await this[_0x25fb2e(0xd7)]('/llm/chat',{'method':'POST','body':JSON[_0x25fb2e(0xde)](_0x48bf73)});if(!_0x234102['ok']){const _0xb81327=await this['_safeJsonParse'](_0x234102),_0x31afc7=this['_createHttpError'](_0x234102[_0x25fb2e(0xcb)],_0xb81327[_0x25fb2e(0xf6)]||_0x234102[_0x25fb2e(0x112)]);throw _0x31afc7;}const _0x13aa08=await _0x234102['json']();return this['_validateChatResponse'](_0x13aa08),_0x13aa08;}catch(_0x3f892d){throw _0x3f892d;}}[a0_0x3c8487(0x10f)](_0x5da787){const _0xdf01e2=a0_0x3c8487;if(!_0x5da787['content']||typeof _0x5da787['content']!==_0xdf01e2(0x75))throw new Error('Invalid\x20response:\x20missing\x20or\x20invalid\x20content');if(_0x5da787[_0xdf01e2(0xed)]&&typeof _0x5da787['usage']!=='object')throw new Error('Invalid\x20response:\x20invalid\x20usage\x20data');}[a0_0x3c8487(0x111)](_0x4c363d,_0x46cb7e,_0x3c883c){const _0x1c5e54=a0_0x3c8487;_0x3c883c[_0x1c5e54(0xed)]&&(this[_0x1c5e54(0x7c)]=_0x3c883c[_0x1c5e54(0xed)]['input_tokens']||0x0,this['lastOutputTokenCount']=_0x3c883c['usage']['output_tokens']||0x0,this[_0x1c5e54(0x6c)]['input']+=this['lastInputTokenCount'],this[_0x1c5e54(0x6c)][_0x1c5e54(0xb7)]+=this['lastOutputTokenCount']),_0x4c363d['messages'][_0x1c5e54(0x98)]({'role':'user','content':_0x46cb7e},{'role':'assistant','content':_0x3c883c[_0x1c5e54(0x106)]}),_0x4c363d[_0x1c5e54(0xcc)]=new Date()[_0x1c5e54(0xf4)]();}async['updateConversation'](_0x3efc57,_0x362c50){const _0x2d6b5d=a0_0x3c8487;this[_0x2d6b5d(0xc0)]['info'](_0x2d6b5d(0x82)+_0x3efc57);const _0xb8404c=this[_0x2d6b5d(0x7d)](_0x3efc57),_0x2b6747=this[_0x2d6b5d(0x88)]['has'](_0x3efc57)?_0x3efc57:_0xb8404c;if(!this['conversations']['has'](_0x2b6747))throw new Error(_0x2d6b5d(0x93)+_0x3efc57+'\x20not\x20found');const _0x4aab3e=this['conversations'][_0x2d6b5d(0xfc)](_0x2b6747);this['_updateConversationState'](_0x4aab3e,_0x362c50);}async['getSummary'](_0x1d1023,_0x29516c=null){const _0x1f7f13=a0_0x3c8487;this[_0x1f7f13(0xc0)]['info']('Getting summary from server');if(!this[_0x1f7f13(0x9b)])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this['apiKey'])throw new Error('No\x20API\x20key\x20available.\x20Please\x20set\x20your\x20API\x20key\x20first.');if(!_0x1d1023||typeof _0x1d1023!==_0x1f7f13(0x75))throw new Error(_0x1f7f13(0x8c));let _0x370879=_0x1f7f13(0x103);if(_0x29516c&&this[_0x1f7f13(0x88)][_0x1f7f13(0xcd)](_0x29516c)){const _0xb18d4e=this['conversations']['get'](_0x29516c);_0x370879=_0xb18d4e['model'],this[_0x1f7f13(0xc0)]['info']('Using\x20conversation\x20model\x20for\x20summary:\x20'+_0x370879);}else this['logger'][_0x1f7f13(0x7a)]('No conversation ID provided or conversation not found, using default model for summary');try{const _0x311bce=await this['_makeRequest']('/llm/summary',{'method':_0x1f7f13(0x76),'body':JSON[_0x1f7f13(0xde)]({'prompt':_0x1d1023[_0x1f7f13(0xda)](),'model':_0x370879})});if(!_0x311bce['ok']){const _0x9d7349=await this['_safeJsonParse'](_0x311bce);throw this['_createHttpError'](_0x311bce[_0x1f7f13(0xcb)],_0x9d7349['error']||_0x311bce[_0x1f7f13(0x112)]);}const _0x1587ce=await _0x311bce[_0x1f7f13(0xc6)]();return _0x1587ce[_0x1f7f13(0xed)]&&(this['lastInputTokenCount']=_0x1587ce['usage']['input_tokens']||0x0,this[_0x1f7f13(0xd2)]=_0x1587ce['usage']['output_tokens']||0x0,this[_0x1f7f13(0x6c)][_0x1f7f13(0xd8)]+=this[_0x1f7f13(0x7c)],this[_0x1f7f13(0x6c)][_0x1f7f13(0xb7)]+=this['lastOutputTokenCount']),_0x1587ce['content'];}catch(_0x757fa9){this['logger']['error']('Error getting summary from server:',_0x757fa9);throw this[_0x1f7f13(0x78)](_0x757fa9,'get_summary');}}async['getImageDescription'](_0x4c1b94,_0x2a30ca,_0x245cc1={}){const _0x25f91b=a0_0x3c8487;this[_0x25f91b(0xc0)][_0x25f91b(0xa2)]('Getting image description from server');if(!this['isInitialized'])throw new Error(_0x25f91b(0xdd));if(!this['apiKey'])throw new Error('No\x20API\x20key\x20available.\x20Please\x20set\x20your\x20API\x20key\x20first.');this[_0x25f91b(0xbb)](_0x4c1b94,_0x2a30ca);try{const _0x35a1be=await this[_0x25f91b(0xd7)](_0x25f91b(0xd5),{'method':_0x25f91b(0x76),'body':JSON[_0x25f91b(0xde)]({'image':_0x4c1b94,'prompt':_0x2a30ca[_0x25f91b(0xda)](),'metadata':_0x245cc1||{}})}),_0x4824fb=await this[_0x25f91b(0xb5)](_0x35a1be);if(!_0x35a1be['ok'])throw this[_0x25f91b(0xe0)](_0x35a1be[_0x25f91b(0xcb)],_0x4824fb[_0x25f91b(0xf6)]||_0x35a1be['statusText']);return _0x4824fb['usage']&&(this['lastInputTokenCount']=_0x4824fb['usage']['input_tokens']||0x0,this['lastOutputTokenCount']=_0x4824fb['usage'][_0x25f91b(0x116)]||0x0,this[_0x25f91b(0x6c)][_0x25f91b(0xd8)]+=this['lastInputTokenCount'],this[_0x25f91b(0x6c)][_0x25f91b(0xb7)]+=this['lastOutputTokenCount']),_0x4824fb['content'];}catch(_0x39ce52){this[_0x25f91b(0xc0)][_0x25f91b(0xf6)]('Error getting image description from server:',_0x39ce52);throw this[_0x25f91b(0x78)](_0x39ce52,'get_image_description');}}async[a0_0x3c8487(0x102)](_0x268a7e,_0x5bfe9d={}){const _0x549a55=a0_0x3c8487;this[_0x549a55(0xc0)][_0x549a55(0xa2)]('Generating image from server');if(!this[_0x549a55(0x9b)])throw new Error(_0x549a55(0xdd));if(!this['apiKey'])throw new Error(_0x549a55(0x12f));this[_0x549a55(0xd9)](_0x268a7e,_0x5bfe9d);try{const _0x515095=_0x5bfe9d['model']||_0x549a55(0x87);if(!_0x515095||_0x515095['trim']()==='')throw new Error('Model\x20name\x20cannot\x20be\x20empty');const _0x71b7f7={'prompt':_0x268a7e[_0x549a55(0xda)](),'model':_0x515095,'size':_0x5bfe9d['size']||_0x549a55(0xf1),'quality':_0x5bfe9d[_0x549a55(0xe8)]||'standard','response_format':_0x5bfe9d[_0x549a55(0x69)]||_0x549a55(0xeb),'requestId':this[_0x549a55(0xfa)]()};this['logger'][_0x549a55(0x126)](_0x549a55(0x80),_0x71b7f7);const _0x1d645d=await this[_0x549a55(0xd7)](_0x549a55(0x105),{'method':_0x549a55(0x76),'body':JSON[_0x549a55(0xde)](_0x71b7f7)}),_0x404529=await this['_safeJsonParse'](_0x1d645d);if(!_0x1d645d['ok'])throw this['_createHttpError'](_0x1d645d[_0x549a55(0xcb)],_0x404529[_0x549a55(0xf6)]||_0x1d645d[_0x549a55(0x112)]);_0x404529[_0x549a55(0xed)]&&(this[_0x549a55(0x7c)]=_0x404529[_0x549a55(0xed)][_0x549a55(0x125)]||0x0,this[_0x549a55(0xd2)]=_0x404529[_0x549a55(0xed)][_0x549a55(0x116)]||0x0,this['tokenUsage']['input']+=this[_0x549a55(0x7c)],this[_0x549a55(0x6c)][_0x549a55(0xb7)]+=this['lastOutputTokenCount']);const _0x2b8999=_0x404529?.['images'][0x0];return{'imageUrl':_0x2b8999?.['url'],'model':_0x404529['model'],'size':_0x404529['size']||_0x71b7f7['size'],'prompt':_0x2b8999?.['revised_prompt']||_0x268a7e,'usage':_0x404529['usage']};}catch(_0x37e4b7){this['logger']['error']('Error generating image from server:',_0x37e4b7);throw this['_enhanceError'](_0x37e4b7,_0x549a55(0x12c));}}['_validateImageGenerationInputs'](_0x544ed0,_0x2e394f){const _0x3b8e15=a0_0x3c8487;if(!_0x544ed0||typeof _0x544ed0!=='string')throw new Error('Invalid\x20image\x20generation\x20prompt');if(_0x544ed0['length']>0xfa0)throw new Error('Image\x20generation\x20prompt\x20too\x20long\x20(max\x204000\x20characters)');if(_0x2e394f['model']&&(typeof _0x2e394f['model']!==_0x3b8e15(0x75)||_0x2e394f['model']['trim']()===''))throw new Error(_0x3b8e15(0x79));if(_0x2e394f['size']&&typeof _0x2e394f['size']!=='string')throw new Error(_0x3b8e15(0xe2));if(_0x2e394f[_0x3b8e15(0xe8)]&&![_0x3b8e15(0x107),'hd'][_0x3b8e15(0xc8)](_0x2e394f['quality']))throw new Error('Invalid\x20quality\x20parameter\x20(must\x20be\x20\x22standard\x22\x20or\x20\x22hd\x22)');}[a0_0x3c8487(0xbb)](_0x4dffec,_0x24ed94){const _0x5b0848=a0_0x3c8487;if(!_0x4dffec||typeof _0x4dffec!=='string')throw new Error(_0x5b0848(0xe9));if(!_0x24ed94||typeof _0x24ed94!=='string')throw new Error('Invalid\x20image\x20description\x20prompt');if(_0x4dffec[_0x5b0848(0x91)]>0x32*0x400*0x400)throw new Error(_0x5b0848(0x83));}async[a0_0x3c8487(0x71)](_0x436415){const _0x205bdb=a0_0x3c8487,_0x18e71a=this['_sanitizeConversationId'](_0x436415),_0x20f0b8=this['conversations'][_0x205bdb(0xcd)](_0x436415)?_0x436415:_0x18e71a;if(!this['conversations'][_0x205bdb(0xcd)](_0x20f0b8))throw new Error(_0x205bdb(0x93)+_0x436415+_0x205bdb(0x6a));const _0x56eba7=this['conversations'][_0x205bdb(0xfc)](_0x20f0b8);let _0x2d0ed6=this[_0x205bdb(0x11a)](_0x56eba7[_0x205bdb(0xd1)]);for(const _0x23efea of _0x56eba7[_0x205bdb(0xd3)]){_0x2d0ed6+=this['_estimateTokens'](_0x23efea[_0x205bdb(0x106)]);}return _0x2d0ed6;}['_estimateTokens'](_0x1036fc){const _0x48e3eb=a0_0x3c8487;if(!_0x1036fc||typeof _0x1036fc!==_0x48e3eb(0x75))return 0x0;return Math['ceil'](_0x1036fc[_0x48e3eb(0x91)]/0x4);}['supportsModel'](_0x28a03e){const _0x366b60=a0_0x3c8487;return this[_0x366b60(0x113)]['has'](_0x28a03e);}[a0_0x3c8487(0x9f)](){const _0x1259d7=a0_0x3c8487;let _0x5f5d7a=0x0;for(const _0x273809 of this[_0x1259d7(0x113)][_0x1259d7(0xf0)]()){_0x273809[_0x1259d7(0xb2)]>_0x5f5d7a&&(_0x5f5d7a=_0x273809['maxTokens']);}return _0x5f5d7a||0x186a0;}['getLastInputTokenCount'](){return this['lastInputTokenCount'];}['getLastOutputTokenCount'](){const _0x36f3f2=a0_0x3c8487;return this[_0x36f3f2(0xd2)];}[a0_0x3c8487(0x6b)](){return{...this['tokenUsage']};}async['refreshPricingData'](){const _0x27a5f8=a0_0x3c8487;this[_0x27a5f8(0xc0)]['info']('Refreshing pricing data from server'),await this['_loadPricingData']();}async['getServerHealth'](){const _0xdfd174=a0_0x3c8487;try{const _0x182c19=await this['_makeRequest']('/health');if(!_0x182c19['ok'])return{'status':'unhealthy','error':'HTTP\x20'+_0x182c19['status']+':\x20'+_0x182c19[_0xdfd174(0x112)]};const _0x12fca7=await _0x182c19['json']();return{'status':_0xdfd174(0x85),..._0x12fca7};}catch(_0x1d1d94){return{'status':_0xdfd174(0xa0),'error':_0x1d1d94['message']};}}async['shutdown'](){const _0x3dad24=a0_0x3c8487;this[_0x3dad24(0xc0)]['info'](_0x3dad24(0x11f)),this['conversations']['clear'](),this['availableModels'][_0x3dad24(0x86)](),this[_0x3dad24(0xea)][_0x3dad24(0x86)](),this['isInitialized']=![],this['apiKey']=null,this[_0x3dad24(0xc0)][_0x3dad24(0xa2)]('Server\x20LLM\x20service\x20shut\x20down\x20successfully');}async[a0_0x3c8487(0xd7)](_0x1abeb1,_0x183e54={}){const _0x38624b=a0_0x3c8487,_0x29060e=''+this['serverUrl']+_0x1abeb1,_0x423f09={'method':_0x183e54['method']||_0x38624b(0xab),'headers':{'Content-Type':_0x38624b(0xe5),'User-Agent':_0x38624b(0xe1),..._0x183e54[_0x38624b(0x120)]},'timeout':this[_0x38624b(0x97)],..._0x183e54};this[_0x38624b(0x94)]&&(_0x423f09[_0x38624b(0x120)][_0x38624b(0xc2)]=_0x38624b(0xa4)+this[_0x38624b(0x94)]);try{const _0x1a8ef9=await a0_0x1e5213(_0x29060e,_0x423f09);return _0x1a8ef9;}catch(_0x117376){throw this['_createNetworkError'](_0x117376,_0x29060e);}}async['_safeJsonParse'](_0x364b97){try{return await _0x364b97['json']();}catch(_0x3547e4){return{};}}['_enhanceError'](_0x470b9d,_0x3dd49a){const _0xdf1af=a0_0x3c8487,_0x3162b2=new Error(_0x3dd49a+_0xdf1af(0x130)+_0x470b9d['message']);return _0x3162b2[_0xdf1af(0xa9)]=_0x3dd49a,_0x3162b2[_0xdf1af(0x9e)]=_0x470b9d,_0x3162b2['errorType']=this[_0xdf1af(0xbc)](_0x470b9d),_0x3162b2;}['_createHttpError'](_0x1a58f3,_0x5a7cf3){const _0x7a7731=a0_0x3c8487,_0x527e9b=new Error(_0x7a7731(0x10c)+_0x1a58f3+':\x20'+_0x5a7cf3);return _0x527e9b[_0x7a7731(0xcb)]=_0x1a58f3,_0x527e9b['errorType']=this[_0x7a7731(0x7f)](_0x1a58f3),_0x527e9b;}[a0_0x3c8487(0x12a)](_0x2a3268,_0xd26aa9){const _0x5a2ae8=a0_0x3c8487,_0x400829=new Error(_0x5a2ae8(0x117)+_0x2a3268[_0x5a2ae8(0xf9)]);_0x400829['url']=_0xd26aa9,_0x400829['originalError']=_0x2a3268,_0x400829['errorType']=ERROR_TYPES[_0x5a2ae8(0xdf)];if(_0x2a3268['code']==='ECONNREFUSED')_0x400829['message']='Connection\x20refused.\x20Server\x20may\x20be\x20down.';else{if(_0x2a3268['code']==='ENOTFOUND')_0x400829[_0x5a2ae8(0xf9)]='DNS\x20lookup\x20failed.\x20Check\x20server\x20URL.';else(_0x2a3268['code']===_0x5a2ae8(0x8e)||_0x2a3268[_0x5a2ae8(0x11c)]===_0x5a2ae8(0xc3))&&(_0x400829[_0x5a2ae8(0xf9)]=_0x5a2ae8(0xd0),_0x400829[_0x5a2ae8(0x95)]=ERROR_TYPES[_0x5a2ae8(0xfb)]);}return _0x400829;}[a0_0x3c8487(0xbc)](_0x27dbba){const _0x5bc6fa=a0_0x3c8487;if(_0x27dbba['status'])return this[_0x5bc6fa(0x7f)](_0x27dbba['status']);if(_0x27dbba[_0x5bc6fa(0x101)]===_0x5bc6fa(0x131)||_0x27dbba[_0x5bc6fa(0x101)]==='ENOTFOUND')return ERROR_TYPES['NETWORK'];if(_0x27dbba[_0x5bc6fa(0x101)]===_0x5bc6fa(0x8e)||_0x27dbba[_0x5bc6fa(0x11c)]===_0x5bc6fa(0xc3))return ERROR_TYPES['TIMEOUT'];return ERROR_TYPES[_0x5bc6fa(0x6e)];}[a0_0x3c8487(0x7f)](_0x2a538b){const _0x40087c=a0_0x3c8487;switch(_0x2a538b){case HTTP_STATUS['UNAUTHORIZED']:case HTTP_STATUS['FORBIDDEN']:return ERROR_TYPES['AUTHENTICATION'];case HTTP_STATUS[_0x40087c(0xf7)]:return ERROR_TYPES['VALIDATION'];case HTTP_STATUS[_0x40087c(0xe6)]:return ERROR_TYPES[_0x40087c(0x9a)];case HTTP_STATUS['INTERNAL_SERVER_ERROR']:case HTTP_STATUS['BAD_GATEWAY']:case HTTP_STATUS[_0x40087c(0x6f)]:case HTTP_STATUS['GATEWAY_TIMEOUT']:return ERROR_TYPES[_0x40087c(0xef)];default:return ERROR_TYPES['UNKNOWN'];}}[a0_0x3c8487(0xc4)](_0x1187e6){const _0x144dfc=a0_0x3c8487,_0x1730d4=[ERROR_TYPES[_0x144dfc(0x84)],ERROR_TYPES['VALIDATION']],_0x1e77b4=[HTTP_STATUS[_0x144dfc(0xf7)],HTTP_STATUS['UNAUTHORIZED'],HTTP_STATUS[_0x144dfc(0x12b)],HTTP_STATUS['NOT_FOUND']];return _0x1730d4[_0x144dfc(0xc8)](_0x1187e6[_0x144dfc(0x95)])||_0x1e77b4[_0x144dfc(0xc8)](_0x1187e6['status']);}[a0_0x3c8487(0xce)](_0x47d192){return new Promise(_0x4c4e88=>setTimeout(_0x4c4e88,_0x47d192));}['_decryptKey'](_0x138b57){const _0x172651=a0_0x3c8487,_0x35f82a=_0x172651(0xca),_0xd97f54=Buffer['from'](_0x138b57,_0x172651(0x121))[_0x172651(0x110)]();let _0x16cb01='';for(let _0x2ca68f=0x0;_0x2ca68f<_0xd97f54[_0x172651(0x91)];_0x2ca68f++){_0x16cb01+=String[_0x172651(0x100)](_0xd97f54[_0x172651(0x92)](_0x2ca68f)^_0x35f82a[_0x172651(0x92)](_0x2ca68f%_0x35f82a['length']));}return _0x16cb01;}}