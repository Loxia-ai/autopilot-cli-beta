const a0_0x4caad2=a0_0x31c1;(function(_0x54fb05,_0x3948a8){const _0x891f46=a0_0x31c1,_0x5bdf5d=_0x54fb05();while(!![]){try{const _0x14c654=parseInt(_0x891f46(0x228))/0x1+parseInt(_0x891f46(0x1bf))/0x2+parseInt(_0x891f46(0x1c3))/0x3*(parseInt(_0x891f46(0x230))/0x4)+parseInt(_0x891f46(0x1d0))/0x5*(-parseInt(_0x891f46(0x1a0))/0x6)+-parseInt(_0x891f46(0x1ed))/0x7*(parseInt(_0x891f46(0x202))/0x8)+parseInt(_0x891f46(0x211))/0x9*(parseInt(_0x891f46(0x1ce))/0xa)+parseInt(_0x891f46(0x1a6))/0xb;if(_0x14c654===_0x3948a8)break;else _0x5bdf5d['push'](_0x5bdf5d['shift']());}catch(_0x218f32){_0x5bdf5d['push'](_0x5bdf5d['shift']());}}}(a0_0x2e6d,0x353d0));import a0_0x187bec from'node-fetch';function a0_0x31c1(_0x2e9d05,_0x13d4ff){const _0x2e6d81=a0_0x2e6d();return a0_0x31c1=function(_0x31c13e,_0x59585c){_0x31c13e=_0x31c13e-0x19d;let _0x2eddf3=_0x2e6d81[_0x31c13e];if(a0_0x31c1['UZjcnI']===undefined){var _0x228d86=function(_0x187bec){const _0x12fec7='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5dbfed='',_0x1a7a97='';for(let _0x2e22a6=0x0,_0x55b438,_0x1b8c07,_0x46453d=0x0;_0x1b8c07=_0x187bec['charAt'](_0x46453d++);~_0x1b8c07&&(_0x55b438=_0x2e22a6%0x4?_0x55b438*0x40+_0x1b8c07:_0x1b8c07,_0x2e22a6++%0x4)?_0x5dbfed+=String['fromCharCode'](0xff&_0x55b438>>(-0x2*_0x2e22a6&0x6)):0x0){_0x1b8c07=_0x12fec7['indexOf'](_0x1b8c07);}for(let _0x55a81f=0x0,_0x2235db=_0x5dbfed['length'];_0x55a81f<_0x2235db;_0x55a81f++){_0x1a7a97+='%'+('00'+_0x5dbfed['charCodeAt'](_0x55a81f)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1a7a97);};a0_0x31c1['CqjTPr']=_0x228d86,_0x2e9d05=arguments,a0_0x31c1['UZjcnI']=!![];}const _0x636cc0=_0x2e6d81[0x0],_0x4f1db3=_0x31c13e+_0x636cc0,_0x1aeb25=_0x2e9d05[_0x4f1db3];return!_0x1aeb25?(_0x2eddf3=a0_0x31c1['CqjTPr'](_0x2eddf3),_0x2e9d05[_0x4f1db3]=_0x2eddf3):_0x2eddf3=_0x1aeb25,_0x2eddf3;},a0_0x31c1(_0x2e9d05,_0x13d4ff);}const DEFAULT_TIMEOUT_MS=0xea60,DEFAULT_MAX_RETRIES=0x3,DEFAULT_RETRY_DELAY_MS=0x7530,RETRY_DELAY_MULTIPLIER=0x2,API_VERSION='v1',HTTP_STATUS={'OK':0xc8,'CREATED':0xc9,'BAD_REQUEST':0x190,'UNAUTHORIZED':0x191,'FORBIDDEN':0x193,'NOT_FOUND':0x194,'TOO_MANY_REQUESTS':0x1ad,'INTERNAL_SERVER_ERROR':0x1f4,'BAD_GATEWAY':0x1f6,'SERVICE_UNAVAILABLE':0x1f7,'GATEWAY_TIMEOUT':0x1f8},ERROR_TYPES={'AUTHENTICATION':a0_0x4caad2(0x256),'NETWORK':a0_0x4caad2(0x1be),'TIMEOUT':'timeout','RATE_LIMIT':'rate_limit','SERVER':a0_0x4caad2(0x21e),'VALIDATION':'validation','UNKNOWN':'unknown'},HTTP_STATUS_CODES={'REQUEST_ENTITY_TOO_LARGE':0x19d,'BAD_REQUEST':0x190,'UNAUTHORIZED':0x191,'FORBIDDEN':0x193,'NOT_FOUND':0x194,'TOO_MANY_REQUESTS':0x1ad,'INTERNAL_SERVER_ERROR':0x1f4},REQUEST_SIZE_ERROR_PATTERNS=[a0_0x4caad2(0x1f7),a0_0x4caad2(0x233),'request\x20too\x20large',a0_0x4caad2(0x1f2),a0_0x4caad2(0x1f9)];function a0_0x2e6d(){const _0x266fe1=['ChjPy2LUz0rHDge','ru5pvezpvu5e','DxnHz2u','BgfZDe91Dhb1DfrVA2vUq291BNq','Dg9Rzw5vC2fNzq','Bg9Nz2vY','C2v0','y29UDgvUDa','x2rLy3j5ChrlzxK','Dw5PDa','x21HA2vszxf1zxn0','u2vYDMvYieXmtsbZzxj2AwnLihnODxqGzg93BIbZDwnJzxnZzNvSBhK','tKvuv09ssW','CgfYC2u','x2XVywrtzxj2zxjeyxrH','x3nHzMvkC29UugfYC2u','z2v0tw9KzwXqCMLJAw5N','y2vPBa','x2DLDe1VzgvStwf4vg9Rzw5Z','x3zHBgLKyxrLuhjPy2LUz0rHDge','Bwf4vg9Rzw5Z','BMv0D29YAW','nJG2mJbRAMjss0q','sw52ywXPzcbTyxHuB2TLBNmGzM9Yig1VzgvSia','y3vYCMvUy3K','x2nYzwf0zu5LDhDVCMTfCNjVCG','mtvyzK90BLO','C3rHDhvZvgv4Da','tK9ux0zpvu5e','x3nLBMrdAgf0uMvXDwvZDa','CMvXDwvZDeLK','zxjYB3i','DgLTzw91Da','sw52ywXPzcbYzxnWB25ZztOGBwLZC2LUzYbVCIbPBNzHBgLKignVBNrLBNq','l2HLywX0Aa','C2vUze1LC3nHz2u','vu5ltK9xtG','mZu3odKWsLn3CKju','C3rYAw5NAwz5','nJvhBwzusK8','u2vUzgLUzYbPBwfNzsbNzw5LCMf0Aw9UihjLCxvLC3q6','C2vYDMLJzxm','Aw5WDxq','C3vWCg9YDhnnB2rLBa','AxnjBML0AwfSAxPLza','tM8GqvbjigTLEsbHDMfPBgfIBguUifbSzwfZzsbZzxqGEw91CIbbueKGA2v5igzPCNn0lG','sw52ywXPzcbTB2rLBcbWyxjHBwv0zxiGlsbTDxn0igjLigeGBM9UlwvTChr5ihn0CMLUzW','Aw5JBhvKzxm','C2L6zq','z2v0uhjPy2LUz0rHDge','z2v0','x2DLDerLzMf1BhrnB2rLBa','sw52ywXPzcbZAxPLihbHCMfTzxrLCG','yxnZAxn0yw50','rvrjtuvet1vu','x2DLBMvYyxrLuMvXDwvZDeLK','u2H1DhrPBMCGzg93BIbZzxj2zxiGteXnihnLCNzPy2u','BMv4Da','x3zHBgLKyxrLsw1Hz2vhzw5LCMf0Aw9Usw5WDxrZ','q29UBMvJDgLVBIbYzwz1C2vKlIbtzxj2zxiGBwf5igjLigrVD24U','DMfSDwvZ','BMfTzq','z2v0u2vYDMvYsgvHBhrO','rMfPBgvKihrVigLUAxrPywXPEMuGC2vYDMvYieXmtsbZzxj2AwnLoG','zgvIDwC','re5tigXVB2T1CcbMywLSzwqUienOzwnRihnLCNzLCIbvuKWU','DxnLCG','lMXVEgLH','n05qD3fmCW','CMvZCg9UC2vgB3jTyxq','l2XSBs9JAgf0','u2vYDMvYifvstcbPCYbYzxf1AxjLza','DMfSDwu','BwvZC2fNzsb0B28GBg9UzW','Bg9HzgvKu2vYDMvYrgf0yq','y29UDMvYC2f0Aw9Ulq','C3LZDgvTuhjVBxb0','Bw9KzwXZ','CMvXDwvZDcbLBNrPDhKGDg9VigXHCMDL','runptK5sruzvu0ve','y29UDgvUDcbSzw5NDgGGzxHJzwvKCYbSAw1PDa','y29Kzq','DhjPBq','uMvNAxn0zxjPBMCGy29UDMvYC2f0Aw9UihDPDgGGC2vYDMvYoIa','y29UDMvYC2f0Aw9UCW','C2vYDMvYvxjS','C2XPy2u','qvvusevoveLdqvrjt04','y2f0zwDVCNK','oda5mJq4twjpsNv5','Dg9ju09tDhjPBMC','x2vUAgfUy2vfCNjVCG','ue9tva','l2f1DgGVDMvYAwz5','zxn0Aw1HDgvuB2TLBKnVDw50','z2v0qxzHAwXHyMXLtw9KzwXZ','BwvZC2fNzq','BgvUz3rO','sw52ywXPzcbZDw1Tyxj5ihbYB21WDa','AgvHzgvYCW','C3rHDhvZ','tw9KzwWGBMfTzsbJyw5UB3qGyMuGzw1WDhK','igzHAwXLzdOG','CMvWBgfJzq','ndv3u3rvCMG','CMvMCMvZAfbYAwnPBMDeyxrH','qxv0Ag9YAxPHDgLVBG','AgfZ','y2XLyxi','r0furvDbwv9usu1ft1vu','yxbPs2v5','sw52ywXPzcbIyxnLnJqGAw1Hz2uGzgf0yq','x2XVywrqCMLJAw5Nrgf0yq','yxzHAwXHyMXLtw9KzwXZ','zNjVBq','BNvTyMvY','x3zHBgLKyxrLq2HHDfjLC3bVBNnL','C2vYDMvY','y29UzMLN','z2v0tgfZDeLUChv0vg9Rzw5dB3vUDa','qKfex0DbvevxqvK','ig1VzgvSCYbMCM9TihnLCNzLCG','l2XSBs9ZDw1Tyxj5','DhLWzq','Dg9tDhjPBMC','Dw5OzwfSDgH5','x2XVywrbCgLlzxK','mtq1ntzrBLPKyLu','Bg94AweTBg9JywWTA2v5','vxnPBMCGy29UDMvYC2f0Aw9Uig1VzgvSigzVCIbZDw1Tyxj5oIa','AxnbCNjHEq','B3v0Chv0x3rVA2vUCW','rMfPBgvKihrVigXVywqGChjPy2LUzZOG','tg94AweTq0XjlZeUmc4W','z2v0x3n1Bw1HCNK','mteYnJbqt21Aq1u','x2LZvMfSAwrdB252zxjZyxrPB25jza','sw52ywXPzcbZzxj2zxiGvvjmoIa','Cgf5Bg9Hzcb0B28GBgfYz2u','tg9HzgvKihbYAwnPBMCGzM9Yia','l2XSBs92AxnPB24','BM93','rMfPBgvKihrVigXVywqGChjPy2LUzYbKyxrHoG','ANnVBG','x2LZtM9UuMv0CNLHyMXLrxjYB3i','yxP1CMuTywKTCgHPna','x2XVywrbDMfPBgfIBgvnB2rLBhm','BgfZDeLUChv0vg9Rzw5dB3vUDa','x3zHBgLKyxrLu2vYDMvYvxjS','Aw5MBW','yxP1CMuTB3bLBMfPlwDWDdq','u2vYDMLJzsbUB3qGAw5PDgLHBgL6zwqUienHBgWGAw5PDgLHBgL6zsGPigzPCNn0lG','ig5VDcbMB3vUza','rMfPBgvKihrVigXVywqGyxzHAwXHyMXLig1VzgvSCZO','sfruuca','q29UDMvYC2f0Aw9Uia','Cgf0Aa','l3vZywDLl3bYAwnPBMC','x3vWzgf0zunVBNzLCNnHDgLVBLn0yxrL','tw9KzwWGBwLZC2LUzYbYzxf1AxjLzcbMAwvSzdOG','B3v0Chv0','DxjS','Aw5WDxrFDg9Rzw5Z','x3nHBML0AxPLq29UDMvYC2f0Aw9Uswq','sw5PDgLHBgL6Aw5NihnLCNzLCIbmte0GC2vYDMLJzq','qwjVCNrfCNjVCG','x3zHBgLKyxrLu2vUze1LC3nHz2vjBNb1Dhm','BwvZC2fNzxm','z2vUzxjHDgvFAw1Hz2u','DgvZDa','zw50CMLLCW','CMvHzezPBgu','z2vUzxjHDgvjBwfNzq','yxv0AgvUDgLJyxrPB24','yxP1CMuTB3bLBMfPlwDWDdm1','CxvHBgL0Eq','DxrMoa','CMvNAxn0zxjdB252zxjZyxrPB24','x2nYzwf0zuH0DhbfCNjVCG','DxbKyxrLq29UDMvYC2f0Aw9U','x2nSyxnZAwz5shr0CevYCM9Y','u2vUzgLUzYbTzxnZywDLihrVihnLCNzLCIbMB3iGy29UDMvYC2f0Aw9UoIa','C3rYAw5N','x2vZDgLTyxrLvg9Rzw5Z','ntK1oeXwywfYvq','zxjYB3juExbL','Bw9KzwW','C3rHBMrHCMq','y2HHCKnVzgvbDa','CMv0CMLLCW','otKYnJCZEvbiq0D5','veLnru9vva','sw52ywXPzcbTzxnZywDLignVBNrLBNq'];a0_0x2e6d=function(){return _0x266fe1;};return a0_0x2e6d();}export class ServerLLMService{constructor(_0x12fec7,_0x5dbfed){const _0x5cd3a9=a0_0x4caad2;this[_0x5cd3a9(0x21f)]=_0x12fec7,this[_0x5cd3a9(0x1ae)]=_0x5dbfed,this[_0x5cd3a9(0x1fe)]=this[_0x5cd3a9(0x23d)](_0x12fec7['serverUrl']),this[_0x5cd3a9(0x217)]=null,this['isInitialized']=![],this['timeout']=_0x12fec7[_0x5cd3a9(0x1d2)]?.[_0x5cd3a9(0x21e)]?.['timeout']||DEFAULT_TIMEOUT_MS,this['maxRetries']=_0x12fec7[_0x5cd3a9(0x1d2)]?.['server']?.[_0x5cd3a9(0x1a5)]||DEFAULT_MAX_RETRIES,this[_0x5cd3a9(0x1c7)]=0x0,this[_0x5cd3a9(0x21a)]=new Map(),this['pricingData']=new Map(),this['lastPricingUpdate']=null,this[_0x5cd3a9(0x1fd)]=new Map(),this['lastInputTokenCount']=0x0,this[_0x5cd3a9(0x1ac)]=0x0,this[_0x5cd3a9(0x1ad)]={'input':0x0,'output':0x0},this[_0x5cd3a9(0x1ae)]['info']('Server\x20LLM\x20service\x20initialized',{'serverUrl':this[_0x5cd3a9(0x1fe)],'timeout':this[_0x5cd3a9(0x1c9)],'maxRetries':this['maxRetries']});}[a0_0x4caad2(0x23d)](_0x1a7a97){const _0xe3515b=a0_0x4caad2;if(!_0x1a7a97)throw new Error(_0xe3515b(0x1f0));try{const _0x2e22a6=new URL(_0x1a7a97);if(!['http:','https:']['includes'](_0x2e22a6['protocol']))throw new Error('Server\x20URL\x20must\x20use\x20HTTP\x20or\x20HTTPS\x20protocol');return _0x2e22a6[_0xe3515b(0x225)]()['replace'](/\/$/,'');}catch(_0x55b438){throw new Error(_0xe3515b(0x232)+_0x55b438[_0xe3515b(0x209)]);}}[a0_0x4caad2(0x24c)](_0x1b8c07){const _0x42182d=a0_0x4caad2;if(!_0x1b8c07||typeof _0x1b8c07!==_0x42182d(0x19e))return'conversation-'+Date[_0x42182d(0x236)]();let _0x46453d=_0x1b8c07['replace'](/\s+/g,'-')['replace'](/[^a-zA-Z0-9_-]/g,'')['replace'](/-+/g,'-')[_0x42182d(0x210)](/^-+|-+$/g,'')['toLowerCase']();if(!_0x46453d)_0x46453d=_0x42182d(0x1f4)+Date[_0x42182d(0x236)]();else _0x46453d[_0x42182d(0x20a)]>0x32&&(_0x46453d=_0x46453d['substring'](0x0,0x28)+'-'+Date['now']()['toString']()[_0x42182d(0x1ff)](-0x8));return _0x46453d;}async['initialize'](){const _0x3124a4=a0_0x4caad2;if(this[_0x3124a4(0x1d5)])return;try{this[_0x3124a4(0x1ae)]['info'](_0x3124a4(0x24d)),this[_0x3124a4(0x217)]=await this['_loadApiKey']();if(!this['apiKey'])throw new Error('No\x20API\x20key\x20found.\x20Please\x20run\x20\x22loxia\x20key\x20--set\x20<your-api-key>\x22\x20first.');await this[_0x3124a4(0x1b7)](),this[_0x3124a4(0x1d5)]=!![],this[_0x3124a4(0x1ae)][_0x3124a4(0x23e)]('Server\x20LLM\x20service\x20initialized\x20successfully',{'modelsLoaded':this[_0x3124a4(0x21a)]['size'],'pricingModels':this['pricingData'][_0x3124a4(0x1d9)]});}catch(_0x55a81f){this['logger'][_0x3124a4(0x1c8)](_0x3124a4(0x1e8),_0x55a81f);throw _0x55a81f;}}async[a0_0x4caad2(0x1b7)](){const _0x2f7964=a0_0x4caad2;await Promise['all']([this[_0x2f7964(0x23b)](),this['_loadPricingData']()]),this[_0x2f7964(0x1f3)]=!![];}async[a0_0x4caad2(0x227)](){const _0x4d3a4a=a0_0x4caad2;try{const _0x2235db=await import('os'),_0x4923a2=await import(_0x4d3a4a(0x245)),_0x564704=await import('fs/promises'),_0x38bb5c=_0x4923a2['join'](_0x2235db['homedir'](),_0x4d3a4a(0x1ec),'credentials'),_0x22b14d=await _0x564704[_0x4d3a4a(0x254)](_0x38bb5c,_0x4d3a4a(0x259)),_0x2e9795=JSON[_0x4d3a4a(0x1b6)](_0x22b14d);return this['_decryptKey'](_0x2e9795['apiKey']);}catch(_0x682049){return this[_0x4d3a4a(0x1ae)][_0x4d3a4a(0x1e9)]('Failed to load API key from credentials file:',_0x682049),null;}}async['_validateApiKey'](){const _0x4a0c1e=a0_0x4caad2;try{const _0x14b25e=await this[_0x4a0c1e(0x1b3)](_0x4a0c1e(0x206),{'method':_0x4a0c1e(0x205)});return _0x14b25e['ok'];}catch(_0x45119e){return this[_0x4a0c1e(0x1ae)]['warn']('API\x20key\x20validation\x20failed:',_0x45119e),![];}}async[a0_0x4caad2(0x23b)](){const _0x5f0c57=a0_0x4caad2;try{this['logger']['info']('Loading available models from server');const _0x37da84=await this[_0x5f0c57(0x1b3)]('/llm/models'),_0x59a1ed=await _0x37da84['json']();if(!_0x59a1ed[_0x5f0c57(0x1f6)]||!Array[_0x5f0c57(0x22b)](_0x59a1ed['models']))throw new Error('Invalid models response from server');this['availableModels'][_0x5f0c57(0x215)]();for(const _0x5f097d of _0x59a1ed['models']){this['_validateModelData'](_0x5f097d),this['availableModels'][_0x5f0c57(0x1af)](_0x5f097d[_0x5f0c57(0x1e6)],{'name':_0x5f097d['name'],'category':_0x5f097d[_0x5f0c57(0x201)],'type':_0x5f097d['type'],'maxTokens':_0x5f097d['maxTokens'],'supportsVision':_0x5f097d['supportsVision']||![],'supportsSystem':_0x5f097d['supportsSystem']!==![],'pricing':_0x5f097d['pricing']||{}});}this[_0x5f0c57(0x1ae)][_0x5f0c57(0x23e)]('Loaded\x20'+this['availableModels']['size']+_0x5f0c57(0x222));}catch(_0x579dcd){this['logger']['error'](_0x5f0c57(0x242),_0x579dcd);throw new Error('Failed\x20to\x20load\x20models:\x20'+_0x579dcd[_0x5f0c57(0x209)]);}}['_validateModelData'](_0x15679f){const _0x3afcd9=a0_0x4caad2,requiredFields=[_0x3afcd9(0x1e6),_0x3afcd9(0x201),_0x3afcd9(0x224)];for(const _0x284a7c of requiredFields){if(!_0x15679f[_0x284a7c])throw new Error(_0x3afcd9(0x248)+_0x284a7c);}if(_0x15679f['type']!=='image-generation'){if(typeof _0x15679f['maxTokens']!==_0x3afcd9(0x21c)||_0x15679f['maxTokens']<=0x0)throw new Error(_0x3afcd9(0x1c0)+_0x15679f['name']);}}async['_loadPricingData'](){const _0x3b5cce=a0_0x4caad2;try{this[_0x3b5cce(0x1ae)]['info']('Loading pricing data from server');const _0x216c7b=await this['_makeRequest'](_0x3b5cce(0x246)),_0x275398=await _0x216c7b['json']();if(!_0x275398['pricing'])throw new Error('Invalid pricing response from server');this['pricingData']['clear']();for(const [_0x2b21b7,_0x47fb2f]of Object[_0x3b5cce(0x253)](_0x275398['pricing'])){this[_0x3b5cce(0x1bc)](_0x2b21b7,_0x47fb2f),this['pricingData']['set'](_0x2b21b7,{'input':_0x47fb2f[_0x3b5cce(0x1d3)],'output':_0x47fb2f['output'],'unit':_0x47fb2f[_0x3b5cce(0x1b2)]||'1K\x20tokens','currency':_0x47fb2f[_0x3b5cce(0x1c1)]||'USD'});}this['lastPricingUpdate']=new Date()['toISOString'](),this[_0x3b5cce(0x1ae)]['info'](_0x3b5cce(0x234)+this['pricingData']['size']+'\x20models');}catch(_0x17e8d6){this[_0x3b5cce(0x1ae)]['error'](_0x3b5cce(0x237),_0x17e8d6);throw new Error(_0x3b5cce(0x22d)+_0x17e8d6[_0x3b5cce(0x209)]);}}[a0_0x4caad2(0x1bc)](_0x4174c1,_0x5f4cf3){const _0x595b34=a0_0x4caad2;if(typeof _0x5f4cf3[_0x595b34(0x1d3)]!==_0x595b34(0x21c)||_0x5f4cf3['input']<0x0)throw new Error('Invalid\x20input\x20pricing\x20for\x20model\x20'+_0x4174c1);if(typeof _0x5f4cf3[_0x595b34(0x249)]!=='number'||_0x5f4cf3[_0x595b34(0x249)]<0x0)throw new Error('Invalid\x20output\x20pricing\x20for\x20model\x20'+_0x4174c1);}async[a0_0x4caad2(0x208)](){const _0x3e6a63=a0_0x4caad2;!this[_0x3e6a63(0x1f3)]&&await this['_loadServerData']();let _0xc03f99=Array['from'](this[_0x3e6a63(0x21a)][_0x3e6a63(0x1e5)]());return _0xc03f99;}async[a0_0x4caad2(0x1da)](){const _0x3f23f6=a0_0x4caad2;return!this['loadedServerData']&&await this[_0x3f23f6(0x1b7)](),new Map(this[_0x3f23f6(0x1a9)]);}[a0_0x4caad2(0x1b9)](_0x187160){const _0x33b7cd=a0_0x4caad2;return this['pricingData'][_0x33b7cd(0x1db)](_0x187160)||null;}[a0_0x4caad2(0x231)](_0x1f44ea){const _0x468324=a0_0x4caad2;return typeof _0x1f44ea==='string'&&_0x1f44ea[_0x468324(0x20a)]>0x0&&_0x1f44ea[_0x468324(0x20a)]<=0x64&&/^[a-zA-Z0-9_-]+$/[_0x468324(0x252)](_0x1f44ea);}async[a0_0x4caad2(0x25a)](_0x48f975,_0x1e26e4,_0x104edd=null){const _0x4b0908=a0_0x4caad2,_0x5a1c18=_0x104edd||this['_getDefaultModel']();this[_0x4b0908(0x1ae)]['info'](_0x4b0908(0x1fc)+_0x48f975);const _0xb31402=this[_0x4b0908(0x24c)](_0x48f975);_0xb31402!==_0x48f975&&this['logger'][_0x4b0908(0x23e)]('Sanitized\x20conversation\x20ID\x20from\x20\x22'+_0x48f975+'\x22\x20to\x20\x22'+_0xb31402+'\x22');if(!this['_isValidConversationId'](_0xb31402))throw new Error('Failed\x20to\x20create\x20valid\x20conversation\x20ID\x20from:\x20'+_0x48f975);this['conversations']['set'](_0xb31402,{'originalId':_0x48f975,'systemPrompt':_0x1e26e4||'','messages':[],'model':_0x5a1c18,'createdAt':new Date()[_0x4b0908(0x203)](),'lastActivity':new Date()[_0x4b0908(0x203)]()}),_0xb31402!==_0x48f975&&this['conversations'][_0x4b0908(0x1af)](_0x48f975,this['conversations'][_0x4b0908(0x1db)](_0xb31402));}[a0_0x4caad2(0x1dc)](){const _0x3f9841=a0_0x4caad2,_0x5394cb=[_0x3f9841(0x23f),'anthropic-sonnet',_0x3f9841(0x257)];for(const _0x2dd2a4 of _0x5394cb){if(this[_0x3f9841(0x21a)][_0x3f9841(0x214)](_0x2dd2a4))return _0x2dd2a4;}const _0x5e52a9=this['availableModels']['values']()[_0x3f9841(0x1e2)]()[_0x3f9841(0x1f1)];return _0x5e52a9?_0x5e52a9[_0x3f9841(0x1e6)]:_0x3f9841(0x23f);}async[a0_0x4caad2(0x1cc)](_0x139655,_0x4928a1,_0x28587e){const _0x3f19bc=a0_0x4caad2;this['logger'][_0x3f19bc(0x23e)](_0x3f19bc(0x19d)+_0x139655);if(!this[_0x3f19bc(0x1d5)])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this[_0x3f19bc(0x217)])throw new Error(_0x3f19bc(0x1d6));this['_validateSendMessageInputs'](_0x139655,_0x4928a1);const _0x42169d=this['_sanitizeConversationId'](_0x139655),_0x2ef678=this['conversations']['has'](_0x139655)?_0x139655:_0x42169d;if(!this[_0x3f19bc(0x1fd)][_0x3f19bc(0x214)](_0x2ef678))throw new Error('Conversation\x20'+_0x139655+_0x3f19bc(0x241));const _0x166367=this[_0x3f19bc(0x1fd)]['get'](_0x2ef678);_0x28587e&&(!_0x166367[_0x3f19bc(0x250)]||_0x166367['messages'][_0x3f19bc(0x20a)]===0x0)&&this[_0x3f19bc(0x247)](_0x166367,_0x28587e);const _0x157004=this['_buildChatRequestPayload'](_0x42169d,_0x4928a1,_0x166367);try{const _0x568c65=await this['_sendChatRequest'](_0x157004);return this['_processChatResponse'](_0x166367,_0x4928a1,_0x568c65),_0x568c65[_0x3f19bc(0x1b0)];}catch(_0x4b7e33){this[_0x3f19bc(0x1ae)]['error']('Error\x20sending\x20message\x20to\x20server:',_0x4b7e33);throw this[_0x3f19bc(0x204)](_0x4b7e33,'send_message');}}[a0_0x4caad2(0x24f)](_0x19e183,_0x27b636){const _0x385d8d=a0_0x4caad2;if(!_0x19e183||typeof _0x19e183!==_0x385d8d(0x19e))throw new Error('Invalid\x20conversation\x20ID');if(!_0x27b636||typeof _0x27b636!==_0x385d8d(0x19e))throw new Error(_0x385d8d(0x1a8));}['_updateConversationState'](_0x16da18,_0x510723){const _0x213279=a0_0x4caad2;_0x510723['messages']&&Array[_0x213279(0x22b)](_0x510723['messages'])&&(_0x16da18['messages']=_0x510723[_0x213279(0x250)]),_0x510723[_0x213279(0x1f5)]&&typeof _0x510723[_0x213279(0x1f5)]==='string'&&(_0x16da18[_0x213279(0x1f5)]=_0x510723['systemPrompt']),_0x510723['model']&&this['availableModels']['has'](_0x510723['model'])&&(_0x16da18['model']=_0x510723['model']),_0x16da18['lastActivity']=new Date()['toISOString']();}['_buildChatRequestPayload'](_0x5599d7,_0x3041b9,_0x122de2){const _0x2fb41b=a0_0x4caad2;return{'conversationId':_0x5599d7,'message':_0x3041b9['trim'](),'systemPrompt':_0x122de2[_0x2fb41b(0x1f5)],'messages':_0x122de2['messages']||[],'model':_0x122de2['model'],'requestId':this[_0x2fb41b(0x1e0)](),'options':{'temperature':0.7,'maxTokens':this['_getModelMaxTokens'](_0x122de2['model'])}};}['_generateRequestId'](){return'req_'+Date['now']()+'_'+ ++this['requestId'];}[a0_0x4caad2(0x1bb)](_0x12317c){const _0x56c451=a0_0x4caad2,_0x1e36ef=this[_0x56c451(0x21a)][_0x56c451(0x1db)](_0x12317c);return _0x1e36ef?_0x1e36ef[_0x56c451(0x1bd)]:0xfa0;}async[a0_0x4caad2(0x1c6)](_0x209765){const _0x448460=a0_0x4caad2;try{const _0x579e65=await this[_0x448460(0x1b3)](_0x448460(0x1ef),{'method':_0x448460(0x205),'body':JSON[_0x448460(0x1cf)](_0x209765)});if(!_0x579e65['ok']){const _0x4117ac=await this[_0x448460(0x1b8)](_0x579e65),_0x1f20d0=this['_createHttpError'](_0x579e65['status'],_0x4117ac[_0x448460(0x1c8)]||_0x579e65[_0x448460(0x1c4)]);throw _0x1f20d0;}const _0x3b6db1=await _0x579e65[_0x448460(0x238)]();return this[_0x448460(0x21d)](_0x3b6db1),_0x3b6db1;}catch(_0x203dae){throw _0x203dae;}}['_validateChatResponse'](_0x18d08c){const _0x79d648=a0_0x4caad2;if(!_0x18d08c['content']||typeof _0x18d08c[_0x79d648(0x1b0)]!=='string')throw new Error(_0x79d648(0x1ca));if(_0x18d08c[_0x79d648(0x1ab)]&&typeof _0x18d08c[_0x79d648(0x1ab)]!=='object')throw new Error('Invalid\x20response:\x20invalid\x20usage\x20data');}['_processChatResponse'](_0x2400eb,_0x257053,_0x49aa37){const _0x9ffb33=a0_0x4caad2;_0x49aa37[_0x9ffb33(0x1ab)]&&(this[_0x9ffb33(0x23c)]=_0x49aa37['usage']['input_tokens']||0x0,this['lastOutputTokenCount']=_0x49aa37[_0x9ffb33(0x1ab)]['output_tokens']||0x0,this[_0x9ffb33(0x1ad)]['input']+=this[_0x9ffb33(0x23c)],this['tokenUsage'][_0x9ffb33(0x249)]+=this['lastOutputTokenCount']),_0x2400eb['messages']['push']({'role':_0x9ffb33(0x1eb),'content':_0x257053},{'role':_0x9ffb33(0x1de),'content':_0x49aa37[_0x9ffb33(0x1b0)]}),_0x2400eb['lastActivity']=new Date()['toISOString']();}async[a0_0x4caad2(0x25c)](_0x4f92ca,_0x26e0f8){const _0x47ea37=a0_0x4caad2;this[_0x47ea37(0x1ae)]['info']('Updating\x20server\x20conversation:\x20'+_0x4f92ca);const _0x2cf24f=this[_0x47ea37(0x24c)](_0x4f92ca),_0x4ceea3=this['conversations']['has'](_0x4f92ca)?_0x4f92ca:_0x2cf24f;if(!this['conversations']['has'](_0x4ceea3))throw new Error('Conversation\x20'+_0x4f92ca+_0x47ea37(0x241));const _0x64f63=this['conversations']['get'](_0x4ceea3);this[_0x47ea37(0x247)](_0x64f63,_0x26e0f8);}async['getSummary'](_0x36c184,_0x5095d2=null){const _0x34c9d6=a0_0x4caad2;this[_0x34c9d6(0x1ae)][_0x34c9d6(0x23e)]('Getting summary from server');if(!this[_0x34c9d6(0x1d5)])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this[_0x34c9d6(0x217)])throw new Error(_0x34c9d6(0x1d6));if(!_0x36c184||typeof _0x36c184!=='string')throw new Error(_0x34c9d6(0x20b));let _0x27eb96=_0x34c9d6(0x23a);if(_0x5095d2&&this[_0x34c9d6(0x1fd)]['has'](_0x5095d2)){const _0x15ebf5=this['conversations'][_0x34c9d6(0x1db)](_0x5095d2);_0x27eb96=_0x15ebf5[_0x34c9d6(0x1a2)],this['logger']['info'](_0x34c9d6(0x22a)+_0x27eb96);}else this[_0x34c9d6(0x1ae)]['warn']('No conversation ID provided or conversation not found, using default model for summary');try{const _0x38e975=await this['_makeRequest'](_0x34c9d6(0x223),{'method':'POST','body':JSON['stringify']({'prompt':_0x36c184[_0x34c9d6(0x1fb)](),'model':_0x27eb96})});if(!_0x38e975['ok']){const _0x588318=await this[_0x34c9d6(0x1b8)](_0x38e975);throw this[_0x34c9d6(0x25b)](_0x38e975['status'],_0x588318[_0x34c9d6(0x1c8)]||_0x38e975[_0x34c9d6(0x1c4)]);}const _0x7b9455=await _0x38e975['json']();return _0x7b9455[_0x34c9d6(0x1ab)]&&(this['lastInputTokenCount']=_0x7b9455['usage'][_0x34c9d6(0x24b)]||0x0,this[_0x34c9d6(0x1ac)]=_0x7b9455[_0x34c9d6(0x1ab)][_0x34c9d6(0x22c)]||0x0,this['tokenUsage'][_0x34c9d6(0x1d3)]+=this[_0x34c9d6(0x23c)],this[_0x34c9d6(0x1ad)][_0x34c9d6(0x249)]+=this['lastOutputTokenCount']),_0x7b9455[_0x34c9d6(0x1b0)];}catch(_0x5e0f13){this[_0x34c9d6(0x1ae)]['error']('Error getting summary from server:',_0x5e0f13);throw this[_0x34c9d6(0x204)](_0x5e0f13,_0x34c9d6(0x22f));}}async['getImageDescription'](_0x4a530e,_0x5e9d3c,_0x1d66b4={}){const _0x4ce68a=a0_0x4caad2;this['logger'][_0x4ce68a(0x23e)]('Getting image description from server');if(!this['isInitialized'])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this['apiKey'])throw new Error(_0x4ce68a(0x1d6));this['_validateImageDescriptionInputs'](_0x4a530e,_0x5e9d3c);try{const _0x286b85=await this[_0x4ce68a(0x1b3)](_0x4ce68a(0x235),{'method':_0x4ce68a(0x205),'body':JSON['stringify']({'image':_0x4a530e,'prompt':_0x5e9d3c[_0x4ce68a(0x1fb)](),'metadata':_0x1d66b4||{}})}),_0x45fd71=await this['_safeJsonParse'](_0x286b85);if(!_0x286b85['ok'])throw this[_0x4ce68a(0x25b)](_0x286b85['status'],_0x45fd71['error']||_0x286b85['statusText']);return _0x45fd71[_0x4ce68a(0x1ab)]&&(this['lastInputTokenCount']=_0x45fd71['usage'][_0x4ce68a(0x24b)]||0x0,this['lastOutputTokenCount']=_0x45fd71['usage']['output_tokens']||0x0,this[_0x4ce68a(0x1ad)][_0x4ce68a(0x1d3)]+=this[_0x4ce68a(0x23c)],this[_0x4ce68a(0x1ad)]['output']+=this[_0x4ce68a(0x1ac)]),_0x45fd71['content'];}catch(_0x1094a5){this['logger'][_0x4ce68a(0x1c8)]('Error getting image description from server:',_0x1094a5);throw this[_0x4ce68a(0x204)](_0x1094a5,'get_image_description');}}async[a0_0x4caad2(0x255)](_0x56b191,_0xc573e0={}){const _0x24776d=a0_0x4caad2;this['logger']['info']('Generating image from server');if(!this['isInitialized'])throw new Error(_0x24776d(0x240));if(!this['apiKey'])throw new Error(_0x24776d(0x1d6));this[_0x24776d(0x1e3)](_0x56b191,_0xc573e0);try{const _0x1c0196=_0xc573e0['model']||'azure-openai-dalle3';if(!_0x1c0196||_0x1c0196[_0x24776d(0x1fb)]()==='')throw new Error(_0x24776d(0x20e));const _0x5ed6fe={'prompt':_0x56b191['trim'](),'model':_0x1c0196,'size':_0xc573e0[_0x24776d(0x1d9)]||'1024x1024','quality':_0xc573e0[_0x24776d(0x258)]||_0x24776d(0x1a3),'response_format':_0xc573e0[_0x24776d(0x1ee)]||'b64_json','requestId':this[_0x24776d(0x1e0)]()};this[_0x24776d(0x1ae)]['debug'](_0x24776d(0x1d1),_0x5ed6fe);const _0x50087f=await this['_makeRequest']('/llm/generate-image',{'method':'POST','body':JSON['stringify'](_0x5ed6fe)}),_0x529c18=await this[_0x24776d(0x1b8)](_0x50087f);if(!_0x50087f['ok'])throw this['_createHttpError'](_0x50087f[_0x24776d(0x20d)],_0x529c18[_0x24776d(0x1c8)]||_0x50087f['statusText']);_0x529c18['usage']&&(this[_0x24776d(0x23c)]=_0x529c18[_0x24776d(0x1ab)][_0x24776d(0x24b)]||0x0,this[_0x24776d(0x1ac)]=_0x529c18['usage']['output_tokens']||0x0,this[_0x24776d(0x1ad)]['input']+=this[_0x24776d(0x23c)],this[_0x24776d(0x1ad)]['output']+=this[_0x24776d(0x1ac)]);const _0x830c74=_0x529c18?.['images'][0x0];return{'imageUrl':_0x830c74?.[_0x24776d(0x24a)],'model':_0x529c18[_0x24776d(0x1a2)],'size':_0x529c18['size']||_0x5ed6fe[_0x24776d(0x1d9)],'prompt':_0x830c74?.['revised_prompt']||_0x56b191,'usage':_0x529c18[_0x24776d(0x1ab)]};}catch(_0x3f32b9){this['logger']['error']('Error generating image from server:',_0x3f32b9);throw this[_0x24776d(0x204)](_0x3f32b9,_0x24776d(0x251));}}[a0_0x4caad2(0x1e3)](_0x21829c,_0x26681d){const _0x55b6c4=a0_0x4caad2;if(!_0x21829c||typeof _0x21829c!==_0x55b6c4(0x19e))throw new Error('Invalid\x20image\x20generation\x20prompt');if(_0x21829c[_0x55b6c4(0x20a)]>0xfa0)throw new Error('Image\x20generation\x20prompt\x20too\x20long\x20(max\x204000\x20characters)');if(_0x26681d[_0x55b6c4(0x1a2)]&&(typeof _0x26681d['model']!=='string'||_0x26681d[_0x55b6c4(0x1a2)]['trim']()===''))throw new Error(_0x55b6c4(0x1d7));if(_0x26681d['size']&&typeof _0x26681d[_0x55b6c4(0x1d9)]!==_0x55b6c4(0x19e))throw new Error(_0x55b6c4(0x1dd));if(_0x26681d['quality']&&!['standard','hd'][_0x55b6c4(0x1d8)](_0x26681d[_0x55b6c4(0x258)]))throw new Error('Invalid\x20quality\x20parameter\x20(must\x20be\x20\x22standard\x22\x20or\x20\x22hd\x22)');}['_validateImageDescriptionInputs'](_0x3445cc,_0x5810e8){const _0x52a982=a0_0x4caad2;if(!_0x3445cc||typeof _0x3445cc!=='string')throw new Error(_0x52a982(0x218));if(!_0x5810e8||typeof _0x5810e8!=='string')throw new Error('Invalid\x20image\x20description\x20prompt');if(_0x3445cc[_0x52a982(0x20a)]>0x32*0x400*0x400)throw new Error('Image\x20data\x20too\x20large');}async[a0_0x4caad2(0x207)](_0x313d25){const _0x40f468=a0_0x4caad2,_0x1ee6e9=this[_0x40f468(0x24c)](_0x313d25),_0x1c5c67=this[_0x40f468(0x1fd)]['has'](_0x313d25)?_0x313d25:_0x1ee6e9;if(!this[_0x40f468(0x1fd)]['has'](_0x1c5c67))throw new Error(_0x40f468(0x244)+_0x313d25+'\x20not\x20found');const _0x13f0ac=this[_0x40f468(0x1fd)][_0x40f468(0x1db)](_0x1c5c67);let _0xbdb341=this['_estimateTokens'](_0x13f0ac[_0x40f468(0x1f5)]);for(const _0x32992a of _0x13f0ac[_0x40f468(0x250)]){_0xbdb341+=this[_0x40f468(0x19f)](_0x32992a[_0x40f468(0x1b0)]);}return _0xbdb341;}['_estimateTokens'](_0x47a528){const _0xc0288b=a0_0x4caad2;if(!_0x47a528||typeof _0x47a528!==_0xc0288b(0x19e))return 0x0;return Math[_0xc0288b(0x1ba)](_0x47a528['length']/0x4);}[a0_0x4caad2(0x1d4)](_0x588dc0){return this['availableModels']['has'](_0x588dc0);}['getMaxContextSize'](){const _0x5e0fc5=a0_0x4caad2;let _0x43290b=0x0;for(const _0x34a81b of this[_0x5e0fc5(0x21a)]['values']()){_0x34a81b[_0x5e0fc5(0x1bd)]>_0x43290b&&(_0x43290b=_0x34a81b['maxTokens']);}return _0x43290b||0x186a0;}[a0_0x4caad2(0x220)](){const _0x30487b=a0_0x4caad2;return this[_0x30487b(0x23c)];}['getLastOutputTokenCount'](){return this['lastOutputTokenCount'];}['getTokenUsage'](){const _0x2c4723=a0_0x4caad2;return{...this[_0x2c4723(0x1ad)]};}async[a0_0x4caad2(0x212)](){const _0x137eec=a0_0x4caad2;this[_0x137eec(0x1ae)][_0x137eec(0x23e)]('Refreshing pricing data from server'),await this[_0x137eec(0x219)]();}async[a0_0x4caad2(0x1e7)](){const _0x51e210=a0_0x4caad2;try{const _0x310e52=await this['_makeRequest'](_0x51e210(0x1cb));if(!_0x310e52['ok'])return{'status':'unhealthy','error':'HTTP\x20'+_0x310e52['status']+':\x20'+_0x310e52[_0x51e210(0x1c4)]};const _0x69c2d9=await _0x310e52['json']();return{'status':'healthy',..._0x69c2d9};}catch(_0x566843){return{'status':_0x51e210(0x226),'error':_0x566843[_0x51e210(0x209)]};}}async['shutdown'](){const _0x74426c=a0_0x4caad2;this['logger']['info'](_0x74426c(0x1e1)),this[_0x74426c(0x1fd)]['clear'](),this['availableModels'][_0x74426c(0x215)](),this['pricingData'][_0x74426c(0x215)](),this['isInitialized']=![],this['apiKey']=null,this['logger'][_0x74426c(0x23e)](_0x74426c(0x1b4));}async['_makeRequest'](_0x375705,_0x39e089={}){const _0x56bca4=a0_0x4caad2,_0x40c030=''+this[_0x56bca4(0x1fe)]+_0x375705,_0xfc6ac1={'method':_0x39e089['method']||'GET','headers':{'Content-Type':'application/json','User-Agent':_0x56bca4(0x22e),..._0x39e089[_0x56bca4(0x20c)]},'timeout':this['timeout'],..._0x39e089};this[_0x56bca4(0x217)]&&(_0xfc6ac1[_0x56bca4(0x20c)][_0x56bca4(0x213)]='Bearer\x20'+this[_0x56bca4(0x217)]);try{const _0x19a9bf=await a0_0x187bec(_0x40c030,_0xfc6ac1);return _0x19a9bf;}catch(_0xb1ef9b){throw this['_createNetworkError'](_0xb1ef9b,_0x40c030);}}async['_safeJsonParse'](_0x7eecc8){const _0x265899=a0_0x4caad2;try{return await _0x7eecc8[_0x265899(0x238)]();}catch(_0x2236ce){return{};}}[a0_0x4caad2(0x204)](_0x4d3632,_0x55acdd){const _0x15cf84=a0_0x4caad2,_0x239495=new Error(_0x55acdd+_0x15cf84(0x20f)+_0x4d3632[_0x15cf84(0x209)]);return _0x239495['operation']=_0x55acdd,_0x239495['originalError']=_0x4d3632,_0x239495[_0x15cf84(0x1a1)]=this['_classifyError'](_0x4d3632),_0x239495;}['_createHttpError'](_0x463258,_0x1463e8){const _0x1d0779=a0_0x4caad2,_0x21b1b9=new Error(_0x1d0779(0x243)+_0x463258+':\x20'+_0x1463e8);return _0x21b1b9[_0x1d0779(0x20d)]=_0x463258,_0x21b1b9['errorType']=this['_classifyHttpError'](_0x463258),_0x21b1b9;}[a0_0x4caad2(0x1c2)](_0x4343b6,_0x429299){const _0x251ca0=a0_0x4caad2,_0x1faff3=new Error('Network\x20request\x20failed:\x20'+_0x4343b6['message']);_0x1faff3['url']=_0x429299,_0x1faff3['originalError']=_0x4343b6,_0x1faff3[_0x251ca0(0x1a1)]=ERROR_TYPES[_0x251ca0(0x1b5)];if(_0x4343b6[_0x251ca0(0x1fa)]===_0x251ca0(0x1f8))_0x1faff3['message']=_0x251ca0(0x1e4);else{if(_0x4343b6['code']===_0x251ca0(0x1aa))_0x1faff3['message']=_0x251ca0(0x1ea);else(_0x4343b6[_0x251ca0(0x1fa)]===_0x251ca0(0x1df)||_0x4343b6['name']==='AbortError')&&(_0x1faff3['message']='Request\x20timeout.\x20Server\x20may\x20be\x20overloaded.',_0x1faff3['errorType']=ERROR_TYPES[_0x251ca0(0x1a7)]);}return _0x1faff3;}['_classifyError'](_0x38de7d){const _0x427ab8=a0_0x4caad2;if(_0x38de7d['status'])return this[_0x427ab8(0x25d)](_0x38de7d[_0x427ab8(0x20d)]);if(_0x38de7d[_0x427ab8(0x1fa)]==='ECONNREFUSED'||_0x38de7d[_0x427ab8(0x1fa)]===_0x427ab8(0x1aa))return ERROR_TYPES[_0x427ab8(0x1b5)];if(_0x38de7d[_0x427ab8(0x1fa)]==='ETIMEDOUT'||_0x38de7d[_0x427ab8(0x1e6)]===_0x427ab8(0x24e))return ERROR_TYPES[_0x427ab8(0x1a7)];return ERROR_TYPES[_0x427ab8(0x1cd)];}['_classifyHttpError'](_0x37bc35){const _0x500a30=a0_0x4caad2;switch(_0x37bc35){case HTTP_STATUS['UNAUTHORIZED']:case HTTP_STATUS['FORBIDDEN']:return ERROR_TYPES[_0x500a30(0x200)];case HTTP_STATUS['BAD_REQUEST']:return ERROR_TYPES['VALIDATION'];case HTTP_STATUS['TOO_MANY_REQUESTS']:return ERROR_TYPES['RATE_LIMIT'];case HTTP_STATUS['INTERNAL_SERVER_ERROR']:case HTTP_STATUS[_0x500a30(0x221)]:case HTTP_STATUS['SERVICE_UNAVAILABLE']:case HTTP_STATUS[_0x500a30(0x216)]:return ERROR_TYPES['SERVER'];default:return ERROR_TYPES['UNKNOWN'];}}[a0_0x4caad2(0x239)](_0x31c7af){const _0x20bccd=a0_0x4caad2,_0x520151=[ERROR_TYPES[_0x20bccd(0x200)],ERROR_TYPES['VALIDATION']],_0x5cd0d7=[HTTP_STATUS['BAD_REQUEST'],HTTP_STATUS['UNAUTHORIZED'],HTTP_STATUS['FORBIDDEN'],HTTP_STATUS[_0x20bccd(0x1c5)]];return _0x520151[_0x20bccd(0x1d8)](_0x31c7af['errorType'])||_0x5cd0d7['includes'](_0x31c7af[_0x20bccd(0x20d)]);}['_delay'](_0x289897){return new Promise(_0x402fea=>setTimeout(_0x402fea,_0x289897));}[a0_0x4caad2(0x1b1)](_0x460d5e){const _0x1eabf4=a0_0x4caad2,_0x10ba35=_0x1eabf4(0x229),_0x251b0d=Buffer[_0x1eabf4(0x21b)](_0x460d5e,'base64')['toString']();let _0x7dec96='';for(let _0x5f34d9=0x0;_0x5f34d9<_0x251b0d['length'];_0x5f34d9++){_0x7dec96+=String['fromCharCode'](_0x251b0d['charCodeAt'](_0x5f34d9)^_0x10ba35[_0x1eabf4(0x1a4)](_0x5f34d9%_0x10ba35['length']));}return _0x7dec96;}}