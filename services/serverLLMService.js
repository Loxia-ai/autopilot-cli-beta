const a0_0x4b7bf5=a0_0x4a3f;(function(_0x20e4aa,_0x4c37ec){const _0x2e9e61=a0_0x4a3f,_0x4431e8=_0x20e4aa();while(!![]){try{const _0x73169f=parseInt(_0x2e9e61(0x1ab))/0x1*(parseInt(_0x2e9e61(0x174))/0x2)+-parseInt(_0x2e9e61(0x1b7))/0x3*(parseInt(_0x2e9e61(0x225))/0x4)+-parseInt(_0x2e9e61(0x1d6))/0x5+parseInt(_0x2e9e61(0x1d0))/0x6*(-parseInt(_0x2e9e61(0x19e))/0x7)+-parseInt(_0x2e9e61(0x1de))/0x8+-parseInt(_0x2e9e61(0x1e4))/0x9+parseInt(_0x2e9e61(0x1c1))/0xa;if(_0x73169f===_0x4c37ec)break;else _0x4431e8['push'](_0x4431e8['shift']());}catch(_0x52a751){_0x4431e8['push'](_0x4431e8['shift']());}}}(a0_0x4339,0x7d116));import a0_0x2b0c16 from'node-fetch';const DEFAULT_TIMEOUT_MS=0xea60,DEFAULT_MAX_RETRIES=0x3,DEFAULT_RETRY_DELAY_MS=0x7530,RETRY_DELAY_MULTIPLIER=0x2,API_VERSION='v1',HTTP_STATUS={'OK':0xc8,'CREATED':0xc9,'BAD_REQUEST':0x190,'UNAUTHORIZED':0x191,'FORBIDDEN':0x193,'NOT_FOUND':0x194,'TOO_MANY_REQUESTS':0x1ad,'INTERNAL_SERVER_ERROR':0x1f4,'BAD_GATEWAY':0x1f6,'SERVICE_UNAVAILABLE':0x1f7,'GATEWAY_TIMEOUT':0x1f8},ERROR_TYPES={'AUTHENTICATION':a0_0x4b7bf5(0x182),'NETWORK':a0_0x4b7bf5(0x17d),'TIMEOUT':a0_0x4b7bf5(0x1fa),'RATE_LIMIT':'rate_limit','SERVER':'server','VALIDATION':a0_0x4b7bf5(0x1c0),'UNKNOWN':'unknown'},HTTP_STATUS_CODES={'REQUEST_ENTITY_TOO_LARGE':0x19d,'BAD_REQUEST':0x190,'UNAUTHORIZED':0x191,'FORBIDDEN':0x193,'NOT_FOUND':0x194,'TOO_MANY_REQUESTS':0x1ad,'INTERNAL_SERVER_ERROR':0x1f4},REQUEST_SIZE_ERROR_PATTERNS=['request\x20entity\x20too\x20large','payload\x20too\x20large',a0_0x4b7bf5(0x176),'message\x20too\x20long',a0_0x4b7bf5(0x1e8)];function a0_0x4a3f(_0xed1b64,_0x37dce8){const _0x433968=a0_0x4339();return a0_0x4a3f=function(_0x4a3fc7,_0x1f2678){_0x4a3fc7=_0x4a3fc7-0x16b;let _0x106778=_0x433968[_0x4a3fc7];if(a0_0x4a3f['ECjGrw']===undefined){var _0x539873=function(_0x2b0c16){const _0x5afe6e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x48744a='',_0x46223d='';for(let _0x161d89=0x0,_0x235831,_0x12b09a,_0x56f4ae=0x0;_0x12b09a=_0x2b0c16['charAt'](_0x56f4ae++);~_0x12b09a&&(_0x235831=_0x161d89%0x4?_0x235831*0x40+_0x12b09a:_0x12b09a,_0x161d89++%0x4)?_0x48744a+=String['fromCharCode'](0xff&_0x235831>>(-0x2*_0x161d89&0x6)):0x0){_0x12b09a=_0x5afe6e['indexOf'](_0x12b09a);}for(let _0x4740fc=0x0,_0x3270ef=_0x48744a['length'];_0x4740fc<_0x3270ef;_0x4740fc++){_0x46223d+='%'+('00'+_0x48744a['charCodeAt'](_0x4740fc)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x46223d);};a0_0x4a3f['CXNBkK']=_0x539873,_0xed1b64=arguments,a0_0x4a3f['ECjGrw']=!![];}const _0x52309a=_0x433968[0x0],_0x305ada=_0x4a3fc7+_0x52309a,_0x4d9349=_0xed1b64[_0x305ada];return!_0x4d9349?(_0x106778=a0_0x4a3f['CXNBkK'](_0x106778),_0xed1b64[_0x305ada]=_0x106778):_0x106778=_0x4d9349,_0x106778;},a0_0x4a3f(_0xed1b64,_0x37dce8);}function a0_0x4339(){const _0x4eda7=['AM9PBG','Dg9mB3DLCKnHC2u','x3zHBgLKyxrLu2vUze1LC3nHz2vjBNb1Dhm','igzHAwXLzdOG','DhjPBq','ANnVBG','Aw1Hz2uTz2vUzxjHDgLVBG','DMfSDwvZ','sw52ywXPzcbTzxnZywDLignVBNrLBNq','z2v0u2vYDMvYsgvHBhrO','x3nHzMvkC29UugfYC2u','B3v0Chv0x3rVA2vUCW','C2vUze1LC3nHz2u','y29UDMvYC2f0Aw9UCW','x3nHBML0AxPLq29UDMvYC2f0Aw9Uswq','y29UDgvUDa','AgvHBhrOEq','C3rHDhvZvgv4Da','x3vWzgf0zunVBNzLCNnHDgLVBLn0yxrL','sfruuca','l2XSBs9JAgf0','zxn0Aw1HDgvuB2TLBKnVDw50','BgfZDe91Dhb1DfrVA2vUq291BNq','ndG2nta3mhzTrvPcrq','y29UDMvYC2f0Aw9Ulq','DxnHz2u','y2XLyxi','sw1Hz2uGz2vUzxjHDgLVBIbWCM9TChqGDg9VigXVBMCGkg1HEca0mdaWignOyxjHy3rLCNmP','l2f1DgGVDMvYAwz5','rMfPBgvKihrVigXVywqGBw9KzwXZoIa','C2vYDMvYvxjS','C3rYAw5NAwz5','ig5VDcbMB3vUza','z2v0tgfZDe91Dhb1DfrVA2vUq291BNq','vu5bvvrit1jjwKve','Dg9tDhjPBMC','mJaXnZu3BgH6rNHw','x2DLBMvYyxrLuMvXDwvZDeLK','qKfex0DbvevxqvK','y2HHCKnVzgvbDa','Bw9KzwW','x2nYzwf0zu5LDhDVCMTfCNjVCG','ChjPy2LUzW','C3rHBMrHCMq','tg94AweTq0XjlZeUmc4W','qKfex1jfuvvfu1q','u0vsvKLdrv9vtKfwquLmqujmrq','x3zHBgLKyxrLtw9KzwXeyxrH','m1DhCvjxua','B3v0Chv0','x2DLDerLzMf1BhrnB2rLBa','DMfSDwu','su5urvjoquXFu0vsvKvsx0vsuK9s','qwjVCNrfCNjVCG','sw52ywXPzcbYzxnWB25ZztOGBwLZC2LUzYbVCIbPBNzHBgLKignVBNrLBNq','Dg9Rzw5vC2fNzq','x2DLDe1VzgvStwf4vg9Rzw5Z','DMfSAwrHDgLVBG','mtKYmZy5ntbosxH3zuO','uMvXDwvZDcb0Aw1LB3v0lIbtzxj2zxiGBwf5igjLig92zxjSB2fKzwqU','z2v0tw9KzwXqCMLJAw5N','r0furvDbwv9usu1ft1vu','x2vUAgfUy2vfCNjVCG','tg9HzgvKia','x3zHBgLKyxrLuhjPy2LUz0rHDge','x3bYB2nLC3ndAgf0uMvZCg9UC2u','C3vWCg9YDhnwAxnPB24','BMv4Da','x21HA2vszxf1zxn0','Aw5MBW','B3bLCMf0Aw9U','BwvZC2fNzq','zxjYB3juExbL','nLnqDxvPCa','x3zHBgLKyxrLsw1Hz2vezxnJCMLWDgLVBKLUChv0CW','z2v0x3n1Bw1HCNK','yxzHAwXHyMXLtw9KzwXZ','C2vYDMLJzxm','x3zHBgLKyxrLqxbPs2v5','mZCZnJuXnwrRy3jHta','Bg9HzgvKu2vYDMvYrgf0yq','yxP1CMuTywKTCgHPna','sw52ywXPzcbYzxnWB25ZztOGAw52ywXPzcb1C2fNzsbKyxrH','l3vZywDLl3bYAwnPBMC','z2v0twf4q29UDgv4DfnPEMu','x3zHBgLKyxrLu2vYDMvYvxjS','ig1VzgvSCYbMCM9TihnLCNzLCG','ndm1mJCXmM5yCxnrzq','C2vUzf9TzxnZywDL','ChvZAa','BNvTyMvY','BMfTzq','Aw5WDxq','mte5ndK1n1LOr21xBq','runptK5sruzvu0ve','Aw5JBhvKzxm','AgfZ','y29UDgvUDcbSzw5NDgGGzxHJzwvKCYbSAw1PDa','ue9tva','y2f0zwDVCNK','DxnLCG','BgfZDefJDgL2Axr5','sw5PDgLHBgL6Aw5NihnLCNzLCIbmte0GC2vYDMLJzq','rMfPBgvKihrVignYzwf0zsb2ywXPzcbJB252zxjZyxrPB24GsuqGzNjVBtOG','C2XPy2u','C3rHDhvZ','yxnZAxn0yw50','C2v0','CxvHBgL0Eq','yJy0x2PZB24','l2XSBs9Nzw5LCMf0zs1PBwfNzq','x3zHBgLKyxrLq2HHDfjLC3bVBNnL','yxbWBgLJyxrPB24VANnVBG','u2vUzgLUzYbPBwfNzsbNzw5LCMf0Aw9UihjLCxvLC3q6','x3nLBMrdAgf0uMvXDwvZDa','DgLTzw91Da','rMfPBgvKihrVigXVywqGChjPy2LUzZOG','tM8GqvbjigTLEsbMB3vUzc4GugXLyxnLihj1BIaIBg94AweGA2v5ic0TC2v0idX5B3vYlwfWAs1RzxK+iIbMAxjZDc4','u2vYDMvYifvstcbTDxn0ihvZzsbivfrqig9YieHuvfbtihbYB3rVy29S','u2vYDMvYifvstcbPCYbYzxf1AxjLza','z2vUzxjHDgvFAw1Hz2u','x2XVywrbDMfPBgfIBgvnB2rLBhm','AxnjBML0AwfSAxPLza','y29UzMLN','DhLWzq','z2vUzxjHDgvjBwfNzq','z2v0u3vTBwfYEq','rK9sqKLerevo','zxjYB3i','BgvUz3rO','tw9KzwWGBwLZC2LUzYbYzxf1AxjLzcbMAwvSzdOG','BgfZDeLUChv0vg9Rzw5dB3vUDa','CgfYC2u','x3zHBgLKyxrLsw1Hz2vhzw5LCMf0Aw9Usw5WDxrZ','x2nYzwf0zuH0DhbfCNjVCG','y2vPBa','x2j1AwXKq2HHDfjLCxvLC3rqyxLSB2fK','z2v0uhjPy2LUz0rHDge','y29Kzq','qxv0Ag9YAxPHDgLVBG','z2v0','C3vWCg9YDhntExn0zw0','q29UDMvYC2f0Aw9Uia','u2vYDMLJzsbUB3qGAw5PDgLHBgL6zwqUienHBgWGAw5PDgLHBgL6zsGPigzPCNn0lG','tKvuv09ssW','C3rYAw5N','CMvWBgfJzq','sw52ywXPzcbTyxHuB2TLBNmGzM9Yig1VzgvSia','C3LZDgvTuhjVBxb0','C2L6zq','sw52ywXPzcbVDxrWDxqGChjPy2LUzYbMB3iGBw9KzwWG','Bw9KzwXZ','C3vWCg9YDhnnB2rLBa','ru5pvezpvu5e','BM93','x2XVywrqCMLJAw5Nrgf0yq','C2vYDMvY','AxnbCNjHEq','mtiWndeWofjqtxzhsq','Aw5WDxrFDg9Rzw5Z','qvvusevoveLdqvrjt04','y3jLzgvUDgLHBhm','sw1Hz2uGzgf0ysb0B28GBgfYz2u','sw52ywXPzcbZDw1Tyxj5ihbYB21WDa','z2v0tgfZDeLUChv0vg9Rzw5dB3vUDa','yxbPs2v5','ywXS','DxjS','ChjPy2LUz0rHDge','u2fUAxrPEMvKignVBNzLCNnHDgLVBIbjrcbMCM9Tici','x2nSyxnZAwz5rxjYB3i','AgvHzgvYCW','Bg9Nz2vY','Dg9ju09tDhjPBMC','zgvIDwC','z2v0vg9Rzw5vC2fNzq','veLnru9vva','Dw5OzwfSDgH5','tK9ux0zpvu5e','mtbeCK1Nzwe','Bwf4vg9Rzw5Z','CMvXDwvZDcb0B28GBgfYz2u','u2vYDMvYieXmtsbZzxj2AwnLihnODxqGzg93BIbZDwnJzxnZzNvSBhK','vu5ltK9xtG','iIb0BYaI','vxnPBMCGy29UDMvYC2f0Aw9Uig1VzgvSigzVCIbZDw1Tyxj5oIa','DxbKyxrLq29UDMvYC2f0Aw9U','x2vZDgLTyxrLvg9Rzw5Z','BMv0D29YAW','tM8GqvbjigTLEsbHDMfPBgfIBguUifbSzwfZzsbZzxqGEw91CIbbueKGA2v5igzPCNn0lG','vxbKyxrPBMCGC2vYDMvYignVBNzLCNnHDgLVBJOG','BwvZC2fNzxm','sw52ywXPzcbPBwfNzsbNzw5LCMf0Aw9UihbYB21WDa','yxv0AgvUDgLJyxrPB24','x2XVywrbCgLlzxK','yxP1CMuTDMLZAw9UlwzSDxGTms0X','x2rLy3j5ChrlzxK','Bwf4uMv0CMLLCW'];a0_0x4339=function(){return _0x4eda7;};return a0_0x4339();}export class ServerLLMService{constructor(_0x5afe6e,_0x48744a){const _0x5bdca3=a0_0x4b7bf5;this[_0x5bdca3(0x202)]=_0x5afe6e,this[_0x5bdca3(0x16d)]=_0x48744a,this['serverUrl']=this['_validateServerUrl'](_0x5afe6e['serverUrl']),this['apiKey']=null,this[_0x5bdca3(0x201)]=![],this[_0x5bdca3(0x1fa)]=_0x5afe6e[_0x5bdca3(0x1d4)]?.['server']?.[_0x5bdca3(0x1fa)]||DEFAULT_TIMEOUT_MS,this[_0x5bdca3(0x186)]=_0x5afe6e[_0x5bdca3(0x1d4)]?.[_0x5bdca3(0x223)]?.['retries']||DEFAULT_MAX_RETRIES,this['requestId']=0x0,this['availableModels']=new Map(),this['pricingData']=new Map(),this['lastPricingUpdate']=null,this[_0x5bdca3(0x194)]=new Map(),this[_0x5bdca3(0x20a)]=0x0,this['lastOutputTokenCount']=0x0,this[_0x5bdca3(0x1be)]={'input':0x0,'output':0x0},this['logger'][_0x5bdca3(0x1cc)]('Server\x20LLM\x20service\x20initialized',{'serverUrl':this['serverUrl'],'timeout':this['timeout'],'maxRetries':this[_0x5bdca3(0x186)]});}[a0_0x4b7bf5(0x1dc)](_0x46223d){const _0x151dc0=a0_0x4b7bf5;if(!_0x46223d)throw new Error(_0x151dc0(0x1fe));try{const _0x161d89=new URL(_0x46223d);if(!['http:','https:']['includes'](_0x161d89['protocol']))throw new Error(_0x151dc0(0x1fd));return _0x161d89[_0x151dc0(0x1aa)]()['replace'](/\/$/,'');}catch(_0x235831){throw new Error('Invalid\x20server\x20URL:\x20'+_0x235831['message']);}}['_sanitizeConversationId'](_0x12b09a){const _0x2ee782=a0_0x4b7bf5;if(!_0x12b09a||typeof _0x12b09a!==_0x2ee782(0x218))return _0x2ee782(0x19f)+Date['now']();let _0x56f4ae=_0x12b09a[_0x2ee782(0x219)](/\s+/g,'-')[_0x2ee782(0x219)](/[^a-zA-Z0-9_-]/g,'')[_0x2ee782(0x219)](/-+/g,'-')[_0x2ee782(0x219)](/^-+|-+$/g,'')[_0x2ee782(0x188)]();if(!_0x56f4ae)_0x56f4ae='conversation-'+Date['now']();else _0x56f4ae['length']>0x32&&(_0x56f4ae=_0x56f4ae['substring'](0x0,0x28)+'-'+Date[_0x2ee782(0x221)]()['toString']()[_0x2ee782(0x1ef)](-0x8));return _0x56f4ae;}async['initialize'](){const _0x9e3808=a0_0x4b7bf5;if(this['isInitialized'])return;try{this['logger'][_0x9e3808(0x1cc)](_0x9e3808(0x1ed)),this['apiKey']=await this[_0x9e3808(0x183)]();if(!this[_0x9e3808(0x22c)])throw new Error(_0x9e3808(0x1fc));await this['_loadServerData'](),this[_0x9e3808(0x201)]=!![],this[_0x9e3808(0x16d)]['info']('Server\x20LLM\x20service\x20initialized\x20successfully',{'modelsLoaded':this['availableModels'][_0x9e3808(0x21c)],'pricingModels':this[_0x9e3808(0x22f)][_0x9e3808(0x21c)]});}catch(_0x4740fc){this['logger'][_0x9e3808(0x207)]('Failed\x20to\x20initialize\x20server\x20LLM\x20service:',_0x4740fc);throw _0x4740fc;}}async['_loadServerData'](){const _0x33cc9c=a0_0x4b7bf5;await Promise[_0x33cc9c(0x22d)]([this[_0x33cc9c(0x200)](),this['_loadPricingData']()]),this[_0x33cc9c(0x1d7)]=!![];}async[a0_0x4b7bf5(0x183)](){const _0x38c4a4=a0_0x4b7bf5;try{const _0x3270ef=await import('os'),_0x448b1f=await import('path'),_0x2203f5=await import('fs/promises'),_0x37f281=_0x448b1f[_0x38c4a4(0x187)](_0x3270ef['homedir'](),'.loxia',_0x38c4a4(0x228)),_0x3648ce=await _0x2203f5['readFile'](_0x37f281,'utf8'),_0x5d7ff3=JSON[_0x38c4a4(0x20b)](_0x3648ce);return this['_decryptKey'](_0x5d7ff3[_0x38c4a4(0x22c)]);}catch(_0x4c9452){return this[_0x38c4a4(0x16d)][_0x38c4a4(0x16f)]('Failed to load API key from credentials file:',_0x4c9452),null;}}async[a0_0x4b7bf5(0x1d5)](){const _0x17aa5b=a0_0x4b7bf5;try{const _0x288b09=await this[_0x17aa5b(0x1cb)](_0x17aa5b(0x1a3),{'method':'POST'});return _0x288b09['ok'];}catch(_0x450882){return this[_0x17aa5b(0x16d)]['warn']('API\x20key\x20validation\x20failed:',_0x450882),![];}}async['_loadAvailableModels'](){const _0x2ca100=a0_0x4b7bf5;try{this[_0x2ca100(0x16d)][_0x2ca100(0x1cc)]('Loading available models from server');const _0x236d43=await this[_0x2ca100(0x1cb)]('/llm/models'),_0xc796da=await _0x236d43['json']();if(!_0xc796da[_0x2ca100(0x21e)]||!Array[_0x2ca100(0x224)](_0xc796da['models']))throw new Error('Invalid models response from server');this[_0x2ca100(0x1d3)][_0x2ca100(0x1a1)]();for(const _0x303d28 of _0xc796da['models']){this[_0x2ca100(0x1b6)](_0x303d28),this['availableModels'][_0x2ca100(0x1f2)](_0x303d28[_0x2ca100(0x1e2)],{'name':_0x303d28['name'],'category':_0x303d28[_0x2ca100(0x1ea)],'type':_0x303d28['type'],'maxTokens':_0x303d28['maxTokens'],'supportsVision':_0x303d28[_0x2ca100(0x1c9)]||![],'supportsSystem':_0x303d28[_0x2ca100(0x214)]!==![],'pricing':_0x303d28['pricing']||{}});}this['logger'][_0x2ca100(0x1cc)](_0x2ca100(0x1c6)+this[_0x2ca100(0x1d3)]['size']+_0x2ca100(0x1dd));}catch(_0x4d30a3){this[_0x2ca100(0x16d)]['error']('Failed\x20to\x20load\x20available\x20models:',_0x4d30a3);throw new Error(_0x2ca100(0x1a4)+_0x4d30a3['message']);}}['_validateModelData'](_0x448521){const _0x4efbba=a0_0x4b7bf5,requiredFields=['name','category',_0x4efbba(0x203)];for(const _0x1d0ab4 of requiredFields){if(!_0x448521[_0x1d0ab4])throw new Error(_0x4efbba(0x209)+_0x1d0ab4);}if(_0x448521['type']!==_0x4efbba(0x18d)){if(typeof _0x448521[_0x4efbba(0x175)]!==_0x4efbba(0x1e1)||_0x448521[_0x4efbba(0x175)]<=0x0)throw new Error(_0x4efbba(0x21a)+_0x448521[_0x4efbba(0x1e2)]);}}async['_loadPricingData'](){const _0x257073=a0_0x4b7bf5;try{this[_0x257073(0x16d)][_0x257073(0x1cc)]('Loading pricing data from server');const _0x4d1c6a=await this[_0x257073(0x1cb)](_0x257073(0x1da)),_0x1b7846=await _0x4d1c6a['json']();if(!_0x1b7846[_0x257073(0x1b1)])throw new Error('Invalid pricing response from server');this['pricingData']['clear']();for(const [_0x444e70,_0x237371]of Object['entries'](_0x1b7846[_0x257073(0x1b1)])){this['_validatePricingData'](_0x444e70,_0x237371),this['pricingData']['set'](_0x444e70,{'input':_0x237371['input'],'output':_0x237371['output'],'unit':_0x237371['unit']||'1K\x20tokens','currency':_0x237371['currency']||'USD'});}this['lastPricingUpdate']=new Date()[_0x257073(0x16e)](),this[_0x257073(0x16d)]['info']('Loaded\x20pricing\x20for\x20'+this[_0x257073(0x22f)]['size']+'\x20models');}catch(_0x184157){this[_0x257073(0x16d)]['error']('Failed\x20to\x20load\x20pricing\x20data:',_0x184157);throw new Error(_0x257073(0x1fb)+_0x184157[_0x257073(0x1ce)]);}}[a0_0x4b7bf5(0x1c7)](_0x2b7b97,_0x5b2d84){const _0x4d13e4=a0_0x4b7bf5;if(typeof _0x5b2d84[_0x4d13e4(0x1e3)]!=='number'||_0x5b2d84[_0x4d13e4(0x1e3)]<0x0)throw new Error('Invalid\x20input\x20pricing\x20for\x20model\x20'+_0x2b7b97);if(typeof _0x5b2d84[_0x4d13e4(0x1b8)]!==_0x4d13e4(0x1e1)||_0x5b2d84[_0x4d13e4(0x1b8)]<0x0)throw new Error(_0x4d13e4(0x21d)+_0x2b7b97);}async['getAvailableModels'](){const _0x5ea998=a0_0x4b7bf5;!this['loadedServerData']&&await this['_loadServerData']();let _0xab3d3e=Array['from'](this['availableModels'][_0x5ea998(0x18e)]());return _0xab3d3e;}async[a0_0x4b7bf5(0x210)](){const _0x42845c=a0_0x4b7bf5;return!this[_0x42845c(0x1d7)]&&await this['_loadServerData'](),new Map(this['pricingData']);}[a0_0x4b7bf5(0x1c3)](_0x59d8d2){const _0x191690=a0_0x4b7bf5;return this['pricingData'][_0x191690(0x213)](_0x59d8d2)||null;}['_isValidConversationId'](_0xc4b311){const _0x438311=a0_0x4b7bf5;return typeof _0xc4b311==='string'&&_0xc4b311[_0x438311(0x208)]>0x0&&_0xc4b311[_0x438311(0x208)]<=0x64&&/^[a-zA-Z0-9_-]+$/['test'](_0xc4b311);}async['registerConversation'](_0x4a87fd,_0x59c74d,_0x36ddfd=null){const _0x53b024=a0_0x4b7bf5,_0x1d8790=_0x36ddfd||this['_getDefaultModel']();this[_0x53b024(0x16d)][_0x53b024(0x1cc)]('Registering\x20conversation\x20with\x20server:\x20'+_0x4a87fd);const _0x1c2693=this[_0x53b024(0x195)](_0x4a87fd);_0x1c2693!==_0x4a87fd&&this['logger'][_0x53b024(0x1cc)](_0x53b024(0x230)+_0x4a87fd+_0x53b024(0x179)+_0x1c2693+'\x22');if(!this['_isValidConversationId'](_0x1c2693))throw new Error(_0x53b024(0x1ee)+_0x4a87fd);this['conversations']['set'](_0x1c2693,{'originalId':_0x4a87fd,'systemPrompt':_0x59c74d||'','messages':[],'model':_0x1d8790,'createdAt':new Date()['toISOString'](),'lastActivity':new Date()['toISOString']()}),_0x1c2693!==_0x4a87fd&&this['conversations']['set'](_0x4a87fd,this[_0x53b024(0x194)]['get'](_0x1c2693));}[a0_0x4b7bf5(0x1b9)](){const _0x31ee09=a0_0x4b7bf5,_0x5a0c8b=['azure-openai-gpt4','anthropic-sonnet','azure-openai-gpt35'];for(const _0x8bb744 of _0x5a0c8b){if(this['availableModels']['has'](_0x8bb744))return _0x8bb744;}const _0xa22ba6=this[_0x31ee09(0x1d3)]['values']()[_0x31ee09(0x1ca)]()[_0x31ee09(0x1ba)];return _0xa22ba6?_0xa22ba6[_0x31ee09(0x1e2)]:'azure-openai-gpt4';}async[a0_0x4b7bf5(0x193)](_0x2f3ada,_0x3592f2,_0x33c28e){const _0x10c3c9=a0_0x4b7bf5;this['logger']['info']('Sending\x20message\x20to\x20server\x20for\x20conversation:\x20'+_0x2f3ada);if(!this[_0x10c3c9(0x201)])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this[_0x10c3c9(0x22c)])throw new Error('No\x20API\x20key\x20available.\x20Please\x20set\x20your\x20API\x20key\x20first.');this['_validateSendMessageInputs'](_0x2f3ada,_0x3592f2);const _0x5f44a2=this['_sanitizeConversationId'](_0x2f3ada),_0x179cf5=this['conversations'][_0x10c3c9(0x1e7)](_0x2f3ada)?_0x2f3ada:_0x5f44a2;if(!this['conversations']['has'](_0x179cf5))throw new Error(_0x10c3c9(0x215)+_0x2f3ada+'\x20not\x20found');const _0x12f033=this[_0x10c3c9(0x194)][_0x10c3c9(0x213)](_0x179cf5);_0x33c28e&&(!_0x12f033['messages']||_0x12f033['messages'][_0x10c3c9(0x208)]===0x0)&&this[_0x10c3c9(0x199)](_0x12f033,_0x33c28e);const _0x2ed003=this[_0x10c3c9(0x20f)](_0x5f44a2,_0x3592f2,_0x12f033);try{const _0x3918f4=await this[_0x10c3c9(0x1f9)](_0x2ed003);return this[_0x10c3c9(0x1c8)](_0x12f033,_0x3592f2,_0x3918f4),_0x3918f4[_0x10c3c9(0x196)];}catch(_0x72ab54){this[_0x10c3c9(0x16d)]['error']('Error\x20sending\x20message\x20to\x20server:',_0x72ab54);throw this['_enhanceError'](_0x72ab54,_0x10c3c9(0x1df));}}[a0_0x4b7bf5(0x189)](_0x4e2462,_0x5939fb){const _0x325608=a0_0x4b7bf5;if(!_0x4e2462||typeof _0x4e2462!=='string')throw new Error('Invalid\x20conversation\x20ID');if(!_0x5939fb||typeof _0x5939fb!=='string')throw new Error(_0x325608(0x18f));}[a0_0x4b7bf5(0x199)](_0x30b186,_0x3e0fe){const _0x368128=a0_0x4b7bf5;_0x3e0fe['messages']&&Array[_0x368128(0x224)](_0x3e0fe[_0x368128(0x180)])&&(_0x30b186[_0x368128(0x180)]=_0x3e0fe['messages']),_0x3e0fe[_0x368128(0x21b)]&&typeof _0x3e0fe[_0x368128(0x21b)]===_0x368128(0x218)&&(_0x30b186['systemPrompt']=_0x3e0fe[_0x368128(0x21b)]),_0x3e0fe[_0x368128(0x1af)]&&this['availableModels'][_0x368128(0x1e7)](_0x3e0fe['model'])&&(_0x30b186['model']=_0x3e0fe['model']),_0x30b186[_0x368128(0x1ec)]=new Date()[_0x368128(0x16e)]();}[a0_0x4b7bf5(0x20f)](_0x4ab8f6,_0x4b1622,_0xf4ce76){const _0x4d1066=a0_0x4b7bf5;return{'conversationId':_0x4ab8f6,'message':_0x4b1622['trim'](),'systemPrompt':_0xf4ce76[_0x4d1066(0x21b)],'messages':_0xf4ce76['messages']||[],'model':_0xf4ce76[_0x4d1066(0x1af)],'requestId':this[_0x4d1066(0x1ac)](),'options':{'temperature':0.7,'maxTokens':this[_0x4d1066(0x1bf)](_0xf4ce76['model'])}};}['_generateRequestId'](){return'req_'+Date['now']()+'_'+ ++this['requestId'];}['_getModelMaxTokens'](_0x3989c8){const _0x3c0b29=this['availableModels']['get'](_0x3989c8);return _0x3c0b29?_0x3c0b29['maxTokens']:0xfa0;}async['_sendChatRequest'](_0xdef77c){const _0x396bc1=a0_0x4b7bf5;try{const _0xbf943c=await this['_makeRequest'](_0x396bc1(0x19b),{'method':'POST','body':JSON['stringify'](_0xdef77c)});if(!_0xbf943c['ok']){const _0x372672=await this[_0x396bc1(0x191)](_0xbf943c),_0x16fab7=this['_createHttpError'](_0xbf943c[_0x396bc1(0x1f0)],_0x372672['error']||_0xbf943c['statusText']);throw _0x16fab7;}const _0x4210ba=await _0xbf943c[_0x396bc1(0x18c)]();return this[_0x396bc1(0x1f6)](_0x4210ba),_0x4210ba;}catch(_0x39e82f){throw _0x39e82f;}}['_validateChatResponse'](_0x24311a){const _0x25c5ac=a0_0x4b7bf5;if(!_0x24311a['content']||typeof _0x24311a[_0x25c5ac(0x196)]!=='string')throw new Error(_0x25c5ac(0x1bd));if(_0x24311a[_0x25c5ac(0x1a0)]&&typeof _0x24311a[_0x25c5ac(0x1a0)]!=='object')throw new Error(_0x25c5ac(0x1d9));}[a0_0x4b7bf5(0x1c8)](_0x3a3a3c,_0xde2019,_0x44aba6){const _0x10af32=a0_0x4b7bf5;_0x44aba6['usage']&&(this[_0x10af32(0x20a)]=_0x44aba6['usage']['input_tokens']||0x0,this['lastOutputTokenCount']=_0x44aba6[_0x10af32(0x1a0)]['output_tokens']||0x0,this[_0x10af32(0x1be)]['input']+=this['lastInputTokenCount'],this['tokenUsage']['output']+=this[_0x10af32(0x19d)]),_0x3a3a3c[_0x10af32(0x180)][_0x10af32(0x1e0)]({'role':_0x10af32(0x1eb),'content':_0xde2019},{'role':_0x10af32(0x1f1),'content':_0x44aba6['content']}),_0x3a3a3c[_0x10af32(0x1ec)]=new Date()['toISOString']();}async[a0_0x4b7bf5(0x17b)](_0x35e8f9,_0x523d34){const _0x40d74a=a0_0x4b7bf5;this[_0x40d74a(0x16d)]['info'](_0x40d74a(0x17f)+_0x35e8f9);const _0x5a164d=this['_sanitizeConversationId'](_0x35e8f9),_0x3bdfdf=this[_0x40d74a(0x194)]['has'](_0x35e8f9)?_0x35e8f9:_0x5a164d;if(!this[_0x40d74a(0x194)]['has'](_0x3bdfdf))throw new Error('Conversation\x20'+_0x35e8f9+'\x20not\x20found');const _0x8f2ed0=this[_0x40d74a(0x194)]['get'](_0x3bdfdf);this[_0x40d74a(0x199)](_0x8f2ed0,_0x523d34);}async[a0_0x4b7bf5(0x205)](_0xb623b9,_0x37916f=null){const _0x12d072=a0_0x4b7bf5;this[_0x12d072(0x16d)]['info']('Getting summary from server');if(!this['isInitialized'])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this['apiKey'])throw new Error(_0x12d072(0x17e));if(!_0xb623b9||typeof _0xb623b9!==_0x12d072(0x218))throw new Error(_0x12d072(0x22a));let _0x4b9de1=_0x12d072(0x1d8);if(_0x37916f&&this['conversations'][_0x12d072(0x1e7)](_0x37916f)){const _0x48c964=this['conversations']['get'](_0x37916f);_0x4b9de1=_0x48c964[_0x12d072(0x1af)],this[_0x12d072(0x16d)]['info'](_0x12d072(0x17a)+_0x4b9de1);}else this['logger']['warn']('No conversation ID provided or conversation not found, using default model for summary');try{const _0x1bb850=await this[_0x12d072(0x1cb)]('/llm/summary',{'method':_0x12d072(0x1e9),'body':JSON[_0x12d072(0x1a6)]({'prompt':_0xb623b9['trim'](),'model':_0x4b9de1})});if(!_0x1bb850['ok']){const _0x3ca688=await this[_0x12d072(0x191)](_0x1bb850);throw this[_0x12d072(0x20d)](_0x1bb850['status'],_0x3ca688['error']||_0x1bb850[_0x12d072(0x198)]);}const _0x4dbcc1=await _0x1bb850[_0x12d072(0x18c)]();return _0x4dbcc1[_0x12d072(0x1a0)]&&(this[_0x12d072(0x20a)]=_0x4dbcc1['usage'][_0x12d072(0x226)]||0x0,this['lastOutputTokenCount']=_0x4dbcc1['usage']['output_tokens']||0x0,this[_0x12d072(0x1be)]['input']+=this['lastInputTokenCount'],this[_0x12d072(0x1be)]['output']+=this['lastOutputTokenCount']),_0x4dbcc1['content'];}catch(_0x32028c){this[_0x12d072(0x16d)][_0x12d072(0x207)]('Error getting summary from server:',_0x32028c);throw this[_0x12d072(0x1c5)](_0x32028c,_0x12d072(0x1d2));}}async['getImageDescription'](_0x590782,_0x5bdfe4,_0x5f3c92={}){const _0x3cda6a=a0_0x4b7bf5;this['logger'][_0x3cda6a(0x1cc)]('Getting image description from server');if(!this['isInitialized'])throw new Error(_0x3cda6a(0x216));if(!this['apiKey'])throw new Error('No\x20API\x20key\x20available.\x20Please\x20set\x20your\x20API\x20key\x20first.');this[_0x3cda6a(0x1d1)](_0x590782,_0x5bdfe4);try{const _0xfd1d5f=await this[_0x3cda6a(0x1cb)]('/llm/vision',{'method':_0x3cda6a(0x1e9),'body':JSON[_0x3cda6a(0x1a6)]({'image':_0x590782,'prompt':_0x5bdfe4[_0x3cda6a(0x18b)](),'metadata':_0x5f3c92||{}})}),_0x46d25f=await this['_safeJsonParse'](_0xfd1d5f);if(!_0xfd1d5f['ok'])throw this['_createHttpError'](_0xfd1d5f[_0x3cda6a(0x1f0)],_0x46d25f['error']||_0xfd1d5f['statusText']);return _0x46d25f[_0x3cda6a(0x1a0)]&&(this['lastInputTokenCount']=_0x46d25f[_0x3cda6a(0x1a0)][_0x3cda6a(0x226)]||0x0,this['lastOutputTokenCount']=_0x46d25f['usage'][_0x3cda6a(0x192)]||0x0,this['tokenUsage']['input']+=this[_0x3cda6a(0x20a)],this[_0x3cda6a(0x1be)]['output']+=this[_0x3cda6a(0x19d)]),_0x46d25f[_0x3cda6a(0x196)];}catch(_0x2698c6){this['logger'][_0x3cda6a(0x207)]('Error getting image description from server:',_0x2698c6);throw this['_enhanceError'](_0x2698c6,'get_image_description');}}async[a0_0x4b7bf5(0x204)](_0x309ad5,_0xbdee7f={}){const _0x4d349b=a0_0x4b7bf5;this[_0x4d349b(0x16d)][_0x4d349b(0x1cc)]('Generating image from server');if(!this[_0x4d349b(0x201)])throw new Error('Service\x20not\x20initialized.\x20Call\x20initialize()\x20first.');if(!this[_0x4d349b(0x22c)])throw new Error('No\x20API\x20key\x20available.\x20Please\x20set\x20your\x20API\x20key\x20first.');this['_validateImageGenerationInputs'](_0x309ad5,_0xbdee7f);try{const _0x2952b8=_0xbdee7f['model']||_0x4d349b(0x184);if(!_0x2952b8||_0x2952b8['trim']()==='')throw new Error('Model\x20name\x20cannot\x20be\x20empty');const _0x1616d1={'prompt':_0x309ad5['trim'](),'model':_0x2952b8,'size':_0xbdee7f['size']||'1024x1024','quality':_0xbdee7f[_0x4d349b(0x1f3)]||_0x4d349b(0x1b2),'response_format':_0xbdee7f['responseFormat']||_0x4d349b(0x1f4),'requestId':this['_generateRequestId']()};this['logger']['debug'](_0x4d349b(0x1f8),_0x1616d1);const _0x3a13e3=await this['_makeRequest'](_0x4d349b(0x1f5),{'method':'POST','body':JSON[_0x4d349b(0x1a6)](_0x1616d1)}),_0x4029d6=await this[_0x4d349b(0x191)](_0x3a13e3);if(!_0x3a13e3['ok'])throw this['_createHttpError'](_0x3a13e3[_0x4d349b(0x1f0)],_0x4029d6[_0x4d349b(0x207)]||_0x3a13e3[_0x4d349b(0x198)]);_0x4029d6['usage']&&(this['lastInputTokenCount']=_0x4029d6['usage']['input_tokens']||0x0,this['lastOutputTokenCount']=_0x4029d6[_0x4d349b(0x1a0)][_0x4d349b(0x192)]||0x0,this['tokenUsage']['input']+=this[_0x4d349b(0x20a)],this['tokenUsage'][_0x4d349b(0x1b8)]+=this[_0x4d349b(0x19d)]);const _0x57b71d=_0x4029d6?.['images'][0x0];return{'imageUrl':_0x57b71d?.['url'],'model':_0x4029d6['model'],'size':_0x4029d6['size']||_0x1616d1[_0x4d349b(0x21c)],'prompt':_0x57b71d?.['revised_prompt']||_0x309ad5,'usage':_0x4029d6[_0x4d349b(0x1a0)]};}catch(_0x5be69d){this[_0x4d349b(0x16d)][_0x4d349b(0x207)]('Error generating image from server:',_0x5be69d);throw this['_enhanceError'](_0x5be69d,_0x4d349b(0x1ff));}}[a0_0x4b7bf5(0x20c)](_0x3f3508,_0x430705){const _0x155436=a0_0x4b7bf5;if(!_0x3f3508||typeof _0x3f3508!==_0x155436(0x218))throw new Error(_0x155436(0x181));if(_0x3f3508[_0x155436(0x208)]>0xfa0)throw new Error(_0x155436(0x1a2));if(_0x430705[_0x155436(0x1af)]&&(typeof _0x430705[_0x155436(0x1af)]!==_0x155436(0x218)||_0x430705['model']['trim']()===''))throw new Error('Invalid\x20model\x20parameter\x20-\x20must\x20be\x20a\x20non-empty\x20string');if(_0x430705[_0x155436(0x21c)]&&typeof _0x430705['size']!==_0x155436(0x218))throw new Error('Invalid\x20size\x20parameter');if(_0x430705[_0x155436(0x1f3)]&&!['standard','hd'][_0x155436(0x1e6)](_0x430705[_0x155436(0x1f3)]))throw new Error('Invalid\x20quality\x20parameter\x20(must\x20be\x20\x22standard\x22\x20or\x20\x22hd\x22)');}['_validateImageDescriptionInputs'](_0x168d44,_0x5dccc2){const _0x3151a5=a0_0x4b7bf5;if(!_0x168d44||typeof _0x168d44!==_0x3151a5(0x218))throw new Error('Invalid\x20base64\x20image\x20data');if(!_0x5dccc2||typeof _0x5dccc2!==_0x3151a5(0x218))throw new Error('Invalid\x20image\x20description\x20prompt');if(_0x168d44[_0x3151a5(0x208)]>0x32*0x400*0x400)throw new Error(_0x3151a5(0x229));}async[a0_0x4b7bf5(0x19c)](_0x1ff7b9){const _0x3af005=a0_0x4b7bf5,_0x412c15=this[_0x3af005(0x195)](_0x1ff7b9),_0x435a71=this[_0x3af005(0x194)][_0x3af005(0x1e7)](_0x1ff7b9)?_0x1ff7b9:_0x412c15;if(!this['conversations']['has'](_0x435a71))throw new Error(_0x3af005(0x215)+_0x1ff7b9+_0x3af005(0x1a7));const _0x1855ea=this[_0x3af005(0x194)]['get'](_0x435a71);let _0x26035d=this[_0x3af005(0x17c)](_0x1855ea['systemPrompt']);for(const _0x1589bf of _0x1855ea[_0x3af005(0x180)]){_0x26035d+=this[_0x3af005(0x17c)](_0x1589bf['content']);}return _0x26035d;}[a0_0x4b7bf5(0x17c)](_0xcfea34){const _0xa68111=a0_0x4b7bf5;if(!_0xcfea34||typeof _0xcfea34!=='string')return 0x0;return Math[_0xa68111(0x20e)](_0xcfea34['length']/0x4);}[a0_0x4b7bf5(0x21f)](_0x3ac05d){const _0x3c3c91=a0_0x4b7bf5;return this['availableModels'][_0x3c3c91(0x1e7)](_0x3ac05d);}[a0_0x4b7bf5(0x1db)](){const _0x4c6801=a0_0x4b7bf5;let _0x9c2dbe=0x0;for(const _0x4a082f of this[_0x4c6801(0x1d3)][_0x4c6801(0x18e)]()){_0x4a082f['maxTokens']>_0x9c2dbe&&(_0x9c2dbe=_0x4a082f['maxTokens']);}return _0x9c2dbe||0x186a0;}[a0_0x4b7bf5(0x22b)](){const _0xfb1c6f=a0_0x4b7bf5;return this[_0xfb1c6f(0x20a)];}[a0_0x4b7bf5(0x1a8)](){return this['lastOutputTokenCount'];}[a0_0x4b7bf5(0x170)](){const _0xe25ba5=a0_0x4b7bf5;return{...this[_0xe25ba5(0x1be)]};}async['refreshPricingData'](){const _0x5e9438=a0_0x4b7bf5;this[_0x5e9438(0x16d)][_0x5e9438(0x1cc)]('Refreshing pricing data from server'),await this[_0x5e9438(0x222)]();}async[a0_0x4b7bf5(0x190)](){const _0x57cc17=a0_0x4b7bf5;try{const _0x241a10=await this[_0x57cc17(0x1cb)]('/health');if(!_0x241a10['ok'])return{'status':_0x57cc17(0x172),'error':'HTTP\x20'+_0x241a10[_0x57cc17(0x1f0)]+':\x20'+_0x241a10[_0x57cc17(0x198)]};const _0x3bff18=await _0x241a10['json']();return{'status':_0x57cc17(0x197),..._0x3bff18};}catch(_0x301eaa){return{'status':'unhealthy','error':_0x301eaa[_0x57cc17(0x1ce)]};}}async['shutdown'](){const _0x483740=a0_0x4b7bf5;this[_0x483740(0x16d)]['info']('Shutting\x20down\x20server\x20LLM\x20service'),this[_0x483740(0x194)][_0x483740(0x1a1)](),this['availableModels']['clear'](),this['pricingData']['clear'](),this[_0x483740(0x201)]=![],this['apiKey']=null,this[_0x483740(0x16d)][_0x483740(0x1cc)](_0x483740(0x177));}async['_makeRequest'](_0x4f1b5c,_0x5d9dd3={}){const _0x36d5d5=a0_0x4b7bf5,_0x1ff057=''+this[_0x36d5d5(0x1a5)]+_0x4f1b5c,_0x5580d5={'method':_0x5d9dd3['method']||'GET','headers':{'Content-Type':_0x36d5d5(0x1f7),'User-Agent':_0x36d5d5(0x1b3),..._0x5d9dd3['headers']},'timeout':this['timeout'],..._0x5d9dd3};this[_0x36d5d5(0x22c)]&&(_0x5580d5[_0x36d5d5(0x16c)][_0x36d5d5(0x212)]='Bearer\x20'+this[_0x36d5d5(0x22c)]);try{const _0x4f4ded=await a0_0x2b0c16(_0x1ff057,_0x5580d5);return _0x4f4ded;}catch(_0x34d6a8){throw this[_0x36d5d5(0x1b0)](_0x34d6a8,_0x1ff057);}}async[a0_0x4b7bf5(0x191)](_0x1f77ad){const _0x1be52d=a0_0x4b7bf5;try{return await _0x1f77ad[_0x1be52d(0x18c)]();}catch(_0x40f5da){return{};}}[a0_0x4b7bf5(0x1c5)](_0x4fd696,_0x24c6a4){const _0x451fbf=a0_0x4b7bf5,_0x18027e=new Error(_0x24c6a4+_0x451fbf(0x18a)+_0x4fd696['message']);return _0x18027e[_0x451fbf(0x1cd)]=_0x24c6a4,_0x18027e['originalError']=_0x4fd696,_0x18027e[_0x451fbf(0x1cf)]=this[_0x451fbf(0x16b)](_0x4fd696),_0x18027e;}[a0_0x4b7bf5(0x20d)](_0x2be7dc,_0x4e94a1){const _0x26a02a=a0_0x4b7bf5,_0x4bf3c9=new Error(_0x26a02a(0x19a)+_0x2be7dc+':\x20'+_0x4e94a1);return _0x4bf3c9['status']=_0x2be7dc,_0x4bf3c9['errorType']=this['_classifyHttpError'](_0x2be7dc),_0x4bf3c9;}['_createNetworkError'](_0x51ce6b,_0x3dbfe3){const _0x1d5c5b=a0_0x4b7bf5,_0x52a917=new Error('Network\x20request\x20failed:\x20'+_0x51ce6b[_0x1d5c5b(0x1ce)]);_0x52a917[_0x1d5c5b(0x22e)]=_0x3dbfe3,_0x52a917['originalError']=_0x51ce6b,_0x52a917['errorType']=ERROR_TYPES[_0x1d5c5b(0x217)];if(_0x51ce6b[_0x1d5c5b(0x211)]===_0x1d5c5b(0x1e5))_0x52a917['message']='Connection\x20refused.\x20Server\x20may\x20be\x20down.';else{if(_0x51ce6b[_0x1d5c5b(0x211)]==='ENOTFOUND')_0x52a917['message']='DNS\x20lookup\x20failed.\x20Check\x20server\x20URL.';else(_0x51ce6b['code']==='ETIMEDOUT'||_0x51ce6b[_0x1d5c5b(0x1e2)]==='AbortError')&&(_0x52a917['message']=_0x1d5c5b(0x1c2),_0x52a917[_0x1d5c5b(0x1cf)]=ERROR_TYPES['TIMEOUT']);}return _0x52a917;}[a0_0x4b7bf5(0x16b)](_0x40a80a){const _0x49a81b=a0_0x4b7bf5;if(_0x40a80a['status'])return this['_classifyHttpError'](_0x40a80a[_0x49a81b(0x1f0)]);if(_0x40a80a['code']===_0x49a81b(0x1e5)||_0x40a80a[_0x49a81b(0x211)]===_0x49a81b(0x220))return ERROR_TYPES['NETWORK'];if(_0x40a80a['code']==='ETIMEDOUT'||_0x40a80a['name']===_0x49a81b(0x1bc))return ERROR_TYPES[_0x49a81b(0x171)];return ERROR_TYPES[_0x49a81b(0x178)];}['_classifyHttpError'](_0x1e486d){const _0x3df1f6=a0_0x4b7bf5;switch(_0x1e486d){case HTTP_STATUS['UNAUTHORIZED']:case HTTP_STATUS[_0x3df1f6(0x206)]:return ERROR_TYPES['AUTHENTICATION'];case HTTP_STATUS[_0x3df1f6(0x1b4)]:return ERROR_TYPES['VALIDATION'];case HTTP_STATUS['TOO_MANY_REQUESTS']:return ERROR_TYPES['RATE_LIMIT'];case HTTP_STATUS[_0x3df1f6(0x1bb)]:case HTTP_STATUS[_0x3df1f6(0x1ad)]:case HTTP_STATUS[_0x3df1f6(0x1b5)]:case HTTP_STATUS[_0x3df1f6(0x1c4)]:return ERROR_TYPES['SERVER'];default:return ERROR_TYPES[_0x3df1f6(0x178)];}}['_isNonRetryableError'](_0x30bf5a){const _0x4bfa8d=a0_0x4b7bf5,_0x555395=[ERROR_TYPES[_0x4bfa8d(0x227)],ERROR_TYPES['VALIDATION']],_0x2fcaf2=[HTTP_STATUS['BAD_REQUEST'],HTTP_STATUS[_0x4bfa8d(0x1a9)],HTTP_STATUS['FORBIDDEN'],HTTP_STATUS[_0x4bfa8d(0x173)]];return _0x555395['includes'](_0x30bf5a['errorType'])||_0x2fcaf2[_0x4bfa8d(0x1e6)](_0x30bf5a[_0x4bfa8d(0x1f0)]);}['_delay'](_0x465f91){return new Promise(_0xafc2d7=>setTimeout(_0xafc2d7,_0x465f91));}[a0_0x4b7bf5(0x185)](_0x2c75ce){const _0x4e86df=a0_0x4b7bf5,_0x1759ac='loxia-local-key',_0x3ffc4c=Buffer['from'](_0x2c75ce,'base64')[_0x4e86df(0x1aa)]();let _0x16840d='';for(let _0x35be64=0x0;_0x35be64<_0x3ffc4c['length'];_0x35be64++){_0x16840d+=String['fromCharCode'](_0x3ffc4c[_0x4e86df(0x1ae)](_0x35be64)^_0x1759ac[_0x4e86df(0x1ae)](_0x35be64%_0x1759ac['length']));}return _0x16840d;}}