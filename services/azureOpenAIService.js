function a0_0x5462(){const _0x6e7768=['Aw5MBW','C3rHDhvZvgv4Da','CMvZCg9UC2u','z3b0ltm1lxr1CMjV','Bg9Nz2vY','qxP1CMuGt3bLBKfjiefqssbYzxf1zxn0ihrPBwvVDxq','DxnLCG','mJq5nJq5Cg9hwhjg','mtfsuLHxu0G','ndG3ote0BhnWAu51','z2v0u2vJCMv0','nJC1ndKZmKTdq0fHuW','yxbWBgLJyxrPB24VANnVBG','qxP1CMuGt3bLBKfjignYzwrLBNrPywXZig5VDcbMB3vUzcbPBIblzxKGvMf1Bhq','qxP1CMuGt3bLBKfjiefqssbYzxf1zxn0igzHAwXLzdOG','Aw5PDgLHBgL6zq','nZu3ode4zwnNCeHK','AgvHBhrOq2HLy2S','mJe2mZKZm25hsMzlzW','Dw5OzwfSDgH5','zNjLCxvLBMn5ugvUywX0Eq','yxbPs2v5','BwvZC2fNzq','z2v0rgvWBg95BwvUDe5HBwu','zw5KCg9PBNq','n1D4CeLTwG','nu1Sq0fAua','DxnHz2u','rMfPBgvKihrVigLUAxrPywXPEMuGqxP1CMuGt3bLBKfjihnLCNzPy2u6','ndC4mtq5uNDQswDm','AgvHBhrOEq','z3b0ltq','mJC1otjAzK9eD08','Dg9Wua','nfHis1nxza','zxjYB3i','Aw5PDgLHBgL6zwq','y29Kzq','qxP1CMuGt3bLBKfjihnLCNzPy2uGAw5PDgLHBgL6zwqGC3vJy2vZC2z1BgX5','y2HHDenVBxbSzxrPB24','mtbdwvz4t0G','Cg9ZDa'];a0_0x5462=function(){return _0x6e7768;};return a0_0x5462();}const a0_0x4b7934=a0_0x4b7c;(function(_0x545ae6,_0x197fb7){const _0x13acec=a0_0x4b7c,_0x58c28c=_0x545ae6();while(!![]){try{const _0x325b56=parseInt(_0x13acec(0xb0))/0x1+parseInt(_0x13acec(0xb2))/0x2+parseInt(_0x13acec(0x9c))/0x3*(-parseInt(_0x13acec(0xa1))/0x4)+-parseInt(_0x13acec(0xc3))/0x5*(-parseInt(_0x13acec(0xb9))/0x6)+parseInt(_0x13acec(0xc2))/0x7*(-parseInt(_0x13acec(0x9f))/0x8)+-parseInt(_0x13acec(0xbb))/0x9*(-parseInt(_0x13acec(0xa7))/0xa)+-parseInt(_0x13acec(0xb1))/0xb*(parseInt(_0x13acec(0xb4))/0xc);if(_0x325b56===_0x197fb7)break;else _0x58c28c['push'](_0x58c28c['shift']());}catch(_0x7df14b){_0x58c28c['push'](_0x58c28c['shift']());}}}(a0_0x5462,0x20dcb));import a0_0x1f7b51 from'axios';import a0_0x5d7a1c from'./keyVaultService.js';function a0_0x4b7c(_0x470828,_0xe23450){const _0x54620c=a0_0x5462();return a0_0x4b7c=function(_0x4b7c30,_0x4681e3){_0x4b7c30=_0x4b7c30-0x9a;let _0x4610ab=_0x54620c[_0x4b7c30];if(a0_0x4b7c['JbVplO']===undefined){var _0x6a3edc=function(_0x1f7b51){const _0x5d7a1c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3e2530='',_0x16a454='';for(let _0x1af54d=0x0,_0x32605c,_0x495b88,_0x29386b=0x0;_0x495b88=_0x1f7b51['charAt'](_0x29386b++);~_0x495b88&&(_0x32605c=_0x1af54d%0x4?_0x32605c*0x40+_0x495b88:_0x495b88,_0x1af54d++%0x4)?_0x3e2530+=String['fromCharCode'](0xff&_0x32605c>>(-0x2*_0x1af54d&0x6)):0x0){_0x495b88=_0x5d7a1c['indexOf'](_0x495b88);}for(let _0x55b697=0x0,_0x2f33c3=_0x3e2530['length'];_0x55b697<_0x2f33c3;_0x55b697++){_0x16a454+='%'+('00'+_0x3e2530['charCodeAt'](_0x55b697)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x16a454);};a0_0x4b7c['bWgnYP']=_0x6a3edc,_0x470828=arguments,a0_0x4b7c['JbVplO']=!![];}const _0x4b780=_0x54620c[0x0],_0xa063ac=_0x4b7c30+_0x4b780,_0x53f3cd=_0x470828[_0xa063ac];return!_0x53f3cd?(_0x4610ab=a0_0x4b7c['bWgnYP'](_0x4610ab),_0x470828[_0xa063ac]=_0x4610ab):_0x4610ab=_0x53f3cd,_0x4610ab;},a0_0x4b7c(_0x470828,_0xe23450);}class AzureOpenAIService{constructor(_0x3e2530){const _0xd05122=a0_0x4b7c;this['logger']=_0x3e2530,this[_0xd05122(0xc1)]=null,this[_0xd05122(0xbe)]=null,this['apiVersion']='2024-02-15-preview',this[_0xd05122(0xa3)]=![];}async['initialize'](){const _0x33ba7b=a0_0x4b7c;if(this[_0x33ba7b(0xa3)])return;try{this['endpoint']=await a0_0x5d7a1c[_0x33ba7b(0xb3)]('AZURE-OPENAI-ENDPOINT'),this['apiKey']=await a0_0x5d7a1c[_0x33ba7b(0xb3)]('AZURE-OPENAI-API-KEY');if(!this[_0x33ba7b(0xc1)]||!this[_0x33ba7b(0xbe)])throw new Error(_0x33ba7b(0xb6));this['initialized']=!![],this['logger'][_0x33ba7b(0xa9)](_0x33ba7b(0xa5));}catch(_0x16a454){this[_0x33ba7b(0xad)][_0x33ba7b(0xa2)](_0x33ba7b(0x9b),_0x16a454);throw _0x16a454;}}async[a0_0x4b7934(0xa6)](_0x1af54d,_0x32605c=a0_0x4b7934(0x9e),_0x495b88={}){const _0x131471=a0_0x4b7934;await this['initialize']();const _0x29386b=this[_0x131471(0xc0)](_0x32605c),_0x55b697=this['endpoint']+'/openai/deployments/'+_0x29386b+'/chat/completions?api-version='+this['apiVersion'],_0x2f33c3={'messages':_0x1af54d,'max_tokens':_0x495b88['maxTokens']||0xfa0,'temperature':_0x495b88['temperature']||0.7,'top_p':_0x495b88[_0x131471(0xa0)]||0x1,'frequency_penalty':_0x495b88[_0x131471(0xbd)]||0x0,'presence_penalty':_0x495b88['presencePenalty']||0x0,..._0x495b88};try{const _0x4d07d6=await a0_0x1f7b51[_0x131471(0xa8)](_0x55b697,_0x2f33c3,{'headers':{'api-key':this[_0x131471(0xbe)],'Content-Type':_0x131471(0xb5)},'timeout':0xea60});return _0x4d07d6['data'];}catch(_0x1cfa59){this[_0x131471(0xad)][_0x131471(0xa2)]('Azure\x20OpenAI\x20API\x20call\x20failed:',_0x1cfa59);if(_0x1cfa59['response'])throw new Error('Azure\x20OpenAI\x20API\x20error:\x20'+_0x1cfa59[_0x131471(0xab)]['status']+'\x20-\x20'+(_0x1cfa59[_0x131471(0xab)]['data']?.['error']?.['message']||_0x1cfa59[_0x131471(0xab)][_0x131471(0xaa)]));else{if(_0x1cfa59[_0x131471(0xa4)]==='ECONNABORTED')throw new Error(_0x131471(0xae));else throw new Error(_0x131471(0xb7)+_0x1cfa59[_0x131471(0xbf)]);}}}[a0_0x4b7934(0xc0)](_0x1bd850){const _0x539f66=a0_0x4b7934,_0x3dfe68={'openai-gpt4':'gpt-4','openai-gpt3.5':_0x539f66(0xac),'azure-openai-gpt4':_0x539f66(0x9e),'azure-openai-gpt35':_0x539f66(0xac),'gpt-4':'gpt-4','gpt-3.5-turbo':_0x539f66(0xac)};return _0x3dfe68[_0x1bd850]||'gpt-4';}async[a0_0x4b7934(0xba)](){const _0x5dba69=a0_0x4b7934;try{await this[_0x5dba69(0xb8)]();const _0x440dc2=[{'role':_0x5dba69(0xaf),'content':'Hello,\x20this\x20is\x20a\x20test\x20message.'}],_0x1ee911=await this['chatCompletion'](_0x440dc2,'gpt-35-turbo',{'maxTokens':0xa});return{'status':_0x5dba69(0x9d),'endpoint':this[_0x5dba69(0xc1)],'model':_0x5dba69(0xac),'usage':_0x1ee911[_0x5dba69(0x9a)]};}catch(_0x290817){return{'status':_0x5dba69(0xbc),'error':_0x290817[_0x5dba69(0xbf)]};}}}export default new AzureOpenAIService();