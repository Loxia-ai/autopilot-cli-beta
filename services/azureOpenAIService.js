const a0_0x11934d=a0_0x15c2;(function(_0x4dfe0c,_0x162a72){const _0x40b9d2=a0_0x15c2,_0x254af7=_0x4dfe0c();while(!![]){try{const _0x5d6acd=-parseInt(_0x40b9d2(0x1a7))/0x1+parseInt(_0x40b9d2(0x1ac))/0x2*(parseInt(_0x40b9d2(0x1aa))/0x3)+-parseInt(_0x40b9d2(0x1bf))/0x4*(-parseInt(_0x40b9d2(0x19e))/0x5)+parseInt(_0x40b9d2(0x1a1))/0x6+-parseInt(_0x40b9d2(0x1a9))/0x7+parseInt(_0x40b9d2(0x1a6))/0x8*(-parseInt(_0x40b9d2(0x1b0))/0x9)+parseInt(_0x40b9d2(0x1a0))/0xa;if(_0x5d6acd===_0x162a72)break;else _0x254af7['push'](_0x254af7['shift']());}catch(_0x27355b){_0x254af7['push'](_0x254af7['shift']());}}}(a0_0x1ea0,0xe409c));import a0_0x14e58d from'axios';function a0_0x15c2(_0x1e3f45,_0x4ad966){const _0x1ea0d3=a0_0x1ea0();return a0_0x15c2=function(_0x15c2cb,_0x3b1ab8){_0x15c2cb=_0x15c2cb-0x19d;let _0x4df036=_0x1ea0d3[_0x15c2cb];if(a0_0x15c2['Oennso']===undefined){var _0x14b0d2=function(_0x14e58d){const _0x59723b='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x293f26='',_0x132541='';for(let _0x2fee93=0x0,_0x4bb3c9,_0x54cc94,_0x47dca5=0x0;_0x54cc94=_0x14e58d['charAt'](_0x47dca5++);~_0x54cc94&&(_0x4bb3c9=_0x2fee93%0x4?_0x4bb3c9*0x40+_0x54cc94:_0x54cc94,_0x2fee93++%0x4)?_0x293f26+=String['fromCharCode'](0xff&_0x4bb3c9>>(-0x2*_0x2fee93&0x6)):0x0){_0x54cc94=_0x59723b['indexOf'](_0x54cc94);}for(let _0x229077=0x0,_0x272187=_0x293f26['length'];_0x229077<_0x272187;_0x229077++){_0x132541+='%'+('00'+_0x293f26['charCodeAt'](_0x229077)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x132541);};a0_0x15c2['PkUJsB']=_0x14b0d2,_0x1e3f45=arguments,a0_0x15c2['Oennso']=!![];}const _0x1907e0=_0x1ea0d3[0x0],_0x1c466a=_0x15c2cb+_0x1907e0,_0x56476c=_0x1e3f45[_0x1c466a];return!_0x56476c?(_0x4df036=a0_0x15c2['PkUJsB'](_0x4df036),_0x1e3f45[_0x1c466a]=_0x4df036):_0x4df036=_0x56476c,_0x4df036;},a0_0x15c2(_0x1e3f45,_0x4ad966);}import a0_0x59723b from'./keyVaultService.js';class AzureOpenAIService{constructor(_0x293f26){const _0x496b97=a0_0x15c2;this['logger']=_0x293f26,this['endpoint']=null,this['apiKey']=null,this[_0x496b97(0x1af)]=_0x496b97(0x1ab),this['initialized']=![];}async['initialize'](){const _0x1059ee=a0_0x15c2;if(this[_0x1059ee(0x1c1)])return;try{this[_0x1059ee(0x1bb)]=await a0_0x59723b[_0x1059ee(0x1b6)]('AZURE-OPENAI-ENDPOINT'),this[_0x1059ee(0x1a3)]=await a0_0x59723b['getSecret'](_0x1059ee(0x1b1));if(!this[_0x1059ee(0x1bb)]||!this['apiKey'])throw new Error(_0x1059ee(0x1ad));this[_0x1059ee(0x1c1)]=!![],this['logger'][_0x1059ee(0x1ba)](_0x1059ee(0x1b4));}catch(_0x132541){this['logger']['error'](_0x1059ee(0x1a5),_0x132541);throw _0x132541;}}async[a0_0x11934d(0x1ae)](_0x2fee93,_0x4bb3c9='gpt-4',_0x54cc94={}){const _0x438c92=a0_0x11934d;await this['initialize']();const _0x47dca5=this[_0x438c92(0x1a8)](_0x4bb3c9),_0x229077=this['endpoint']+_0x438c92(0x1b5)+_0x47dca5+'/chat/completions?api-version='+this[_0x438c92(0x1af)],_0x272187={'messages':_0x2fee93,'max_tokens':_0x54cc94['maxTokens']||0xfa0,'temperature':_0x54cc94[_0x438c92(0x1bd)]||0.7,'top_p':_0x54cc94['topP']||0x1,'frequency_penalty':_0x54cc94[_0x438c92(0x1b2)]||0x0,'presence_penalty':_0x54cc94['presencePenalty']||0x0,..._0x54cc94};try{const _0x4940d9=await a0_0x14e58d['post'](_0x229077,_0x272187,{'headers':{'api-key':this['apiKey'],'Content-Type':'application/json'},'timeout':0xea60});return _0x4940d9['data'];}catch(_0x40b49f){this['logger']['error'](_0x438c92(0x1be),_0x40b49f);if(_0x40b49f['response'])throw new Error('Azure\x20OpenAI\x20API\x20error:\x20'+_0x40b49f[_0x438c92(0x1bc)][_0x438c92(0x1b3)]+_0x438c92(0x19f)+(_0x40b49f[_0x438c92(0x1bc)]['data']?.[_0x438c92(0x1b9)]?.['message']||_0x40b49f[_0x438c92(0x1bc)]['statusText']));else{if(_0x40b49f[_0x438c92(0x1a4)]==='ECONNABORTED')throw new Error(_0x438c92(0x19d));else throw new Error('Azure\x20OpenAI\x20API\x20request\x20failed:\x20'+_0x40b49f['message']);}}}['getDeploymentName'](_0x4957c5){const _0x2740b0=a0_0x11934d,_0x28fa97={'openai-gpt4':'gpt-4','openai-gpt3.5':_0x2740b0(0x1a2),'azure-openai-gpt4':_0x2740b0(0x1b8),'azure-openai-gpt35':_0x2740b0(0x1a2),'gpt-4':'gpt-4','gpt-3.5-turbo':'gpt-35-turbo'};return _0x28fa97[_0x4957c5]||'gpt-4';}async[a0_0x11934d(0x1c0)](){const _0xf28dbf=a0_0x11934d;try{await this['initialize']();const _0x423d71=[{'role':_0xf28dbf(0x1b7),'content':'Hello,\x20this\x20is\x20a\x20test\x20message.'}],_0x311e78=await this[_0xf28dbf(0x1ae)](_0x423d71,_0xf28dbf(0x1a2),{'maxTokens':0xa});return{'status':'healthy','endpoint':this[_0xf28dbf(0x1bb)],'model':'gpt-35-turbo','usage':_0x311e78['usage']};}catch(_0x5bc4e8){return{'status':'unhealthy','error':_0x5bc4e8['message']};}}}function a0_0x1ea0(){const _0x355efc=['DgvTCgvYyxr1CMu','qxP1CMuGt3bLBKfjiefqssbJywXSigzHAwXLzdO','mtm0mfL4rfjItq','AgvHBhrOq2HLy2S','Aw5PDgLHBgL6zwq','qxP1CMuGt3bLBKfjiefqssbYzxf1zxn0ihrPBwvVDxq','mti0odbXEe9cvNe','ic0G','mta3ndy2nZbxsvzYB0m','otG1mdq0nNP3CuvRyG','z3b0ltm1lxr1CMjV','yxbPs2v5','y29Kzq','rMfPBgvKihrVigLUAxrPywXPEMuGqxP1CMuGt3bLBKfjihnLCNzPy2u6','mZyWywHMywjP','mtu3mZG3nw5rrNbczq','z2v0rgvWBg95BwvUDe5HBwu','mta3nZiXotvpyLrRBLm','nLDHBwHgsG','mJaYnc0WmI0Xns1WCMv2Awv3','odm3nda2tNDzre5K','qxP1CMuGt3bLBKfjignYzwrLBNrPywXZig5VDcbMB3vUzcbPBIblzxKGvMf1Bhq','y2HHDenVBxbSzxrPB24','yxbPvMvYC2LVBG','nJG2mZrgBvHSwfi','qvPvuKuTt1bftKfjlufqss1lrvK','zNjLCxvLBMn5ugvUywX0Eq','C3rHDhvZ','qxP1CMuGt3bLBKfjihnLCNzPy2uGAw5PDgLHBgL6zwqGC3vJy2vZC2z1BgX5','l29Wzw5HAs9KzxbSB3LTzw50CY8','z2v0u2vJCMv0','DxnLCG','z3b0ltq','zxjYB3i','Aw5MBW','zw5KCg9PBNq','CMvZCg9UC2u'];a0_0x1ea0=function(){return _0x355efc;};return a0_0x1ea0();}export default new AzureOpenAIService();