function a0_0x28ab(){const _0x2035ed=['ohf3CNj1Dq','mJe5nJuXBuXWDw5q','DxnHz2u','qvPvuKuTt1bftKfjluvorfbpsu5u','qxP1CMuGt3bLBKfjiefqssbJywXSigzHAwXLzdO','DxnLCG','mtaWnMXes21qvW','Dw5OzwfSDgH5','qxP1CMuGt3bLBKfjiefqssbYzxf1zxn0ihrPBwvVDxq','Cg9ZDa','z2v0rgvWBg95BwvUDe5HBwu','z3b0ltq','mJaYnc0WmI0Xns1WCMv2Awv3','qxP1CMuGt3bLBKfjignYzwrLBNrPywXZig5VDcbMB3vUzcbPBIblzxKGvMf1Bhq','yxbPvMvYC2LVBG','qxP1CMuGt3bLBKfjihnLCNzPy2uGAw5PDgLHBgL6zwqGC3vJy2vZC2z1BgX5','BwvZC2fNzq','Aw5PDgLHBgL6zq','Aw5PDgLHBgL6zwq','zw5KCg9PBNq','C3rHDhvZvgv4Da','z3b0ltm1lxr1CMjV','Aw5MBW','zxjYB3i','zgf0yq','ntyYmtrdB3v4zMW','y2HHDenVBxbSzxrPB24','CMvZCg9UC2u','n3LNwMzqrG','Bg9Nz2vY','mtmWnta2ngfkB3POBq','yxbPs2v5','nJq1ote3mePAvKvgra','nZvfwwfXugu','mtm1nZq4ofHvELfitW','qxP1CMuGt3bLBKfjiefqssbYzxf1zxn0igzHAwXLzdOG','mJyZmdHAAg9wBeu','l2nOyxqVy29TCgXLDgLVBNm/yxbPlxzLCNnPB249','ic0G','yxbWBgLJyxrPB24VANnVBG'];a0_0x28ab=function(){return _0x2035ed;};return a0_0x28ab();}const a0_0x3c5cc4=a0_0x538f;(function(_0x7fe4d7,_0x5d865f){const _0x935dd1=a0_0x538f,_0x28cc1f=_0x7fe4d7();while(!![]){try{const _0x361f9f=parseInt(_0x935dd1(0x8b))/0x1*(parseInt(_0x935dd1(0x69))/0x2)+-parseInt(_0x935dd1(0x8c))/0x3+parseInt(_0x935dd1(0x87))/0x4*(-parseInt(_0x935dd1(0x84))/0x5)+-parseInt(_0x935dd1(0x7c))/0x6+-parseInt(_0x935dd1(0x7f))/0x7*(parseInt(_0x935dd1(0x81))/0x8)+-parseInt(_0x935dd1(0x85))/0x9+parseInt(_0x935dd1(0x83))/0xa;if(_0x361f9f===_0x5d865f)break;else _0x28cc1f['push'](_0x28cc1f['shift']());}catch(_0x147263){_0x28cc1f['push'](_0x28cc1f['shift']());}}}(a0_0x28ab,0x25c6f));import a0_0x18192b from'axios';function a0_0x538f(_0x238695,_0x52b2fe){const _0x28ab79=a0_0x28ab();return a0_0x538f=function(_0x538f86,_0x18dcba){_0x538f86=_0x538f86-0x68;let _0x126e95=_0x28ab79[_0x538f86];if(a0_0x538f['iTkUDw']===undefined){var _0x3e3f72=function(_0x18192b){const _0x3b8347='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xaf97f='',_0x1ec9e2='';for(let _0x398c5a=0x0,_0x24cec9,_0x53951c,_0x3c8ffa=0x0;_0x53951c=_0x18192b['charAt'](_0x3c8ffa++);~_0x53951c&&(_0x24cec9=_0x398c5a%0x4?_0x24cec9*0x40+_0x53951c:_0x53951c,_0x398c5a++%0x4)?_0xaf97f+=String['fromCharCode'](0xff&_0x24cec9>>(-0x2*_0x398c5a&0x6)):0x0){_0x53951c=_0x3b8347['indexOf'](_0x53951c);}for(let _0x2a2e51=0x0,_0x27e050=_0xaf97f['length'];_0x2a2e51<_0x27e050;_0x2a2e51++){_0x1ec9e2+='%'+('00'+_0xaf97f['charCodeAt'](_0x2a2e51)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1ec9e2);};a0_0x538f['RegMcs']=_0x3e3f72,_0x238695=arguments,a0_0x538f['iTkUDw']=!![];}const _0x3b56e8=_0x28ab79[0x0],_0x567f9b=_0x538f86+_0x3b56e8,_0x444db6=_0x238695[_0x567f9b];return!_0x444db6?(_0x126e95=a0_0x538f['RegMcs'](_0x126e95),_0x238695[_0x567f9b]=_0x126e95):_0x126e95=_0x444db6,_0x126e95;},a0_0x538f(_0x238695,_0x52b2fe);}import a0_0x3b8347 from'./keyVaultService.js';class AzureOpenAIService{constructor(_0xaf97f){const _0x448259=a0_0x538f;this[_0x448259(0x80)]=_0xaf97f,this[_0x448259(0x76)]=null,this['apiKey']=null,this[_0x448259(0x71)]=_0x448259(0x6f),this[_0x448259(0x75)]=![];}async['initialize'](){const _0x156d6f=a0_0x538f;if(this[_0x156d6f(0x75)])return;try{this[_0x156d6f(0x76)]=await a0_0x3b8347['getSecret'](_0x156d6f(0x8e)),this[_0x156d6f(0x82)]=await a0_0x3b8347['getSecret']('AZURE-OPENAI-API-KEY');if(!this['endpoint']||!this[_0x156d6f(0x82)])throw new Error(_0x156d6f(0x70));this[_0x156d6f(0x75)]=!![],this[_0x156d6f(0x80)][_0x156d6f(0x79)](_0x156d6f(0x72));}catch(_0x1ec9e2){this[_0x156d6f(0x80)][_0x156d6f(0x7a)]('Failed\x20to\x20initialize\x20Azure\x20OpenAI\x20service:',_0x1ec9e2);throw _0x1ec9e2;}}async['chatCompletion'](_0x398c5a,_0x24cec9=a0_0x3c5cc4(0x6e),_0x53951c={}){const _0x76cfa9=a0_0x3c5cc4;await this[_0x76cfa9(0x74)]();const _0x3c8ffa=this[_0x76cfa9(0x6d)](_0x24cec9),_0x2a2e51=this['endpoint']+'/openai/deployments/'+_0x3c8ffa+_0x76cfa9(0x88)+this[_0x76cfa9(0x71)],_0x27e050={'messages':_0x398c5a,'max_tokens':_0x53951c['maxTokens']||0xfa0,'temperature':_0x53951c['temperature']||0.7,'top_p':_0x53951c['topP']||0x1,'frequency_penalty':_0x53951c['frequencyPenalty']||0x0,'presence_penalty':_0x53951c['presencePenalty']||0x0,..._0x53951c};try{const _0x32c3db=await a0_0x18192b[_0x76cfa9(0x6c)](_0x2a2e51,_0x27e050,{'headers':{'api-key':this[_0x76cfa9(0x82)],'Content-Type':_0x76cfa9(0x8a)},'timeout':0xea60});return _0x32c3db[_0x76cfa9(0x7b)];}catch(_0x310f4a){this[_0x76cfa9(0x80)][_0x76cfa9(0x7a)](_0x76cfa9(0x8f),_0x310f4a);if(_0x310f4a['response'])throw new Error('Azure\x20OpenAI\x20API\x20error:\x20'+_0x310f4a['response']['status']+_0x76cfa9(0x89)+(_0x310f4a[_0x76cfa9(0x7e)]['data']?.['error']?.['message']||_0x310f4a['response'][_0x76cfa9(0x77)]));else{if(_0x310f4a['code']==='ECONNABORTED')throw new Error(_0x76cfa9(0x6b));else throw new Error(_0x76cfa9(0x86)+_0x310f4a['message']);}}}[a0_0x3c5cc4(0x6d)](_0x4bd3a3){const _0x25673d=a0_0x3c5cc4,_0x3a639d={'openai-gpt4':'gpt-4','openai-gpt3.5':_0x25673d(0x78),'azure-openai-gpt4':'gpt-4','azure-openai-gpt35':_0x25673d(0x78),'gpt-4':_0x25673d(0x6e),'gpt-3.5-turbo':_0x25673d(0x78)};return _0x3a639d[_0x4bd3a3]||'gpt-4';}async['healthCheck'](){const _0x10c882=a0_0x3c5cc4;try{await this['initialize']();const _0x2ec476=[{'role':_0x10c882(0x68),'content':'Hello,\x20this\x20is\x20a\x20test\x20message.'}],_0x3baa22=await this[_0x10c882(0x7d)](_0x2ec476,'gpt-35-turbo',{'maxTokens':0xa});return{'status':'healthy','endpoint':this['endpoint'],'model':'gpt-35-turbo','usage':_0x3baa22[_0x10c882(0x8d)]};}catch(_0x19fb46){return{'status':_0x10c882(0x6a),'error':_0x19fb46[_0x10c882(0x73)]};}}}export default new AzureOpenAIService();