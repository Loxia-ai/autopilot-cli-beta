const a0_0x3ae79c=a0_0x1337;(function(_0x666d29,_0x1a9c52){const _0x3e6cde=a0_0x1337,_0x5881b6=_0x666d29();while(!![]){try{const _0xbfdaf3=-parseInt(_0x3e6cde(0x123))/0x1*(parseInt(_0x3e6cde(0x12f))/0x2)+-parseInt(_0x3e6cde(0x124))/0x3*(-parseInt(_0x3e6cde(0x141))/0x4)+-parseInt(_0x3e6cde(0x12a))/0x5+parseInt(_0x3e6cde(0x131))/0x6+-parseInt(_0x3e6cde(0x121))/0x7*(-parseInt(_0x3e6cde(0x138))/0x8)+-parseInt(_0x3e6cde(0x12d))/0x9*(-parseInt(_0x3e6cde(0x12c))/0xa)+-parseInt(_0x3e6cde(0x133))/0xb;if(_0xbfdaf3===_0x1a9c52)break;else _0x5881b6['push'](_0x5881b6['shift']());}catch(_0xda1484){_0x5881b6['push'](_0x5881b6['shift']());}}}(a0_0x3a72,0x7dd96));function a0_0x3a72(){const _0x5a0231=['zxjYB3i','z2v0u2vJCMv0','odG5mZy1DMTmvMPg','z2v0rgvWBg95BwvUDe5HBwu','mtbkyvzhugm','ndy2ndCYn014yNvetG','runptK5bqK9sveve','otKYmZr5zvj1u1i','Bwf4vg9Rzw5Z','nJa3mJqZmLb3BMPfqG','BwvZC2fNzq','nZm2nte3mwDKtvD6Dq','zw5KCg9PBNq','ic0G','Aw5PDgLHBgL6zq','z3b0ltm1lxr1CMjV','ndHhu2nIvNq','yxbPs2v5','z3b0ltq','Aw5PDgLHBgL6zwq','rMfPBgvKihrVigLUAxrPywXPEMuGqxP1CMuGt3bLBKfjihnLCNzPy2u6','zNjLCxvLBMn5ugvUywX0Eq','DgvTCgvYyxr1CMu','mJaYnc0WmI0Xns1WCMv2Awv3','y2HHDenVBxbSzxrPB24','mZq4EfHiBKDO','DxnHz2u','CMvZCg9UC2u','Dg9Wua','Aw5MBW','mty4otmXy25zvMrz','Bg9Nz2vY','mJboC1zMv3u','mJm0ntf2uuntvLm','l2nOyxqVy29TCgXLDgLVBNm/yxbPlxzLCNnPB249','C3rHDhvZ','qxP1CMuGt3bLBKfjiefqssbYzxf1zxn0ihrPBwvVDxq'];a0_0x3a72=function(){return _0x5a0231;};return a0_0x3a72();}import a0_0x4a23ba from'axios';function a0_0x1337(_0x241595,_0x2b6afc){const _0x3a72f9=a0_0x3a72();return a0_0x1337=function(_0x1337cd,_0x5cea96){_0x1337cd=_0x1337cd-0x11e;let _0x493969=_0x3a72f9[_0x1337cd];if(a0_0x1337['FMJaUf']===undefined){var _0x19948d=function(_0x4a23ba){const _0x5dd64b='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x535443='',_0x2cd33e='';for(let _0x1118a4=0x0,_0x287fec,_0xaba090,_0x4216d2=0x0;_0xaba090=_0x4a23ba['charAt'](_0x4216d2++);~_0xaba090&&(_0x287fec=_0x1118a4%0x4?_0x287fec*0x40+_0xaba090:_0xaba090,_0x1118a4++%0x4)?_0x535443+=String['fromCharCode'](0xff&_0x287fec>>(-0x2*_0x1118a4&0x6)):0x0){_0xaba090=_0x5dd64b['indexOf'](_0xaba090);}for(let _0x5c41db=0x0,_0x53a70b=_0x535443['length'];_0x5c41db<_0x53a70b;_0x5c41db++){_0x2cd33e+='%'+('00'+_0x535443['charCodeAt'](_0x5c41db)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2cd33e);};a0_0x1337['wlFWQV']=_0x19948d,_0x241595=arguments,a0_0x1337['FMJaUf']=!![];}const _0x4e10d7=_0x3a72f9[0x0],_0x2dfcbc=_0x1337cd+_0x4e10d7,_0x5c973b=_0x241595[_0x2dfcbc];return!_0x5c973b?(_0x493969=a0_0x1337['wlFWQV'](_0x493969),_0x241595[_0x2dfcbc]=_0x493969):_0x493969=_0x5c973b,_0x493969;},a0_0x1337(_0x241595,_0x2b6afc);}import a0_0x5dd64b from'./keyVaultService.js';class AzureOpenAIService{constructor(_0x535443){const _0x2b7349=a0_0x1337;this['logger']=_0x535443,this['endpoint']=null,this['apiKey']=null,this['apiVersion']=_0x2b7349(0x13f),this['initialized']=![];}async['initialize'](){const _0x563817=a0_0x1337;if(this[_0x563817(0x13b)])return;try{this[_0x563817(0x134)]=await a0_0x5dd64b[_0x563817(0x129)]('AZURE-OPENAI-ENDPOINT'),this['apiKey']=await a0_0x5dd64b[_0x563817(0x129)]('AZURE-OPENAI-API-KEY');if(!this['endpoint']||!this[_0x563817(0x139)])throw new Error('Azure\x20OpenAI\x20credentials\x20not\x20found\x20in\x20Key\x20Vault');this['initialized']=!![],this[_0x563817(0x122)][_0x563817(0x120)]('Azure\x20OpenAI\x20service\x20initialized\x20successfully');}catch(_0x2cd33e){this[_0x563817(0x122)][_0x563817(0x128)](_0x563817(0x13c),_0x2cd33e);throw _0x2cd33e;}}async[a0_0x3ae79c(0x140)](_0x1118a4,_0x287fec=a0_0x3ae79c(0x13a),_0xaba090={}){const _0x4a9ffd=a0_0x3ae79c;await this[_0x4a9ffd(0x136)]();const _0x4216d2=this[_0x4a9ffd(0x12b)](_0x287fec),_0x5c41db=this['endpoint']+'/openai/deployments/'+_0x4216d2+_0x4a9ffd(0x125)+this['apiVersion'],_0x53a70b={'messages':_0x1118a4,'max_tokens':_0xaba090[_0x4a9ffd(0x130)]||0xfa0,'temperature':_0xaba090[_0x4a9ffd(0x13e)]||0.7,'top_p':_0xaba090[_0x4a9ffd(0x11f)]||0x1,'frequency_penalty':_0xaba090[_0x4a9ffd(0x13d)]||0x0,'presence_penalty':_0xaba090['presencePenalty']||0x0,..._0xaba090};try{const _0xb10779=await a0_0x4a23ba['post'](_0x5c41db,_0x53a70b,{'headers':{'api-key':this[_0x4a9ffd(0x139)],'Content-Type':'application/json'},'timeout':0xea60});return _0xb10779['data'];}catch(_0x3954ec){this[_0x4a9ffd(0x122)]['error']('Azure\x20OpenAI\x20API\x20call\x20failed:',_0x3954ec);if(_0x3954ec[_0x4a9ffd(0x11e)])throw new Error('Azure\x20OpenAI\x20API\x20error:\x20'+_0x3954ec['response'][_0x4a9ffd(0x126)]+_0x4a9ffd(0x135)+(_0x3954ec[_0x4a9ffd(0x11e)]['data']?.['error']?.[_0x4a9ffd(0x132)]||_0x3954ec[_0x4a9ffd(0x11e)]['statusText']));else{if(_0x3954ec['code']===_0x4a9ffd(0x12e))throw new Error(_0x4a9ffd(0x127));else throw new Error('Azure\x20OpenAI\x20API\x20request\x20failed:\x20'+_0x3954ec['message']);}}}['getDeploymentName'](_0x5975a3){const _0x3ab0df=a0_0x3ae79c,_0x4577aa={'openai-gpt4':'gpt-4','openai-gpt3.5':_0x3ab0df(0x137),'azure-openai-gpt4':_0x3ab0df(0x13a),'azure-openai-gpt35':_0x3ab0df(0x137),'gpt-4':'gpt-4','gpt-3.5-turbo':'gpt-35-turbo'};return _0x4577aa[_0x5975a3]||'gpt-4';}async['healthCheck'](){const _0x267535=a0_0x3ae79c;try{await this[_0x267535(0x136)]();const _0x133612=[{'role':'user','content':'Hello,\x20this\x20is\x20a\x20test\x20message.'}],_0x530fd8=await this[_0x267535(0x140)](_0x133612,'gpt-35-turbo',{'maxTokens':0xa});return{'status':'healthy','endpoint':this['endpoint'],'model':'gpt-35-turbo','usage':_0x530fd8[_0x267535(0x142)]};}catch(_0x3c9c1c){return{'status':'unhealthy','error':_0x3c9c1c['message']};}}}export default new AzureOpenAIService();