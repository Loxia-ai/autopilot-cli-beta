const a0_0x1e7010=a0_0x4c53;(function(_0x23ad39,_0x16e9e9){const _0xe6a1d2=a0_0x4c53,_0x5a4b03=_0x23ad39();while(!![]){try{const _0x18d611=parseInt(_0xe6a1d2(0x136))/0x1+parseInt(_0xe6a1d2(0x122))/0x2*(parseInt(_0xe6a1d2(0x10f))/0x3)+parseInt(_0xe6a1d2(0x12f))/0x4+parseInt(_0xe6a1d2(0x123))/0x5*(-parseInt(_0xe6a1d2(0x115))/0x6)+-parseInt(_0xe6a1d2(0x139))/0x7*(parseInt(_0xe6a1d2(0x11c))/0x8)+parseInt(_0xe6a1d2(0x12c))/0x9*(-parseInt(_0xe6a1d2(0x124))/0xa)+-parseInt(_0xe6a1d2(0x110))/0xb*(-parseInt(_0xe6a1d2(0x12b))/0xc);if(_0x18d611===_0x16e9e9)break;else _0x5a4b03['push'](_0x5a4b03['shift']());}catch(_0x21dcdb){_0x5a4b03['push'](_0x5a4b03['shift']());}}}(a0_0x246b,0x24b51));import a0_0x415f38 from'path';function a0_0x4c53(_0x4f612d,_0x3d9150){const _0x246be9=a0_0x246b();return a0_0x4c53=function(_0x4c5316,_0x3804b9){_0x4c5316=_0x4c5316-0xfa;let _0x423e26=_0x246be9[_0x4c5316];if(a0_0x4c53['uQWFLo']===undefined){var _0x244d9e=function(_0x415f38){const _0x52d5c6='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x17aada='',_0x4df588='';for(let _0x1713f6=0x0,_0x540e76,_0xfe8592,_0x48e4cd=0x0;_0xfe8592=_0x415f38['charAt'](_0x48e4cd++);~_0xfe8592&&(_0x540e76=_0x1713f6%0x4?_0x540e76*0x40+_0xfe8592:_0xfe8592,_0x1713f6++%0x4)?_0x17aada+=String['fromCharCode'](0xff&_0x540e76>>(-0x2*_0x1713f6&0x6)):0x0){_0xfe8592=_0x52d5c6['indexOf'](_0xfe8592);}for(let _0x2f746f=0x0,_0x23e99c=_0x17aada['length'];_0x2f746f<_0x23e99c;_0x2f746f++){_0x4df588+='%'+('00'+_0x17aada['charCodeAt'](_0x2f746f)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x4df588);};a0_0x4c53['gxUQrd']=_0x244d9e,_0x4f612d=arguments,a0_0x4c53['uQWFLo']=!![];}const _0x5d0b73=_0x246be9[0x0],_0x463e33=_0x4c5316+_0x5d0b73,_0x3a965=_0x4f612d[_0x463e33];return!_0x3a965?(_0x423e26=a0_0x4c53['gxUQrd'](_0x423e26),_0x4f612d[_0x463e33]=_0x423e26):_0x423e26=_0x3a965,_0x423e26;},a0_0x4c53(_0x4f612d,_0x3d9150);}import{promises as a0_0x52d5c6}from'fs';function a0_0x246b(){const _0x11abb4=['igrVzxmGBM90igHHDMuGysbNzxrezxnJCMLWDgLVBIbTzxrOB2q','Bg9Nz2vY','zxjYB3i','lI4VDg9VBhmVDxbKyxrLvxnLCLrVB2WUANm','lI4VDg9VBhmVDwLuB29SlMPZ','lI4VDg9VBhmVzMLSzvrYzwvuB29SlMPZ','u2H1DhrPBMCGzg93BIb0B29SoIa','DwLuB29S','m3zeuvf1DG','nJznENDxBLq','Aw1Hz2uTz2vU','AgfZ','z2v0vg9VBhnezxnJCMLWDgLVBG','C2v0','nZe0mJm0DKfgCgj1','ChvZAa','C2H1DgrVD24','z2v0','z2v0vg9VBerLC2nYAxb0Aw9U','y29UzMLN','Aw5MBW','oezQBK5qCq','CMvNAxn0zxjuB29S','ig5VDcbMB3vUzcbPBIbYzwDPC3rYEq','yNjVD3nLCG','ChjVAMvJDerPCG','vg9VBcbjrdOG','mZyYmtKWDMrfvvn5','mtbrqwXTDgy','mtb4vgzuBLa','vg9VBca','Dg9VBhm','CMvNAxn0zxjcDwLSDeLUvg9VBhm','qxzHAwXHyMXLihrVB2XZoGOk','qwXSihrVB2XZihnODxqGzg93BG','lI4VDg9VBhmVzMLSzvn5C3rLBvrVB2WUANm','nZqYnJGWqNniwe5c','mJm0mZa2ovrXq05esW','vxbKyxrLzcbWCM9Qzwn0igrPCMvJDg9YEsbMB3iGDg9VBhm6ia','Dg9VBerLC2nYAxb0Aw9UCW','mJi5mtqWyu91Du9m','zw5HyMXLza','C2v0uhjVAMvJDerPCMvJDg9YEq','DxbKyxrLlxvZzxi','A2v5CW','lI4VDg9VBhmVzgvWzw5Kzw5JEvjLC29SDMvYvg9VBc5QCW','lI4VDg9VBhmVyNjVD3nLCLrVB2WUANm','mti3mtK3A25Lz2Pb','z2v0rgvZy3jPChrPB24','zNvUy3rPB24','nJe3mde1CwjrEunn','C2L6zq','zxHLy3v0zq','zNjVBq','BgXTu2vYDMLJzq','zgvWlxjLC29SDMvY','z2v0vg9VBeLKCW','C2v0teXnu2vYDMLJzq','DgvYBwLUywW','rxjYB3iGCMvNAxn0zxjPBMCGyNvPBhqTAw4GDg9VBhm6','y3jLyxrLvg9VBhntExn0zw1qCM9TChq','AgfZvg9VBa','zMLSzs1JB250zw50lxjLCgXHy2u','rwfJAcb0B29SigHHCYbPDhmGB3DUihnWzwnPzMLJigzVCM1HDcbMB3iGy29TBwfUzhmGyxmGzgvZy3jPyMvKigfIB3zLlG'];a0_0x246b=function(){return _0x11abb4;};return a0_0x246b();}export class ToolRegistry{constructor(_0x17aada,_0x4df588,_0x1713f6=null,_0x540e76=null){const _0x188cd5=a0_0x4c53;this[_0x188cd5(0x11a)]=_0x17aada,this['logger']=_0x4df588,this[_0x188cd5(0x120)]=_0x540e76,this['llmService']=_0x1713f6,this[_0x188cd5(0x126)]=new Map(),this[_0x188cd5(0x12e)]=new Map(),this[_0x188cd5(0x127)]();}[a0_0x1e7010(0x100)](_0xfe8592){const _0x3a12c4=a0_0x1e7010;this[_0x3a12c4(0xfd)]=_0xfe8592;if(this['tools'][_0x3a12c4(0x112)](_0x3a12c4(0x11f))){const _0x48e4cd=this['tools'][_0x3a12c4(0x118)]('browser');_0x48e4cd[_0x3a12c4(0x100)](_0xfe8592),this['logger']['info']('Updated\x20browser\x20tool\x20with\x20LLM\x20service\x20for\x20vision\x20capabilities');}if(this[_0x3a12c4(0x126)]['has'](_0x3a12c4(0x111))){const _0x2f746f=this['tools'][_0x3a12c4(0x118)](_0x3a12c4(0x111));_0x2f746f[_0x3a12c4(0x100)](_0xfe8592),this[_0x3a12c4(0x108)][_0x3a12c4(0x11b)]('Updated\x20image\x20tool\x20with\x20LLM\x20service\x20for\x20image\x20generation');}}['setProjectDirectory'](_0x23e99c){const _0x38aea6=a0_0x1e7010;this[_0x38aea6(0x120)]=_0x23e99c;const _0x17939f=this['tools'][_0x38aea6(0x118)](_0x38aea6(0x101));_0x17939f&&typeof _0x17939f[_0x38aea6(0x131)]==='function'&&_0x17939f['setProjectDirectory'](_0x23e99c),this['logger'][_0x38aea6(0x11b)](_0x38aea6(0x12d)+_0x23e99c);}async[a0_0x1e7010(0x127)](){const _0x2246ea=a0_0x1e7010;this['logger']['info']('Registering\x20built-in\x20tools');try{const {BrowserTool:_0x2cf149}=await import(_0x2246ea(0x135)),_0x5a8ba5=new _0x2cf149(this['config'],this[_0x2246ea(0x108)],this[_0x2246ea(0xfd)]);this[_0x2246ea(0x11d)](_0x2246ea(0x11f),_0x5a8ba5);const {TerminalTool:_0x37ce77}=await import('../tools/terminalTool.js'),_0x3167bd=new _0x37ce77(this['config'],this[_0x2246ea(0x108)],undefined,this['projectDir']);this[_0x2246ea(0x11d)]('terminal',_0x3167bd);const {FileSystemTool:_0x1b87e8}=await import(_0x2246ea(0x12a)),_0xff4e1a=new _0x1b87e8(this['config'],this[_0x2246ea(0x108)]);this[_0x2246ea(0x11d)]('filesys',_0xff4e1a);const {ImageTool:_0x168fb5}=await import('../tools/imageTool.js'),_0x2791e3=new _0x168fb5(this[_0x2246ea(0x11a)],this[_0x2246ea(0x108)],this[_0x2246ea(0xfd)]);this['registerTool'](_0x2246ea(0x111),_0x2791e3);const {FileTreeTool:_0x1f8d7f}=await import(_0x2246ea(0x10c)),_0x1894d8=new _0x1f8d7f(this[_0x2246ea(0x11a)],this['logger']);this['registerTool']('file-tree',_0x1894d8);const {SeekTool:_0x4b882b}=await import('../tools/seekTool.js'),_0x186114=new _0x4b882b(this[_0x2246ea(0x11a)],this['logger']);this[_0x2246ea(0x11d)]('seek',_0x186114);const {MemoryTool:_0x9aed56}=await import('../tools/memoryTool.js'),_0x17b30f=new _0x9aed56(this[_0x2246ea(0x11a)],this[_0x2246ea(0x108)]);this['registerTool']('memory',_0x17b30f);const {CodeAnalysisTool:_0x535fcb}=await import('../tools/codeAnalysisTool.js'),_0x1c5fa1=new _0x535fcb(this['config'],this[_0x2246ea(0x108)]);this[_0x2246ea(0x11d)]('code-analysis',_0x1c5fa1);const {FileContentReplaceTool:_0x3621f8}=await import('../tools/fileContentReplaceTool.js'),_0xf5cf83=new _0x3621f8(this['config'],this[_0x2246ea(0x108)]);this[_0x2246ea(0x11d)](_0x2246ea(0x105),_0xf5cf83);if(this[_0x2246ea(0x11a)][_0x2246ea(0x126)]?.['mcpTool']?.['enabled']){const _0x4bdc60=new MCPClientTool(this[_0x2246ea(0x11a)],this['logger']);this[_0x2246ea(0x11d)]('mcp-client',_0x4bdc60);}if(this['config'][_0x2246ea(0x126)]?.[_0x2246ea(0x10e)]?.[_0x2246ea(0x130)]){const _0x2c6eb0=await import(_0x2246ea(0x10b)),_0x2a26e0=new _0x2c6eb0(this['config'],this[_0x2246ea(0x108)]);this['registerTool']('ui',_0x2a26e0);}const {UpdateUserTool:_0x15aec7}=await import(_0x2246ea(0x10a)),_0x2c0507=new _0x15aec7(this['config'],this[_0x2246ea(0x108)]);this[_0x2246ea(0x11d)](_0x2246ea(0x132),_0x2c0507);const {DependencyResolverTool:_0xe9b046}=await import(_0x2246ea(0x134)),_0x6fccd1=new _0xe9b046(this['config'],this['logger']);this[_0x2246ea(0x11d)](_0x2246ea(0xfe),_0x6fccd1);const {ImportAnalyzerTool:_0x2d280d}=await import('../tools/importAnalyzerTool.js'),_0x1d3813=new _0x2d280d(this['config'],this['logger']);this[_0x2246ea(0x11d)]('import-analyzer',_0x1d3813),this[_0x2246ea(0x108)]['info']('Registered\x20'+this['tools'][_0x2246ea(0xfa)]+'\x20tools');}catch(_0xb3a828){this['logger'][_0x2246ea(0x109)](_0x2246ea(0x102),_0xb3a828);throw _0xb3a828;}}['registerTool'](_0x57ecb5,_0x4a7a57){const _0x2d4492=a0_0x1e7010;this['logger'][_0x2d4492(0x11b)]('Registering\x20tool:\x20'+_0x57ecb5);if(typeof _0x4a7a57[_0x2d4492(0xfb)]!==_0x2d4492(0x138))throw new Error('Tool\x20'+_0x57ecb5+'\x20does\x20not\x20have\x20an\x20execute\x20method');if(typeof _0x4a7a57[_0x2d4492(0x137)]!=='function')throw new Error('Tool\x20'+_0x57ecb5+_0x2d4492(0x107));this['tools'][_0x2d4492(0x114)](_0x57ecb5,_0x4a7a57),this[_0x2d4492(0x12e)][_0x2d4492(0x114)](_0x57ecb5,_0x4a7a57['getDescription']());}[a0_0x1e7010(0x104)](_0x2db3a3){const _0x1b48de=a0_0x1e7010;return this[_0x1b48de(0x126)]['has'](_0x2db3a3);}['getTool'](_0x30a142){const _0x2c577a=a0_0x1e7010;if(!this[_0x2c577a(0x126)]['has'](_0x30a142))throw new Error('Tool\x20'+_0x30a142+_0x2c577a(0x11e));return this['tools'][_0x2c577a(0x118)](_0x30a142);}[a0_0x1e7010(0xff)](){const _0x48485d=a0_0x1e7010;return Array[_0x48485d(0xfc)](this[_0x48485d(0x126)][_0x48485d(0x133)]());}[a0_0x1e7010(0x113)](){const _0xcc04e4=a0_0x1e7010;let _0x1cf62d='';for(const [_0x504081,_0x15882e]of this[_0xcc04e4(0x12e)]['entries']()){_0x1cf62d+=_0xcc04e4(0x121)+_0x504081+'\x0a',_0x1cf62d+=_0x15882e+'\x0a\x0a';}return _0x1cf62d;}[a0_0x1e7010(0x119)](_0x2abeaa){const _0x3c357d=a0_0x1e7010;if(!this[_0x3c357d(0x12e)][_0x3c357d(0x112)](_0x2abeaa))throw new Error(_0x3c357d(0x125)+_0x2abeaa+_0x3c357d(0x11e));return this[_0x3c357d(0x12e)]['get'](_0x2abeaa);}[a0_0x1e7010(0x103)](){const _0x18ea69=a0_0x1e7010;let _0x41f803=_0x18ea69(0x128);for(const [_0x212264,_0x518adc]of this[_0x18ea69(0x12e)]['entries']()){_0x41f803+='##\x20'+_0x212264+'\x0a',_0x41f803+=_0x518adc+'\x0a\x0a';}return _0x41f803+='To\x20use\x20a\x20tool,\x20wrap\x20your\x20commands\x20in\x20[tools-commands]\x20and\x20[/tools-commands]\x20tags.\x0a',_0x41f803+='For\x20each\x20tool,\x20use\x20[tool\x20id=\x22tool_id\x22]\x20and\x20[/tool]\x20tags\x20to\x20specify\x20which\x20tool\x20to\x20use.\x0a',_0x41f803+=_0x18ea69(0x106),_0x41f803;}async[a0_0x1e7010(0x117)](){const _0x354ac=a0_0x1e7010;this['logger']['info']('Shutting\x20down\x20all\x20tools');const _0x2a22c0=[];for(const [_0x3334f3,_0x239b0b]of this['tools']['entries']()){typeof _0x239b0b[_0x354ac(0x117)]==='function'&&(this[_0x354ac(0x108)][_0x354ac(0x11b)](_0x354ac(0x10d)+_0x3334f3),_0x2a22c0[_0x354ac(0x116)](_0x239b0b[_0x354ac(0x117)]()));}await Promise['allSettled'](_0x2a22c0),this['logger'][_0x354ac(0x11b)](_0x354ac(0x129));}}