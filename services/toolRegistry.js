function a0_0x5356(){const _0x3008a5=['rxjYB3iGCMvNAxn0zxjPBMCGyNvPBhqTAw4GDg9VBhm6','mty5nZbODvDkDMm','lI4VDg9VBhmVDwLuB29SlMPZ','lI4VDg9VBhmVzMLSzunVBNrLBNrszxbSywnLvg9VBc5QCW','AgfZ','yNjVD3nLCG','nJCYvxvZy2vY','y3jLyxrLvg9VBhntExn0zw1qCM9TChq','mJKZnJmYmMHAB0PJqG','ChvZAa','mZm5zKT5wg5U','zw50CMLLCW','lI4VDg9VBhmVC2vLA1rVB2WUANm','lI4VDg9VBhmVy29KzufUywX5C2LZvg9VBc5QCW','mZeXnJiYwKTxsLzM','nta0mtuZnKTvsgjmvG','vg9VBca','CMvNAxn0zxjcDwLSDeLUvg9VBhm','ndq0ndy2AxrNDfLS','lI4VDg9VBhmVzMLSzvn5C3rLBvrVB2WUANm','y29UzMLN','zMLSzs1JB250zw50lxjLCgXHy2u','z2v0','C2v0teXnu2vYDMLJzq','vg8GDxnLigeGDg9VBcWGD3jHCcb5B3vYignVBw1HBMrZigLUifT0B29SCY1JB21Tyw5KC10Gyw5KifSVDg9VBhmTy29TBwfUzhnDihrHz3mUcG','ChjVAMvJDerPCG','Bg9Nz2vY','BgXTu2vYDMLJzq','BwvTB3j5','mtu3nJmXmMX2ALPHzq','DxbKyxrLlxvZzxi','z2v0vg9VBerLC2nYAxb0Aw9U','vxbKyxrLzcbWCM9Qzwn0igrPCMvJDg9YEsbMB3iGDg9VBhm6ia','zNvUy3rPB24','ihrVB2XZ','ig5VDcbMB3vUzcbPBIbYzwDPC3rYEq','zMLSzxn5CW','Aw5MBW','Dg9VBerLC2nYAxb0Aw9UCW','CMvNAxn0zxjuB29S','zw5HyMXLza','AgfZvg9VBa','DgvYBwLUywW','z2v0vg9VBeLKCW','mtboEgrOyuy','ndq3ntbkD2Psv0S','BwnWvg9VBa','z2v0rgvZy3jPChrPB24','lI4VDg9VBhmVBwvTB3j5vg9VBc5QCW','uMvNAxn0zxjPBMCGDg9VBdOG','mJCYqw1rELb6','qxzHAwXHyMXLihrVB2XZoGOk','lI4VDg9VBhmVAw1Hz2vuB29SlMPZ','C2v0uhjVAMvJDerPCMvJDg9YEq','C2H1DgrVD24','mtmZwuTcywPM','vg9VBcbjrdOG','lI4VDg9VBhmVzMLSzvrYzwvuB29SlMPZ','Dg9VBhm'];a0_0x5356=function(){return _0x3008a5;};return a0_0x5356();}const a0_0x11db3f=a0_0x44d2;function a0_0x44d2(_0x1409ae,_0x21237d){const _0x535675=a0_0x5356();return a0_0x44d2=function(_0x44d25e,_0x4b899b){_0x44d25e=_0x44d25e-0x14f;let _0x1bbb97=_0x535675[_0x44d25e];if(a0_0x44d2['BEVlOf']===undefined){var _0x7bc44c=function(_0x58720b){const _0x1b41e9='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1ae58c='',_0x8dd054='';for(let _0x34b91c=0x0,_0x1714fd,_0x377b14,_0x1817d6=0x0;_0x377b14=_0x58720b['charAt'](_0x1817d6++);~_0x377b14&&(_0x1714fd=_0x34b91c%0x4?_0x1714fd*0x40+_0x377b14:_0x377b14,_0x34b91c++%0x4)?_0x1ae58c+=String['fromCharCode'](0xff&_0x1714fd>>(-0x2*_0x34b91c&0x6)):0x0){_0x377b14=_0x1b41e9['indexOf'](_0x377b14);}for(let _0x283d3f=0x0,_0x17b961=_0x1ae58c['length'];_0x283d3f<_0x17b961;_0x283d3f++){_0x8dd054+='%'+('00'+_0x1ae58c['charCodeAt'](_0x283d3f)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x8dd054);};a0_0x44d2['IRcyMD']=_0x7bc44c,_0x1409ae=arguments,a0_0x44d2['BEVlOf']=!![];}const _0x3d9dea=_0x535675[0x0],_0x3f6d61=_0x44d25e+_0x3d9dea,_0x2b70fd=_0x1409ae[_0x3f6d61];return!_0x2b70fd?(_0x1bbb97=a0_0x44d2['IRcyMD'](_0x1bbb97),_0x1409ae[_0x3f6d61]=_0x1bbb97):_0x1bbb97=_0x2b70fd,_0x1bbb97;},a0_0x44d2(_0x1409ae,_0x21237d);}(function(_0x4c3fc9,_0xe2c3c6){const _0x1a5a4a=a0_0x44d2,_0x264408=_0x4c3fc9();while(!![]){try{const _0x55357e=parseInt(_0x1a5a4a(0x186))/0x1+-parseInt(_0x1a5a4a(0x16a))/0x2*(-parseInt(_0x1a5a4a(0x173))/0x3)+parseInt(_0x1a5a4a(0x160))/0x4*(parseInt(_0x1a5a4a(0x15b))/0x5)+-parseInt(_0x1a5a4a(0x177))/0x6*(-parseInt(_0x1a5a4a(0x165))/0x7)+-parseInt(_0x1a5a4a(0x178))/0x8+-parseInt(_0x1a5a4a(0x171))/0x9*(parseInt(_0x1a5a4a(0x15a))/0xa)+-parseInt(_0x1a5a4a(0x17b))/0xb*(parseInt(_0x1a5a4a(0x16f))/0xc);if(_0x55357e===_0xe2c3c6)break;else _0x264408['push'](_0x264408['shift']());}catch(_0x3e9f96){_0x264408['push'](_0x264408['shift']());}}}(a0_0x5356,0xde7e6));import a0_0x58720b from'path';import{promises as a0_0x1b41e9}from'fs';export class ToolRegistry{constructor(_0x1ae58c,_0x8dd054,_0x34b91c=null,_0x1714fd=null){const _0x250ea2=a0_0x44d2;this[_0x250ea2(0x17d)]=_0x1ae58c,this['logger']=_0x8dd054,this[_0x250ea2(0x182)]=_0x1714fd,this[_0x250ea2(0x184)]=_0x34b91c,this['tools']=new Map(),this['toolDescriptions']=new Map(),this['registerBuiltInTools']();}[a0_0x11db3f(0x180)](_0x377b14){const _0x378aa8=a0_0x11db3f;this['llmService']=_0x377b14;if(this[_0x378aa8(0x168)]['has']('browser')){const _0x1817d6=this['tools']['get'](_0x378aa8(0x16e));_0x1817d6['setLLMService'](_0x377b14),this[_0x378aa8(0x183)][_0x378aa8(0x153)]('Updated\x20browser\x20tool\x20with\x20LLM\x20service\x20for\x20vision\x20capabilities');}}['setProjectDirectory'](_0x283d3f){const _0x19c724=a0_0x11db3f;this[_0x19c724(0x182)]=_0x283d3f;const _0x17b961=this[_0x19c724(0x168)][_0x19c724(0x17f)]('terminal');_0x17b961&&typeof _0x17b961['setProjectDirectory']==='function'&&_0x17b961[_0x19c724(0x163)](_0x283d3f),this[_0x19c724(0x183)]['info'](_0x19c724(0x189)+_0x283d3f);}async[a0_0x11db3f(0x17a)](){const _0x1a8a06=a0_0x11db3f;this['logger']['info']('Registering\x20built-in\x20tools');try{const {BrowserTool:_0x4820b3}=await import('../tools/browserTool.js'),_0x1448d7=new _0x4820b3(this['config'],this['logger'],this['llmService']);this['registerTool']('browser',_0x1448d7);const {TerminalTool:_0x2c6d48}=await import('../tools/terminalTool.js'),_0x4ecde8=new _0x2c6d48(this[_0x1a8a06(0x17d)],this[_0x1a8a06(0x183)],undefined,this['projectDir']);this[_0x1a8a06(0x155)](_0x1a8a06(0x158),_0x4ecde8);const {FileSystemTool:_0x5e2a5e}=await import(_0x1a8a06(0x17c)),_0xb63b5=new _0x5e2a5e(this[_0x1a8a06(0x17d)],this['logger']);this['registerTool'](_0x1a8a06(0x152),_0xb63b5);const {ImageTool:_0x4a8a2e}=await import(_0x1a8a06(0x162)),_0xd1ca84=new _0x4a8a2e(this['config'],this['logger']);this['registerTool']('image-gen',_0xd1ca84);const {FileTreeTool:_0x389fef}=await import(_0x1a8a06(0x167)),_0x387ece=new _0x389fef(this['config'],this[_0x1a8a06(0x183)]);this['registerTool']('file-tree',_0x387ece);const {SeekTool:_0x1ae6e2}=await import(_0x1a8a06(0x175)),_0x565757=new _0x1ae6e2(this[_0x1a8a06(0x17d)],this[_0x1a8a06(0x183)]);this[_0x1a8a06(0x155)]('seek',_0x565757);const {MemoryTool:_0x90b4b8}=await import(_0x1a8a06(0x15e)),_0x184821=new _0x90b4b8(this[_0x1a8a06(0x17d)],this[_0x1a8a06(0x183)]);this['registerTool'](_0x1a8a06(0x185),_0x184821);const {CodeAnalysisTool:_0x55ab19}=await import(_0x1a8a06(0x176)),_0xe0ca9d=new _0x55ab19(this[_0x1a8a06(0x17d)],this[_0x1a8a06(0x183)]);this['registerTool']('code-analysis',_0xe0ca9d);const {FileContentReplaceTool:_0x55646e}=await import(_0x1a8a06(0x16c)),_0x10e5a5=new _0x55646e(this[_0x1a8a06(0x17d)],this[_0x1a8a06(0x183)]);this['registerTool'](_0x1a8a06(0x17e),_0x10e5a5);if(this[_0x1a8a06(0x17d)][_0x1a8a06(0x168)]?.[_0x1a8a06(0x15c)]?.[_0x1a8a06(0x156)]){const _0x5934da=new MCPClientTool(this['config'],this['logger']);this['registerTool']('mcp-client',_0x5934da);}if(this[_0x1a8a06(0x17d)][_0x1a8a06(0x168)]?.['uiTool']?.[_0x1a8a06(0x156)]){const _0x49dc69=await import(_0x1a8a06(0x16b)),_0x163de9=new _0x49dc69(this['config'],this[_0x1a8a06(0x183)]);this['registerTool']('ui',_0x163de9);}const {UpdateUserTool:_0x54e676}=await import('../tools/updateUserTool.js'),_0x372a25=new _0x54e676(this[_0x1a8a06(0x17d)],this[_0x1a8a06(0x183)]);this['registerTool'](_0x1a8a06(0x187),_0x372a25),this['logger']['info']('Registered\x20'+this[_0x1a8a06(0x168)]['size']+_0x1a8a06(0x150));}catch(_0x48dbe1){this[_0x1a8a06(0x183)]['error'](_0x1a8a06(0x169),_0x48dbe1);throw _0x48dbe1;}}['registerTool'](_0x8bf77c,_0x2d20ed){const _0x2e895e=a0_0x11db3f;this[_0x2e895e(0x183)]['info'](_0x2e895e(0x15f)+_0x8bf77c);if(typeof _0x2d20ed['execute']!==_0x2e895e(0x14f))throw new Error(_0x2e895e(0x179)+_0x8bf77c+'\x20does\x20not\x20have\x20an\x20execute\x20method');if(typeof _0x2d20ed['getDescription']!=='function')throw new Error(_0x2e895e(0x179)+_0x8bf77c+'\x20does\x20not\x20have\x20a\x20getDescription\x20method');this[_0x2e895e(0x168)]['set'](_0x8bf77c,_0x2d20ed),this['toolDescriptions']['set'](_0x8bf77c,_0x2d20ed[_0x2e895e(0x15d)]());}[a0_0x11db3f(0x157)](_0x148ddb){const _0x5bc937=a0_0x11db3f;return this[_0x5bc937(0x168)][_0x5bc937(0x16d)](_0x148ddb);}['getTool'](_0x4eda54){const _0x17dfef=a0_0x11db3f;if(!this[_0x17dfef(0x168)][_0x17dfef(0x16d)](_0x4eda54))throw new Error('Tool\x20'+_0x4eda54+_0x17dfef(0x151));return this['tools']['get'](_0x4eda54);}[a0_0x11db3f(0x159)](){return Array['from'](this['tools']['keys']());}['getToolsDescription'](){const _0x2d0888=a0_0x11db3f;let _0x281c16='';for(const [_0xe64bd9,_0x5aead4]of this[_0x2d0888(0x154)][_0x2d0888(0x174)]()){_0x281c16+=_0x2d0888(0x166)+_0xe64bd9+'\x0a',_0x281c16+=_0x5aead4+'\x0a\x0a';}return _0x281c16;}[a0_0x11db3f(0x188)](_0x3c7204){const _0x320165=a0_0x11db3f;if(!this[_0x320165(0x154)]['has'](_0x3c7204))throw new Error(_0x320165(0x179)+_0x3c7204+'\x20not\x20found\x20in\x20registry');return this[_0x320165(0x154)]['get'](_0x3c7204);}[a0_0x11db3f(0x170)](){const _0x5d1834=a0_0x11db3f;let _0x1d0bbf=_0x5d1834(0x161);for(const [_0x49c5fc,_0x5d8a05]of this['toolDescriptions']['entries']()){_0x1d0bbf+='##\x20'+_0x49c5fc+'\x0a',_0x1d0bbf+=_0x5d8a05+'\x0a\x0a';}return _0x1d0bbf+=_0x5d1834(0x181),_0x1d0bbf+='For\x20each\x20tool,\x20use\x20[tool\x20id=\x22tool_id\x22]\x20and\x20[/tool]\x20tags\x20to\x20specify\x20which\x20tool\x20to\x20use.\x0a',_0x1d0bbf+='Each\x20tool\x20has\x20its\x20own\x20specific\x20format\x20for\x20commands\x20as\x20described\x20above.',_0x1d0bbf;}async['shutdown'](){const _0x355243=a0_0x11db3f;this['logger'][_0x355243(0x153)]('Shutting\x20down\x20all\x20tools');const _0x328332=[];for(const [_0x1e7ac0,_0x1ba6b5]of this[_0x355243(0x168)]['entries']()){typeof _0x1ba6b5[_0x355243(0x164)]==='function'&&(this['logger'][_0x355243(0x153)]('Shutting\x20down\x20tool:\x20'+_0x1e7ac0),_0x328332[_0x355243(0x172)](_0x1ba6b5['shutdown']()));}await Promise['allSettled'](_0x328332),this['logger'][_0x355243(0x153)]('All\x20tools\x20shut\x20down');}}