const a0_0x45d693=a0_0x1bc3;(function(_0x5fe383,_0x260b4d){const _0x2eccaa=a0_0x1bc3,_0x5c5888=_0x5fe383();while(!![]){try{const _0x4fabd1=parseInt(_0x2eccaa(0xe1))/0x1+parseInt(_0x2eccaa(0xe3))/0x2*(parseInt(_0x2eccaa(0xb7))/0x3)+-parseInt(_0x2eccaa(0xbe))/0x4+parseInt(_0x2eccaa(0xc0))/0x5*(-parseInt(_0x2eccaa(0xc1))/0x6)+parseInt(_0x2eccaa(0xb1))/0x7+-parseInt(_0x2eccaa(0xb6))/0x8*(parseInt(_0x2eccaa(0xb4))/0x9)+parseInt(_0x2eccaa(0xd6))/0xa;if(_0x4fabd1===_0x260b4d)break;else _0x5c5888['push'](_0x5c5888['shift']());}catch(_0x5326c9){_0x5c5888['push'](_0x5c5888['shift']());}}}(a0_0x5505,0x60d56));import a0_0x4edbd6 from'path';import{promises as a0_0x4f5b75}from'fs';export class ToolRegistry{constructor(_0x22f3ad,_0xfbfa52,_0xbed62=null,_0x2b15f5=null){const _0x394768=a0_0x1bc3;this[_0x394768(0xd5)]=_0x22f3ad,this[_0x394768(0xc5)]=_0xfbfa52,this[_0x394768(0xd1)]=_0x2b15f5,this[_0x394768(0xc3)]=_0xbed62,this['tools']=new Map(),this[_0x394768(0xb5)]=new Map(),this[_0x394768(0xd3)]();}['setLLMService'](_0x31a5a9){const _0x36d360=a0_0x1bc3;this[_0x36d360(0xc3)]=_0x31a5a9;if(this[_0x36d360(0xbd)][_0x36d360(0xca)](_0x36d360(0xc8))){const _0x969237=this['tools'][_0x36d360(0xc9)]('browser');_0x969237[_0x36d360(0xdf)](_0x31a5a9),this[_0x36d360(0xc5)]['info']('Updated\x20browser\x20tool\x20with\x20LLM\x20service\x20for\x20vision\x20capabilities');}}['setProjectDirectory'](_0x4394b2){const _0x1d5732=a0_0x1bc3;this[_0x1d5732(0xd1)]=_0x4394b2;const _0x4ab7b5=this[_0x1d5732(0xbd)][_0x1d5732(0xc9)]('terminal');_0x4ab7b5&&typeof _0x4ab7b5[_0x1d5732(0xdc)]==='function'&&_0x4ab7b5['setProjectDirectory'](_0x4394b2),this[_0x1d5732(0xc5)]['info'](_0x1d5732(0xd9)+_0x4394b2);}async[a0_0x45d693(0xd3)](){const _0x4ba83c=a0_0x45d693;this['logger']['info']('Registering\x20built-in\x20tools');try{const {BrowserTool:_0x108d59}=await import(_0x4ba83c(0xeb)),_0x25a51a=new _0x108d59(this[_0x4ba83c(0xd5)],this['logger'],this[_0x4ba83c(0xc3)]);this['registerTool']('browser',_0x25a51a);const {TerminalTool:_0x41af0b}=await import(_0x4ba83c(0xee)),_0x39967c=new _0x41af0b(this[_0x4ba83c(0xd5)],this['logger'],undefined,this[_0x4ba83c(0xd1)]);this[_0x4ba83c(0xbc)](_0x4ba83c(0xe7),_0x39967c);const {FileSystemTool:_0x5594be}=await import('../tools/fileSystemTool.js'),_0x2d9038=new _0x5594be(this[_0x4ba83c(0xd5)],this['logger']);this['registerTool']('filesys',_0x2d9038);const {ImageTool:_0x562926}=await import(_0x4ba83c(0xb3)),_0x5ccd70=new _0x562926(this['config'],this['logger']);this[_0x4ba83c(0xbc)](_0x4ba83c(0xcb),_0x5ccd70);const {FileTreeTool:_0x56352a}=await import(_0x4ba83c(0xd2)),_0x51dbce=new _0x56352a(this[_0x4ba83c(0xd5)],this['logger']);this[_0x4ba83c(0xbc)](_0x4ba83c(0xec),_0x51dbce);const {SeekTool:_0x24c4a0}=await import(_0x4ba83c(0xe9)),_0x558e21=new _0x24c4a0(this['config'],this[_0x4ba83c(0xc5)]);this['registerTool'](_0x4ba83c(0xde),_0x558e21);const {MemoryTool:_0x9a24a5}=await import('../tools/memoryTool.js'),_0x4ecb32=new _0x9a24a5(this[_0x4ba83c(0xd5)],this[_0x4ba83c(0xc5)]);this['registerTool'](_0x4ba83c(0xcd),_0x4ecb32);const {CodeAnalysisTool:_0x1db2ca}=await import('../tools/codeAnalysisTool.js'),_0x2a763f=new _0x1db2ca(this['config'],this['logger']);this['registerTool'](_0x4ba83c(0xea),_0x2a763f);const {FileContentReplaceTool:_0x24729c}=await import('../tools/fileContentReplaceTool.js'),_0x252004=new _0x24729c(this['config'],this['logger']);this[_0x4ba83c(0xbc)]('file-content-replace',_0x252004);if(this[_0x4ba83c(0xd5)]['tools']?.['mcpTool']?.['enabled']){const _0x1cd7d0=new MCPClientTool(this['config'],this['logger']);this['registerTool'](_0x4ba83c(0xc2),_0x1cd7d0);}if(this[_0x4ba83c(0xd5)]['tools']?.[_0x4ba83c(0xe2)]?.[_0x4ba83c(0xe6)]){const _0xbbaad1=await import(_0x4ba83c(0xdd)),_0x59f735=new _0xbbaad1(this['config'],this['logger']);this['registerTool']('ui',_0x59f735);}const {UpdateUserTool:_0x29206e}=await import(_0x4ba83c(0xd7)),_0x1d7c54=new _0x29206e(this['config'],this[_0x4ba83c(0xc5)]);this[_0x4ba83c(0xbc)](_0x4ba83c(0xce),_0x1d7c54),this['logger'][_0x4ba83c(0xba)](_0x4ba83c(0xe4)+this[_0x4ba83c(0xbd)][_0x4ba83c(0xc4)]+_0x4ba83c(0xbf));}catch(_0xf35524){this['logger']['error']('Error\x20registering\x20built-in\x20tools:',_0xf35524);throw _0xf35524;}}['registerTool'](_0x2cd47e,_0xa4b066){const _0x514ebd=a0_0x45d693;this[_0x514ebd(0xc5)]['info']('Registering\x20tool:\x20'+_0x2cd47e);if(typeof _0xa4b066['execute']!==_0x514ebd(0xed))throw new Error(_0x514ebd(0xb9)+_0x2cd47e+_0x514ebd(0xcf));if(typeof _0xa4b066['getDescription']!=='function')throw new Error(_0x514ebd(0xb9)+_0x2cd47e+'\x20does\x20not\x20have\x20a\x20getDescription\x20method');this[_0x514ebd(0xbd)][_0x514ebd(0xda)](_0x2cd47e,_0xa4b066),this[_0x514ebd(0xb5)]['set'](_0x2cd47e,_0xa4b066[_0x514ebd(0xef)]());}['hasTool'](_0x5ae1be){const _0x2697a3=a0_0x45d693;return this[_0x2697a3(0xbd)][_0x2697a3(0xca)](_0x5ae1be);}['getTool'](_0x55b764){const _0x5c3759=a0_0x45d693;if(!this[_0x5c3759(0xbd)][_0x5c3759(0xca)](_0x55b764))throw new Error(_0x5c3759(0xb9)+_0x55b764+_0x5c3759(0xe5));return this[_0x5c3759(0xbd)]['get'](_0x55b764);}['getToolIds'](){const _0x2ab302=a0_0x45d693;return Array[_0x2ab302(0xd4)](this['tools'][_0x2ab302(0xe0)]());}[a0_0x45d693(0xc6)](){const _0x3d3171=a0_0x45d693;let _0x52ade3='';for(const [_0x3df1f9,_0x49181a]of this['toolDescriptions']['entries']()){_0x52ade3+=_0x3d3171(0xbb)+_0x3df1f9+'\x0a',_0x52ade3+=_0x49181a+'\x0a\x0a';}return _0x52ade3;}['getToolDescription'](_0x131984){const _0xa016d0=a0_0x45d693;if(!this['toolDescriptions']['has'](_0x131984))throw new Error('Tool\x20'+_0x131984+'\x20not\x20found\x20in\x20registry');return this[_0xa016d0(0xb5)][_0xa016d0(0xc9)](_0x131984);}[a0_0x45d693(0xc7)](){const _0xe07beb=a0_0x45d693;let _0x3b0d51=_0xe07beb(0xb2);for(const [_0x4f3e21,_0x4953b9]of this[_0xe07beb(0xb5)]['entries']()){_0x3b0d51+='##\x20'+_0x4f3e21+'\x0a',_0x3b0d51+=_0x4953b9+'\x0a\x0a';}return _0x3b0d51+='To\x20use\x20a\x20tool,\x20wrap\x20your\x20commands\x20in\x20[tools-commands]\x20and\x20[/tools-commands]\x20tags.\x0a',_0x3b0d51+=_0xe07beb(0xcc),_0x3b0d51+=_0xe07beb(0xd8),_0x3b0d51;}async[a0_0x45d693(0xb8)](){const _0x58d3d6=a0_0x45d693;this['logger']['info'](_0x58d3d6(0xdb));const _0x886ff6=[];for(const [_0xf9c586,_0x4e7172]of this['tools']['entries']()){typeof _0x4e7172['shutdown']===_0x58d3d6(0xed)&&(this['logger']['info'](_0x58d3d6(0xe8)+_0xf9c586),_0x886ff6[_0x58d3d6(0xd0)](_0x4e7172['shutdown']()));}await Promise['allSettled'](_0x886ff6),this[_0x58d3d6(0xc5)][_0x58d3d6(0xba)]('All\x20tools\x20shut\x20down');}}function a0_0x1bc3(_0x23faad,_0x2dd5df){const _0x5505d1=a0_0x5505();return a0_0x1bc3=function(_0x1bc36e,_0x553f21){_0x1bc36e=_0x1bc36e-0xb1;let _0x4011ef=_0x5505d1[_0x1bc36e];if(a0_0x1bc3['TLPFwa']===undefined){var _0x21c9b3=function(_0x4edbd6){const _0x4f5b75='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x22f3ad='',_0xfbfa52='';for(let _0xbed62=0x0,_0x2b15f5,_0x31a5a9,_0x969237=0x0;_0x31a5a9=_0x4edbd6['charAt'](_0x969237++);~_0x31a5a9&&(_0x2b15f5=_0xbed62%0x4?_0x2b15f5*0x40+_0x31a5a9:_0x31a5a9,_0xbed62++%0x4)?_0x22f3ad+=String['fromCharCode'](0xff&_0x2b15f5>>(-0x2*_0xbed62&0x6)):0x0){_0x31a5a9=_0x4f5b75['indexOf'](_0x31a5a9);}for(let _0x4394b2=0x0,_0x4ab7b5=_0x22f3ad['length'];_0x4394b2<_0x4ab7b5;_0x4394b2++){_0xfbfa52+='%'+('00'+_0x22f3ad['charCodeAt'](_0x4394b2)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xfbfa52);};a0_0x1bc3['EjlLQy']=_0x21c9b3,_0x23faad=arguments,a0_0x1bc3['TLPFwa']=!![];}const _0x57169a=_0x5505d1[0x0],_0x473fbf=_0x1bc36e+_0x57169a,_0x1d59c8=_0x23faad[_0x473fbf];return!_0x1d59c8?(_0x4011ef=a0_0x1bc3['EjlLQy'](_0x4011ef),_0x23faad[_0x473fbf]=_0x4011ef):_0x4011ef=_0x1d59c8,_0x4011ef;},a0_0x1bc3(_0x23faad,_0x2dd5df);}function a0_0x5505(){const _0xa4bd28=['BwnWlwnSAwvUDa','BgXTu2vYDMLJzq','C2L6zq','Bg9Nz2vY','z2v0vg9VBhnezxnJCMLWDgLVBG','y3jLyxrLvg9VBhntExn0zw1qCM9TChq','yNjVD3nLCG','z2v0','AgfZ','Aw1Hz2uTz2vU','rM9YigvHy2GGDg9VBcWGDxnLifT0B29SigLKpsj0B29Sx2LKiL0Gyw5KifSVDg9VBf0GDgfNCYb0BYbZCgvJAwz5ihDOAwnOihrVB2WGDg8GDxnLlGO','BwvTB3j5','DxbKyxrLlxvZzxi','igrVzxmGBM90igHHDMuGyw4GzxHLy3v0zsbTzxrOB2q','ChvZAa','ChjVAMvJDerPCG','lI4VDg9VBhmVzMLSzvrYzwvuB29SlMPZ','CMvNAxn0zxjcDwLSDeLUvg9VBhm','zNjVBq','y29UzMLN','mZq0mZaYmfP1ChPSBG','lI4VDg9VBhmVDxbKyxrLvxnLCLrVB2WUANm','rwfJAcb0B29SigHHCYbPDhmGB3DUihnWzwnPzMLJigzVCM1HDcbMB3iGy29TBwfUzhmGyxmGzgvZy3jPyMvKigfIB3zLlG','vxbKyxrLzcbWCM9Qzwn0igrPCMvJDg9YEsbMB3iGDg9VBhm6ia','C2v0','u2H1DhrPBMCGzg93BIbHBgWGDg9VBhm','C2v0uhjVAMvJDerPCMvJDg9YEq','lI4VDg9VBhmVDwLuB29SlMPZ','C2vLAW','C2v0teXnu2vYDMLJzq','A2v5CW','mtyXmtuYuKzlDM5u','DwLuB29S','mty1mdroC0T2sgK','uMvNAxn0zxjLzca','ig5VDcbMB3vUzcbPBIbYzwDPC3rYEq','zw5HyMXLza','DgvYBwLUywW','u2H1DhrPBMCGzg93BIb0B29SoIa','lI4VDg9VBhmVC2vLA1rVB2WUANm','y29Kzs1HBMfSExnPCW','lI4VDg9VBhmVyNjVD3nLCLrVB2WUANm','zMLSzs10CMvL','zNvUy3rPB24','lI4VDg9VBhmVDgvYBwLUywXuB29SlMPZ','z2v0rgvZy3jPChrPB24','mZGZmtmXn0ffEw1jrG','qxzHAwXHyMXLihrVB2XZoGOk','lI4VDg9VBhmVAw1Hz2vuB29SlMPZ','ow51tLvqCG','Dg9VBerLC2nYAxb0Aw9UCW','mJKXodGXnKrgveTgtG','mtu2Buz2swL1','C2H1DgrVD24','vg9VBca','Aw5MBW','vg9VBcbjrdOG','CMvNAxn0zxjuB29S','Dg9VBhm','mJu3odK1mMXmug5JBW','ihrVB2XZ','mZqZotvLz1jVshO','nJzKs2nKvfe'];a0_0x5505=function(){return _0xa4bd28;};return a0_0x5505();}