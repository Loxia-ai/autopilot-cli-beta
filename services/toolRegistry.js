const a0_0x3e61f6=a0_0x4c3a;function a0_0x595f(){const _0x1bb411=['lI4VDg9VBhmVDxbKyxrLvxnLCLrVB2WUANm','nJqWntuYsfDRtKj4','AgfZ','zMLSzxn5CW','mtbkuvfft1u','ihrVB2XZ','uMvNAxn0zxjLzca','qwXSihrVB2XZihnODxqGzg93BG','lI4VDg9VBhmVAw1Hz2vuB29SlMPZ','C2H1DgrVD24','mtiYmJqXmeXsyNLHyW','BwvTB3j5','C2vLAW','y29Kzs1HBMfSExnPCW','yNjVD3nLCG','z2v0vg9VBeLKCW','lI4VDg9VBhmVzMLSzvrYzwvuB29SlMPZ','y29UzMLN','zw5HyMXLza','vxbKyxrLzcbICM93C2vYihrVB2WGD2L0Acbmte0GC2vYDMLJzsbMB3iGDMLZAw9UignHCgfIAwXPDgLLCW','igrVzxmGBM90igHHDMuGyw4GzxHLy3v0zsbTzxrOB2q','mJa2mtC2wKTWuNPw','nJi3odbUtuTdy2m','ouHRB3fLDW','rxjYB3iGCMvNAxn0zxjPBMCGyNvPBhqTAw4GDg9VBhm6','C2v0uhjVAMvJDerPCMvJDg9YEq','C2v0teXnu2vYDMLJzq','vg9VBcbjrdOG','Dg9VBhm','BgXTu2vYDMLJzq','z2v0','mJHozKLZvM8','zxjYB3i','CMvNAxn0zxjuB29S','DxbKyxrLlxvZzxi','lI4VDg9VBhmVy29KzufUywX5C2LZvg9VBc5QCW','rwfJAcb0B29SigHHCYbPDhmGB3DUihnWzwnPzMLJigzVCM1HDcbMB3iGy29TBwfUzhmGyxmGzgvZy3jPyMvKigfIB3zLlG','igrVzxmGBM90igHHDMuGysbNzxrezxnJCMLWDgLVBIbTzxrOB2q','lI4VDg9VBhmVzMLSzunVBNrLBNrszxbSywnLvg9VBc5QCW','z2v0rgvZy3jPChrPB24','mtC5otGYru9Vq0X4','zw50CMLLCW','z2v0vg9VBa','uMvNAxn0zxjPBMCGyNvPBhqTAw4GDg9VBhm','ywXSu2v0DgXLza','Bg9Nz2vY','Aw5MBW','mtjcELb5rhq','iYmG','zMLSzs1JB250zw50lxjLCgXHy2u','Aw1Hz2uTz2vU','vg9VBca','nZm0mZyWDMfUqwvP','z2v0vg9VBerLC2nYAxb0Aw9U','uMvNAxn0zxjPBMCGDg9VBdOG','zNvUy3rPB24','vxbKyxrLzcbPBwfNzsb0B29SihDPDgGGteXnihnLCNzPy2uGzM9YigLTywDLigDLBMvYyxrPB24','lI4VDg9VBhmVyNjVD3nLCLrVB2WUANm','zgvWlxjLC29SDMvY','nty2nteXmfb4DM1hCW','Dg9VBerLC2nYAxb0Aw9UCW','CMvNAxn0zxjcDwLSDeLUvg9VBhm','ChjVAMvJDerPCG','C2v0','lI4VDg9VBhmVDMLZAw9Uqw5HBhL6zxjuB29SlMPZ'];a0_0x595f=function(){return _0x1bb411;};return a0_0x595f();}function a0_0x4c3a(_0x2ec3d4,_0x556b47){const _0x595fd2=a0_0x595f();return a0_0x4c3a=function(_0x4c3ac6,_0x1ae122){_0x4c3ac6=_0x4c3ac6-0x7b;let _0x27f2bb=_0x595fd2[_0x4c3ac6];if(a0_0x4c3a['WiMDup']===undefined){var _0x2547b4=function(_0x40b173){const _0x5db5d5='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x5110ac='',_0x5ecc82='';for(let _0x231061=0x0,_0x42aead,_0x219a82,_0x3d6a98=0x0;_0x219a82=_0x40b173['charAt'](_0x3d6a98++);~_0x219a82&&(_0x42aead=_0x231061%0x4?_0x42aead*0x40+_0x219a82:_0x219a82,_0x231061++%0x4)?_0x5110ac+=String['fromCharCode'](0xff&_0x42aead>>(-0x2*_0x231061&0x6)):0x0){_0x219a82=_0x5db5d5['indexOf'](_0x219a82);}for(let _0x16a641=0x0,_0x22ae2e=_0x5110ac['length'];_0x16a641<_0x22ae2e;_0x16a641++){_0x5ecc82+='%'+('00'+_0x5110ac['charCodeAt'](_0x16a641)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5ecc82);};a0_0x4c3a['XjuLFD']=_0x2547b4,_0x2ec3d4=arguments,a0_0x4c3a['WiMDup']=!![];}const _0x13a25f=_0x595fd2[0x0],_0x55db37=_0x4c3ac6+_0x13a25f,_0x512f2e=_0x2ec3d4[_0x55db37];return!_0x512f2e?(_0x27f2bb=a0_0x4c3a['XjuLFD'](_0x27f2bb),_0x2ec3d4[_0x55db37]=_0x27f2bb):_0x27f2bb=_0x512f2e,_0x27f2bb;},a0_0x4c3a(_0x2ec3d4,_0x556b47);}(function(_0x2c2a2c,_0x3c63ed){const _0x9de178=a0_0x4c3a,_0x5829d5=_0x2c2a2c();while(!![]){try{const _0x46212f=parseInt(_0x9de178(0x82))/0x1+-parseInt(_0x9de178(0x83))/0x2*(parseInt(_0x9de178(0x9c))/0x3)+-parseInt(_0x9de178(0xa1))/0x4+-parseInt(_0x9de178(0xb8))/0x5+-parseInt(_0x9de178(0x95))/0x6*(parseInt(_0x9de178(0x8c))/0x7)+parseInt(_0x9de178(0xaf))/0x8*(parseInt(_0x9de178(0x84))/0x9)+parseInt(_0x9de178(0xb2))/0xa*(parseInt(_0x9de178(0xa8))/0xb);if(_0x46212f===_0x3c63ed)break;else _0x5829d5['push'](_0x5829d5['shift']());}catch(_0xf98dc9){_0x5829d5['push'](_0x5829d5['shift']());}}}(a0_0x595f,0x1f293));import a0_0x40b173 from'path';import{promises as a0_0x5db5d5}from'fs';export class ToolRegistry{constructor(_0x5110ac,_0x5ecc82,_0x231061=null,_0x42aead=null){const _0x2edd1b=a0_0x4c3a;this[_0x2edd1b(0x7e)]=_0x5110ac,this['logger']=_0x5ecc82,this['projectDir']=_0x42aead,this['llmService']=_0x231061,this[_0x2edd1b(0x89)]=new Map(),this[_0x2edd1b(0xa9)]=new Map(),this['registerBuiltInTools']();}[a0_0x3e61f6(0x87)](_0x219a82){const _0x4313df=a0_0x3e61f6;this[_0x4313df(0x8a)]=_0x219a82;if(this[_0x4313df(0x89)]['has']('browser')){const _0x3d6a98=this[_0x4313df(0x89)]['get']('browser');_0x3d6a98[_0x4313df(0x87)](_0x219a82),this['logger']['info'](_0x4313df(0x80));}if(this[_0x4313df(0x89)][_0x4313df(0xb0)](_0x4313df(0x9f))){const _0x16a641=this[_0x4313df(0x89)]['get']('image-gen');_0x16a641[_0x4313df(0x87)](_0x219a82),this[_0x4313df(0x9a)][_0x4313df(0x9b)](_0x4313df(0xa5));}if(this[_0x4313df(0x89)]['has']('vision-analyzer')){const _0x22ae2e=this['tools'][_0x4313df(0x8b)]('vision-analyzer');_0x22ae2e['setLLMService'](_0x219a82),this['logger'][_0x4313df(0x9b)]('Updated\x20vision\x20analyzer\x20tool\x20with\x20LLM\x20service\x20for\x20image\x20analysis');}}[a0_0x3e61f6(0x86)](_0x2f237f){const _0x3a4082=a0_0x3e61f6;this['projectDir']=_0x2f237f;const _0x22f0a5=this[_0x3a4082(0x89)]['get']('terminal');_0x22f0a5&&typeof _0x22f0a5['setProjectDirectory']==='function'&&_0x22f0a5['setProjectDirectory'](_0x2f237f),this[_0x3a4082(0x9a)]['info']('Updated\x20project\x20directory\x20for\x20tools:\x20'+_0x2f237f);}async[a0_0x3e61f6(0xaa)](){const _0x3b13b2=a0_0x3e61f6;this['logger']['info'](_0x3b13b2(0x98));try{const {BrowserTool:_0x4fb468}=await import(_0x3b13b2(0xa6)),_0x237c1a=new _0x4fb468(this[_0x3b13b2(0x7e)],this['logger'],this['llmService']);this[_0x3b13b2(0x8e)](_0x3b13b2(0x7b),_0x237c1a);const {TerminalTool:_0x44f142}=await import('../tools/terminalTool.js'),_0xe27af=new _0x44f142(this['config'],this['logger'],undefined,this[_0x3b13b2(0xab)]);this[_0x3b13b2(0x8e)]('terminal',_0xe27af);const {FileSystemTool:_0x2e12db}=await import('../tools/fileSystemTool.js'),_0x2a6afa=new _0x2e12db(this['config'],this[_0x3b13b2(0x9a)]);this['registerTool'](_0x3b13b2(0xb1),_0x2a6afa);const {ImageTool:_0x4caacf}=await import(_0x3b13b2(0xb6)),_0x58f96a=new _0x4caacf(this['config'],this[_0x3b13b2(0x9a)],this[_0x3b13b2(0x8a)]);this[_0x3b13b2(0x8e)]('image-gen',_0x58f96a);const {FileTreeTool:_0x3ff350}=await import(_0x3b13b2(0x7d)),_0x4c943e=new _0x3ff350(this[_0x3b13b2(0x7e)],this[_0x3b13b2(0x9a)]);this[_0x3b13b2(0x8e)]('file-tree',_0x4c943e);const {SeekTool:_0x1b139c}=await import('../tools/seekTool.js'),_0x191fcc=new _0x1b139c(this['config'],this['logger']);this['registerTool'](_0x3b13b2(0xba),_0x191fcc);const {MemoryTool:_0x3be995}=await import('../tools/memoryTool.js'),_0x33f489=new _0x3be995(this[_0x3b13b2(0x7e)],this[_0x3b13b2(0x9a)]);this[_0x3b13b2(0x8e)](_0x3b13b2(0xb9),_0x33f489);const {CodeAnalysisTool:_0x1879b2}=await import(_0x3b13b2(0x90)),_0x261c62=new _0x1879b2(this['config'],this['logger']);this[_0x3b13b2(0x8e)](_0x3b13b2(0xbb),_0x261c62);const {FileContentReplaceTool:_0x3d50e9}=await import(_0x3b13b2(0x93)),_0x2257e9=new _0x3d50e9(this[_0x3b13b2(0x7e)],this[_0x3b13b2(0x9a)]);this['registerTool'](_0x3b13b2(0x9e),_0x2257e9);if(this[_0x3b13b2(0x7e)]['tools']?.['mcpTool']?.[_0x3b13b2(0x7f)]){const _0x2f0385=new MCPClientTool(this[_0x3b13b2(0x7e)],this['logger']);this[_0x3b13b2(0x8e)]('mcp-client',_0x2f0385);}if(this[_0x3b13b2(0x7e)]['tools']?.['uiTool']?.['enabled']){const _0x4cfa69=await import('../tools/uiTool.js'),_0xb78f1a=new _0x4cfa69(this[_0x3b13b2(0x7e)],this['logger']);this['registerTool']('ui',_0xb78f1a);}const {UpdateUserTool:_0x4c471d}=await import(_0x3b13b2(0xae)),_0x2935cb=new _0x4c471d(this[_0x3b13b2(0x7e)],this['logger']);this[_0x3b13b2(0x8e)](_0x3b13b2(0x8f),_0x2935cb);const {DependencyResolverTool:_0x2c566f}=await import('../tools/dependencyResolverTool.js'),_0x437684=new _0x2c566f(this['config'],this[_0x3b13b2(0x9a)]);this[_0x3b13b2(0x8e)](_0x3b13b2(0xa7),_0x437684);const {ImportAnalyzerTool:_0x43bf4f}=await import('../tools/importAnalyzerTool.js'),_0x3a2a83=new _0x43bf4f(this[_0x3b13b2(0x7e)],this[_0x3b13b2(0x9a)]);this[_0x3b13b2(0x8e)]('import-analyzer',_0x3a2a83);const {VisionAnalyzerTool:_0x8748b8}=await import(_0x3b13b2(0xad)),_0x10ba77=new _0x8748b8(this[_0x3b13b2(0x7e)],this[_0x3b13b2(0x9a)],this[_0x3b13b2(0x8a)]);this[_0x3b13b2(0x8e)]('vision-analyzer',_0x10ba77),this[_0x3b13b2(0x9a)][_0x3b13b2(0x9b)](_0x3b13b2(0xb4)+this['tools']['size']+_0x3b13b2(0xb3));}catch(_0x39cd45){this['logger'][_0x3b13b2(0x8d)](_0x3b13b2(0x85),_0x39cd45);throw _0x39cd45;}}['registerTool'](_0x1bd8bc,_0x274d37){const _0x6756df=a0_0x3e61f6;this[_0x6756df(0x9a)]['info'](_0x6756df(0xa3)+_0x1bd8bc);if(typeof _0x274d37['execute']!==_0x6756df(0xa4))throw new Error(_0x6756df(0xa0)+_0x1bd8bc+_0x6756df(0x81));if(typeof _0x274d37[_0x6756df(0x94)]!==_0x6756df(0xa4))throw new Error(_0x6756df(0xa0)+_0x1bd8bc+_0x6756df(0x92));this['tools']['set'](_0x1bd8bc,_0x274d37),this['toolDescriptions'][_0x6756df(0xac)](_0x1bd8bc,_0x274d37[_0x6756df(0x94)]());}['hasTool'](_0x46bce5){return this['tools']['has'](_0x46bce5);}[a0_0x3e61f6(0x97)](_0x47cd2d){const _0x4d703b=a0_0x3e61f6;if(!this['tools'][_0x4d703b(0xb0)](_0x47cd2d))throw new Error(_0x4d703b(0xa0)+_0x47cd2d+'\x20not\x20found\x20in\x20registry');return this['tools']['get'](_0x47cd2d);}[a0_0x3e61f6(0x7c)](){return Array['from'](this['tools']['keys']());}['getToolsDescription'](){const _0x36a32e=a0_0x3e61f6;let _0x4940ae='';for(const [_0x467f3e,_0x16a158]of this[_0x36a32e(0xa9)][_0x36a32e(0x96)]()){_0x4940ae+=_0x36a32e(0x88)+_0x467f3e+'\x0a',_0x4940ae+=_0x16a158+'\x0a\x0a';}return _0x4940ae;}[a0_0x3e61f6(0xa2)](_0x34487c){const _0x118eb8=a0_0x3e61f6;if(!this[_0x118eb8(0xa9)]['has'](_0x34487c))throw new Error('Tool\x20'+_0x34487c+'\x20not\x20found\x20in\x20registry');return this[_0x118eb8(0xa9)][_0x118eb8(0x8b)](_0x34487c);}['createToolsSystemPrompt'](){const _0x5177ca=a0_0x3e61f6;let _0x3fa713='Available\x20tools:\x0a\x0a';for(const [_0x2aa46c,_0x2da6d3]of this['toolDescriptions']['entries']()){_0x3fa713+=_0x5177ca(0x9d)+_0x2aa46c+'\x0a',_0x3fa713+=_0x2da6d3+'\x0a\x0a';}return _0x3fa713+='To\x20use\x20a\x20tool,\x20wrap\x20your\x20commands\x20in\x20[tools-commands]\x20and\x20[/tools-commands]\x20tags.\x0a',_0x3fa713+='For\x20each\x20tool,\x20use\x20[tool\x20id=\x22tool_id\x22]\x20and\x20[/tool]\x20tags\x20to\x20specify\x20which\x20tool\x20to\x20use.\x0a',_0x3fa713+=_0x5177ca(0x91),_0x3fa713;}async[a0_0x3e61f6(0xb7)](){const _0x4c91b0=a0_0x3e61f6;this[_0x4c91b0(0x9a)]['info']('Shutting\x20down\x20all\x20tools');const _0x45b018=[];for(const [_0x4f85f2,_0x934b3e]of this['tools']['entries']()){typeof _0x934b3e[_0x4c91b0(0xb7)]==='function'&&(this['logger']['info']('Shutting\x20down\x20tool:\x20'+_0x4f85f2),_0x45b018['push'](_0x934b3e['shutdown']()));}await Promise[_0x4c91b0(0x99)](_0x45b018),this['logger'][_0x4c91b0(0x9b)](_0x4c91b0(0xb5));}}