const a0_0x2e07c3=a0_0x5926;(function(_0x277569,_0x236e2e){const _0x409b5e=a0_0x5926,_0x346ae2=_0x277569();while(!![]){try{const _0x35f8ff=-parseInt(_0x409b5e(0x183))/0x1+parseInt(_0x409b5e(0x174))/0x2+-parseInt(_0x409b5e(0x189))/0x3+parseInt(_0x409b5e(0x186))/0x4*(-parseInt(_0x409b5e(0x16d))/0x5)+parseInt(_0x409b5e(0x17d))/0x6+parseInt(_0x409b5e(0x171))/0x7+-parseInt(_0x409b5e(0x17a))/0x8*(parseInt(_0x409b5e(0x176))/0x9);if(_0x35f8ff===_0x236e2e)break;else _0x346ae2['push'](_0x346ae2['shift']());}catch(_0x3f0611){_0x346ae2['push'](_0x346ae2['shift']());}}}(a0_0x4de3,0x1e7b5));import a0_0x206429 from'path';function a0_0x4de3(){const _0x530c7b=['zxjYB3i','z2v0vg9VBhnezxnJCMLWDgLVBG','ntC5oti0zgXkzKjN','AgfZ','vg9VBca','zNvUy3rPB24','Aw5MBW','zNjVBq','BwnWvg9VBa','CMvNAxn0zxjcDwLSDeLUvg9VBhm','ig5VDcbMB3vUzcbPBIbYzwDPC3rYEq','C2H1DgrVD24','rwfJAcb0B29SigHHCYbPDhmGB3DUihnWzwnPzMLJigzVCM1HDcbMB3iGy29TBwfUzhmGyxmGzgvZy3jPyMvKigfIB3zLlG','ChvZAa','C2v0','zxHLy3v0zq','zMLSzs10CMvL','igrVzxmGBM90igHHDMuGyw4GzxHLy3v0zsbTzxrOB2q','uMvNAxn0zxjPBMCGyNvPBhqTAw4GDg9VBhm','z2v0rgvZy3jPChrPB24','C2v0uhjVAMvJDerPCMvJDg9YEq','z2v0vg9VBa','DgvYBwLUywW','zw50CMLLCW','Dg9VBhm','z2v0vg9VBerLC2nYAxb0Aw9U','BgXTu2vYDMLJzq','Bg9Nz2vY','lI4VDg9VBhmVDgvYBwLUywXuB29SlMPZ','C2v0teXnu2vYDMLJzq','ntC3nZvPquDvENq','z2v0vg9VBeLKCW','uMvNAxn0zxjPBMCGDg9VBdOG','lI4VDg9VBhmVDwLuB29SlMPZ','mtC0nJG2nefdvfDlvG','AgfZvg9VBa','y29UzMLN','mtGYmduWBwf5D0D5','rM9YigvHy2GGDg9VBcWGDxnLifT0B29SigLKpsj0B29Sx2LKiL0Gyw5KifSVDg9VBf0GDgfNCYb0BYbZCgvJAwz5ihDOAwnOihrVB2WGDg8GDxnLlGO','mZzywvjHAMW','BwvTB3j5','qwXSihrVB2XZihnODxqGzg93BG','Aw1Hz2uTz2vU','mJiYnJruB2P4C1i','lI4VDg9VBhmVBwvTB3j5vg9VBc5QCW','C2L6zq','mtqXnde3me9kwNDcwq','lI4VDg9VBhmVzMLSzvrYzwvuB29SlMPZ','igrVzxmGBM90igHHDMuGysbNzxrezxnJCMLWDgLVBIbTzxrOB2q','yNjVD3nLCG','zMLSzxn5CW','CMvNAxn0zxjuB29S','mte5odC0q0fxs21U','Dg9VBerLC2nYAxb0Aw9UCW','z2v0','ndrUANDqAMe'];a0_0x4de3=function(){return _0x530c7b;};return a0_0x4de3();}function a0_0x5926(_0x4064d6,_0x439572){const _0x4de3e2=a0_0x4de3();return a0_0x5926=function(_0x592690,_0x286be1){_0x592690=_0x592690-0x15b;let _0x26144e=_0x4de3e2[_0x592690];if(a0_0x5926['TAZuAI']===undefined){var _0x2268a6=function(_0x206429){const _0x2d9805='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1be6c8='',_0xd78b8f='';for(let _0x30e300=0x0,_0x4cda33,_0x449314,_0x2c2058=0x0;_0x449314=_0x206429['charAt'](_0x2c2058++);~_0x449314&&(_0x4cda33=_0x30e300%0x4?_0x4cda33*0x40+_0x449314:_0x449314,_0x30e300++%0x4)?_0x1be6c8+=String['fromCharCode'](0xff&_0x4cda33>>(-0x2*_0x30e300&0x6)):0x0){_0x449314=_0x2d9805['indexOf'](_0x449314);}for(let _0x55ad89=0x0,_0x68a8ab=_0x1be6c8['length'];_0x55ad89<_0x68a8ab;_0x55ad89++){_0xd78b8f+='%'+('00'+_0x1be6c8['charCodeAt'](_0x55ad89)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xd78b8f);};a0_0x5926['uBKLhE']=_0x2268a6,_0x4064d6=arguments,a0_0x5926['TAZuAI']=!![];}const _0x870906=_0x4de3e2[0x0],_0x4d15a3=_0x592690+_0x870906,_0x53f318=_0x4064d6[_0x4d15a3];return!_0x53f318?(_0x26144e=a0_0x5926['uBKLhE'](_0x26144e),_0x4064d6[_0x4d15a3]=_0x26144e):_0x26144e=_0x53f318,_0x26144e;},a0_0x5926(_0x4064d6,_0x439572);}import{promises as a0_0x2d9805}from'fs';export class ToolRegistry{constructor(_0x1be6c8,_0xd78b8f,_0x30e300=null,_0x4cda33=null){const _0x4e71c3=a0_0x5926;this[_0x4e71c3(0x173)]=_0x1be6c8,this[_0x4e71c3(0x16a)]=_0xd78b8f,this['projectDir']=_0x4cda33,this[_0x4e71c3(0x169)]=_0x30e300,this['tools']=new Map(),this[_0x4e71c3(0x184)]=new Map(),this[_0x4e71c3(0x190)]();}['setLLMService'](_0x449314){const _0x36508b=a0_0x5926;this['llmService']=_0x449314;if(this['tools'][_0x36508b(0x18a)](_0x36508b(0x180))){const _0x2c2058=this['tools']['get']('browser');_0x2c2058[_0x36508b(0x16c)](_0x449314),this['logger']['info']('Updated\x20browser\x20tool\x20with\x20LLM\x20service\x20for\x20vision\x20capabilities');}if(this['tools']['has']('image-gen')){const _0x55ad89=this['tools']['get'](_0x36508b(0x179));_0x55ad89[_0x36508b(0x16c)](_0x449314),this['logger'][_0x36508b(0x18d)]('Updated\x20image\x20tool\x20with\x20LLM\x20service\x20for\x20image\x20generation');}}[a0_0x2e07c3(0x163)](_0x68a8ab){const _0x2e424b=a0_0x2e07c3;this['projectDir']=_0x68a8ab;const _0x439d2b=this[_0x2e424b(0x167)]['get']('terminal');_0x439d2b&&typeof _0x439d2b[_0x2e424b(0x163)]===_0x2e424b(0x18c)&&_0x439d2b[_0x2e424b(0x163)](_0x68a8ab),this[_0x2e424b(0x16a)]['info']('Updated\x20project\x20directory\x20for\x20tools:\x20'+_0x68a8ab);}async[a0_0x2e07c3(0x190)](){const _0x399db6=a0_0x2e07c3;this['logger'][_0x399db6(0x18d)](_0x399db6(0x161));try{const {BrowserTool:_0x29402a}=await import('../tools/browserTool.js'),_0x1f9afc=new _0x29402a(this['config'],this['logger'],this[_0x399db6(0x169)]);this[_0x399db6(0x182)](_0x399db6(0x180),_0x1f9afc);const {TerminalTool:_0x415ef0}=await import(_0x399db6(0x16b)),_0x8c6b0a=new _0x415ef0(this['config'],this[_0x399db6(0x16a)],undefined,this['projectDir']);this[_0x399db6(0x182)](_0x399db6(0x165),_0x8c6b0a);const {FileSystemTool:_0x3dada8}=await import('../tools/fileSystemTool.js'),_0x1b5fdb=new _0x3dada8(this['config'],this['logger']);this['registerTool'](_0x399db6(0x181),_0x1b5fdb);const {FileTreeTool:_0x4ecd7a}=await import(_0x399db6(0x17e)),_0x25b03b=new _0x4ecd7a(this[_0x399db6(0x173)],this['logger']);this['registerTool'](_0x399db6(0x15f),_0x25b03b);const {SeekTool:_0x4c4b9c}=await import('../tools/seekTool.js'),_0x539b7b=new _0x4c4b9c(this[_0x399db6(0x173)],this[_0x399db6(0x16a)]);this[_0x399db6(0x182)]('seek',_0x539b7b);const {MemoryTool:_0x572184}=await import(_0x399db6(0x17b)),_0x5168fb=new _0x572184(this['config'],this[_0x399db6(0x16a)]);this['registerTool'](_0x399db6(0x177),_0x5168fb);const {CodeAnalysisTool:_0x5c77f6}=await import('../tools/codeAnalysisTool.js'),_0x1a6743=new _0x5c77f6(this['config'],this[_0x399db6(0x16a)]);this['registerTool']('code-analysis',_0x1a6743);const {FileContentReplaceTool:_0x360a97}=await import('../tools/fileContentReplaceTool.js'),_0x2bb1c8=new _0x360a97(this['config'],this[_0x399db6(0x16a)]);this['registerTool']('file-content-replace',_0x2bb1c8);if(this[_0x399db6(0x173)][_0x399db6(0x167)]?.[_0x399db6(0x18f)]?.['enabled']){const _0x5062e5=new MCPClientTool(this['config'],this['logger']);this['registerTool']('mcp-client',_0x5062e5);}if(this['config']['tools']?.['uiTool']?.['enabled']){const _0x4c5362=await import(_0x399db6(0x170)),_0x20bb14=new _0x4c5362(this[_0x399db6(0x173)],this['logger']);this['registerTool']('ui',_0x20bb14);}const {UpdateUserTool:_0x4f1b86}=await import('../tools/updateUserTool.js'),_0x3fb77c=new _0x4f1b86(this['config'],this['logger']);this[_0x399db6(0x182)]('update-user',_0x3fb77c),this['logger'][_0x399db6(0x18d)]('Registered\x20'+this[_0x399db6(0x167)][_0x399db6(0x17c)]+'\x20tools');}catch(_0x3962b0){this[_0x399db6(0x16a)][_0x399db6(0x187)]('Error\x20registering\x20built-in\x20tools:',_0x3962b0);throw _0x3962b0;}}['registerTool'](_0x3181fb,_0x46ef28){const _0x274003=a0_0x2e07c3;this['logger']['info'](_0x274003(0x16f)+_0x3181fb);if(typeof _0x46ef28[_0x274003(0x15e)]!=='function')throw new Error(_0x274003(0x18b)+_0x3181fb+_0x274003(0x160));if(typeof _0x46ef28[_0x274003(0x162)]!==_0x274003(0x18c))throw new Error('Tool\x20'+_0x3181fb+_0x274003(0x17f));this['tools'][_0x274003(0x15d)](_0x3181fb,_0x46ef28),this['toolDescriptions'][_0x274003(0x15d)](_0x3181fb,_0x46ef28[_0x274003(0x162)]());}[a0_0x2e07c3(0x172)](_0x2d5025){const _0x46e1f0=a0_0x2e07c3;return this[_0x46e1f0(0x167)]['has'](_0x2d5025);}[a0_0x2e07c3(0x164)](_0x404078){const _0x58a8af=a0_0x2e07c3;if(!this['tools']['has'](_0x404078))throw new Error(_0x58a8af(0x18b)+_0x404078+_0x58a8af(0x191));return this['tools'][_0x58a8af(0x185)](_0x404078);}[a0_0x2e07c3(0x16e)](){const _0x3d0e83=a0_0x2e07c3;return Array[_0x3d0e83(0x18e)](this['tools']['keys']());}[a0_0x2e07c3(0x188)](){const _0x33ba36=a0_0x2e07c3;let _0x569ee4='';for(const [_0x2047c5,_0x1783bc]of this[_0x33ba36(0x184)]['entries']()){_0x569ee4+='Tool\x20ID:\x20'+_0x2047c5+'\x0a',_0x569ee4+=_0x1783bc+'\x0a\x0a';}return _0x569ee4;}[a0_0x2e07c3(0x168)](_0x37626e){const _0x38d342=a0_0x2e07c3;if(!this[_0x38d342(0x184)][_0x38d342(0x18a)](_0x37626e))throw new Error('Tool\x20'+_0x37626e+_0x38d342(0x191));return this['toolDescriptions'][_0x38d342(0x185)](_0x37626e);}['createToolsSystemPrompt'](){const _0x3a6a0a=a0_0x2e07c3;let _0x5bbbe0='Available\x20tools:\x0a\x0a';for(const [_0x2a0bb8,_0x1a8436]of this[_0x3a6a0a(0x184)][_0x3a6a0a(0x166)]()){_0x5bbbe0+='##\x20'+_0x2a0bb8+'\x0a',_0x5bbbe0+=_0x1a8436+'\x0a\x0a';}return _0x5bbbe0+='To\x20use\x20a\x20tool,\x20wrap\x20your\x20commands\x20in\x20[tools-commands]\x20and\x20[/tools-commands]\x20tags.\x0a',_0x5bbbe0+=_0x3a6a0a(0x175),_0x5bbbe0+=_0x3a6a0a(0x15b),_0x5bbbe0;}async['shutdown'](){const _0x55f9f4=a0_0x2e07c3;this['logger']['info']('Shutting\x20down\x20all\x20tools');const _0x4b6e48=[];for(const [_0x3301d6,_0x3dee12]of this[_0x55f9f4(0x167)]['entries']()){typeof _0x3dee12[_0x55f9f4(0x192)]==='function'&&(this[_0x55f9f4(0x16a)]['info']('Shutting\x20down\x20tool:\x20'+_0x3301d6),_0x4b6e48[_0x55f9f4(0x15c)](_0x3dee12['shutdown']()));}await Promise['allSettled'](_0x4b6e48),this['logger'][_0x55f9f4(0x18d)](_0x55f9f4(0x178));}}