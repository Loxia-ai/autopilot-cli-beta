function a0_0x12d7(_0x433645,_0x35b675){const _0x209343=a0_0x2093();return a0_0x12d7=function(_0x12d7e2,_0x722106){_0x12d7e2=_0x12d7e2-0xce;let _0x4d6adb=_0x209343[_0x12d7e2];if(a0_0x12d7['pDkgBy']===undefined){var _0x3b73d6=function(_0x20f9e8){const _0x55d86d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1b70cc='',_0x48f114='';for(let _0x107c11=0x0,_0x23ccc0,_0x5c8088,_0x9b9424=0x0;_0x5c8088=_0x20f9e8['charAt'](_0x9b9424++);~_0x5c8088&&(_0x23ccc0=_0x107c11%0x4?_0x23ccc0*0x40+_0x5c8088:_0x5c8088,_0x107c11++%0x4)?_0x1b70cc+=String['fromCharCode'](0xff&_0x23ccc0>>(-0x2*_0x107c11&0x6)):0x0){_0x5c8088=_0x55d86d['indexOf'](_0x5c8088);}for(let _0x56a7b1=0x0,_0xe2971a=_0x1b70cc['length'];_0x56a7b1<_0xe2971a;_0x56a7b1++){_0x48f114+='%'+('00'+_0x1b70cc['charCodeAt'](_0x56a7b1)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x48f114);};a0_0x12d7['wqZKtD']=_0x3b73d6,_0x433645=arguments,a0_0x12d7['pDkgBy']=!![];}const _0xaee93=_0x209343[0x0],_0x4f74bf=_0x12d7e2+_0xaee93,_0x2406bb=_0x433645[_0x4f74bf];return!_0x2406bb?(_0x4d6adb=a0_0x12d7['wqZKtD'](_0x4d6adb),_0x433645[_0x4f74bf]=_0x4d6adb):_0x4d6adb=_0x2406bb,_0x4d6adb;},a0_0x12d7(_0x433645,_0x35b675);}const a0_0x3cfaa6=a0_0x12d7;(function(_0x1a53c8,_0x34e382){const _0x4e493b=a0_0x12d7,_0x31f42a=_0x1a53c8();while(!![]){try{const _0x52be61=-parseInt(_0x4e493b(0x104))/0x1+parseInt(_0x4e493b(0xf6))/0x2+-parseInt(_0x4e493b(0xcf))/0x3+-parseInt(_0x4e493b(0xe6))/0x4+-parseInt(_0x4e493b(0xff))/0x5*(parseInt(_0x4e493b(0xf1))/0x6)+parseInt(_0x4e493b(0xd9))/0x7*(parseInt(_0x4e493b(0xf8))/0x8)+-parseInt(_0x4e493b(0xeb))/0x9*(-parseInt(_0x4e493b(0xf9))/0xa);if(_0x52be61===_0x34e382)break;else _0x31f42a['push'](_0x31f42a['shift']());}catch(_0x6b081a){_0x31f42a['push'](_0x31f42a['shift']());}}}(a0_0x2093,0xcd861));function a0_0x2093(){const _0x5dd6aa=['z2v0vg9VBhnezxnJCMLWDgLVBG','ndC5mZKYogvAuNbNBW','C2L6zq','DgvYBwLUywW','BwnWlwnSAwvUDa','qxzHAwXHyMXLihrVB2XZoGOk','igrVzxmGBM90igHHDMuGysbNzxrezxnJCMLWDgLVBIbTzxrOB2q','Dg9VBerLC2nYAxb0Aw9UCW','zw5HyMXLza','C2v0uhjVAMvJDerPCMvJDg9YEq','C2v0teXnu2vYDMLJzq','mta1reTjs0zd','u2H1DhrPBMCGzg93BIb0B29SoIa','vxbKyxrLzcbPBwfNzsb0B29SihDPDgGGteXnihnLCNzPy2uGzM9YigLTywDLigDLBMvYyxrPB24','AgfZ','DwLuB29S','zw50CMLLCW','z2v0vg9VBerLC2nYAxb0Aw9U','vxbKyxrLzcbICM93C2vYihrVB2WGD2L0Acbmte0GC2vYDMLJzsbMB3iGDMLZAw9UignHCgfIAwXPDgLLCW','uMvNAxn0zxjLzca','rwfJAcb0B29SigHHCYbPDhmGB3DUihnWzwnPzMLJigzVCM1HDcbMB3iGy29TBwfUzhmGyxmGzgvZy3jPyMvKigfIB3zLlG','Dg9VBhm','vg9VBca','zMLSzs10CMvL','ndu3nZqWnhvUt1HHqW','BgXTu2vYDMLJzq','ig5VDcbMB3vUzcbPBIbYzwDPC3rYEq','lI4VDg9VBhmVC2vLA1rVB2WUANm','Aw1Hz2uTz2vU','mteWmJy4mZzrzKnttw4','uMvNAxn0zxjPBMCGyNvPBhqTAw4GDg9VBhm','z2v0rgvZy3jPChrPB24','y29UzMLN','C2v0','DxbKyxrLlxvZzxi','ndq0vgDSsLPK','zMLSzxn5CW','Bg9Nz2vY','C2vLAW','CMvNAxn0zxjuB29S','mtC4nJGXmerKCgfJsa','lI4VDg9VBhmVzMLSzvrYzwvuB29SlMPZ','nJy0nZC2CM9zwejd','mJbuwhbHANm','vxbKyxrLzcbWCM9Qzwn0igrPCMvJDg9YEsbMB3iGDg9VBhm6ia','z2v0','z2v0vg9VBa','lI4VDg9VBhmVzMLSzvn5C3rLBvrVB2WUANm','yNjVD3nLCG','ota0nwfpCevYuG','zNvUy3rPB24','Aw5MBW','zMLSzs1JB250zw50lxjLCgXHy2u','ChjVAMvJDerPCG','odCYmJuWtg5JseTb'];a0_0x2093=function(){return _0x5dd6aa;};return a0_0x2093();}import a0_0x20f9e8 from'path';import{promises as a0_0x55d86d}from'fs';export class ToolRegistry{constructor(_0x1b70cc,_0x48f114,_0x107c11=null,_0x23ccc0=null){const _0x389327=a0_0x12d7;this['config']=_0x1b70cc,this[_0x389327(0xf3)]=_0x48f114,this[_0x389327(0x103)]=_0x23ccc0,this['llmService']=_0x107c11,this[_0x389327(0xe3)]=new Map(),this[_0x389327(0xd5)]=new Map(),this['registerBuiltInTools']();}['setLLMService'](_0x5c8088){const _0x45cab0=a0_0x12d7;this[_0x45cab0(0xe7)]=_0x5c8088;if(this['tools']['has']('browser')){const _0x9b9424=this['tools']['get'](_0x45cab0(0xfe));_0x9b9424[_0x45cab0(0xd8)](_0x5c8088),this[_0x45cab0(0xf3)][_0x45cab0(0x101)](_0x45cab0(0xe0));}if(this[_0x45cab0(0xe3)]['has'](_0x45cab0(0xea))){const _0x56a7b1=this['tools']['get']('image-gen');_0x56a7b1['setLLMService'](_0x5c8088),this['logger']['info'](_0x45cab0(0xdb));}}['setProjectDirectory'](_0xe2971a){const _0x55d4f4=a0_0x12d7;this[_0x55d4f4(0x103)]=_0xe2971a;const _0x30b5e2=this['tools']['get'](_0x55d4f4(0xd1));_0x30b5e2&&typeof _0x30b5e2[_0x55d4f4(0xd7)]==='function'&&_0x30b5e2['setProjectDirectory'](_0xe2971a),this[_0x55d4f4(0xf3)]['info'](_0x55d4f4(0xfa)+_0xe2971a);}async['registerBuiltInTools'](){const _0x53ceb4=a0_0x12d7;this['logger'][_0x53ceb4(0x101)](_0x53ceb4(0xec));try{const {BrowserTool:_0x4ed686}=await import('../tools/browserTool.js'),_0x398b6d=new _0x4ed686(this['config'],this[_0x53ceb4(0xf3)],this['llmService']);this['registerTool']('browser',_0x398b6d);const {TerminalTool:_0x240d4c}=await import('../tools/terminalTool.js'),_0x1beaed=new _0x240d4c(this[_0x53ceb4(0xee)],this[_0x53ceb4(0xf3)],undefined,this['projectDir']);this['registerTool']('terminal',_0x1beaed);const {FileSystemTool:_0x2e68bc}=await import(_0x53ceb4(0xfd)),_0x490013=new _0x2e68bc(this['config'],this[_0x53ceb4(0xf3)]);this[_0x53ceb4(0xf5)](_0x53ceb4(0xf2),_0x490013);const {ImageTool:_0x7b4d19}=await import('../tools/imageTool.js'),_0x99b5f9=new _0x7b4d19(this[_0x53ceb4(0xee)],this[_0x53ceb4(0xf3)],this['llmService']);this[_0x53ceb4(0xf5)]('image-gen',_0x99b5f9);const {FileTreeTool:_0x5cb529}=await import(_0x53ceb4(0xf7)),_0x5793a7=new _0x5cb529(this[_0x53ceb4(0xee)],this[_0x53ceb4(0xf3)]);this[_0x53ceb4(0xf5)](_0x53ceb4(0xe5),_0x5793a7);const {SeekTool:_0x3456fb}=await import(_0x53ceb4(0xe9)),_0x25d6b8=new _0x3456fb(this['config'],this['logger']);this[_0x53ceb4(0xf5)](_0x53ceb4(0xf4),_0x25d6b8);const {MemoryTool:_0x1035de}=await import('../tools/memoryTool.js'),_0x5d91fd=new _0x1035de(this[_0x53ceb4(0xee)],this['logger']);this[_0x53ceb4(0xf5)]('memory',_0x5d91fd);const {CodeAnalysisTool:_0x22d41c}=await import('../tools/codeAnalysisTool.js'),_0x493831=new _0x22d41c(this['config'],this[_0x53ceb4(0xf3)]);this['registerTool']('code-analysis',_0x493831);const {FileContentReplaceTool:_0x319624}=await import('../tools/fileContentReplaceTool.js'),_0x4009f4=new _0x319624(this['config'],this['logger']);this['registerTool'](_0x53ceb4(0x102),_0x4009f4);if(this[_0x53ceb4(0xee)][_0x53ceb4(0xe3)]?.['mcpTool']?.[_0x53ceb4(0xd6)]){const _0x4813f3=new MCPClientTool(this['config'],this['logger']);this[_0x53ceb4(0xf5)](_0x53ceb4(0xd2),_0x4813f3);}if(this[_0x53ceb4(0xee)][_0x53ceb4(0xe3)]?.[_0x53ceb4(0xdd)]?.['enabled']){const _0x54717c=await import('../tools/uiTool.js'),_0x52aea7=new _0x54717c(this[_0x53ceb4(0xee)],this['logger']);this['registerTool']('ui',_0x52aea7);}const {UpdateUserTool:_0x5a162b}=await import('../tools/updateUserTool.js'),_0x54edf5=new _0x5a162b(this[_0x53ceb4(0xee)],this['logger']);this['registerTool'](_0x53ceb4(0xf0),_0x54edf5),this['logger'][_0x53ceb4(0x101)](_0x53ceb4(0xe1)+this[_0x53ceb4(0xe3)][_0x53ceb4(0xd0)]+'\x20tools');}catch(_0x281a4f){this[_0x53ceb4(0xf3)]['error']('Error\x20registering\x20built-in\x20tools:',_0x281a4f);throw _0x281a4f;}}[a0_0x3cfaa6(0xf5)](_0x373e14,_0x52d85b){const _0x10b57a=a0_0x3cfaa6;this['logger'][_0x10b57a(0x101)]('Registering\x20tool:\x20'+_0x373e14);if(typeof _0x52d85b['execute']!=='function')throw new Error('Tool\x20'+_0x373e14+'\x20does\x20not\x20have\x20an\x20execute\x20method');if(typeof _0x52d85b['getDescription']!=='function')throw new Error(_0x10b57a(0xe4)+_0x373e14+_0x10b57a(0xd4));this[_0x10b57a(0xe3)][_0x10b57a(0xef)](_0x373e14,_0x52d85b),this[_0x10b57a(0xd5)]['set'](_0x373e14,_0x52d85b[_0x10b57a(0xed)]());}['hasTool'](_0x346bdd){const _0xd01219=a0_0x3cfaa6;return this['tools'][_0xd01219(0xdc)](_0x346bdd);}[a0_0x3cfaa6(0xfc)](_0x7293b2){const _0x4907b2=a0_0x3cfaa6;if(!this['tools']['has'](_0x7293b2))throw new Error('Tool\x20'+_0x7293b2+_0x4907b2(0xe8));return this[_0x4907b2(0xe3)][_0x4907b2(0xfb)](_0x7293b2);}['getToolIds'](){const _0x51f636=a0_0x3cfaa6;return Array['from'](this[_0x51f636(0xe3)]['keys']());}[a0_0x3cfaa6(0xce)](){const _0x8e6911=a0_0x3cfaa6;let _0x22be61='';for(const [_0x47e7f4,_0x30eab1]of this['toolDescriptions'][_0x8e6911(0xde)]()){_0x22be61+='Tool\x20ID:\x20'+_0x47e7f4+'\x0a',_0x22be61+=_0x30eab1+'\x0a\x0a';}return _0x22be61;}[a0_0x3cfaa6(0xdf)](_0x29ff11){const _0x41e157=a0_0x3cfaa6;if(!this['toolDescriptions'][_0x41e157(0xdc)](_0x29ff11))throw new Error('Tool\x20'+_0x29ff11+_0x41e157(0xe8));return this[_0x41e157(0xd5)]['get'](_0x29ff11);}['createToolsSystemPrompt'](){const _0x58ecdd=a0_0x3cfaa6;let _0x28a401=_0x58ecdd(0xd3);for(const [_0x11c7e4,_0x51a65a]of this[_0x58ecdd(0xd5)][_0x58ecdd(0xde)]()){_0x28a401+='##\x20'+_0x11c7e4+'\x0a',_0x28a401+=_0x51a65a+'\x0a\x0a';}return _0x28a401+='To\x20use\x20a\x20tool,\x20wrap\x20your\x20commands\x20in\x20[tools-commands]\x20and\x20[/tools-commands]\x20tags.\x0a',_0x28a401+='For\x20each\x20tool,\x20use\x20[tool\x20id=\x22tool_id\x22]\x20and\x20[/tool]\x20tags\x20to\x20specify\x20which\x20tool\x20to\x20use.\x0a',_0x28a401+=_0x58ecdd(0xe2),_0x28a401;}async['shutdown'](){const _0x10785e=a0_0x3cfaa6;this[_0x10785e(0xf3)]['info']('Shutting\x20down\x20all\x20tools');const _0x1b2398=[];for(const [_0x4d9491,_0x9316d3]of this[_0x10785e(0xe3)]['entries']()){typeof _0x9316d3['shutdown']===_0x10785e(0x100)&&(this[_0x10785e(0xf3)]['info'](_0x10785e(0xda)+_0x4d9491),_0x1b2398['push'](_0x9316d3['shutdown']()));}await Promise['allSettled'](_0x1b2398),this['logger'][_0x10785e(0x101)]('All\x20tools\x20shut\x20down');}}