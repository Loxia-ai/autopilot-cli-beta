#!/usr/bin/env node

const a0_0x5bcc1f=a0_0x3f56;(function(_0x4343ce,_0x143696){const _0x49e512=a0_0x3f56,_0x244d91=_0x4343ce();while(!![]){try{const _0x564dd0=parseInt(_0x49e512(0x16c))/0x1*(-parseInt(_0x49e512(0x128))/0x2)+parseInt(_0x49e512(0x171))/0x3*(parseInt(_0x49e512(0x126))/0x4)+-parseInt(_0x49e512(0x17c))/0x5*(parseInt(_0x49e512(0x169))/0x6)+parseInt(_0x49e512(0x158))/0x7*(parseInt(_0x49e512(0x116))/0x8)+parseInt(_0x49e512(0x132))/0x9*(parseInt(_0x49e512(0x146))/0xa)+-parseInt(_0x49e512(0x176))/0xb*(parseInt(_0x49e512(0x17f))/0xc)+-parseInt(_0x49e512(0x115))/0xd*(-parseInt(_0x49e512(0x16e))/0xe);if(_0x564dd0===_0x143696)break;else _0x244d91['push'](_0x244d91['shift']());}catch(_0x544cf1){_0x244d91['push'](_0x244d91['shift']());}}}(a0_0xe8e3,0xf2f8c));import a0_0x798725 from'dotenv';a0_0x798725['config']();function a0_0x3f56(_0x383cc6,_0x86f369){const _0xe8e30c=a0_0xe8e3();return a0_0x3f56=function(_0x3f5669,_0x372f14){_0x3f5669=_0x3f5669-0xfb;let _0x1efaf2=_0xe8e30c[_0x3f5669];if(a0_0x3f56['SGnATu']===undefined){var _0x277e30=function(_0x798725){const _0x2b6e4e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3b0b63='',_0x1c1f21='';for(let _0x489b90=0x0,_0x565507,_0xeac761,_0x50e24e=0x0;_0xeac761=_0x798725['charAt'](_0x50e24e++);~_0xeac761&&(_0x565507=_0x489b90%0x4?_0x565507*0x40+_0xeac761:_0xeac761,_0x489b90++%0x4)?_0x3b0b63+=String['fromCharCode'](0xff&_0x565507>>(-0x2*_0x489b90&0x6)):0x0){_0xeac761=_0x2b6e4e['indexOf'](_0xeac761);}for(let _0x1a8265=0x0,_0x302a98=_0x3b0b63['length'];_0x1a8265<_0x302a98;_0x1a8265++){_0x1c1f21+='%'+('00'+_0x3b0b63['charCodeAt'](_0x1a8265)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1c1f21);};a0_0x3f56['xLsWBK']=_0x277e30,_0x383cc6=arguments,a0_0x3f56['SGnATu']=!![];}const _0x6b616a=_0xe8e30c[0x0],_0x24b702=_0x3f5669+_0x6b616a,_0x3d81ca=_0x383cc6[_0x24b702];return!_0x3d81ca?(_0x1efaf2=a0_0x3f56['xLsWBK'](_0x1efaf2),_0x383cc6[_0x24b702]=_0x1efaf2):_0x1efaf2=_0x3d81ca,_0x1efaf2;},a0_0x3f56(_0x383cc6,_0x86f369);}import{CLI}from'./core/cli.js';import{ConversationOrchestrator}from'./core/conversationOrchestrator.js';function a0_0xe8e3(){const _0x18039b=['ndHvCgLqsge','t3jJAgvZDhjHDg9YigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','Bg9Nz2LUzW','ndC5ntiZA3HlD2Lz','y2f0y2G','nJeZmtu4rK56wuDS','AgvHBhrOEq','Bg9Nz2vY','mJfywujyyMe','yNvKz2v0','vMvYAwz5ihrOzsbZzxj2zxiGvvjmigLUihLVDxiGy29UzMLNDxjHDgLVBG','y29UC29Szq','C2vYDMvY','nJGYEernzwDn','D2fYBG','u2LNBMfSigHHBMrSzxjZignVBMzPz3vYzwq','te9ysufFrevcvuC','q29UzMLNDxjHDgLVBIbSB2fKzwqGyw5KihzHBgLKyxrLzcbZDwnJzxnZzNvSBhK','CgvYBwLZC2LVBG','mtaXodeZnu55s3rLDq','Aw5PDgLHBgL6yxrPB25tDgfYDfrPBwu','zMLSzq','mtGYoti4AMTbzun6','icaTia','u0Lhsu5u','C3rHy2S','q0XjihnODxrKB3DUigvYCM9YoG','q0XjihnODxrKB3DUihrPBwvVDxq','BwvZC2fNzq','zgvIDwC','z2v0sgvHBhrOu3rHDhvZ','ls1OzwXW','y29TCgXLDgvuyxnR','zw52','zxHPDa','Bg9N','q2HLy2SGBMv0D29YAYbJB25Uzwn0AxzPDhK','vhj5igfNywLUigLUigeGzMv3ig1VBwvUDhm','zw5HyMXLza','sgvHBhrOig1VBML0B3jPBMCGy29UzMLNDxjLza','rM9Yy2uGC2H1DgrVD24GlsbYzwnLAxzLzcbZzwnVBMqGu0Lhsu5u','vhj5ihvZAw5NigzHBgXIywnRig1Vzgu6ieXpweLbx1vtrv9trvjwrvjFteXnpwzHBhnL','cVcFKQeGvhjVDwjSzxnOB290Aw5Nihn1z2DLC3rPB25ZoG','vw5Oyw5KBgvKihbYB21PC2uGCMvQzwn0Aw9UoG','C3rHDhvZ','yw50AhjVCgLJ','cLn0ywnRihrYywnLoG','r3jHy2vMDwWGC2H1DgrVD24','B3jJAgvZDhjHDg9Y','C2LSzw50','q2fUBM90ihDYAxrLihrVigj1zgDLDcbKAxjLy3rVCNK6ia','mtaWmw1ArgjbqW','ohvkyKTTzq','ChvZAa','u3rHCNrPBMCGtg94AweGq0XjigfWCgXPy2f0Aw9U','BwTKAxi','DgHLBG','sw5PDgLHBgL6Aw5NignVBNzLCNnHDgLVBIbVCMnOzxn0CMf0B3i','Dw5OzwfSDgH5','Bg9JywW','z2XVyMfS','tg94AweGq0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEsbPBIa','yxjNDG','y2XP','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbPBML0AwfSAxPLzcbZDwnJzxnZzNvSBhK','qM9VDhn0CMfW','Aw5MBW','BM8GBg9JywWGy29UzMLN','mtyXmZy0t09Sy2nu','u0Lhvevstq','ogrssfjNCW','tM8GqvbjigTLEsbMB3vUzcaTihnVBwuGy29TBwfUzhmGD2LSBcbUB3qGyMuGyxzHAwXHyMXL','zxjYB3i','te9ysufFte9hx0XfvKvm','r0vu','tg9HzgLUzYbJB25MAwD1CMf0Aw9U','icaG4OcIifj1BJOGBg94AweGls1OzwXW','C29Tzq','AgvHBhrOq2HLy2TjBNrLCNzHBa','q0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEq','mteYnteWmJzKq3nts2m','B3bLBMfP','icaG4OcIia','Dw5Oyw5KBgvKuMvQzwn0Aw9U','zM9YrwfJAa','cUkDJcbgywLSzwqGDg8GC3rHCNqGtg94AweGq0XjoG','CMfJzq','ChjVBwLZzxm','rw1LCMDLBMn5ihnODxrKB3DUigzHAwXLzdO','sgvHBhrOignOzwnRigzHAwXLzdO','u2v0ihLVDxiGqvbjigTLEsb3AxrOoIbSB3HPysbRzxKGls1ZzxqGphLVDxiTyxbPlwTLEt4','r3jHy2vMDwWGC2H1DgrVD24Gy29TCgXLDgvKihn1y2nLC3nMDwXSEq','C3rHCNruyxnR','sw5PDgLHBgL6Aw5NigfWCgXPy2f0Aw9UignVBxbVBMvUDhm','qM9VDhn0CMfWihrPBwvVDxq','Aw5JBhvKzxm','C2H1DgrVD24','BM93','C2XPy2u','C2f2zvnLC3nPB25tDgf0zq','mtbQyMHIDMS','v19psW','vMfSAwrHDguGy29UzMLNDxjHDgLVBJOGBg94AweGy29UzMLNic0TDMfSAwrHDgu','B3zLCMfSBa','z29Vz2XL','BwfRzq','y3LHBG','ywnJzxnZ','tM9Kzs5QCYb3yxjUAw5NoG','uNvUDgLTzsb2ywXPzgf0Aw9UigzHAwXLzdOk','cVcFKQuGrMf0ywWGC3rHCNr1CcbLCNjVCJO','z2v0u3rVCMvKqxbPs2v5','C2vYDMLJzxm','cVcFLi0GrM9Yig1VCMuGAgvSCdO','q2fUBM90ihjLywnOihnLCNzLCIbHDca','u2H1DhrPBMCGzg93BIbKDwuGDg8G','y29UC3rHBNrZ','z3jHEq','nda3oda0nLb6t0nOsW','Dw5RBM93BG','CMvK','ls12zxjZAw9U','rM9Yy2uGC2H1DgrVD24GlsbYzwnLAxzLzcbZzwnVBMqGu0Lhvevstq','yxbPs2v5','AxntAhv0DgLUz0rVD24','BgvUz3rO','rxjYB3iGzhvYAw5NigDYywnLzNvSihnODxrKB3DUoG','te9ysufFu0Lmru5u','DxnLu2vYDMvYteXn','u2vYDMLJzsbOzwfSDgGGy2HLy2SGzgv0zwn0zwqGAxnZDwvZoG','q2HLy2SGEw91CIbPBNrLCM5LDcbJB25Uzwn0Aw9U','zgvNCMfKzwq','uMvJzwL2zwqGu0Lhsu5ulcbPBML0Awf0Aw5NigDYywnLzNvSihnODxrKB3DU','EwvSBg93','Bg9Ntgv2zwW'];a0_0xe8e3=function(){return _0x18039b;};return a0_0xe8e3();}import{LoggingService}from'./services/loggingService.js';import{loadConfig}from'./config/configLoader.js';import a0_0x2b6e4e from'chalk';import{performance}from'perf_hooks';const INITIALIZATION_TIMEOUT_MS=0x7530,GRACEFUL_SHUTDOWN_TIMEOUT_MS=0x2710,SERVICE_HEALTH_CHECK_INTERVAL_MS=0x493e0;let applicationState={'isShuttingDown':![],'initializationStartTime':null,'services':{'logger':null,'config':null,'cli':null,'orchestrator':null},'healthCheckInterval':null};async function bootstrap(){const _0x41503a=a0_0x3f56;applicationState[_0x41503a(0x17d)]=performance['now']();const _0x3b0b63=createInitialLogger();applicationState['services']['logger']=_0x3b0b63;try{_0x3b0b63[_0x41503a(0x124)](_0x41503a(0x118)),_0x3b0b63['startTask'](_0x41503a(0x123),_0x41503a(0x13f));const _0x1c1f21=await initializeConfiguration(_0x3b0b63);applicationState['services']['config']=_0x1c1f21;const _0x489b90=createEnhancedLogger(_0x1c1f21);applicationState[_0x41503a(0x152)]['logger']=_0x489b90;const _0x565507=await initializeCLI(_0x1c1f21,_0x489b90);applicationState[_0x41503a(0x152)][_0x41503a(0x121)]=_0x565507,await initializeOrchestratorIfNeeded(_0x565507,_0x1c1f21,_0x489b90),setupSignalHandlers(_0x489b90),setupHealthMonitoring(_0x489b90);const _0xeac761=performance[_0x41503a(0x143)]()-applicationState[_0x41503a(0x17d)];_0x489b90['completeTask']('Bootstrap',!![],{'initializationTime':Math['round'](_0xeac761),'serverMode':_0x1c1f21[_0x41503a(0x162)],'services':Object['keys'](applicationState[_0x41503a(0x152)])['filter'](_0x50e24e=>applicationState[_0x41503a(0x152)][_0x50e24e]!==null)}),_0x489b90['info'](_0x41503a(0x11f)+Math['round'](_0xeac761)+'ms'),await _0x565507['start']();}catch(_0x1a8265){const _0x302a98=performance['now']()-applicationState[_0x41503a(0x17d)];_0x3b0b63[_0x41503a(0x102)](_0x41503a(0x123),![],{'error':_0x1a8265[_0x41503a(0xfe)],'initializationTime':Math['round'](_0x302a98)}),console['error'](a0_0x2b6e4e[_0x41503a(0x15a)](_0x41503a(0x137))),console[_0x41503a(0x12a)](a0_0x2b6e4e[_0x41503a(0x15a)]('\x20\x20\x20'+_0x1a8265[_0x41503a(0xfe)])),_0x1a8265['stack']&&process[_0x41503a(0x103)][_0x41503a(0x179)]&&(console['error'](a0_0x2b6e4e[_0x41503a(0x157)](_0x41503a(0x110))),console['error'](a0_0x2b6e4e['gray'](_0x1a8265['stack']))),provideTroubleshootingSuggestions(_0x1a8265),await performEmergencyShutdown(_0x3b0b63),process['exit'](0x1);}}function createInitialLogger(){const _0x3863d5=a0_0x3f56;return new LoggingService({'console':![],'file':![],'logLevel':process['env'][_0x3863d5(0x12b)]||_0x3863d5(0x124),'silent':process['env'][_0x3863d5(0x161)]==='true'});}async function initializeConfiguration(_0x4ea27e){const _0x1aac9c=a0_0x3f56;_0x4ea27e['info'](_0x1aac9c(0x12d));try{const _0xcac6b4=await loadConfig();return await validateRuntimeConfiguration(_0xcac6b4,_0x4ea27e),_0x4ea27e['info'](_0x1aac9c(0x17a),{'serverMode':_0xcac6b4[_0x1aac9c(0x162)],'logLevel':_0xcac6b4['logging']['logLevel'],'llmStrategy':_0xcac6b4['llmStrategy']}),_0xcac6b4;}catch(_0x59c2e2){_0x4ea27e['error']('Configuration\x20loading\x20failed:',_0x59c2e2);throw new Error('Configuration\x20error:\x20'+_0x59c2e2[_0x1aac9c(0xfe)]);}}async function validateRuntimeConfiguration(_0x555d76,_0x553f43){const _0x45722c=a0_0x3f56,_0x5649ea=[];if(_0x555d76['useServerLLM'])try{const _0x136176=await fetch(_0x555d76['serverUrl']+'/health',{'method':_0x45722c(0x12c),'timeout':0x1388});!_0x136176['ok']&&_0x5649ea['push']('Server\x20health\x20check\x20failed:\x20HTTP\x20'+_0x136176['status']);}catch(_0x1cf6ee){_0x5649ea['push'](_0x45722c(0x154)+_0x555d76['serverUrl']+':\x20'+_0x1cf6ee['message']);}if(!_0x555d76['useServerLLM']){const _0x59196c=_0x555d76[_0x45722c(0x152)]['anthropic']['apiKey']||_0x555d76['services'][_0x45722c(0x133)][_0x45722c(0x15d)]||_0x555d76['services']['google']['apiKey'];!_0x59196c&&_0x5649ea['push']('No\x20API\x20keys\x20configured\x20for\x20fallback\x20services');}try{const _0x5185e5=_0x555d76[_0x45722c(0x172)]['usageDir'];await import('fs')[_0x45722c(0x11a)](_0x59a51d=>_0x59a51d['promises'][_0x45722c(0x119)](_0x5185e5,{'recursive':!![]})),await import('fs')[_0x45722c(0x11a)](_0x275ef2=>_0x275ef2['promises']['access'](_0x5185e5,_0x275ef2[_0x45722c(0x156)][_0x45722c(0x147)]));}catch(_0x1df850){_0x5649ea['push'](_0x45722c(0x114)+_0x1df850['message']);}if(_0x5649ea[_0x45722c(0x15f)]>0x0){const _0x13dcc4=_0x45722c(0x14f)+_0x5649ea['map'](_0x2c9627=>_0x45722c(0x180)+_0x2c9627)['join']('\x0a');if(_0x555d76['useServerLLM']&&_0x5649ea['some'](_0x3b691a=>_0x3b691a[_0x45722c(0x141)]('server')))_0x553f43[_0x45722c(0x177)]('Server\x20validation\x20failed,\x20will\x20attempt\x20fallback\x20to\x20local\x20services'),_0x555d76[_0x45722c(0x162)]=![],_0x555d76['services'][_0x45722c(0x10f)][_0x45722c(0x108)]=!!_0x555d76[_0x45722c(0x152)]['anthropic'][_0x45722c(0x15d)],_0x555d76['services'][_0x45722c(0x133)][_0x45722c(0x108)]=!!_0x555d76['services'][_0x45722c(0x133)]['apiKey'],_0x555d76['services'][_0x45722c(0x14a)]['enabled']=!!_0x555d76[_0x45722c(0x152)][_0x45722c(0x14a)]['apiKey'];else throw new Error(_0x13dcc4);}}function createEnhancedLogger(_0x50ac6b){const _0x432be0=a0_0x3f56;return new LoggingService({'console':_0x50ac6b['logging'][_0x432be0(0x174)]!==![],'file':_0x50ac6b['logging'][_0x432be0(0x17e)]!==![],'logLevel':_0x50ac6b['logging'][_0x432be0(0x168)],'logDir':_0x50ac6b[_0x432be0(0x16b)]['logDir'],'silent':_0x50ac6b['logging'][_0x432be0(0x113)]===!![]});}async function initializeCLI(_0x3b8c7b,_0x70db78){const _0x54089e=a0_0x3f56;_0x70db78['info']('Initializing\x20CLI');try{const _0x537508=new CLI(null,_0x3b8c7b,_0x70db78);return await validateCLIResources(_0x537508,_0x3b8c7b,_0x70db78),_0x70db78['info'](_0x54089e(0x131)),_0x537508;}catch(_0x19587b){_0x70db78[_0x54089e(0x12a)]('CLI\x20initialization\x20failed:',_0x19587b);throw new Error('CLI\x20initialization\x20error:\x20'+_0x19587b['message']);}}async function validateCLIResources(_0x1c5797,_0x5b829f,_0xc9d1a7){const _0x112c37=a0_0x3f56,_0x281c49=await _0x1c5797[_0x112c37(0x151)]()['catch'](()=>null);!_0x281c49&&_0x5b829f[_0x112c37(0x162)]&&_0xc9d1a7['warn'](_0x112c37(0x129));try{const {getConfigPaths:_0x51c993}=await import('./config/configLoader.js'),_0x3f2791=_0x51c993();await import('fs')['then'](_0xd2d8b6=>{const _0xe86ab7=_0x112c37,_0x3ddb56=[];return _0x3f2791[_0xe86ab7(0x11e)]&&_0x3ddb56[_0xe86ab7(0x117)](_0xd2d8b6[_0xe86ab7(0x139)][_0xe86ab7(0x14d)](_0x3f2791['global'])['catch'](()=>'no\x20global\x20config')),_0x3f2791[_0xe86ab7(0x11d)]&&_0x3ddb56[_0xe86ab7(0x117)](_0xd2d8b6['promises'][_0xe86ab7(0x14d)](_0x3f2791[_0xe86ab7(0x11d)])['catch'](()=>_0xe86ab7(0x125))),Promise['allSettled'](_0x3ddb56);});}catch(_0x26b4d4){_0xc9d1a7[_0x112c37(0x177)]('Configuration\x20file\x20validation\x20failed:',_0x26b4d4);}}async function initializeOrchestratorIfNeeded(_0x494511,_0x54b1a3,_0x40bfe8){const _0x5b0d7b=a0_0x3f56,_0x55e548=process['argv']['slice'](0x2),_0x856e62=_0x55e548[0x0],_0x2ab0e2=['key','status',_0x5b0d7b(0x172),_0x5b0d7b(0x101),'-h',_0x5b0d7b(0x15b),'-v'];if(_0x2ab0e2['includes'](_0x856e62)||_0x55e548['includes'](_0x5b0d7b(0x101))||_0x55e548['includes']('-h')){_0x40bfe8[_0x5b0d7b(0xff)]('Skipping\x20orchestrator\x20initialization\x20for\x20utility\x20command');return;}_0x40bfe8[_0x5b0d7b(0x124)](_0x5b0d7b(0x11b));try{const _0x3d624a=new ConversationOrchestrator(_0x54b1a3,_0x40bfe8);await _0x3d624a['initializeServices'](),_0x494511['setOrchestrator'](_0x3d624a),applicationState[_0x5b0d7b(0x152)][_0x5b0d7b(0x112)]=_0x3d624a,_0x40bfe8['info'](_0x5b0d7b(0x122));}catch(_0x28cee0){_0x40bfe8[_0x5b0d7b(0x12a)]('Orchestrator\x20initialization\x20failed:',_0x28cee0);if([_0x5b0d7b(0x10e),'budget']['includes'](_0x856e62))_0x40bfe8['warn']('Continuing\x20without\x20orchestrator\x20for\x20status\x20command');else throw new Error(_0x5b0d7b(0x16a)+_0x28cee0['message']);}}function setupSignalHandlers(_0x3537fc){const _0x4d1967=a0_0x3f56;process['on'](_0x4d1967(0x181),async()=>{const _0x346b90=_0x4d1967;applicationState['isShuttingDown']&&(_0x3537fc[_0x346b90(0x177)](_0x346b90(0x10a)),process['exit'](0x1)),_0x3537fc[_0x346b90(0x124)](_0x346b90(0x166)),await performGracefulShutdown(_0x3537fc,'SIGINT');}),process['on'](_0x4d1967(0x127),async()=>{const _0x15b579=_0x4d1967;applicationState[_0x15b579(0x15e)]&&(_0x3537fc['warn'](_0x15b579(0x15c)),process['exit'](0x1)),_0x3537fc['info']('Received\x20SIGTERM,\x20initiating\x20graceful\x20shutdown'),await performGracefulShutdown(_0x3537fc,'SIGTERM');}),process['on']('uncaughtException',async _0x36b3a1=>{const _0x50334b=_0x4d1967;_0x3537fc[_0x50334b(0x12a)]('Uncaught\x20exception:',_0x36b3a1),_0x36b3a1[_0x50334b(0xfb)]&&_0x3537fc[_0x50334b(0x12a)]('Stack\x20trace:',_0x36b3a1['stack']),await performEmergencyShutdown(_0x3537fc),process['exit'](0x1);}),process['on'](_0x4d1967(0x135),async(_0x511766,_0x22bfbe)=>{const _0x59f5e9=_0x4d1967;_0x3537fc[_0x59f5e9(0x12a)](_0x59f5e9(0x10d),{'reason':_0x511766?.['message']||_0x511766,'promise':_0x22bfbe?.['toString']()}),_0x511766?.[_0x59f5e9(0xfb)]&&_0x3537fc[_0x59f5e9(0x12a)]('Rejection\x20stack\x20trace:',_0x511766[_0x59f5e9(0xfb)]),await performEmergencyShutdown(_0x3537fc),process['exit'](0x1);}),process['on']('warning',_0x24a50b=>{const _0x170ff0=_0x4d1967;_0x3537fc[_0x170ff0(0x177)](_0x170ff0(0x14e),{'name':_0x24a50b['name'],'message':_0x24a50b[_0x170ff0(0xfe)],'stack':_0x24a50b[_0x170ff0(0xfb)]});}),_0x3537fc['debug'](_0x4d1967(0x178));}function setupHealthMonitoring(_0x40959b){const _0x5181bf=a0_0x3f56,_0x5935df=process[_0x5181bf(0x120)][_0x5181bf(0x144)](0x2),_0x5f3a3f=['do',_0x5181bf(0x14b),'resume','modify'];if(!_0x5f3a3f[_0x5181bf(0x12f)](_0x158a0c=>_0x5935df['includes'](_0x158a0c)))return;applicationState[_0x5181bf(0x130)]=setInterval(async()=>{const _0x292f4e=_0x5181bf;try{await performHealthCheck(_0x40959b);}catch(_0x4f12d8){_0x40959b['warn'](_0x292f4e(0x13b),_0x4f12d8);}},SERVICE_HEALTH_CHECK_INTERVAL_MS),_0x40959b[_0x5181bf(0xff)](_0x5181bf(0x109));}async function performHealthCheck(_0x1a0602){const _0x3ee67e=a0_0x3f56,_0x2a1476={'timestamp':new Date()['toISOString'](),'services':{},'overall':_0x3ee67e(0x16f)};if(applicationState[_0x3ee67e(0x152)]['cli'])try{_0x2a1476['services'][_0x3ee67e(0x121)]='healthy';}catch(_0x5ad9e4){_0x2a1476[_0x3ee67e(0x152)][_0x3ee67e(0x121)]=_0x3ee67e(0x11c),_0x2a1476[_0x3ee67e(0x149)]=_0x3ee67e(0x165);}if(applicationState[_0x3ee67e(0x152)]['orchestrator'])try{const _0x950559=await applicationState['services'][_0x3ee67e(0x112)][_0x3ee67e(0x100)]?.()||_0x3ee67e(0x159);_0x2a1476[_0x3ee67e(0x152)]['orchestrator']=_0x950559['overall']||'healthy',(_0x950559['overall']==='degraded'||_0x950559['overall']==='unhealthy')&&(_0x2a1476[_0x3ee67e(0x149)]='degraded');}catch(_0x35754c){_0x2a1476['services'][_0x3ee67e(0x112)]=_0x3ee67e(0x11c),_0x2a1476['overall']='degraded';}_0x2a1476['overall']!==_0x3ee67e(0x16f)?_0x1a0602[_0x3ee67e(0x177)](_0x3ee67e(0x163),_0x2a1476):_0x1a0602[_0x3ee67e(0xff)]('Health\x20check\x20passed:',_0x2a1476);}async function performGracefulShutdown(_0x81c320,_0xbf03a0){const _0x7ffece=a0_0x3f56;if(applicationState['isShuttingDown'])return;applicationState[_0x7ffece(0x15e)]=!![],_0x81c320[_0x7ffece(0x13e)](_0x7ffece(0x111),_0x7ffece(0x155)+_0xbf03a0);try{applicationState[_0x7ffece(0x130)]&&(clearInterval(applicationState['healthCheckInterval']),applicationState['healthCheckInterval']=null);const _0x2e27f4=[];applicationState['services'][_0x7ffece(0x112)]?.['shutdown']&&_0x2e27f4['push'](Promise[_0x7ffece(0x138)]([applicationState['services']['orchestrator']['shutdown'](),new Promise((_0x122b7f,_0x171fa6)=>setTimeout(()=>_0x171fa6(new Error('Orchestrator\x20shutdown\x20timeout')),0x1388))])['catch'](_0x57220=>{const _0x2413e4=_0x7ffece;_0x81c320[_0x2413e4(0x177)]('Orchestrator\x20shutdown\x20error:',_0x57220);})),applicationState[_0x7ffece(0x152)]['cli']?.[_0x7ffece(0x142)]&&_0x2e27f4[_0x7ffece(0x117)](Promise[_0x7ffece(0x138)]([applicationState[_0x7ffece(0x152)][_0x7ffece(0x121)][_0x7ffece(0x142)](),new Promise((_0x39ab33,_0x1b11c2)=>setTimeout(()=>_0x1b11c2(new Error(_0x7ffece(0xfd))),0xbb8))])['catch'](_0xd7101e=>{const _0xe856d2=_0x7ffece;_0x81c320[_0xe856d2(0x177)](_0xe856d2(0xfc),_0xd7101e);})),await Promise['race']([Promise['allSettled'](_0x2e27f4),new Promise(_0x5b1ea2=>setTimeout(_0x5b1ea2,GRACEFUL_SHUTDOWN_TIMEOUT_MS))]),_0x81c320['completeTask'](_0x7ffece(0x111),!![]),_0x81c320['info'](_0x7ffece(0x13d));}catch(_0x3e4668){_0x81c320['completeTask'](_0x7ffece(0x111),![],{'error':_0x3e4668['message']}),_0x81c320[_0x7ffece(0x12a)](_0x7ffece(0x160),_0x3e4668);}finally{setTimeout(()=>{process['exit'](0x0);},0x1f4);}}async function performEmergencyShutdown(_0x47e4b1){const _0x3b1eac=a0_0x3f56;if(applicationState[_0x3b1eac(0x15e)])return;applicationState['isShuttingDown']=!![],_0x47e4b1['error']('Performing\x20emergency\x20shutdown');try{applicationState[_0x3b1eac(0x130)]&&clearInterval(applicationState['healthCheckInterval']),applicationState[_0x3b1eac(0x152)]['orchestrator']?.[_0x3b1eac(0x145)]&&await Promise[_0x3b1eac(0x138)]([applicationState['services'][_0x3b1eac(0x112)][_0x3b1eac(0x145)](),new Promise(_0xf9ede6=>setTimeout(_0xf9ede6,0x7d0))])['catch'](()=>{}),_0x47e4b1['error']('Emergency\x20shutdown\x20completed');}catch(_0x46a4a8){console['error'](_0x3b1eac(0x13a),_0x46a4a8[_0x3b1eac(0xfe)]);}}function provideTroubleshootingSuggestions(_0x118e7b){const _0x43dd6d=a0_0x3f56,_0x211273=[],_0x52c516=_0x118e7b[_0x43dd6d(0xfe)]['toLowerCase']();_0x52c516[_0x43dd6d(0x141)]('api\x20key')&&(_0x211273['push'](_0x43dd6d(0x13c)),_0x211273['push']('Get your API key from: https://autopilot.loxia.ai/account/api-keys')),(_0x52c516['includes'](_0x43dd6d(0x175))||_0x52c516['includes']('connection'))&&(_0x211273['push'](_0x43dd6d(0x164)),_0x211273[_0x43dd6d(0x117)](_0x43dd6d(0x173)),_0x211273[_0x43dd6d(0x117)](_0x43dd6d(0x10b))),(_0x52c516['includes'](_0x43dd6d(0x17b))||_0x52c516[_0x43dd6d(0x141)]('access'))&&(_0x211273['push']('Check\x20file\x20system\x20permissions'),_0x211273[_0x43dd6d(0x117)]('Ensure\x20you\x20have\x20write\x20access\x20to\x20the\x20current\x20directory'),_0x211273['push']('Try running from a different directory')),_0x52c516['includes']('timeout')&&(_0x211273['push']('Increase\x20timeout\x20settings\x20in\x20configuration'),_0x211273['push'](_0x43dd6d(0x106)),_0x211273[_0x43dd6d(0x117)](_0x43dd6d(0x107))),_0x52c516['includes']('config')&&(_0x211273[_0x43dd6d(0x117)]('Check\x20configuration\x20file\x20syntax'),_0x211273[_0x43dd6d(0x117)]('Create default config: loxia config --create'),_0x211273['push'](_0x43dd6d(0x148))),_0x211273[_0x43dd6d(0x15f)]>0x0&&(console['log'](a0_0x2b6e4e['yellow'](_0x43dd6d(0x10c))),_0x211273[_0x43dd6d(0x136)](_0x5523c7=>{const _0x5f2971=_0x43dd6d;console['log'](a0_0x2b6e4e[_0x5f2971(0x14c)](_0x5f2971(0x134)+_0x5523c7));})),console[_0x43dd6d(0x105)](a0_0x2b6e4e[_0x43dd6d(0x157)](_0x43dd6d(0x153))),console[_0x43dd6d(0x105)](a0_0x2b6e4e[_0x43dd6d(0x157)](_0x43dd6d(0x12e))),console[_0x43dd6d(0x105)](a0_0x2b6e4e['gray']('\x20\x20\x20•\x20Check\x20documentation:\x20https://docs.loxia.ai')),console['log'](a0_0x2b6e4e['gray']('\x20\x20\x20•\x20Report\x20issues:\x20https://github.com/loxia-ai/cli/issues'));}async function handleBootstrapTimeout(_0x50a2d3){const _0x4a928f=a0_0x3f56;_0x50a2d3[_0x4a928f(0x12a)]('Bootstrap\x20process\x20timed\x20out'),console['error'](a0_0x2b6e4e[_0x4a928f(0x15a)]('\x0a⏰\x20Initialization\x20timed\x20out')),console[_0x4a928f(0x12a)](a0_0x2b6e4e[_0x4a928f(0x167)]('This\x20might\x20indicate:')),console[_0x4a928f(0x12a)](a0_0x2b6e4e[_0x4a928f(0x167)]('\x20\x20\x20•\x20Network\x20connectivity\x20issues')),console[_0x4a928f(0x12a)](a0_0x2b6e4e['yellow']('\x20\x20\x20•\x20Server\x20is\x20down\x20or\x20overloaded')),console['error'](a0_0x2b6e4e[_0x4a928f(0x167)]('\x20\x20\x20•\x20Configuration\x20problems')),await performEmergencyShutdown(_0x50a2d3),process[_0x4a928f(0x104)](0x1);}async function main(){const _0x25078d=a0_0x3f56,_0x19f424=Date['now']();try{await Promise['race']([bootstrap(),new Promise((_0xea5278,_0x51d469)=>setTimeout(()=>_0x51d469(new Error('Bootstrap\x20timeout')),INITIALIZATION_TIMEOUT_MS))]);}catch(_0x4d1156){const _0x9777e6=Date[_0x25078d(0x143)]()-_0x19f424;if(_0x4d1156[_0x25078d(0xfe)]===_0x25078d(0x140))await handleBootstrapTimeout(applicationState[_0x25078d(0x152)][_0x25078d(0x170)]||createInitialLogger());else throw _0x4d1156;}}main()[a0_0x5bcc1f(0x16d)](_0x48cd1b=>{const _0x16356c=a0_0x5bcc1f,_0x291bb7=applicationState[_0x16356c(0x152)]['logger']||createInitialLogger();_0x291bb7['error']('Fatal\x20error\x20during\x20startup:',_0x48cd1b),console[_0x16356c(0x12a)](a0_0x2b6e4e[_0x16356c(0x15a)](_0x16356c(0x150))),console[_0x16356c(0x12a)](a0_0x2b6e4e['red']('\x20\x20\x20'+_0x48cd1b[_0x16356c(0xfe)])),process['env'][_0x16356c(0x179)]&&_0x48cd1b[_0x16356c(0xfb)]&&(console['error'](a0_0x2b6e4e['gray'](_0x16356c(0x110))),console['error'](a0_0x2b6e4e[_0x16356c(0x157)](_0x48cd1b['stack']))),process[_0x16356c(0x104)](0x1);}),process['on']('warning',_0x2c7eb3=>{const _0x597369=a0_0x5bcc1f;applicationState['services'][_0x597369(0x170)]&&applicationState['services']['logger']['warn']('Process\x20warning:',_0x2c7eb3);});export{bootstrap,performGracefulShutdown,performHealthCheck};