#!/usr/bin/env node

const a0_0x4de01c=a0_0x2fc3;(function(_0x26cb6a,_0x41fd99){const _0x873ecf=a0_0x2fc3,_0x2fa6a1=_0x26cb6a();while(!![]){try{const _0x319e7f=-parseInt(_0x873ecf(0x222))/0x1*(-parseInt(_0x873ecf(0x20d))/0x2)+-parseInt(_0x873ecf(0x230))/0x3*(-parseInt(_0x873ecf(0x204))/0x4)+-parseInt(_0x873ecf(0x217))/0x5+parseInt(_0x873ecf(0x22a))/0x6*(parseInt(_0x873ecf(0x245))/0x7)+parseInt(_0x873ecf(0x1fc))/0x8*(parseInt(_0x873ecf(0x21b))/0x9)+-parseInt(_0x873ecf(0x246))/0xa*(parseInt(_0x873ecf(0x1fe))/0xb)+-parseInt(_0x873ecf(0x22c))/0xc*(-parseInt(_0x873ecf(0x21c))/0xd);if(_0x319e7f===_0x41fd99)break;else _0x2fa6a1['push'](_0x2fa6a1['shift']());}catch(_0x16a826){_0x2fa6a1['push'](_0x2fa6a1['shift']());}}}(a0_0x2530,0x721db));import a0_0xf06273 from'dotenv';a0_0xf06273[a0_0x4de01c(0x1fb)]();import{CLI}from'./core/cli.js';import{ConversationOrchestrator}from'./core/conversationOrchestrator.js';function a0_0x2fc3(_0x45a6ba,_0x401581){const _0x253024=a0_0x2530();return a0_0x2fc3=function(_0x2fc3c5,_0x1fb31e){_0x2fc3c5=_0x2fc3c5-0x1d8;let _0x56f909=_0x253024[_0x2fc3c5];if(a0_0x2fc3['yfAjdM']===undefined){var _0x1004e9=function(_0xf06273){const _0x5cab17='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x412f78='',_0xb4cc5b='';for(let _0x43ca77=0x0,_0x57fb9b,_0x585536,_0xe377d5=0x0;_0x585536=_0xf06273['charAt'](_0xe377d5++);~_0x585536&&(_0x57fb9b=_0x43ca77%0x4?_0x57fb9b*0x40+_0x585536:_0x585536,_0x43ca77++%0x4)?_0x412f78+=String['fromCharCode'](0xff&_0x57fb9b>>(-0x2*_0x43ca77&0x6)):0x0){_0x585536=_0x5cab17['indexOf'](_0x585536);}for(let _0x68bdff=0x0,_0x404809=_0x412f78['length'];_0x68bdff<_0x404809;_0x68bdff++){_0xb4cc5b+='%'+('00'+_0x412f78['charCodeAt'](_0x68bdff)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xb4cc5b);};a0_0x2fc3['qhTJDQ']=_0x1004e9,_0x45a6ba=arguments,a0_0x2fc3['yfAjdM']=!![];}const _0x35daa0=_0x253024[0x0],_0x2655f0=_0x2fc3c5+_0x35daa0,_0x493cf5=_0x45a6ba[_0x2655f0];return!_0x493cf5?(_0x56f909=a0_0x2fc3['qhTJDQ'](_0x56f909),_0x45a6ba[_0x2655f0]=_0x56f909):_0x56f909=_0x493cf5,_0x56f909;},a0_0x2fc3(_0x45a6ba,_0x401581);}import{LoggingService}from'./services/loggingService.js';import{loadConfig}from'./config/configLoader.js';import a0_0x5cab17 from'chalk';import{performance}from'perf_hooks';const INITIALIZATION_TIMEOUT_MS=0x7530,GRACEFUL_SHUTDOWN_TIMEOUT_MS=0x2710,SERVICE_HEALTH_CHECK_INTERVAL_MS=0x493e0;let applicationState={'isShuttingDown':![],'initializationStartTime':null,'services':{'logger':null,'config':null,'cli':null,'orchestrator':null},'healthCheckInterval':null};function a0_0x2530(){const _0x1fce58=['cVcFKQuGrMf0ywWGC3rHCNr1CcbLCNjVCJO','ugvYzM9YBwLUzYbLBwvYz2vUy3KGC2H1DgrVD24','lI9JB25MAwCVy29UzMLNtg9HzgvYlMPZ','Bg9JywW','zMLSDgvY','vhj5ihvZAw5NigzHBgXIywnRig1Vzgu6ieXpweLbx1vtrv9trvjwrvjFteXnpwzHBhnL','ChvZAa','t3jJAgvZDhjHDg9YihnODxrKB3DUigvYCM9YoG','Aw5JBhvKzxm','vMfSAwrHDguGy29UzMLNDxjHDgLVBJOGBg94AweGy29UzMLNic0TDMfSAwrHDgu','te9ysufFu0Lmru5u','q0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEq','sw5PDgLHBgL6Aw5NignVBNzLCNnHDgLVBIbVCMnOzxn0CMf0B3i','Dw5Oyw5KBgvKuMvQzwn0Aw9U','BgvUz3rO','yw50AhjVCgLJ','CM91BMq','ywnJzxnZ','Bg9N','C2vYDMLJzxm','AM9PBG','zw52','Dg9tDhjPBMC','qM9VDhn0CMfWihrPBwvVDxq','cVcFKQeGvhjVDwjSzxnOB290Aw5Nihn1z2DLC3rPB25ZoG','uNvUDgLTzsb2ywXPzgf0Aw9UigzHAwXLzdOk','q2HLy2SGzMLSzsbZExn0zw0GCgvYBwLZC2LVBNm','AgvHBhrOEq','D2fYBG','rM9Yy2uGC2H1DgrVD24GlsbYzwnLAxzLzcbZzwnVBMqGu0Lhsu5u','u2vYDMvYigHLywX0AcbJAgvJAYbMywLSzwq6ieHuvfaG','C2v0t3jJAgvZDhjHDg9Y','BwvZC2fNzq','t3jJAgvZDhjHDg9YigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','q29UzMLNDxjHDgLVBIbSB2fKAw5NigzHAwXLzdO','sw5PDgLHBgL6Aw5NigfWCgXPy2f0Aw9UignVBxbVBMvUDhm','q29UzMLNDxjHDgLVBIbMAwXLihzHBgLKyxrPB24GzMfPBgvKoG','CMvK','z29Vz2XL','tM8GqvbjigTLEsbMB3vUzcaTihnVBwuGy29TBwfUzhmGD2LSBcbUB3qGyMuGyxzHAwXHyMXL','u2vYDMLJzsbOzwfSDgGGy2HLy2SGzgv0zwn0zwqGAxnZDwvZoG','zMLSzq','C2f2zvnLC3nPB25tDgf0zq','DxnLu2vYDMvYteXn','icaG','r3jHy2vMDwWGC2H1DgrVD24','CMfJzq','y29UzMLN','mZyZmKD4qvbbra','vhj5igfNywLUigLUigeGzMv3ig1VBwvUDhm','nZDjy1bMue4','u0Lhvevstq','q29UzMLNDxjHDgLVBIbLCNjVCJOG','y29TCgXLDgvuyxnR','z3jHEq','B3zLCMfSBa','mtq2nZzmqwXwww4','t3jJAgvZDhjHDg9YigLUAxrPywXPEMf0Aw9UigzHAwXLzdO','yxjNDG','AxntAhv0DgLUz0rVD24','cVcFLi0GrM9Yig1VCMuGAgvSCdO','Dg9ju09tDhjPBMC','r3jHy2vMDwWGC2H1DgrVD24Gy29TCgXLDgvKihn1y2nLC3nMDwXSEq','CgvYBwLZC2LVBG','rw1LCMDLBMn5ihnODxrKB3DUignVBxbSzxrLza','nta5nZq2yKXbwvjq','y2XP','B3jJAgvZDhjHDg9Y','qM9VDhn0CMfWihbYB2nLC3mGDgLTzwqGB3v0','icaG4OcIia','u2H1DhrPBMCGzg93BIbKDwuGDg8G','qM9VDhn0CMfW','Aw5PDgLHBgL6zvnLCNzPy2vZ','Dhj1zq','zgvIDwC','nde4mdKXmefKtvbrDG','C2XPy2u','BMfTzq','icaG4OcIienVBMzPz3vYyxrPB24GChjVyMXLBxm','ode0nvzTwePHAa','mJy1mZnnu1rnseu','y29UC3rHBNrZ','C2LSzw50','vw5JyxvNAhqGzxHJzxb0Aw9UoG','yNvKz2v0','C2H1DgrVD24','mwXsywfrDG','icaG4OcIifnLCNzLCIbPCYbKB3DUig9Yig92zxjSB2fKzwq','rw5ZDxjLihLVDsbOyxzLihDYAxrLigfJy2vZCYb0BYb0AguGy3vYCMvUDcbKAxjLy3rVCNK','y2f0y2G','DgHLBG','Dw5OzwfSDgH5','u2LNBMfSigHHBMrSzxjZignVBMzPz3vYzwq','yxbPs2v5','mtqWmJC0z1nLDxPy','C3rHDhvZ','nZmWohDLD25Yzq','Bg9Nz2LUzW','BwTKAxi','uhjVy2vZCYb3yxjUAw5NoG','mtHwv29rD2e','Bg9Ntgv2zwW','y29UBMvJDgLVBG','zxjYB3i','q0XjigLUAxrPywXPEMf0Aw9UigzHAwXLzdO','uMvJzwL2zwqGu0LhvevstsWGAw5PDgLHDgLUzYbNCMfJzwz1BcbZAhv0zg93BG','rxjYB3iGzhvYAw5NigDYywnLzNvSihnODxrKB3DUoG','ChjVBwLZzxm','BM93','A2v5','zgvNCMfKzwq','AgvHBhrOq2HLy2TjBNrLCNzHBa','u0Lhsu5u','C3rHy2S','q0XjigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','rw1LCMDLBMn5ihnODxrKB3DUigzHAwXLzdO','Bg9Nz2vY','Aw5MBW','tg9HzgLUzYbJB25MAwD1CMf0Aw9U','cLn0ywnRihrYywnLoG','zxHPDa','mtrZtg9MCvG','otyYnJKWDe9MuMzt','EwvSBg93','tM8GqvbjigTLExmGy29UzMLNDxjLzcbMB3iGzMfSBgjHy2SGC2vYDMLJzxm','zw5HyMXLza','u2vYDMvYihzHBgLKyxrPB24GzMfPBgvKlcb3AwXSigf0DgvTChqGzMfSBgjHy2SGDg8GBg9JywWGC2vYDMLJzxm','q2HLy2SGEw91CIbPBNrLCM5LDcbJB25Uzwn0Aw9U','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbPBML0AwfSAxPLzcbZDwnJzxnZzNvSBhK','A2v5CW'];a0_0x2530=function(){return _0x1fce58;};return a0_0x2530();}async function bootstrap(){const _0x18ed68=a0_0x4de01c;applicationState['initializationStartTime']=performance[_0x18ed68(0x238)]();const _0x412f78=createInitialLogger();applicationState['services']['logger']=_0x412f78;try{_0x412f78['info']('Starting\x20Loxia\x20CLI\x20application'),_0x412f78['startTask'](_0x18ed68(0x213),_0x18ed68(0x1ef));const _0xb4cc5b=await initializeConfiguration(_0x412f78);applicationState[_0x18ed68(0x1df)]['config']=_0xb4cc5b;const _0x43ca77=createEnhancedLogger(_0xb4cc5b);applicationState['services']['logger']=_0x43ca77;const _0x57fb9b=await initializeCLI(_0xb4cc5b,_0x43ca77);applicationState[_0x18ed68(0x1df)]['cli']=_0x57fb9b,await initializeOrchestratorIfNeeded(_0x57fb9b,_0xb4cc5b,_0x43ca77),setupSignalHandlers(_0x43ca77),setupHealthMonitoring(_0x43ca77);const _0x585536=performance['now']()-applicationState['initializationStartTime'];_0x43ca77[_0x18ed68(0x201)](_0x18ed68(0x213),!![],{'initializationTime':Math['round'](_0x585536),'serverMode':_0xb4cc5b[_0x18ed68(0x1f7)],'services':Object[_0x18ed68(0x24d)](applicationState[_0x18ed68(0x1df)])[_0x18ed68(0x252)](_0xe377d5=>applicationState['services'][_0xe377d5]!==null)}),_0x43ca77['info']('Loxia\x20CLI\x20initialized\x20successfully\x20in\x20'+Math[_0x18ed68(0x1dc)](_0x585536)+'ms'),await _0x57fb9b['start']();}catch(_0x68bdff){const _0x404809=performance['now']()-applicationState['initializationStartTime'];_0x412f78[_0x18ed68(0x201)]('Bootstrap',![],{'error':_0x68bdff[_0x18ed68(0x1ec)],'initializationTime':Math['round'](_0x404809)}),console['error'](a0_0x5cab17[_0x18ed68(0x1f1)]('\x0a❌\x20Failed\x20to\x20start\x20Loxia\x20CLI:')),console[_0x18ed68(0x233)](a0_0x5cab17['red'](_0x18ed68(0x1f8)+_0x68bdff['message'])),_0x68bdff[_0x18ed68(0x23d)]&&process[_0x18ed68(0x1e1)]['LOXIA_DEBUG']&&(console['error'](a0_0x5cab17['gray'](_0x18ed68(0x243))),console[_0x18ed68(0x233)](a0_0x5cab17['gray'](_0x68bdff['stack']))),provideTroubleshootingSuggestions(_0x68bdff),await performEmergencyShutdown(_0x412f78),process['exit'](0x1);}}function createInitialLogger(){const _0x5a265c=a0_0x4de01c;return new LoggingService({'console':![],'file':![],'logLevel':process['env']['LOXIA_LOG_LEVEL']||_0x5a265c(0x241),'silent':process['env'][_0x5a265c(0x258)]===_0x5a265c(0x215)});}async function initializeConfiguration(_0x2ddd82){const _0x57a65e=a0_0x4de01c;_0x2ddd82['info'](_0x57a65e(0x242));try{const _0x32b7f8=await loadConfig();return await validateRuntimeConfiguration(_0x32b7f8,_0x2ddd82),_0x2ddd82[_0x57a65e(0x241)]('Configuration\x20loaded\x20and\x20validated\x20successfully',{'serverMode':_0x32b7f8[_0x57a65e(0x1f7)],'logLevel':_0x32b7f8[_0x57a65e(0x22d)][_0x57a65e(0x231)],'llmStrategy':_0x32b7f8['llmStrategy']}),_0x32b7f8;}catch(_0x29e472){_0x2ddd82[_0x57a65e(0x233)](_0x57a65e(0x1ee),_0x29e472);throw new Error(_0x57a65e(0x200)+_0x29e472['message']);}}async function validateRuntimeConfiguration(_0x58d0fe,_0x33fbe4){const _0xabe60e=a0_0x4de01c,_0x227344=[];if(_0x58d0fe['useServerLLM'])try{const _0xf057f6=await fetch(_0x58d0fe['serverUrl']+'/health',{'method':'GET','timeout':0x1388});!_0xf057f6['ok']&&_0x227344[_0xabe60e(0x254)](_0xabe60e(0x1ea)+_0xf057f6[_0xabe60e(0x22b)]);}catch(_0x55405c){_0x227344['push']('Cannot\x20reach\x20server\x20at\x20'+_0x58d0fe['serverUrl']+':\x20'+_0x55405c['message']);}if(!_0x58d0fe['useServerLLM']){const _0x346425=_0x58d0fe[_0xabe60e(0x1df)]['anthropic'][_0xabe60e(0x229)]||_0x58d0fe['services']['openai'][_0xabe60e(0x229)]||_0x58d0fe[_0xabe60e(0x1df)][_0xabe60e(0x1f2)][_0xabe60e(0x229)];!_0x346425&&_0x227344[_0xabe60e(0x254)](_0xabe60e(0x248));}try{const _0x26a8ff=_0x58d0fe[_0xabe60e(0x220)]['usageDir'];await import('fs')['then'](_0x472d06=>_0x472d06['promises'][_0xabe60e(0x22e)](_0x26a8ff,{'recursive':!![]})),await import('fs')[_0xabe60e(0x226)](_0x1b4a90=>_0x1b4a90['promises'][_0xabe60e(0x1dd)](_0x26a8ff,_0x1b4a90[_0xabe60e(0x21d)]['W_OK']));}catch(_0x5949ee){_0x227344[_0xabe60e(0x254)]('Cannot\x20write\x20to\x20budget\x20directory:\x20'+_0x5949ee['message']);}if(_0x227344['length']>0x0){const _0x58ccd2=_0xabe60e(0x1e5)+_0x227344['map'](_0x46c0f4=>'\x20\x20-\x20'+_0x46c0f4)[_0xabe60e(0x1e0)]('\x0a');if(_0x58d0fe['useServerLLM']&&_0x227344['some'](_0x55c37d=>_0x55c37d[_0xabe60e(0x256)]('server')))_0x33fbe4[_0xabe60e(0x1e8)](_0xabe60e(0x24a)),_0x58d0fe[_0xabe60e(0x1f7)]=![],_0x58d0fe['services'][_0xabe60e(0x1db)][_0xabe60e(0x249)]=!!_0x58d0fe['services'][_0xabe60e(0x1db)]['apiKey'],_0x58d0fe[_0xabe60e(0x1df)]['openai'][_0xabe60e(0x249)]=!!_0x58d0fe[_0xabe60e(0x1df)]['openai'][_0xabe60e(0x229)],_0x58d0fe[_0xabe60e(0x1df)]['google']['enabled']=!!_0x58d0fe['services'][_0xabe60e(0x1f2)][_0xabe60e(0x229)];else throw new Error(_0x58ccd2);}}function createEnhancedLogger(_0x43b272){const _0x39bdb1=a0_0x4de01c;return new LoggingService({'console':_0x43b272['logging']['console']!==![],'file':_0x43b272[_0x39bdb1(0x22d)][_0x39bdb1(0x1f5)]!==![],'logLevel':_0x43b272[_0x39bdb1(0x22d)]['logLevel'],'logDir':_0x43b272['logging']['logDir'],'silent':_0x43b272[_0x39bdb1(0x22d)][_0x39bdb1(0x21e)]===!![]});}async function initializeCLI(_0x499499,_0x230f64){const _0x453b2b=a0_0x4de01c;_0x230f64['info']('Initializing\x20CLI');try{const _0x47b647=new CLI(null,_0x499499,_0x230f64);return await validateCLIResources(_0x47b647,_0x499499,_0x230f64),_0x230f64['info'](_0x453b2b(0x259)),_0x47b647;}catch(_0x5f433a){_0x230f64[_0x453b2b(0x233)](_0x453b2b(0x234),_0x5f433a);throw new Error(_0x453b2b(0x23e)+_0x5f433a['message']);}}async function validateCLIResources(_0x5adb88,_0x13c2f0,_0x505fce){const _0x18d1db=a0_0x4de01c,_0x46e971=await _0x5adb88['getStoredApiKey']()['catch'](()=>null);!_0x46e971&&_0x13c2f0[_0x18d1db(0x1f7)]&&_0x505fce[_0x18d1db(0x1e8)](_0x18d1db(0x1f3));try{const {getConfigPaths:_0x2b86f5}=await import(_0x18d1db(0x250)),_0xc25ada=_0x2b86f5();await import('fs')['then'](_0x2bbe9b=>{const _0x499ed4=_0x18d1db,_0x5ac8e6=[];return _0xc25ada['global']&&_0x5ac8e6['push'](_0x2bbe9b[_0x499ed4(0x237)]['access'](_0xc25ada['global'])['catch'](()=>'no\x20global\x20config')),_0xc25ada[_0x499ed4(0x251)]&&_0x5ac8e6['push'](_0x2bbe9b[_0x499ed4(0x237)]['access'](_0xc25ada[_0x499ed4(0x251)])['catch'](()=>'no\x20local\x20config')),Promise['allSettled'](_0x5ac8e6);});}catch(_0x3bb981){_0x505fce[_0x18d1db(0x1e8)](_0x18d1db(0x1f0),_0x3bb981);}}async function initializeOrchestratorIfNeeded(_0x4f668c,_0x225cfa,_0x4b54a0){const _0x444379=a0_0x4de01c,_0x3b86bb=process[_0x444379(0x206)]['slice'](0x2),_0x4f7044=_0x3b86bb[0x0],_0x1c33c1=[_0x444379(0x239),'status',_0x444379(0x220),'--help','-h','--version','-v'];if(_0x1c33c1[_0x444379(0x256)](_0x4f7044)||_0x3b86bb['includes']('--help')||_0x3b86bb['includes']('-h')){_0x4b54a0['debug']('Skipping\x20orchestrator\x20initialization\x20for\x20utility\x20command');return;}_0x4b54a0[_0x444379(0x241)](_0x444379(0x1d8));try{const _0x1f9b57=new ConversationOrchestrator(_0x225cfa,_0x4b54a0);await _0x1f9b57[_0x444379(0x214)](),_0x4f668c[_0x444379(0x1eb)](_0x1f9b57),applicationState['services']['orchestrator']=_0x1f9b57,_0x4b54a0['info'](_0x444379(0x24c));}catch(_0x1e5cf3){_0x4b54a0[_0x444379(0x233)](_0x444379(0x205),_0x1e5cf3);if(['status',_0x444379(0x220)]['includes'](_0x4f7044))_0x4b54a0['warn']('Continuing\x20without\x20orchestrator\x20for\x20status\x20command');else throw new Error(_0x444379(0x1ed)+_0x1e5cf3['message']);}}function setupSignalHandlers(_0x3890b2){const _0xf3dd3a=a0_0x4de01c;process['on'](_0xf3dd3a(0x23c),async()=>{const _0xea9e39=_0xf3dd3a;applicationState[_0xea9e39(0x207)]&&(_0x3890b2[_0xea9e39(0x1e8)](_0xea9e39(0x1e9)),process[_0xea9e39(0x244)](0x1)),_0x3890b2['info']('Received\x20SIGINT,\x20initiating\x20graceful\x20shutdown'),await performGracefulShutdown(_0x3890b2,_0xea9e39(0x23c));}),process['on']('SIGTERM',async()=>{const _0x183e13=_0xf3dd3a;applicationState['isShuttingDown']&&(_0x3890b2[_0x183e13(0x1e8)]('Force\x20shutdown\x20-\x20received\x20second\x20SIGTERM'),process[_0x183e13(0x244)](0x1)),_0x3890b2['info'](_0x183e13(0x235)),await performGracefulShutdown(_0x3890b2,_0x183e13(0x1ff));}),process['on']('uncaughtException',async _0x26ba0b=>{const _0x95ca21=_0xf3dd3a;_0x3890b2['error'](_0x95ca21(0x21f),_0x26ba0b),_0x26ba0b[_0x95ca21(0x23d)]&&_0x3890b2['error']('Stack\x20trace:',_0x26ba0b['stack']),await performEmergencyShutdown(_0x3890b2),process['exit'](0x1);}),process['on'](_0xf3dd3a(0x1d9),async(_0x31bcff,_0x27841c)=>{const _0x3a073c=_0xf3dd3a;_0x3890b2[_0x3a073c(0x233)]('Unhandled\x20promise\x20rejection:',{'reason':_0x31bcff?.['message']||_0x31bcff,'promise':_0x27841c?.[_0x3a073c(0x1e2)]()}),_0x31bcff?.['stack']&&_0x3890b2[_0x3a073c(0x233)]('Rejection\x20stack\x20trace:',_0x31bcff[_0x3a073c(0x23d)]),await performEmergencyShutdown(_0x3890b2),process['exit'](0x1);}),process['on']('warning',_0x4610db=>{const _0x52066d=_0xf3dd3a;_0x3890b2[_0x52066d(0x1e8)]('Node.js\x20warning:',{'name':_0x4610db[_0x52066d(0x219)],'message':_0x4610db[_0x52066d(0x1ec)],'stack':_0x4610db['stack']});}),_0x3890b2[_0xf3dd3a(0x216)](_0xf3dd3a(0x228));}function setupHealthMonitoring(_0x4d5eda){const _0x2565a9=a0_0x4de01c,_0x1a61f9=process[_0x2565a9(0x206)][_0x2565a9(0x218)](0x2),_0x3f3f4d=['do','make','resume','modify'];if(!_0x3f3f4d['some'](_0x3ac2b4=>_0x1a61f9[_0x2565a9(0x256)](_0x3ac2b4)))return;applicationState[_0x2565a9(0x23b)]=setInterval(async()=>{try{await performHealthCheck(_0x4d5eda);}catch(_0x338372){_0x4d5eda['warn']('Health\x20check\x20failed:',_0x338372);}},SERVICE_HEALTH_CHECK_INTERVAL_MS),_0x4d5eda[_0x2565a9(0x216)]('Health\x20monitoring\x20configured');}async function performHealthCheck(_0x20b5cd){const _0x22f47d=a0_0x4de01c,_0x3e2277={'timestamp':new Date()[_0x22f47d(0x209)](),'services':{},'overall':_0x22f47d(0x1e7)};if(applicationState['services'][_0x22f47d(0x20e)])try{_0x3e2277['services']['cli']=_0x22f47d(0x1e7);}catch(_0x812cc4){_0x3e2277['services']['cli']='unhealthy',_0x3e2277['overall']=_0x22f47d(0x23a);}if(applicationState[_0x22f47d(0x1df)][_0x22f47d(0x20f)])try{const _0x216a2c=await applicationState['services']['orchestrator']['getHealthStatus']?.()||'unknown';_0x3e2277[_0x22f47d(0x1df)][_0x22f47d(0x20f)]=_0x216a2c[_0x22f47d(0x203)]||_0x22f47d(0x1e7),(_0x216a2c['overall']==='degraded'||_0x216a2c['overall']===_0x22f47d(0x227))&&(_0x3e2277['overall']='degraded');}catch(_0x559e9e){_0x3e2277['services']['orchestrator']=_0x22f47d(0x227),_0x3e2277['overall']='degraded';}_0x3e2277['overall']!=='healthy'?_0x20b5cd['warn'](_0x22f47d(0x1f4),_0x3e2277):_0x20b5cd[_0x22f47d(0x216)]('Health\x20check\x20passed:',_0x3e2277);}async function performGracefulShutdown(_0x17cdef,_0x46e8d6){const _0x23cc5c=a0_0x4de01c;if(applicationState[_0x23cc5c(0x207)])return;applicationState[_0x23cc5c(0x207)]=!![],_0x17cdef['startTask'](_0x23cc5c(0x1f9),_0x23cc5c(0x212)+_0x46e8d6);try{applicationState['healthCheckInterval']&&(clearInterval(applicationState[_0x23cc5c(0x23b)]),applicationState['healthCheckInterval']=null);const _0xb2f75c=[];applicationState[_0x23cc5c(0x1df)]['orchestrator']?.[_0x23cc5c(0x221)]&&_0xb2f75c['push'](Promise[_0x23cc5c(0x1fa)]([applicationState['services']['orchestrator']['shutdown'](),new Promise((_0xeb7c23,_0x2ca699)=>setTimeout(()=>_0x2ca699(new Error('Orchestrator\x20shutdown\x20timeout')),0x1388))])['catch'](_0x1e0091=>{const _0x4672e8=_0x23cc5c;_0x17cdef[_0x4672e8(0x1e8)](_0x4672e8(0x255),_0x1e0091);})),applicationState['services']['cli']?.['shutdown']&&_0xb2f75c[_0x23cc5c(0x254)](Promise[_0x23cc5c(0x1fa)]([applicationState['services'][_0x23cc5c(0x20e)]['shutdown'](),new Promise((_0x3d6c81,_0x2e4101)=>setTimeout(()=>_0x2e4101(new Error('CLI\x20shutdown\x20timeout')),0xbb8))])[_0x23cc5c(0x225)](_0x3b389c=>{_0x17cdef['warn']('CLI\x20shutdown\x20error:',_0x3b389c);})),await Promise['race']([Promise['allSettled'](_0xb2f75c),new Promise(_0x562889=>setTimeout(_0x562889,GRACEFUL_SHUTDOWN_TIMEOUT_MS))]),_0x17cdef['completeTask'](_0x23cc5c(0x1f9),!![]),_0x17cdef[_0x23cc5c(0x241)](_0x23cc5c(0x20a));}catch(_0x2a9859){_0x17cdef[_0x23cc5c(0x201)](_0x23cc5c(0x1f9),![],{'error':_0x2a9859['message']}),_0x17cdef['error'](_0x23cc5c(0x236),_0x2a9859);}finally{setTimeout(()=>{const _0x3d3c7a=_0x23cc5c;process[_0x3d3c7a(0x244)](0x0);},0x1f4);}}async function performEmergencyShutdown(_0x3ce222){const _0x18a56d=a0_0x4de01c;if(applicationState['isShuttingDown'])return;applicationState['isShuttingDown']=!![],_0x3ce222['error'](_0x18a56d(0x24f));try{applicationState['healthCheckInterval']&&clearInterval(applicationState['healthCheckInterval']),applicationState['services']['orchestrator']?.[_0x18a56d(0x1f6)]&&await Promise[_0x18a56d(0x1fa)]([applicationState['services'][_0x18a56d(0x20f)][_0x18a56d(0x1f6)](),new Promise(_0x5eddb4=>setTimeout(_0x5eddb4,0x7d0))])[_0x18a56d(0x225)](()=>{}),_0x3ce222['error'](_0x18a56d(0x20c));}catch(_0x3524b4){console['error'](_0x18a56d(0x23f),_0x3524b4['message']);}}function provideTroubleshootingSuggestions(_0x3aa631){const _0xf88867=a0_0x4de01c,_0x3be522=[],_0x537c16=_0x3aa631[_0xf88867(0x1ec)]['toLowerCase']();_0x537c16[_0xf88867(0x256)]('api\x20key')&&(_0x3be522['push']('Set\x20your\x20API\x20key\x20with:\x20loxia\x20key\x20--set\x20<your-api-key>'),_0x3be522[_0xf88867(0x254)]('Get your API key from: https://autopilot.loxia.ai/account/api-keys')),(_0x537c16['includes']('server')||_0x537c16[_0xf88867(0x256)](_0xf88867(0x232)))&&(_0x3be522[_0xf88867(0x254)](_0xf88867(0x24b)),_0x3be522[_0xf88867(0x254)]('Verify\x20the\x20server\x20URL\x20in\x20your\x20configuration'),_0x3be522[_0xf88867(0x254)](_0xf88867(0x253))),(_0x537c16['includes'](_0xf88867(0x20b))||_0x537c16['includes']('access'))&&(_0x3be522[_0xf88867(0x254)](_0xf88867(0x1e6)),_0x3be522['push'](_0xf88867(0x224)),_0x3be522[_0xf88867(0x254)]('Try running from a different directory')),_0x537c16['includes']('timeout')&&(_0x3be522[_0xf88867(0x254)]('Increase\x20timeout\x20settings\x20in\x20configuration'),_0x3be522['push']('Check\x20network\x20connectivity'),_0x3be522['push'](_0xf88867(0x1fd))),_0x537c16[_0xf88867(0x256)]('config')&&(_0x3be522['push']('Check\x20configuration\x20file\x20syntax'),_0x3be522['push']('Create default config: loxia config --create'),_0x3be522['push'](_0xf88867(0x257))),_0x3be522[_0xf88867(0x1da)]>0x0&&(console['log'](a0_0x5cab17[_0xf88867(0x247)](_0xf88867(0x1e4))),_0x3be522['forEach'](_0x2d7efd=>{const _0x36625c=_0xf88867;console[_0x36625c(0x1de)](a0_0x5cab17['cyan'](_0x36625c(0x211)+_0x2d7efd));})),console[_0xf88867(0x1de)](a0_0x5cab17[_0xf88867(0x202)](_0xf88867(0x208))),console[_0xf88867(0x1de)](a0_0x5cab17['gray']('\x20\x20\x20•\x20Run:\x20loxia\x20--help')),console[_0xf88867(0x1de)](a0_0x5cab17['gray']('\x20\x20\x20•\x20Check\x20documentation:\x20https://docs.loxia.ai')),console['log'](a0_0x5cab17[_0xf88867(0x202)]('\x20\x20\x20•\x20Report\x20issues:\x20https://github.com/loxia-ai/cli/issues'));}async function handleBootstrapTimeout(_0x5726d9){const _0x238076=a0_0x4de01c;_0x5726d9['error'](_0x238076(0x210)),console['error'](a0_0x5cab17['red']('\x0a⏰\x20Initialization\x20timed\x20out')),console['error'](a0_0x5cab17['yellow']('This\x20might\x20indicate:')),console['error'](a0_0x5cab17[_0x238076(0x247)]('\x20\x20\x20•\x20Network\x20connectivity\x20issues')),console['error'](a0_0x5cab17[_0x238076(0x247)](_0x238076(0x223))),console['error'](a0_0x5cab17[_0x238076(0x247)](_0x238076(0x21a))),await performEmergencyShutdown(_0x5726d9),process['exit'](0x1);}async function main(){const _0x2b6542=a0_0x4de01c,_0x4d16b5=Date[_0x2b6542(0x238)]();try{await Promise['race']([bootstrap(),new Promise((_0x3e5a4b,_0x1ad20f)=>setTimeout(()=>_0x1ad20f(new Error('Bootstrap\x20timeout')),INITIALIZATION_TIMEOUT_MS))]);}catch(_0x4689f3){const _0x5d1ed8=Date['now']()-_0x4d16b5;if(_0x4689f3['message']===_0x2b6542(0x1e3))await handleBootstrapTimeout(applicationState[_0x2b6542(0x1df)][_0x2b6542(0x240)]||createInitialLogger());else throw _0x4689f3;}}main()['catch'](_0x14340f=>{const _0x20fc28=a0_0x4de01c,_0x4a5590=applicationState[_0x20fc28(0x1df)]['logger']||createInitialLogger();_0x4a5590[_0x20fc28(0x233)]('Fatal\x20error\x20during\x20startup:',_0x14340f),console['error'](a0_0x5cab17['red'](_0x20fc28(0x24e))),console['error'](a0_0x5cab17['red']('\x20\x20\x20'+_0x14340f['message'])),process[_0x20fc28(0x1e1)]['LOXIA_DEBUG']&&_0x14340f[_0x20fc28(0x23d)]&&(console['error'](a0_0x5cab17['gray'](_0x20fc28(0x243))),console[_0x20fc28(0x233)](a0_0x5cab17['gray'](_0x14340f['stack']))),process[_0x20fc28(0x244)](0x1);}),process['on']('warning',_0x16b15e=>{const _0x5a37a5=a0_0x4de01c;applicationState[_0x5a37a5(0x1df)]['logger']&&applicationState['services'][_0x5a37a5(0x240)][_0x5a37a5(0x1e8)](_0x5a37a5(0x22f),_0x16b15e);});export{bootstrap,performGracefulShutdown,performHealthCheck};