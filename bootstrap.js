#!/usr/bin/env node

const a0_0x5a69a5=a0_0x3936;(function(_0x3eb065,_0x368d39){const _0x9ba6e4=a0_0x3936,_0x229ef3=_0x3eb065();while(!![]){try{const _0xad9636=-parseInt(_0x9ba6e4(0x14c))/0x1*(-parseInt(_0x9ba6e4(0x145))/0x2)+parseInt(_0x9ba6e4(0x133))/0x3*(parseInt(_0x9ba6e4(0x106))/0x4)+-parseInt(_0x9ba6e4(0x131))/0x5+parseInt(_0x9ba6e4(0x147))/0x6*(parseInt(_0x9ba6e4(0x13e))/0x7)+-parseInt(_0x9ba6e4(0x148))/0x8*(parseInt(_0x9ba6e4(0x11f))/0x9)+-parseInt(_0x9ba6e4(0xef))/0xa+parseInt(_0x9ba6e4(0x130))/0xb;if(_0xad9636===_0x368d39)break;else _0x229ef3['push'](_0x229ef3['shift']());}catch(_0x45e98d){_0x229ef3['push'](_0x229ef3['shift']());}}}(a0_0x3901,0xc2c4e));function a0_0x3901(){const _0x101885=['Bg9NrgLY','DxnLu2vYDMvYteXn','v19psW','ChvZAa','C2XPy2u','CMvK','Aw5PDgLHBgL6zvnLCNzPy2vZ','BM8Gz2XVyMfSignVBMzPzW','ls12zxjZAw9U','AxntAhv0DgLUz0rVD24','yxbPigTLEq','qM9VDhn0CMfWihrPBwvVDxq','icaG4OcIienOzwnRigrVy3vTzw50yxrPB246igH0DhbZoI8Vzg9JCY5SB3HPys5HAq','Aw5MBW','B3jJAgvZDhjHDg9Y','A2v5','ndi1mdmWEujwBfPo','z2v0u3rVCMvKqxbPs2v5','uNvUDgLTzsb2ywXPzgf0Aw9UigzHAwXLzdOk','qM9VDhn0CMfW','ywnJzxnZ','Dg9ju09tDhjPBMC','q29UzMLNDxjHDgLVBIbMAwXLihzHBgLKyxrPB24GzMfPBgvKoG','cUkDJcbgywLSzwqGDg8GC3rHCNqGtg94AweGq0XjoG','vMfSAwrHDguGy29UzMLNDxjHDgLVBJOGBg94AweGy29UzMLNic0TDMfSAwrHDgu','CM91BMq','q0XjigLUAxrPywXPEMf0Aw9UigzHAwXLzdO','icaG4OcIie5LDhDVCMSGy29UBMvJDgL2Axr5igLZC3vLCW','Dg9tDhjPBMC','Bg9N','AM9PBG','zgvNCMfKzwq','ywXSu2v0DgXLza','z2XVyMfS','cLn0ywnRihrYywnLoG','t3jJAgvZDhjHDg9YigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','sgvHBhrOignOzwnRigzHAwXLzdO','y29UzMLN','BM8GBg9JywWGy29UzMLN','mJeZmdrprMLYrhG','Bg9JywW','C3rHDhvZ','icaG','q29UzMLNDxjHDgLVBIbSB2fKzwqGyw5KihzHBgLKyxrLzcbZDwnJzxnZzNvSBhK','y3LHBG','y29UC29Szq','C2vYDMLJzxm','BM93','icaG4OcIifjLCg9YDcbPC3n1zxm6igH0DhbZoI8Vz2L0AhvIlMnVBs9SB3HPys1HAs9JBgKVAxnZDwvZ','cVcFLi0GrM9Yig1VCMuGAgvSCdO','u2v0ihLVDxiGqvbjigTLEsb3AxrOoIbSB3HPysbRzxKGls1ZzxqGphLVDxiTyxbPlwTLEt4','vMvYAwz5ihrOzsbZzxj2zxiGvvjmigLUihLVDxiGy29UzMLNDxjHDgLVBG','Bg9Nz2vY','t3jJAgvZDhjHDg9YihnODxrKB3DUihrPBwvVDxq','r3jHy2vMDwWGC2H1DgrVD24','u2LNBMfSigHHBMrSzxjZignVBMzPz3vYzwq','icaTia','tM8GqvbjigTLExmGy29UzMLNDxjLzcbMB3iGzMfSBgjHy2SGC2vYDMLJzxm','ChjVBwLZzxm','icaG4OcIifj1BJOGBg94AweGls1OzwXW','y2f0y2G','zgvIDwC','AgvHBhrOq2HLy2TjBNrLCNzHBa','Bg9Nz2LUzW','mJmYnJaYm2jequ9XzW','uMvJzwL2zwqGu0Lhsu5ulcbPBML0Awf0Aw5NigDYywnLzNvSihnODxrKB3DU','y29UBMvJDgLVBG','q0XjihnODxrKB3DUihrPBwvVDxq','D2fYBMLUzW','z3jHEq','l2HLywX0Aa','icaG4OcIienVBMzPz3vYyxrPB24GChjVyMXLBxm','vw5Oyw5KBgvKihbYB21PC2uGCMvQzwn0Aw9UoG','Dw5OzwfSDgH5','q2HLy2SGy29UzMLNDxjHDgLVBIbMAwXLihn5BNrHEa','q0XjihnODxrKB3DUigvYCM9YoG','BwTKAxi','y2XP','Aw5PDgLHBgL6yxrPB25tDgfYDfrPBwu','BwfW','q0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEq','ndK3mtK3ogHKvM9Pwq','ntu4nZyWrxbNB2TI','zxjYB3i','ndeXwwTRD09v','B3zLCMfSBa','Bw9KAwz5','yxbPs2v5','uhjVy2vZCYb3yxjUAw5NoG','zw52','cUkpScbjBML0AwfSAxPHDgLVBIb0Aw1LzcbVDxq','rxjYB3iGzhvYAw5NigDYywnLzNvSihnODxrKB3DUoG','AgvHBhrOEq','C2H1DgrVD24','EwvSBg93','nJGWmJzrzMjHzgu','u2TPChbPBMCGB3jJAgvZDhjHDg9YigLUAxrPywXPEMf0Aw9UigzVCIb1DgLSAxr5ignVBw1HBMq','z29Vz2XL','CMfJzq','q0XjigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','q29UDgLUDwLUzYb3AxrOB3v0ig9Yy2HLC3rYyxrVCIbMB3iGC3rHDhvZignVBw1HBMq','zxHPDa','mte4t1PeruPz','vhj5ihvZAw5NigzHBgXIywnRig1Vzgu6ieXpweLbx1vtrv9trvjwrvjFteXnpwzHBhnL','ndaYCwPVAKLP','ndH4t0rlyLC','C2LSzw50','tg9HzgLUzYbJB25MAwD1CMf0Aw9U','te9ysufFrevcvuC','mteZntvUrw1srKO','q2fUBM90ihDYAxrLihrVigj1zgDLDcbKAxjLy3rVCNK6ia','u0Lhsu5u','zMLSDgvY','DgHLBG','y29TCgXLDgvuyxnR','rw5ZDxjLihLVDsbOyxzLihDYAxrLigfJy2vZCYb0BYb0AguGy3vYCMvUDcbKAxjLy3rVCNK','vgHPCYbTAwDODcbPBMrPy2f0ztO','q2HLy2SGBMv0D29YAYbJB25Uzwn0AxzPDhK','C3rHCNruyxnR','cVcFKQuGrMf0ywWGC3rHCNr1CcbLCNjVCJO','yNvKz2v0','C2v0t3jJAgvZDhjHDg9Y','C3rHCNq','zw5HyMXLza','tM8GqvbjigTLEsbMB3vUzcaTihnVBwuGy29TBwfUzhmGD2LSBcbUB3qGyMuGyxzHAwXHyMXL','yw50AhjVCgLJ','CMvZDw1L','Dhj1zq','Aw5JBhvKzxm','uMvJzwL2zwqGu0LhvevstsWGAw5PDgLHDgLUzYbNCMfJzwz1BcbZAhv0zg93BG','C3rHy2S','ls1OzwXW','D2fYBG','BwvZC2fNzq','Dw5Oyw5KBgvKuMvQzwn0Aw9U','C2f2zvnLC3nPB25tDgf0zq','yxjNDG'];a0_0x3901=function(){return _0x101885;};return a0_0x3901();}import a0_0x371db6 from'dotenv';a0_0x371db6['config']();import{CLI}from'./core/cli.js';import{ConversationOrchestrator}from'./core/conversationOrchestrator.js';import{LoggingService}from'./services/loggingService.js';import{loadConfig}from'./config/configLoader.js';import a0_0x2006e4 from'chalk';import{performance}from'perf_hooks';const INITIALIZATION_TIMEOUT_MS=0x7530,GRACEFUL_SHUTDOWN_TIMEOUT_MS=0x2710,SERVICE_HEALTH_CHECK_INTERVAL_MS=0x493e0;let applicationState={'isShuttingDown':![],'initializationStartTime':null,'services':{'logger':null,'config':null,'cli':null,'orchestrator':null},'healthCheckInterval':null};async function bootstrap(){const _0x37da38=a0_0x3936;applicationState['initializationStartTime']=performance[_0x37da38(0x10e)]();const _0x1ae7ba=createInitialLogger();applicationState[_0x37da38(0x10d)]['logger']=_0x1ae7ba;try{_0x1ae7ba['info']('Starting\x20Loxia\x20CLI\x20application'),_0x1ae7ba[_0x37da38(0x155)](_0x37da38(0xf2),'Initializing\x20application\x20components');const _0x54392f=await initializeConfiguration(_0x1ae7ba);applicationState['services']['config']=_0x54392f;const _0x30579d=createEnhancedLogger(_0x54392f);applicationState['services']['logger']=_0x30579d;const _0x377ad6=await initializeCLI(_0x54392f,_0x30579d);applicationState[_0x37da38(0x10d)]['cli']=_0x377ad6,await initializeOrchestratorIfNeeded(_0x377ad6,_0x54392f,_0x30579d),setupSignalHandlers(_0x30579d),setupHealthMonitoring(_0x30579d);const _0x899b47=performance[_0x37da38(0x10e)]()-applicationState[_0x37da38(0x12d)];_0x30579d[_0x37da38(0x151)](_0x37da38(0xf2),!![],{'initializationTime':Math[_0x37da38(0xf8)](_0x899b47),'serverMode':_0x54392f['useServerLLM'],'services':Object['keys'](applicationState[_0x37da38(0x10d)])[_0x37da38(0x14f)](_0x1ea9e4=>applicationState['services'][_0x1ea9e4]!==null)}),_0x30579d[_0x37da38(0xec)]('Loxia\x20CLI\x20initialized\x20successfully\x20in\x20'+Math[_0x37da38(0xf8)](_0x899b47)+'ms'),await _0x377ad6[_0x37da38(0x159)]();}catch(_0x118ed9){const _0x4e0529=performance[_0x37da38(0x10e)]()-applicationState['initializationStartTime'];_0x1ae7ba['completeTask']('Bootstrap',![],{'error':_0x118ed9[_0x37da38(0xdb)],'initializationTime':Math['round'](_0x4e0529)}),console['error'](a0_0x2006e4['red'](_0x37da38(0xf6))),console[_0x37da38(0x132)](a0_0x2006e4[_0x37da38(0xe4)](_0x37da38(0x109)+_0x118ed9[_0x37da38(0xdb)])),_0x118ed9['stack']&&process[_0x37da38(0x138)]['LOXIA_DEBUG']&&(console['error'](a0_0x2006e4['gray'](_0x37da38(0x101))),console[_0x37da38(0x132)](a0_0x2006e4[_0x37da38(0x124)](_0x118ed9[_0x37da38(0x161)]))),provideTroubleshootingSuggestions(_0x118ed9),await performEmergencyShutdown(_0x1ae7ba),process['exit'](0x1);}}function createInitialLogger(){const _0xab2c51=a0_0x3936;return new LoggingService({'console':![],'file':![],'logLevel':process['env']['LOXIA_LOG_LEVEL']||_0xab2c51(0xec),'silent':process['env']['LOXIA_SILENT']===_0xab2c51(0x15e)});}async function initializeConfiguration(_0x29205c){const _0x3ee6ef=a0_0x3936;_0x29205c[_0x3ee6ef(0xec)](_0x3ee6ef(0x14a));try{const _0x48d203=await loadConfig();return await validateRuntimeConfiguration(_0x48d203,_0x29205c),_0x29205c['info'](_0x3ee6ef(0x10a),{'serverMode':_0x48d203[_0x3ee6ef(0xe0)],'logLevel':_0x48d203['logging']['logLevel'],'llmStrategy':_0x48d203['llmStrategy']}),_0x48d203;}catch(_0x493911){_0x29205c[_0x3ee6ef(0x132)]('Configuration\x20loading\x20failed:',_0x493911);throw new Error('Configuration\x20error:\x20'+_0x493911[_0x3ee6ef(0xdb)]);}}async function validateRuntimeConfiguration(_0x1fd59b,_0x4c84bc){const _0x3481b0=a0_0x3936,_0x563fbd=[];if(_0x1fd59b['useServerLLM'])try{const _0x5e6096=await fetch(_0x1fd59b['serverUrl']+_0x3481b0(0x125),{'method':'GET','timeout':0x1388});!_0x5e6096['ok']&&_0x563fbd[_0x3481b0(0xe2)]('Server\x20health\x20check\x20failed:\x20HTTP\x20'+_0x5e6096[_0x3481b0(0x108)]);}catch(_0x614d90){_0x563fbd['push']('Cannot\x20reach\x20server\x20at\x20'+_0x1fd59b['serverUrl']+':\x20'+_0x614d90['message']);}if(!_0x1fd59b['useServerLLM']){const _0x2992c6=_0x1fd59b[_0x3481b0(0x10d)][_0x3481b0(0x15c)]['apiKey']||_0x1fd59b[_0x3481b0(0x10d)]['openai']['apiKey']||_0x1fd59b['services']['google'][_0x3481b0(0x136)];!_0x2992c6&&_0x563fbd['push'](_0x3481b0(0x118));}try{const _0x4b68de=_0x1fd59b['budget']['usageDir'];await import('fs')[_0x3481b0(0x150)](_0x3f42f5=>_0x3f42f5['promises'][_0x3481b0(0x12b)](_0x4b68de,{'recursive':!![]})),await import('fs')['then'](_0x3eaadf=>_0x3eaadf['promises']['access'](_0x4b68de,_0x3eaadf['constants'][_0x3481b0(0xe1)]));}catch(_0x17d539){_0x563fbd['push'](_0x3481b0(0x14d)+_0x17d539['message']);}if(_0x563fbd['length']>0x0){const _0x21a76b=_0x3481b0(0xf1)+_0x563fbd[_0x3481b0(0x12e)](_0x405bd5=>_0x3481b0(0x117)+_0x405bd5)[_0x3481b0(0xfd)]('\x0a');if(_0x1fd59b[_0x3481b0(0xe0)]&&_0x563fbd['some'](_0x3adb57=>_0x3adb57['includes']('server')))_0x4c84bc[_0x3481b0(0xda)]('Server\x20validation\x20failed,\x20will\x20attempt\x20fallback\x20to\x20local\x20services'),_0x1fd59b[_0x3481b0(0xe0)]=![],_0x1fd59b['services']['anthropic']['enabled']=!!_0x1fd59b[_0x3481b0(0x10d)][_0x3481b0(0x15c)]['apiKey'],_0x1fd59b[_0x3481b0(0x10d)]['openai']['enabled']=!!_0x1fd59b[_0x3481b0(0x10d)]['openai']['apiKey'],_0x1fd59b[_0x3481b0(0x10d)]['google'][_0x3481b0(0x15a)]=!!_0x1fd59b[_0x3481b0(0x10d)][_0x3481b0(0x140)][_0x3481b0(0x136)];else throw new Error(_0x21a76b);}}function createEnhancedLogger(_0x192ad3){const _0x1ac86d=a0_0x3936;return new LoggingService({'console':_0x192ad3[_0x1ac86d(0x11e)][_0x1ac86d(0x10c)]!==![],'file':_0x192ad3[_0x1ac86d(0x11e)]['file']!==![],'logLevel':_0x192ad3[_0x1ac86d(0x11e)]['logLevel'],'logDir':_0x192ad3[_0x1ac86d(0x11e)][_0x1ac86d(0xdf)],'silent':_0x192ad3['logging'][_0x1ac86d(0x149)]===!![]});}function a0_0x3936(_0x2ba0c3,_0x17a526){const _0x3901d9=a0_0x3901();return a0_0x3936=function(_0x393631,_0x47958d){_0x393631=_0x393631-0xda;let _0x3360ca=_0x3901d9[_0x393631];if(a0_0x3936['WDMnRM']===undefined){var _0x2dd20a=function(_0x371db6){const _0x2006e4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1ae7ba='',_0x54392f='';for(let _0x30579d=0x0,_0x377ad6,_0x899b47,_0x1ea9e4=0x0;_0x899b47=_0x371db6['charAt'](_0x1ea9e4++);~_0x899b47&&(_0x377ad6=_0x30579d%0x4?_0x377ad6*0x40+_0x899b47:_0x899b47,_0x30579d++%0x4)?_0x1ae7ba+=String['fromCharCode'](0xff&_0x377ad6>>(-0x2*_0x30579d&0x6)):0x0){_0x899b47=_0x2006e4['indexOf'](_0x899b47);}for(let _0x118ed9=0x0,_0x4e0529=_0x1ae7ba['length'];_0x118ed9<_0x4e0529;_0x118ed9++){_0x54392f+='%'+('00'+_0x1ae7ba['charCodeAt'](_0x118ed9)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x54392f);};a0_0x3936['VJrqCw']=_0x2dd20a,_0x2ba0c3=arguments,a0_0x3936['WDMnRM']=!![];}const _0x20b67e=_0x3901d9[0x0],_0x2367de=_0x393631+_0x20b67e,_0x20888c=_0x2ba0c3[_0x2367de];return!_0x20888c?(_0x3360ca=a0_0x3936['VJrqCw'](_0x3360ca),_0x2ba0c3[_0x2367de]=_0x3360ca):_0x3360ca=_0x20888c,_0x3360ca;},a0_0x3936(_0x2ba0c3,_0x17a526);}async function initializeCLI(_0x446c01,_0x26089e){const _0x5cc0c4=a0_0x3936;_0x26089e['info']('Initializing\x20CLI');try{const _0x31264c=new CLI(null,_0x446c01,_0x26089e);return await validateCLIResources(_0x31264c,_0x446c01,_0x26089e),_0x26089e[_0x5cc0c4(0xec)](_0x5cc0c4(0x12f)),_0x31264c;}catch(_0x468ee2){_0x26089e['error'](_0x5cc0c4(0xf9),_0x468ee2);throw new Error(_0x5cc0c4(0x142)+_0x468ee2[_0x5cc0c4(0xdb)]);}}async function validateCLIResources(_0x5260cb,_0xc95398,_0x32ef3f){const _0x5cd8d=a0_0x3936,_0x565794=await _0x5260cb[_0x5cd8d(0xf0)]()['catch'](()=>null);!_0x565794&&_0xc95398['useServerLLM']&&_0x32ef3f['warn'](_0x5cd8d(0x15b));try{const {getConfigPaths:_0x451c03}=await import('./config/configLoader.js'),_0x8f10f7=_0x451c03();await import('fs')[_0x5cd8d(0x150)](_0x3f2693=>{const _0x1a538a=_0x5cd8d,_0x546f0f=[];return _0x8f10f7[_0x1a538a(0x100)]&&_0x546f0f['push'](_0x3f2693[_0x1a538a(0x119)]['access'](_0x8f10f7['global'])[_0x1a538a(0x11b)](()=>_0x1a538a(0xe6))),_0x8f10f7[_0x1a538a(0x107)]&&_0x546f0f[_0x1a538a(0xe2)](_0x3f2693[_0x1a538a(0x119)][_0x1a538a(0xf3)](_0x8f10f7[_0x1a538a(0x107)])[_0x1a538a(0x11b)](()=>_0x1a538a(0x105))),Promise['allSettled'](_0x546f0f);});}catch(_0x4a53e4){_0x32ef3f['warn'](_0x5cd8d(0xf5),_0x4a53e4);}}async function initializeOrchestratorIfNeeded(_0x5c7f01,_0x4cc9b8,_0x24f81d){const _0x4df92a=a0_0x3936,_0x2abb3c=process['argv'][_0x4df92a(0xe3)](0x2),_0x47e79c=_0x2abb3c[0x0],_0x311124=[_0x4df92a(0xee),_0x4df92a(0x108),'budget',_0x4df92a(0x162),'-h',_0x4df92a(0xe7),'-v'];if(_0x311124['includes'](_0x47e79c)||_0x2abb3c['includes']('--help')||_0x2abb3c['includes']('-h')){_0x24f81d[_0x4df92a(0x11c)](_0x4df92a(0x13f));return;}_0x24f81d[_0x4df92a(0xec)]('Initializing\x20conversation\x20orchestrator');try{const _0x57a2c9=new ConversationOrchestrator(_0x4cc9b8,_0x24f81d);await _0x57a2c9[_0x4df92a(0xe5)](),_0x5c7f01[_0x4df92a(0x158)](_0x57a2c9),applicationState['services'][_0x4df92a(0xed)]=_0x57a2c9,_0x24f81d['info']('Conversation\x20orchestrator\x20initialized\x20successfully');}catch(_0x189863){_0x24f81d['error']('Orchestrator\x20initialization\x20failed:',_0x189863);if(['status',_0x4df92a(0x157)][_0x4df92a(0x15f)](_0x47e79c))_0x24f81d[_0x4df92a(0xda)](_0x4df92a(0x143));else throw new Error(_0x4df92a(0x102)+_0x189863['message']);}}function setupSignalHandlers(_0x4b10fe){const _0x672552=a0_0x3936;process['on'](_0x672552(0x14e),async()=>{const _0x2a39b5=_0x672552;applicationState['isShuttingDown']&&(_0x4b10fe['warn']('Force\x20shutdown\x20-\x20received\x20second\x20SIGINT'),process['exit'](0x1)),_0x4b10fe[_0x2a39b5(0xec)](_0x2a39b5(0x120)),await performGracefulShutdown(_0x4b10fe,'SIGINT');}),process['on']('SIGTERM',async()=>{const _0x32df7f=_0x672552;applicationState[_0x32df7f(0xe8)]&&(_0x4b10fe['warn']('Force\x20shutdown\x20-\x20received\x20second\x20SIGTERM'),process['exit'](0x1)),_0x4b10fe[_0x32df7f(0xec)](_0x32df7f(0x160)),await performGracefulShutdown(_0x4b10fe,'SIGTERM');}),process['on']('uncaughtException',async _0x373b51=>{const _0x45a45b=_0x672552;_0x4b10fe[_0x45a45b(0x132)]('Uncaught\x20exception:',_0x373b51),_0x373b51['stack']&&_0x4b10fe['error']('Stack\x20trace:',_0x373b51[_0x45a45b(0x161)]),await performEmergencyShutdown(_0x4b10fe),process[_0x45a45b(0x144)](0x1);}),process['on'](_0x672552(0xdc),async(_0x319f97,_0x1b4a59)=>{const _0x795f8b=_0x672552;_0x4b10fe[_0x795f8b(0x132)](_0x795f8b(0x127),{'reason':_0x319f97?.['message']||_0x319f97,'promise':_0x1b4a59?.[_0x795f8b(0xfb)]()}),_0x319f97?.['stack']&&_0x4b10fe['error']('Rejection\x20stack\x20trace:',_0x319f97[_0x795f8b(0x161)]),await performEmergencyShutdown(_0x4b10fe),process[_0x795f8b(0x144)](0x1);}),process['on']('warning',_0xfa85ae=>{const _0x11c5fc=_0x672552;_0x4b10fe[_0x11c5fc(0xda)]('Node.js\x20warning:',{'name':_0xfa85ae['name'],'message':_0xfa85ae[_0x11c5fc(0xdb)],'stack':_0xfa85ae['stack']});}),_0x4b10fe['debug'](_0x672552(0x116));}function setupHealthMonitoring(_0x4db2de){const _0x857e40=a0_0x3936,_0x3a70bd=process[_0x857e40(0xde)][_0x857e40(0xe3)](0x2),_0x2c77d0=['do','make',_0x857e40(0x15d),_0x857e40(0x135)];if(!_0x2c77d0['some'](_0x157297=>_0x3a70bd[_0x857e40(0x15f)](_0x157297)))return;applicationState['healthCheckInterval']=setInterval(async()=>{const _0x324943=_0x857e40;try{await performHealthCheck(_0x4db2de);}catch(_0x19d146){_0x4db2de['warn'](_0x324943(0x103),_0x19d146);}},SERVICE_HEALTH_CHECK_INTERVAL_MS),_0x4db2de[_0x857e40(0x11c)]('Health\x20monitoring\x20configured');}async function performHealthCheck(_0x5f070e){const _0x1a024e=a0_0x3936,_0x5c8aac={'timestamp':new Date()[_0x1a024e(0xf4)](),'services':{},'overall':_0x1a024e(0x13b)};if(applicationState['services']['cli'])try{_0x5c8aac[_0x1a024e(0x10d)]['cli']='healthy';}catch(_0xe0ac16){_0x5c8aac[_0x1a024e(0x10d)][_0x1a024e(0x12c)]='unhealthy',_0x5c8aac[_0x1a024e(0x134)]=_0x1a024e(0xfe);}if(applicationState['services'][_0x1a024e(0xed)])try{const _0x44a1c6=await applicationState['services']['orchestrator']['getHealthStatus']?.()||'unknown';_0x5c8aac[_0x1a024e(0x10d)]['orchestrator']=_0x44a1c6[_0x1a024e(0x134)]||_0x1a024e(0x13b),(_0x44a1c6['overall']==='degraded'||_0x44a1c6['overall']===_0x1a024e(0x128))&&(_0x5c8aac[_0x1a024e(0x134)]=_0x1a024e(0xfe));}catch(_0x29b9f7){_0x5c8aac[_0x1a024e(0x10d)][_0x1a024e(0xed)]='unhealthy',_0x5c8aac['overall']='degraded';}_0x5c8aac['overall']!=='healthy'?_0x5f070e[_0x1a024e(0xda)]('Service\x20health\x20check\x20detected\x20issues:',_0x5c8aac):_0x5f070e['debug']('Health\x20check\x20passed:',_0x5c8aac);}async function performGracefulShutdown(_0x3e6822,_0x384563){const _0x2bd29c=a0_0x3936;if(applicationState['isShuttingDown'])return;applicationState[_0x2bd29c(0xe8)]=!![],_0x3e6822[_0x2bd29c(0x155)](_0x2bd29c(0x115),'Shutting\x20down\x20due\x20to\x20'+_0x384563);try{applicationState['healthCheckInterval']&&(clearInterval(applicationState['healthCheckInterval']),applicationState[_0x2bd29c(0x11d)]=null);const _0x6bbdd0=[];applicationState['services'][_0x2bd29c(0xed)]?.[_0x2bd29c(0x13c)]&&_0x6bbdd0[_0x2bd29c(0xe2)](Promise['race']([applicationState['services']['orchestrator'][_0x2bd29c(0x13c)](),new Promise((_0x5bcef7,_0x3a1874)=>setTimeout(()=>_0x3a1874(new Error(_0x2bd29c(0x114))),0x1388))])['catch'](_0x36cd6c=>{const _0x16a523=_0x2bd29c;_0x3e6822[_0x16a523(0xda)]('Orchestrator\x20shutdown\x20error:',_0x36cd6c);})),applicationState['services'][_0x2bd29c(0x12c)]?.['shutdown']&&_0x6bbdd0[_0x2bd29c(0xe2)](Promise['race']([applicationState[_0x2bd29c(0x10d)][_0x2bd29c(0x12c)][_0x2bd29c(0x13c)](),new Promise((_0x37d94f,_0x29dafa)=>setTimeout(()=>_0x29dafa(new Error(_0x2bd29c(0x122))),0xbb8))])['catch'](_0x5d2a11=>{const _0x5f49bf=_0x2bd29c;_0x3e6822[_0x5f49bf(0xda)](_0x5f49bf(0x12a),_0x5d2a11);})),await Promise[_0x2bd29c(0x141)]([Promise[_0x2bd29c(0xff)](_0x6bbdd0),new Promise(_0x737e82=>setTimeout(_0x737e82,GRACEFUL_SHUTDOWN_TIMEOUT_MS))]),_0x3e6822[_0x2bd29c(0x151)]('Graceful\x20shutdown',!![]),_0x3e6822[_0x2bd29c(0xec)]('Graceful\x20shutdown\x20completed\x20successfully');}catch(_0x286558){_0x3e6822[_0x2bd29c(0x151)]('Graceful\x20shutdown',![],{'error':_0x286558[_0x2bd29c(0xdb)]}),_0x3e6822[_0x2bd29c(0x132)](_0x2bd29c(0x13a),_0x286558);}finally{setTimeout(()=>{const _0x202958=_0x2bd29c;process[_0x202958(0x144)](0x0);},0x1f4);}}async function performEmergencyShutdown(_0x1f0f07){const _0x5f3bfb=a0_0x3936;if(applicationState[_0x5f3bfb(0xe8)])return;applicationState['isShuttingDown']=!![],_0x1f0f07['error']('Performing\x20emergency\x20shutdown');try{applicationState[_0x5f3bfb(0x11d)]&&clearInterval(applicationState['healthCheckInterval']),applicationState['services'][_0x5f3bfb(0xed)]?.[_0x5f3bfb(0xdd)]&&await Promise['race']([applicationState[_0x5f3bfb(0x10d)][_0x5f3bfb(0xed)]['saveSessionState'](),new Promise(_0x7fc1d7=>setTimeout(_0x7fc1d7,0x7d0))])[_0x5f3bfb(0x11b)](()=>{}),_0x1f0f07[_0x5f3bfb(0x132)]('Emergency\x20shutdown\x20completed');}catch(_0x43d040){console[_0x5f3bfb(0x132)]('Emergency\x20shutdown\x20failed:',_0x43d040['message']);}}function provideTroubleshootingSuggestions(_0x2a32c4){const _0xe83a75=a0_0x3936,_0x527416=[],_0x3dccf1=_0x2a32c4['message']['toLowerCase']();_0x3dccf1[_0xe83a75(0x15f)](_0xe83a75(0xe9))&&(_0x527416['push'](_0xe83a75(0x111)),_0x527416['push']('Get your API key from: https://autopilot.loxia.ai/account/api-keys')),(_0x3dccf1[_0xe83a75(0x15f)]('server')||_0x3dccf1[_0xe83a75(0x15f)](_0xe83a75(0x121)))&&(_0x527416[_0xe83a75(0xe2)]('Check\x20your\x20internet\x20connection'),_0x527416[_0xe83a75(0xe2)](_0xe83a75(0x112)),_0x527416['push'](_0xe83a75(0x146))),(_0x3dccf1[_0xe83a75(0x15f)]('permission')||_0x3dccf1[_0xe83a75(0x15f)](_0xe83a75(0xf3)))&&(_0x527416['push']('Check\x20file\x20system\x20permissions'),_0x527416[_0xe83a75(0xe2)](_0xe83a75(0x152)),_0x527416['push']('Try running from a different directory')),_0x3dccf1['includes']('timeout')&&(_0x527416['push']('Increase\x20timeout\x20settings\x20in\x20configuration'),_0x527416[_0xe83a75(0xe2)](_0xe83a75(0x154)),_0x527416['push']('Try\x20again\x20in\x20a\x20few\x20moments')),_0x3dccf1[_0xe83a75(0x15f)](_0xe83a75(0x104))&&(_0x527416[_0xe83a75(0xe2)](_0xe83a75(0x129)),_0x527416['push']('Create default config: loxia config --create'),_0x527416['push'](_0xe83a75(0xf7))),_0x527416['length']>0x0&&(console[_0xe83a75(0xfc)](a0_0x2006e4[_0xe83a75(0x13d)]('\x0a💡\x20Troubleshooting\x20suggestions:')),_0x527416['forEach'](_0x120046=>{const _0x134e7c=_0xe83a75;console['log'](a0_0x2006e4[_0x134e7c(0x10b)]('\x20\x20\x20•\x20'+_0x120046));})),console['log'](a0_0x2006e4[_0xe83a75(0x124)](_0xe83a75(0x110))),console['log'](a0_0x2006e4['gray'](_0xe83a75(0x11a))),console[_0xe83a75(0xfc)](a0_0x2006e4[_0xe83a75(0x124)](_0xe83a75(0xeb))),console[_0xe83a75(0xfc)](a0_0x2006e4[_0xe83a75(0x124)](_0xe83a75(0x10f)));}async function handleBootstrapTimeout(_0x11c225){const _0x1af4e4=a0_0x3936;_0x11c225['error']('Bootstrap\x20process\x20timed\x20out'),console['error'](a0_0x2006e4['red'](_0x1af4e4(0x139))),console['error'](a0_0x2006e4[_0x1af4e4(0x13d)](_0x1af4e4(0x153))),console[_0x1af4e4(0x132)](a0_0x2006e4[_0x1af4e4(0x13d)](_0x1af4e4(0xfa))),console[_0x1af4e4(0x132)](a0_0x2006e4['yellow']('\x20\x20\x20•\x20Server\x20is\x20down\x20or\x20overloaded')),console[_0x1af4e4(0x132)](a0_0x2006e4[_0x1af4e4(0x13d)](_0x1af4e4(0x126))),await performEmergencyShutdown(_0x11c225),process[_0x1af4e4(0x144)](0x1);}async function main(){const _0x24e958=a0_0x3936,_0x1a1160=Date['now']();try{await Promise[_0x24e958(0x141)]([bootstrap(),new Promise((_0x2f5a49,_0x155915)=>setTimeout(()=>_0x155915(new Error(_0x24e958(0xea))),INITIALIZATION_TIMEOUT_MS))]);}catch(_0x4e98fa){const _0xfcb211=Date['now']()-_0x1a1160;if(_0x4e98fa['message']===_0x24e958(0xea))await handleBootstrapTimeout(applicationState[_0x24e958(0x10d)]['logger']||createInitialLogger());else throw _0x4e98fa;}}main()['catch'](_0x1dbbc0=>{const _0x136354=a0_0x3936,_0x5c9586=applicationState[_0x136354(0x10d)][_0x136354(0x113)]||createInitialLogger();_0x5c9586[_0x136354(0x132)]('Fatal\x20error\x20during\x20startup:',_0x1dbbc0),console[_0x136354(0x132)](a0_0x2006e4[_0x136354(0xe4)](_0x136354(0x156))),console[_0x136354(0x132)](a0_0x2006e4['red'](_0x136354(0x109)+_0x1dbbc0[_0x136354(0xdb)])),process['env'][_0x136354(0x14b)]&&_0x1dbbc0[_0x136354(0x161)]&&(console[_0x136354(0x132)](a0_0x2006e4[_0x136354(0x124)](_0x136354(0x101))),console[_0x136354(0x132)](a0_0x2006e4[_0x136354(0x124)](_0x1dbbc0['stack']))),process[_0x136354(0x144)](0x1);}),process['on'](a0_0x5a69a5(0x123),_0x5d4648=>{const _0x820ff1=a0_0x5a69a5;applicationState[_0x820ff1(0x10d)]['logger']&&applicationState['services']['logger']['warn'](_0x820ff1(0x137),_0x5d4648);});export{bootstrap,performGracefulShutdown,performHealthCheck};