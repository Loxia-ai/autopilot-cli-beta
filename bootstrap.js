#!/usr/bin/env node

const a0_0x124b3d=a0_0x2147;(function(_0x125e9d,_0xcc3f4c){const _0x371fa3=a0_0x2147,_0x2b51c6=_0x125e9d();while(!![]){try{const _0x25307a=-parseInt(_0x371fa3(0x1bd))/0x1*(-parseInt(_0x371fa3(0x17f))/0x2)+parseInt(_0x371fa3(0x1d4))/0x3+-parseInt(_0x371fa3(0x18a))/0x4*(parseInt(_0x371fa3(0x1ce))/0x5)+parseInt(_0x371fa3(0x185))/0x6+-parseInt(_0x371fa3(0x1c1))/0x7*(-parseInt(_0x371fa3(0x17c))/0x8)+parseInt(_0x371fa3(0x178))/0x9+parseInt(_0x371fa3(0x195))/0xa*(-parseInt(_0x371fa3(0x1d0))/0xb);if(_0x25307a===_0xcc3f4c)break;else _0x2b51c6['push'](_0x2b51c6['shift']());}catch(_0x429d3f){_0x2b51c6['push'](_0x2b51c6['shift']());}}}(a0_0x4986,0x4b5a2));import a0_0x40e387 from'dotenv';a0_0x40e387[a0_0x124b3d(0x1b2)]();import{CLI}from'./core/cli.js';import{ConversationOrchestrator}from'./core/conversationOrchestrator.js';import{LoggingService}from'./services/loggingService.js';import{loadConfig}from'./config/configLoader.js';import a0_0x3d47a8 from'chalk';import{performance}from'perf_hooks';function a0_0x2147(_0x1a7132,_0x4e1f49){const _0x498679=a0_0x4986();return a0_0x2147=function(_0x21475c,_0x2fc56b){_0x21475c=_0x21475c-0x173;let _0x286c21=_0x498679[_0x21475c];if(a0_0x2147['RFZQDg']===undefined){var _0x150c52=function(_0x40e387){const _0x3d47a8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3155d1='',_0x222d0f='';for(let _0x3952f6=0x0,_0x3a8122,_0x42c4cd,_0x1f167c=0x0;_0x42c4cd=_0x40e387['charAt'](_0x1f167c++);~_0x42c4cd&&(_0x3a8122=_0x3952f6%0x4?_0x3a8122*0x40+_0x42c4cd:_0x42c4cd,_0x3952f6++%0x4)?_0x3155d1+=String['fromCharCode'](0xff&_0x3a8122>>(-0x2*_0x3952f6&0x6)):0x0){_0x42c4cd=_0x3d47a8['indexOf'](_0x42c4cd);}for(let _0x24b957=0x0,_0x52b145=_0x3155d1['length'];_0x24b957<_0x52b145;_0x24b957++){_0x222d0f+='%'+('00'+_0x3155d1['charCodeAt'](_0x24b957)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x222d0f);};a0_0x2147['OEXNSD']=_0x150c52,_0x1a7132=arguments,a0_0x2147['RFZQDg']=!![];}const _0x30e4bd=_0x498679[0x0],_0x1b0226=_0x21475c+_0x30e4bd,_0x21b4f1=_0x1a7132[_0x1b0226];return!_0x21b4f1?(_0x286c21=a0_0x2147['OEXNSD'](_0x286c21),_0x1a7132[_0x1b0226]=_0x286c21):_0x286c21=_0x21b4f1,_0x286c21;},a0_0x2147(_0x1a7132,_0x4e1f49);}const INITIALIZATION_TIMEOUT_MS=0x7530,GRACEFUL_SHUTDOWN_TIMEOUT_MS=0x2710,SERVICE_HEALTH_CHECK_INTERVAL_MS=0x493e0;let applicationState={'isShuttingDown':![],'initializationStartTime':null,'services':{'logger':null,'config':null,'cli':null,'orchestrator':null},'healthCheckInterval':null};async function bootstrap(){const _0xd75eeb=a0_0x124b3d;applicationState['initializationStartTime']=performance['now']();const _0x3155d1=createInitialLogger();applicationState[_0xd75eeb(0x18b)]['logger']=_0x3155d1;try{_0x3155d1['info'](_0xd75eeb(0x19d)),_0x3155d1['startTask']('Bootstrap','Initializing\x20application\x20components');const _0x222d0f=await initializeConfiguration(_0x3155d1);applicationState['services'][_0xd75eeb(0x1b2)]=_0x222d0f;const _0x3952f6=createEnhancedLogger(_0x222d0f);applicationState['services'][_0xd75eeb(0x184)]=_0x3952f6;const _0x3a8122=await initializeCLI(_0x222d0f,_0x3952f6);applicationState['services']['cli']=_0x3a8122,await initializeOrchestratorIfNeeded(_0x3a8122,_0x222d0f,_0x3952f6),setupSignalHandlers(_0x3952f6),setupHealthMonitoring(_0x3952f6);const _0x42c4cd=performance['now']()-applicationState['initializationStartTime'];_0x3952f6['completeTask'](_0xd75eeb(0x174),!![],{'initializationTime':Math['round'](_0x42c4cd),'serverMode':_0x222d0f['useServerLLM'],'services':Object[_0xd75eeb(0x1c7)](applicationState['services'])[_0xd75eeb(0x1b8)](_0x1f167c=>applicationState['services'][_0x1f167c]!==null)}),_0x3952f6[_0xd75eeb(0x1da)](_0xd75eeb(0x1cd)+Math[_0xd75eeb(0x1c3)](_0x42c4cd)+'ms'),await _0x3a8122[_0xd75eeb(0x1a1)]();}catch(_0x24b957){const _0x52b145=performance[_0xd75eeb(0x1dd)]()-applicationState['initializationStartTime'];_0x3155d1[_0xd75eeb(0x1df)](_0xd75eeb(0x174),![],{'error':_0x24b957['message'],'initializationTime':Math[_0xd75eeb(0x1c3)](_0x52b145)}),console['error'](a0_0x3d47a8[_0xd75eeb(0x1b5)]('\x0a❌\x20Failed\x20to\x20start\x20Loxia\x20CLI:')),console[_0xd75eeb(0x197)](a0_0x3d47a8['red']('\x20\x20\x20'+_0x24b957['message'])),_0x24b957['stack']&&process['env']['LOXIA_DEBUG']&&(console['error'](a0_0x3d47a8['gray'](_0xd75eeb(0x17a))),console['error'](a0_0x3d47a8[_0xd75eeb(0x1b0)](_0x24b957[_0xd75eeb(0x199)]))),provideTroubleshootingSuggestions(_0x24b957),await performEmergencyShutdown(_0x3155d1),process[_0xd75eeb(0x1c5)](0x1);}}function createInitialLogger(){const _0x26305b=a0_0x124b3d;return new LoggingService({'console':![],'file':![],'logLevel':process[_0x26305b(0x19b)]['LOXIA_LOG_LEVEL']||'info','silent':process['env']['LOXIA_SILENT']==='true'});}async function initializeConfiguration(_0x4c3e38){const _0x161d5a=a0_0x124b3d;_0x4c3e38[_0x161d5a(0x1da)](_0x161d5a(0x193));try{const _0x4a1481=await loadConfig();return await validateRuntimeConfiguration(_0x4a1481,_0x4c3e38),_0x4c3e38['info']('Configuration\x20loaded\x20and\x20validated\x20successfully',{'serverMode':_0x4a1481[_0x161d5a(0x177)],'logLevel':_0x4a1481[_0x161d5a(0x1e5)]['logLevel'],'llmStrategy':_0x4a1481['llmStrategy']}),_0x4a1481;}catch(_0x3c1a42){_0x4c3e38['error'](_0x161d5a(0x188),_0x3c1a42);throw new Error('Configuration\x20error:\x20'+_0x3c1a42[_0x161d5a(0x1ed)]);}}function a0_0x4986(){const _0x236dd6=['CM91BMq','r3jHy2vMDwWGC2H1DgrVD24Gy29TCgXLDgvKihn1y2nLC3nMDwXSEq','zxHPDa','rM9Yy2uGC2H1DgrVD24GlsbYzwnLAxzLzcbZzwnVBMqGu0Lhvevstq','A2v5CW','q29UDgLUDwLUzYb3AxrOB3v0ig9Yy2HLC3rYyxrVCIbMB3iGC3rHDhvZignVBw1HBMq','EwvSBg93','q29UzMLNDxjHDgLVBIbMAwXLihzHBgLKyxrPB24GzMfPBgvKoG','DgHLBG','AxntAhv0DgLUz0rVD24','tg94AweGq0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEsbPBIa','nJvpz3jMyw4','qM9VDhn0CMfWihrPBwvVDxq','mtfxBLzcAgy','u2TPChbPBMCGB3jJAgvZDhjHDg9YigLUAxrPywXPEMf0Aw9UigzVCIb1DgLSAxr5ignVBw1HBMq','icaG4OcIia','y3LHBG','mteWmtK5m1jUs2HNvq','CMfJzq','Dg9mB3DLCKnHC2u','z2XVyMfS','Aw5JBhvKzxm','AgvHBhrOq2HLy2TjBNrLCNzHBa','Aw5MBW','lI9JB25MAwCVy29UzMLNtg9HzgvYlMPZ','yxjNDG','BM93','tM8GqvbjigTLEsbMB3vUzcaTihnVBwuGy29TBwfUzhmGD2LSBcbUB3qGyMuGyxzHAwXHyMXL','y29TCgXLDgvuyxnR','uNvUDgLTzsb2ywXPzgf0Aw9UigzHAwXLzdOk','q0XjigLUAxrPywXPEMf0Aw9UigzHAwXLzdO','zgvNCMfKzwq','y2f0y2G','ywXSu2v0DgXLza','Bg9Nz2LUzW','rMf0ywWGzxjYB3iGzhvYAw5Nihn0yxj0Dxa6','C2v0t3jJAgvZDhjHDg9Y','BgvUz3rO','cVcFLi0GrM9Yig1VCMuGAgvSCdO','t3jJAgvZDhjHDg9YihnODxrKB3DUigvYCM9YoG','ugvYzM9YBwLUzYbLBwvYz2vUy3KGC2H1DgrVD24','Bg9N','BwvZC2fNzq','B3zLCMfSBa','qM9VDhn0CMfW','Bg9Ntgv2zwW','uhjVy2vZCYb3yxjUAw5NoG','DxnLu2vYDMvYteXn','ndK0mJq0uwDZz0z4','ChvZAa','cLn0ywnRihrYywnLoG','t3jJAgvZDhjHDg9YigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','mta0ndqWohDRrKnovG','C2vYDMvYvxjS','C2H1DgrVD24','mJzvuvrJrxC','r3jHy2vMDwWGC2H1DgrVD24','u2H1DhrPBMCGzg93BIbKDwuGDg8G','C29Tzq','z2v0u3rVCMvKqxbPs2v5','Bg9Nz2vY','mZi5ntK4menrDwr5tq','q0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEq','q0XjihnODxrKB3DUihrPBwvVDxq','q29UzMLNDxjHDgLVBIbSB2fKAw5NigzHAwXLzdO','q0XjigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','mJi0nZj4u2fyB2e','C2vYDMLJzxm','AgvHBhrOEq','q2HLy2SGzMLSzsbZExn0zw0GCgvYBwLZC2LVBNm','yxbPs2v5','icaG4OcIifnLCNzLCIbPCYbKB3DUig9Yig92zxjSB2fKzwq','u2v0ihLVDxiGqvbjigTLEsb3AxrOoIbSB3HPysbRzxKGls1ZzxqGphLVDxiTyxbPlwTLEt4','r0vu','ls1OzwXW','tg9HzgLUzYbJB25MAwD1CMf0Aw9U','C2vYDMvY','mtm3mZC3nZbMy2jTseq','D2fYBG','zxjYB3i','y29UC29Szq','C3rHy2S','zw5HyMXLza','zw52','y2XP','u3rHCNrPBMCGtg94AweGq0XjigfWCgXPy2f0Aw9U','Bg9JywW','Dg9tDhjPBMC','u0Lhvevstq','C3rHCNq','C2XPy2u','yw50AhjVCgLJ','Dg9ju09tDhjPBMC','vw5JyxvNAhqGzxHJzxb0Aw9UoG','B3bLBMfP','vhj5igfNywLUigLUigeGzMv3ig1VBwvUDhm','C2f2zvnLC3nPB25tDgf0zq','u2vYDMvYigHLywX0AcbJAgvJAYbMywLSzwq6ieHuvfaG','u2vYDMLJzsbOzwfSDgGGy2HLy2SGzgv0zwn0zwqGAxnZDwvZoG','icaG','BM8GBg9JywWGy29UzMLN','z2v0sgvHBhrOu3rHDhvZ','ChjVBwLZzxm','B3jJAgvZDhjHDg9Y','z3jHEq','cUkpScbjBML0AwfSAxPHDgLVBIb0Aw1LzcbVDxq','y29UzMLN','uMvJzwL2zwqGu0LhvevstsWGAw5PDgLHDgLUzYbNCMfJzwz1BcbZAhv0zg93BG','sw5PDgLHBgL6Aw5NignVBNzLCNnHDgLVBIbVCMnOzxn0CMf0B3i','CMvK','cVcFKQeGvhjVDwjSzxnOB290Aw5Nihn1z2DLC3rPB25ZoG','u0Lhsu5u','zMLSDgvY','z29Vz2XL','icaTia','yNvKz2v0','Bg9NrgLY','mZaXnZfetMLgq1K','y29UBMvJDgLVBG','zM9YrwfJAa','Dw5OzwfSDgH5','mJftse1oCxm','rw5ZDxjLihLVDsbOyxzLihDYAxrLigfJy2vZCYb0BYb0AguGy3vYCMvUDcbKAxjLy3rVCNK'];a0_0x4986=function(){return _0x236dd6;};return a0_0x4986();}async function validateRuntimeConfiguration(_0x13d085,_0x575914){const _0x122839=a0_0x124b3d,_0x3db3e2=[];if(_0x13d085['useServerLLM'])try{const _0x114121=await fetch(_0x13d085['serverUrl']+'/health',{'method':_0x122839(0x191),'timeout':0x1388});!_0x114121['ok']&&_0x3db3e2['push'](_0x122839(0x1a9)+_0x114121['status']);}catch(_0x27d013){_0x3db3e2[_0x122839(0x179)]('Cannot\x20reach\x20server\x20at\x20'+_0x13d085[_0x122839(0x17d)]+':\x20'+_0x27d013['message']);}if(!_0x13d085['useServerLLM']){const _0x1a3f34=_0x13d085[_0x122839(0x18b)]['anthropic']['apiKey']||_0x13d085['services'][_0x122839(0x1a6)]['apiKey']||_0x13d085['services']['google'][_0x122839(0x18e)];!_0x1a3f34&&_0x3db3e2[_0x122839(0x179)]('No\x20API\x20keys\x20configured\x20for\x20fallback\x20services');}try{const _0xfb954=_0x13d085['budget']['usageDir'];await import('fs')[_0x122839(0x1cb)](_0x1adacb=>_0x1adacb['promises']['mkdir'](_0xfb954,{'recursive':!![]})),await import('fs')['then'](_0x681a10=>_0x681a10[_0x122839(0x1ae)]['access'](_0xfb954,_0x681a10['constants']['W_OK']));}catch(_0x41e8b0){_0x3db3e2[_0x122839(0x179)]('Cannot\x20write\x20to\x20budget\x20directory:\x20'+_0x41e8b0['message']);}if(_0x3db3e2['length']>0x0){const _0x52985a=_0x122839(0x1e0)+_0x3db3e2['map'](_0x268c2b=>_0x122839(0x1ba)+_0x268c2b)['join']('\x0a');if(_0x13d085[_0x122839(0x177)]&&_0x3db3e2[_0x122839(0x182)](_0x2512d9=>_0x2512d9['includes']('server')))_0x575914['warn']('Server\x20validation\x20failed,\x20will\x20attempt\x20fallback\x20to\x20local\x20services'),_0x13d085['useServerLLM']=![],_0x13d085[_0x122839(0x18b)]['anthropic']['enabled']=!!_0x13d085['services'][_0x122839(0x1a3)][_0x122839(0x18e)],_0x13d085[_0x122839(0x18b)]['openai']['enabled']=!!_0x13d085['services'][_0x122839(0x1a6)][_0x122839(0x18e)],_0x13d085['services'][_0x122839(0x1b9)][_0x122839(0x19a)]=!!_0x13d085['services'][_0x122839(0x1b9)]['apiKey'];else throw new Error(_0x52985a);}}function createEnhancedLogger(_0x5c17ef){const _0x4526b4=a0_0x124b3d;return new LoggingService({'console':_0x5c17ef['logging'][_0x4526b4(0x198)]!==![],'file':_0x5c17ef[_0x4526b4(0x1e5)]['file']!==![],'logLevel':_0x5c17ef[_0x4526b4(0x1e5)][_0x4526b4(0x175)],'logDir':_0x5c17ef[_0x4526b4(0x1e5)][_0x4526b4(0x1bc)],'silent':_0x5c17ef['logging']['silent']===!![]});}async function initializeCLI(_0x259799,_0x53e34f){const _0x2891c9=a0_0x124b3d;_0x53e34f['info']('Initializing\x20CLI');try{const _0x5608f5=new CLI(null,_0x259799,_0x53e34f);return await validateCLIResources(_0x5608f5,_0x259799,_0x53e34f),_0x53e34f['info'](_0x2891c9(0x186)),_0x5608f5;}catch(_0x1fdc12){_0x53e34f['error'](_0x2891c9(0x1e1),_0x1fdc12);throw new Error(_0x2891c9(0x189)+_0x1fdc12['message']);}}async function validateCLIResources(_0x6ec0f8,_0x26b602,_0x4971e7){const _0x4eec40=a0_0x124b3d,_0x5cf298=await _0x6ec0f8[_0x4eec40(0x183)]()['catch'](()=>null);!_0x5cf298&&_0x26b602['useServerLLM']&&_0x4971e7['warn'](_0x4eec40(0x1de));try{const {getConfigPaths:_0x4bc234}=await import(_0x4eec40(0x1db)),_0x178e54=_0x4bc234();await import('fs')[_0x4eec40(0x1cb)](_0x16722d=>{const _0x1eef28=_0x4eec40,_0x4f3d93=[];return _0x178e54[_0x1eef28(0x1d7)]&&_0x4f3d93['push'](_0x16722d['promises']['access'](_0x178e54[_0x1eef28(0x1d7)])[_0x1eef28(0x1e3)](()=>'no\x20global\x20config')),_0x178e54['local']&&_0x4f3d93[_0x1eef28(0x179)](_0x16722d[_0x1eef28(0x1ae)]['access'](_0x178e54[_0x1eef28(0x19e)])[_0x1eef28(0x1e3)](()=>_0x1eef28(0x1ac))),Promise[_0x1eef28(0x1e4)](_0x4f3d93);});}catch(_0x31cbda){_0x4971e7['warn'](_0x4eec40(0x1ca),_0x31cbda);}}async function initializeOrchestratorIfNeeded(_0x27f8f5,_0x5e384d,_0x2dae69){const _0x120bf1=a0_0x124b3d,_0x81511e=process[_0x120bf1(0x1dc)][_0x120bf1(0x1a2)](0x2),_0xe4e05b=_0x81511e[0x0],_0x12b750=['key','status','budget','--help','-h','--version','-v'];if(_0x12b750[_0x120bf1(0x1d8)](_0xe4e05b)||_0x81511e[_0x120bf1(0x1d8)](_0x120bf1(0x192))||_0x81511e[_0x120bf1(0x1d8)]('-h')){_0x2dae69['debug'](_0x120bf1(0x1d1));return;}_0x2dae69[_0x120bf1(0x1da)](_0x120bf1(0x1b4));try{const _0x2c4bb9=new ConversationOrchestrator(_0x5e384d,_0x2dae69);await _0x2c4bb9['initializeServices'](),_0x27f8f5[_0x120bf1(0x1e7)](_0x2c4bb9),applicationState['services']['orchestrator']=_0x2c4bb9,_0x2dae69[_0x120bf1(0x1da)]('Conversation\x20orchestrator\x20initialized\x20successfully');}catch(_0x3f6d3f){_0x2dae69[_0x120bf1(0x197)]('Orchestrator\x20initialization\x20failed:',_0x3f6d3f);if(['status',_0x120bf1(0x1bb)][_0x120bf1(0x1d8)](_0xe4e05b))_0x2dae69['warn'](_0x120bf1(0x1c8));else throw new Error(_0x120bf1(0x17b)+_0x3f6d3f[_0x120bf1(0x1ed)]);}}function setupSignalHandlers(_0x3e50da){process['on']('SIGINT',async()=>{const _0x5680ae=a0_0x2147;applicationState['isShuttingDown']&&(_0x3e50da[_0x5680ae(0x196)]('Force\x20shutdown\x20-\x20received\x20second\x20SIGINT'),process['exit'](0x1)),_0x3e50da['info']('Received\x20SIGINT,\x20initiating\x20graceful\x20shutdown'),await performGracefulShutdown(_0x3e50da,_0x5680ae(0x1b7));}),process['on']('SIGTERM',async()=>{const _0x33cb82=a0_0x2147;applicationState[_0x33cb82(0x1cc)]&&(_0x3e50da['warn'](_0x33cb82(0x1c6)),process['exit'](0x1)),_0x3e50da['info'](_0x33cb82(0x1b3)),await performGracefulShutdown(_0x3e50da,_0x33cb82(0x1a0));}),process['on']('uncaughtException',async _0x2c6b48=>{const _0x3edc6e=a0_0x2147;_0x3e50da[_0x3edc6e(0x197)](_0x3edc6e(0x1a5),_0x2c6b48),_0x2c6b48['stack']&&_0x3e50da['error']('Stack\x20trace:',_0x2c6b48['stack']),await performEmergencyShutdown(_0x3e50da),process['exit'](0x1);}),process['on']('unhandledRejection',async(_0x545dc4,_0x3cdf2a)=>{const _0x1e16d6=a0_0x2147;_0x3e50da['error']('Unhandled\x20promise\x20rejection:',{'reason':_0x545dc4?.[_0x1e16d6(0x1ed)]||_0x545dc4,'promise':_0x3cdf2a?.[_0x1e16d6(0x19f)]()}),_0x545dc4?.[_0x1e16d6(0x199)]&&_0x3e50da['error']('Rejection\x20stack\x20trace:',_0x545dc4['stack']),await performEmergencyShutdown(_0x3e50da),process[_0x1e16d6(0x1c5)](0x1);}),process['on']('warning',_0x343fa1=>{_0x3e50da['warn']('Node.js\x20warning:',{'name':_0x343fa1['name'],'message':_0x343fa1['message'],'stack':_0x343fa1['stack']});}),_0x3e50da['debug']('Signal\x20handlers\x20configured');}function setupHealthMonitoring(_0x13382e){const _0x3417f3=a0_0x124b3d,_0x315aad=process['argv'][_0x3417f3(0x1a2)](0x2),_0x4297b6=['do','make','resume','modify'];if(!_0x4297b6['some'](_0x480069=>_0x315aad['includes'](_0x480069)))return;applicationState[_0x3417f3(0x1d9)]=setInterval(async()=>{const _0x291e10=_0x3417f3;try{await performHealthCheck(_0x13382e);}catch(_0x312247){_0x13382e[_0x291e10(0x196)]('Health\x20check\x20failed:',_0x312247);}},SERVICE_HEALTH_CHECK_INTERVAL_MS),_0x13382e['debug']('Health\x20monitoring\x20configured');}async function performHealthCheck(_0x3eda4e){const _0x3e312d=a0_0x124b3d,_0x1fa577={'timestamp':new Date()[_0x3e312d(0x1a4)](),'services':{},'overall':_0x3e312d(0x18c)};if(applicationState[_0x3e312d(0x18b)][_0x3e312d(0x19c)])try{_0x1fa577['services'][_0x3e312d(0x19c)]=_0x3e312d(0x18c);}catch(_0x75e07c){_0x1fa577['services'][_0x3e312d(0x19c)]='unhealthy',_0x1fa577[_0x3e312d(0x173)]='degraded';}if(applicationState['services']['orchestrator'])try{const _0x4b08ae=await applicationState[_0x3e312d(0x18b)][_0x3e312d(0x1af)][_0x3e312d(0x1ad)]?.()||'unknown';_0x1fa577[_0x3e312d(0x18b)][_0x3e312d(0x1af)]=_0x4b08ae['overall']||'healthy',(_0x4b08ae['overall']===_0x3e312d(0x1e2)||_0x4b08ae[_0x3e312d(0x173)]===_0x3e312d(0x1c0))&&(_0x1fa577['overall']=_0x3e312d(0x1e2));}catch(_0x25a221){_0x1fa577[_0x3e312d(0x18b)]['orchestrator']=_0x3e312d(0x1c0),_0x1fa577[_0x3e312d(0x173)]='degraded';}_0x1fa577[_0x3e312d(0x173)]!=='healthy'?_0x3eda4e[_0x3e312d(0x196)](_0x3e312d(0x1aa),_0x1fa577):_0x3eda4e['debug']('Health\x20check\x20passed:',_0x1fa577);}async function performGracefulShutdown(_0xf7816f,_0x4beec0){const _0x16c4d4=a0_0x124b3d;if(applicationState[_0x16c4d4(0x1cc)])return;applicationState[_0x16c4d4(0x1cc)]=!![],_0xf7816f['startTask']('Graceful\x20shutdown',_0x16c4d4(0x181)+_0x4beec0);try{applicationState['healthCheckInterval']&&(clearInterval(applicationState['healthCheckInterval']),applicationState[_0x16c4d4(0x1d9)]=null);const _0x509fda=[];applicationState[_0x16c4d4(0x18b)]['orchestrator']?.['shutdown']&&_0x509fda[_0x16c4d4(0x179)](Promise[_0x16c4d4(0x1d5)]([applicationState[_0x16c4d4(0x18b)][_0x16c4d4(0x1af)]['shutdown'](),new Promise((_0xf2e76b,_0x506115)=>setTimeout(()=>_0x506115(new Error('Orchestrator\x20shutdown\x20timeout')),0x1388))])[_0x16c4d4(0x1e3)](_0x5eb9ce=>{const _0x307564=_0x16c4d4;_0xf7816f[_0x307564(0x196)](_0x307564(0x1ea),_0x5eb9ce);})),applicationState['services']['cli']?.['shutdown']&&_0x509fda['push'](Promise['race']([applicationState['services']['cli'][_0x16c4d4(0x17e)](),new Promise((_0xbbfaae,_0x22b3d6)=>setTimeout(()=>_0x22b3d6(new Error(_0x16c4d4(0x187))),0xbb8))])[_0x16c4d4(0x1e3)](_0x19e54e=>{const _0x2f3627=_0x16c4d4;_0xf7816f[_0x2f3627(0x196)]('CLI\x20shutdown\x20error:',_0x19e54e);})),await Promise[_0x16c4d4(0x1d5)]([Promise['allSettled'](_0x509fda),new Promise(_0x1830cb=>setTimeout(_0x1830cb,GRACEFUL_SHUTDOWN_TIMEOUT_MS))]),_0xf7816f[_0x16c4d4(0x1df)](_0x16c4d4(0x180),!![]),_0xf7816f[_0x16c4d4(0x1da)](_0x16c4d4(0x1c4));}catch(_0xca7374){_0xf7816f[_0x16c4d4(0x1df)]('Graceful\x20shutdown',![],{'error':_0xca7374['message']}),_0xf7816f['error']('Error\x20during\x20graceful\x20shutdown:',_0xca7374);}finally{setTimeout(()=>{process['exit'](0x0);},0x1f4);}}async function performEmergencyShutdown(_0x57d651){const _0x55a1f1=a0_0x124b3d;if(applicationState[_0x55a1f1(0x1cc)])return;applicationState['isShuttingDown']=!![],_0x57d651['error'](_0x55a1f1(0x1eb));try{applicationState['healthCheckInterval']&&clearInterval(applicationState[_0x55a1f1(0x1d9)]),applicationState[_0x55a1f1(0x18b)]['orchestrator']?.[_0x55a1f1(0x1a8)]&&await Promise[_0x55a1f1(0x1d5)]([applicationState[_0x55a1f1(0x18b)][_0x55a1f1(0x1af)][_0x55a1f1(0x1a8)](),new Promise(_0x4fd103=>setTimeout(_0x4fd103,0x7d0))])[_0x55a1f1(0x1e3)](()=>{}),_0x57d651[_0x55a1f1(0x197)]('Emergency\x20shutdown\x20completed');}catch(_0x55ce7c){console[_0x55a1f1(0x197)]('Emergency\x20shutdown\x20failed:',_0x55ce7c['message']);}}function provideTroubleshootingSuggestions(_0x560216){const _0x6f4441=a0_0x124b3d,_0x2faa32=[],_0x5c7291=_0x560216['message'][_0x6f4441(0x1d6)]();_0x5c7291['includes']('api\x20key')&&(_0x2faa32[_0x6f4441(0x179)](_0x6f4441(0x190)),_0x2faa32[_0x6f4441(0x179)]('Get your API key from: https://autopilot.loxia.ai/account/api-keys')),(_0x5c7291['includes'](_0x6f4441(0x194))||_0x5c7291[_0x6f4441(0x1d8)](_0x6f4441(0x1be)))&&(_0x2faa32['push']('Check\x20your\x20internet\x20connection'),_0x2faa32[_0x6f4441(0x179)]('Verify\x20the\x20server\x20URL\x20in\x20your\x20configuration'),_0x2faa32['push']('Try\x20using\x20fallback\x20mode:\x20LOXIA_USE_SERVER_LLM=false')),(_0x5c7291['includes']('permission')||_0x5c7291[_0x6f4441(0x1d8)]('access'))&&(_0x2faa32['push'](_0x6f4441(0x18d)),_0x2faa32['push'](_0x6f4441(0x1c2)),_0x2faa32['push']('Try running from a different directory')),_0x5c7291[_0x6f4441(0x1d8)]('timeout')&&(_0x2faa32[_0x6f4441(0x179)]('Increase\x20timeout\x20settings\x20in\x20configuration'),_0x2faa32['push']('Check\x20network\x20connectivity'),_0x2faa32[_0x6f4441(0x179)](_0x6f4441(0x1a7))),_0x5c7291[_0x6f4441(0x1d8)]('config')&&(_0x2faa32[_0x6f4441(0x179)]('Check\x20configuration\x20file\x20syntax'),_0x2faa32[_0x6f4441(0x179)]('Create default config: loxia config --create'),_0x2faa32[_0x6f4441(0x179)]('Validate\x20configuration:\x20loxia\x20config\x20--validate')),_0x2faa32[_0x6f4441(0x1e8)]>0x0&&(console[_0x6f4441(0x1ec)](a0_0x3d47a8[_0x6f4441(0x1c9)](_0x6f4441(0x1b6))),_0x2faa32[_0x6f4441(0x1bf)](_0x5cd6a1=>{const _0x34597d=_0x6f4441;console[_0x34597d(0x1ec)](a0_0x3d47a8[_0x34597d(0x1d3)](_0x34597d(0x1d2)+_0x5cd6a1));})),console[_0x6f4441(0x1ec)](a0_0x3d47a8['gray'](_0x6f4441(0x1e9))),console['log'](a0_0x3d47a8['gray']('\x20\x20\x20•\x20Run:\x20loxia\x20--help')),console['log'](a0_0x3d47a8['gray']('\x20\x20\x20•\x20Check\x20documentation:\x20https://docs.loxia.ai')),console['log'](a0_0x3d47a8['gray']('\x20\x20\x20•\x20Report\x20issues:\x20https://github.com/loxia-ai/cli/issues'));}async function handleBootstrapTimeout(_0x109bea){const _0xb24141=a0_0x124b3d;_0x109bea['error']('Bootstrap\x20process\x20timed\x20out'),console['error'](a0_0x3d47a8['red'](_0xb24141(0x1b1))),console['error'](a0_0x3d47a8[_0xb24141(0x1c9)]('This\x20might\x20indicate:')),console['error'](a0_0x3d47a8[_0xb24141(0x1c9)]('\x20\x20\x20•\x20Network\x20connectivity\x20issues')),console['error'](a0_0x3d47a8['yellow'](_0xb24141(0x18f))),console[_0xb24141(0x197)](a0_0x3d47a8['yellow']('\x20\x20\x20•\x20Configuration\x20problems')),await performEmergencyShutdown(_0x109bea),process['exit'](0x1);}async function main(){const _0x38b569=a0_0x124b3d,_0x79a631=Date['now']();try{await Promise['race']([bootstrap(),new Promise((_0x11170d,_0x3f9717)=>setTimeout(()=>_0x3f9717(new Error(_0x38b569(0x1cf))),INITIALIZATION_TIMEOUT_MS))]);}catch(_0x13ce05){const _0xd8a5d8=Date[_0x38b569(0x1dd)]()-_0x79a631;if(_0x13ce05[_0x38b569(0x1ed)]==='Bootstrap\x20timeout')await handleBootstrapTimeout(applicationState[_0x38b569(0x18b)]['logger']||createInitialLogger());else throw _0x13ce05;}}main()[a0_0x124b3d(0x1e3)](_0x1fd87a=>{const _0x4d4f49=a0_0x124b3d,_0x3f4d23=applicationState[_0x4d4f49(0x18b)]['logger']||createInitialLogger();_0x3f4d23['error'](_0x4d4f49(0x1e6),_0x1fd87a),console[_0x4d4f49(0x197)](a0_0x3d47a8['red']('\x0a💥\x20Fatal\x20startup\x20error:')),console['error'](a0_0x3d47a8['red'](_0x4d4f49(0x1ab)+_0x1fd87a['message'])),process['env']['LOXIA_DEBUG']&&_0x1fd87a[_0x4d4f49(0x199)]&&(console['error'](a0_0x3d47a8['gray'](_0x4d4f49(0x17a))),console[_0x4d4f49(0x197)](a0_0x3d47a8['gray'](_0x1fd87a['stack']))),process[_0x4d4f49(0x1c5)](0x1);}),process['on']('warning',_0x1e0bcd=>{const _0x45d3c1=a0_0x124b3d;applicationState['services']['logger']&&applicationState[_0x45d3c1(0x18b)][_0x45d3c1(0x184)][_0x45d3c1(0x196)](_0x45d3c1(0x176),_0x1e0bcd);});export{bootstrap,performGracefulShutdown,performHealthCheck};