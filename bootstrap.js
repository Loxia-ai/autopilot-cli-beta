#!/usr/bin/env node

const a0_0x46ec98=a0_0x846c;function a0_0x2588(){const _0x510bae=['C2H1DgrVD24','CMvK','icaG4OcIifnLCNzLCIbPCYbKB3DUig9Yig92zxjSB2fKzwq','mti2rePgvMvk','zgvIDwC','rM9Yy2uGC2H1DgrVD24GlsbYzwnLAxzLzcbZzwnVBMqGu0Lhvevstq','zgvNCMfKzwq','ugvYzM9YBwLUzYbLBwvYz2vUy3KGC2H1DgrVD24','te9ysufFte9hx0XfvKvm','q29UzMLNDxjHDgLVBIbSB2fKzwqGyw5KihzHBgLKyxrLzcbZDwnJzxnZzNvSBhK','BwTKAxi','A2v5CW','C2v0t3jJAgvZDhjHDg9Y','yNvKz2v0','zw52','Dhj1zq','q0XjihnODxrKB3DUigvYCM9YoG','D2fYBG','z2XVyMfS','q0XjigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','icaG','Dg9ju09tDhjPBMC','DxnLu2vYDMvYteXn','mZC5nJq4vgfPC1L2','C3rHDhvZ','BgvUz3rO','r3jHy2vMDwWGC2H1DgrVD24Gy29TCgXLDgvKihn1y2nLC3nMDwXSEq','sgvHBhrOignOzwnRigzHAwXLzdO','ywXSu2v0DgXLza','ntK3ode2AwDfvLH6','Dw5OzwfSDgH5','Aw5PDgLHBgL6zvnLCNzPy2vZ','C2vYDMLJzxm','C2vYDMvYvxjS','vMfSAwrHDguGy29UzMLNDxjHDgLVBJOGBg94AweGy29UzMLNic0TDMfSAwrHDgu','BM8GBg9JywWGy29UzMLN','vw5Oyw5KBgvKihbYB21PC2uGCMvQzwn0Aw9UoG','icaG4OcIie5LDhDVCMSGy29UBMvJDgL2Axr5igLZC3vLCW','BgXTu3rYyxrLz3K','cVcFKQuGrMf0ywWGC3rHCNr1CcbLCNjVCJO','rxjYB3iGzhvYAw5NigDYywnLzNvSihnODxrKB3DUoG','q2fUBM90ihjLywnOihnLCNzLCIbHDca','uNvUDgLTzsb2ywXPzgf0Aw9UigzHAwXLzdOk','yw50AhjVCgLJ','C3rHCNruyxnR','q2fUBM90ihDYAxrLihrVigj1zgDLDcbKAxjLy3rVCNK6ia','tg9HzgLUzYbJB25MAwD1CMf0Aw9U','y29UC29Szq','y2XP','icaG4OcIienVBMzPz3vYyxrPB24GChjVyMXLBxm','AxntAhv0DgLUz0rVD24','y29TCgXLDgvuyxnR','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbPBML0AwfSAxPLzcbZDwnJzxnZzNvSBhK','sw5PDgLHBgL6Aw5NignVBNzLCNnHDgLVBIbVCMnOzxn0CMf0B3i','Aw5PDgLHBgL6yxrPB25tDgfYDfrPBwu','Aw5MBW','CMfJzq','Bg9N','ChvZAa','AgvHBhrOEq','mtK0odrivwHsB08','q29UzMLNDxjHDgLVBIbSB2fKAw5NigzHAwXLzdO','BwfW','z3jHEq','B3zLCMfSBa','z29Vz2XL','DgHLBG','C2f2zvnLC3nPB25tDgf0zq','C3rHy2S','cUkDJcbgywLSzwqGDg8GC3rHCNqGtg94AweGq0XjoG','u3rHCNrPBMCGtg94AweGq0XjigfWCgXPy2f0Aw9U','zxHPDa','BM93','y2f0y2G','C2LSzw50','ChjVBwLZzxm','vgHPCYbTAwDODcbPBMrPy2f0ztO','yxbPigTLEq','cVcFLi0GrM9Yig1VCMuGAgvSCdO','zMLSDgvY','vw5JyxvNAhqGzxHJzxb0Aw9UoG','mtreyLv3BNq','q2HLy2SGy29UzMLNDxjHDgLVBIbMAwXLihn5BNrHEa','r3jHy2vMDwWGC2H1DgrVD24','nMHfEuvWDq','AgvHBhrOq2HLy2TjBNrLCNzHBa','tM8GqvbjigTLEsbMB3vUzcaTihnVBwuGy29TBwfUzhmGD2LSBcbUB3qGyMuGyxzHAwXHyMXL','uhjVy2vZCYb3yxjUAw5NoG','vhj5igfNywLUigLUigeGzMv3ig1VBwvUDhm','ywnJzxnZ','BwvZC2fNzq','Bg9Ntgv2zwW','te9ysufFrevcvuC','sgvHBhrOig1VBML0B3jPBMCGy29UzMLNDxjLza','y3LHBG','u0Lhsu5u','u2H1DhrPBMCGzg93BIbKDwuGDg8G','Dg9mB3DLCKnHC2u','tg94AweGq0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEsbPBIa','yxbPs2v5','mJa2mZyYnvvjAvvqtq','EwvSBg93','l2HLywX0Aa','C2vYDMvY','ls1OzwXW','mZniA0Tmthq','C29Tzq','A2v5','C3rHCNq','u0Lhvevstq','y29UzMLN','Bg9NrgLY','zw5HyMXLza','rw1LCMDLBMn5ihnODxrKB3DUignVBxbSzxrLza','z2v0sgvHBhrOu3rHDhvZ','B3jJAgvZDhjHDg9Y','icaG4OcIienOzwnRigrVy3vTzw50yxrPB246igH0DhbZoI8Vzg9JCY5SB3HPys5HAq','Bg9Nz2vY','DxnHz2veAxi','ls12zxjZAw9U','zxjYB3i','u2vYDMvYigHLywX0AcbJAgvJAYbMywLSzwq6ieHuvfaG','CM91BMq','ndK4nZK2uuLZD2Pn','sw5JCMvHC2uGDgLTzw91DcbZzxr0Aw5NCYbPBIbJB25MAwD1CMf0Aw9U','Aw5JBhvKzxm','icaG4OcIia','D2fYBMLUzW','mti2mJG3mNbcCw5Vwq','u2LNBMfSigHHBMrSzxjZignVBMzPz3vYzwq','mJq1mtCZmgDXBKTdtG','q29UzMLNDxjHDgLVBIbMAwXLihzHBgLKyxrPB24GzMfPBgvKoG','Bg9Nz2LUzW'];a0_0x2588=function(){return _0x510bae;};return a0_0x2588();}(function(_0x9d6d06,_0x29bfd5){const _0x55cd37=a0_0x846c,_0x8198c8=_0x9d6d06();while(!![]){try{const _0x22d7a2=parseInt(_0x55cd37(0x183))/0x1+parseInt(_0x55cd37(0x1a8))/0x2*(parseInt(_0x55cd37(0x1f4))/0x3)+parseInt(_0x55cd37(0x1e7))/0x4+-parseInt(_0x55cd37(0x1d0))/0x5*(-parseInt(_0x55cd37(0x1c0))/0x6)+parseInt(_0x55cd37(0x1bd))/0x7*(-parseInt(_0x55cd37(0x1ec))/0x8)+-parseInt(_0x55cd37(0x189))/0x9+parseInt(_0x55cd37(0x1ee))/0xa*(-parseInt(_0x55cd37(0x1d5))/0xb);if(_0x22d7a2===_0x29bfd5)break;else _0x8198c8['push'](_0x8198c8['shift']());}catch(_0x48ccf8){_0x8198c8['push'](_0x8198c8['shift']());}}}(a0_0x2588,0x32ebf));import a0_0x2f394a from'dotenv';a0_0x2f394a[a0_0x46ec98(0x1da)]();import{CLI}from'./core/cli.js';import{ConversationOrchestrator}from'./core/conversationOrchestrator.js';import{LoggingService}from'./services/loggingService.js';import{loadConfig}from'./config/configLoader.js';import a0_0x24eb09 from'chalk';import{performance}from'perf_hooks';const INITIALIZATION_TIMEOUT_MS=0x7530,GRACEFUL_SHUTDOWN_TIMEOUT_MS=0x2710,SERVICE_HEALTH_CHECK_INTERVAL_MS=0x493e0;let applicationState={'isShuttingDown':![],'initializationStartTime':null,'services':{'logger':null,'config':null,'cli':null,'orchestrator':null},'healthCheckInterval':null};async function bootstrap(){const _0x48b062=a0_0x46ec98;applicationState['initializationStartTime']=performance[_0x48b062(0x1b4)]();const _0x1f7424=createInitialLogger();applicationState[_0x48b062(0x18c)][_0x48b062(0x1e1)]=_0x1f7424;try{_0x1f7424['info'](_0x48b062(0x1b2)),_0x1f7424['startTask']('Bootstrap','Initializing\x20application\x20components');const _0x204333=await initializeConfiguration(_0x1f7424);applicationState['services']['config']=_0x204333;const _0x328f8d=createEnhancedLogger(_0x204333);applicationState['services']['logger']=_0x328f8d;const _0x21416a=await initializeCLI(_0x204333,_0x328f8d);applicationState['services']['cli']=_0x21416a,await initializeOrchestratorIfNeeded(_0x21416a,_0x204333,_0x328f8d),setupSignalHandlers(_0x328f8d),setupHealthMonitoring(_0x328f8d);const _0x346bea=performance[_0x48b062(0x1b4)]()-applicationState[_0x48b062(0x1a2)];_0x328f8d[_0x48b062(0x19f)]('Bootstrap',!![],{'initializationTime':Math[_0x48b062(0x1e6)](_0x346bea),'serverMode':_0x204333['useServerLLM'],'services':Object[_0x48b062(0x1fc)](applicationState['services'])[_0x48b062(0x1bb)](_0x11b76e=>applicationState['services'][_0x11b76e]!==null)}),_0x328f8d[_0x48b062(0x1a3)](_0x48b062(0x1ce)+Math[_0x48b062(0x1e6)](_0x346bea)+'ms'),await _0x21416a[_0x48b062(0x1d8)]();}catch(_0x21554b){const _0x1465b6=performance['now']()-applicationState[_0x48b062(0x1a2)];_0x1f7424['completeTask']('Bootstrap',![],{'error':_0x21554b[_0x48b062(0x1c6)],'initializationTime':Math[_0x48b062(0x1e6)](_0x1465b6)}),console[_0x48b062(0x1e4)](a0_0x24eb09['red'](_0x48b062(0x1b1))),console[_0x48b062(0x1e4)](a0_0x24eb09[_0x48b062(0x1f2)](_0x48b062(0x180)+_0x21554b['message'])),_0x21554b['stack']&&process['env']['LOXIA_DEBUG']&&(console[_0x48b062(0x1e4)](a0_0x24eb09[_0x48b062(0x1ab)]('\x0aStack\x20trace:')),console[_0x48b062(0x1e4)](a0_0x24eb09['gray'](_0x21554b[_0x48b062(0x1b0)]))),provideTroubleshootingSuggestions(_0x21554b),await performEmergencyShutdown(_0x1f7424),process['exit'](0x1);}}function createInitialLogger(){const _0x25bd36=a0_0x46ec98;return new LoggingService({'console':![],'file':![],'logLevel':process['env'][_0x25bd36(0x1f9)]||'info','silent':process['env']['LOXIA_SILENT']===_0x25bd36(0x17b)});}async function initializeConfiguration(_0xc1a02a){const _0xa69590=a0_0x46ec98;_0xc1a02a[_0xa69590(0x1a3)](_0xa69590(0x19a));try{const _0x37f41e=await loadConfig();return await validateRuntimeConfiguration(_0x37f41e,_0xc1a02a),_0xc1a02a[_0xa69590(0x1a3)](_0xa69590(0x1fa),{'serverMode':_0x37f41e['useServerLLM'],'logLevel':_0x37f41e['logging'][_0xa69590(0x1c7)],'llmStrategy':_0x37f41e[_0xa69590(0x192)]}),_0x37f41e;}catch(_0x289514){_0xc1a02a['error'](_0xa69590(0x1a9),_0x289514);throw new Error('Configuration\x20error:\x20'+_0x289514['message']);}}async function validateRuntimeConfiguration(_0x1a2cb4,_0x9e2a1){const _0x2f15bc=a0_0x46ec98,_0x2b31f5=[];if(_0x1a2cb4[_0x2f15bc(0x182)])try{const _0x4fc0f6=await fetch(_0x1a2cb4[_0x2f15bc(0x18d)]+_0x2f15bc(0x1d2),{'method':'GET','timeout':0x1388});!_0x4fc0f6['ok']&&_0x2b31f5[_0x2f15bc(0x1a6)](_0x2f15bc(0x1e5)+_0x4fc0f6['status']);}catch(_0x3cdab7){_0x2b31f5[_0x2f15bc(0x1a6)](_0x2f15bc(0x195)+_0x1a2cb4[_0x2f15bc(0x18d)]+':\x20'+_0x3cdab7['message']);}if(!_0x1a2cb4['useServerLLM']){const _0x44cb8d=_0x1a2cb4['services']['anthropic']['apiKey']||_0x1a2cb4['services']['openai'][_0x2f15bc(0x1cf)]||_0x1a2cb4['services']['google'][_0x2f15bc(0x1cf)];!_0x44cb8d&&_0x2b31f5['push']('No\x20API\x20keys\x20configured\x20for\x20fallback\x20services');}try{const _0x336ec0=_0x1a2cb4['budget'][_0x2f15bc(0x1e2)];await import('fs')['then'](_0x1fa535=>_0x1fa535[_0x2f15bc(0x1b7)][_0x2f15bc(0x1fb)](_0x336ec0,{'recursive':!![]})),await import('fs')[_0x2f15bc(0x1ae)](_0x432103=>_0x432103['promises']['access'](_0x336ec0,_0x432103['constants']['W_OK']));}catch(_0x18d9a2){_0x2b31f5['push'](_0x2f15bc(0x199)+_0x18d9a2[_0x2f15bc(0x1c6)]);}if(_0x2b31f5[_0x2f15bc(0x185)]>0x0){const _0x1ae589=_0x2f15bc(0x196)+_0x2b31f5[_0x2f15bc(0x1aa)](_0x3ed8a8=>'\x20\x20-\x20'+_0x3ed8a8)['join']('\x0a');if(_0x1a2cb4[_0x2f15bc(0x182)]&&_0x2b31f5[_0x2f15bc(0x1d6)](_0x1ef5fe=>_0x1ef5fe['includes'](_0x2f15bc(0x1d3))))_0x9e2a1[_0x2f15bc(0x17d)]('Server\x20validation\x20failed,\x20will\x20attempt\x20fallback\x20to\x20local\x20services'),_0x1a2cb4['useServerLLM']=![],_0x1a2cb4[_0x2f15bc(0x18c)][_0x2f15bc(0x197)][_0x2f15bc(0x1dc)]=!!_0x1a2cb4[_0x2f15bc(0x18c)]['anthropic'][_0x2f15bc(0x1cf)],_0x1a2cb4[_0x2f15bc(0x18c)]['openai']['enabled']=!!_0x1a2cb4['services']['openai']['apiKey'],_0x1a2cb4['services']['google']['enabled']=!!_0x1a2cb4['services'][_0x2f15bc(0x1ad)][_0x2f15bc(0x1cf)];else throw new Error(_0x1ae589);}}function a0_0x846c(_0x13b1fa,_0x3d1f8c){const _0x25883d=a0_0x2588();return a0_0x846c=function(_0x846c03,_0x14065e){_0x846c03=_0x846c03-0x17b;let _0x2d0e02=_0x25883d[_0x846c03];if(a0_0x846c['xFfJFQ']===undefined){var _0x5f426f=function(_0x2f394a){const _0x24eb09='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1f7424='',_0x204333='';for(let _0x328f8d=0x0,_0x21416a,_0x346bea,_0x11b76e=0x0;_0x346bea=_0x2f394a['charAt'](_0x11b76e++);~_0x346bea&&(_0x21416a=_0x328f8d%0x4?_0x21416a*0x40+_0x346bea:_0x346bea,_0x328f8d++%0x4)?_0x1f7424+=String['fromCharCode'](0xff&_0x21416a>>(-0x2*_0x328f8d&0x6)):0x0){_0x346bea=_0x24eb09['indexOf'](_0x346bea);}for(let _0x21554b=0x0,_0x1465b6=_0x1f7424['length'];_0x21554b<_0x1465b6;_0x21554b++){_0x204333+='%'+('00'+_0x1f7424['charCodeAt'](_0x21554b)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x204333);};a0_0x846c['WZsEMk']=_0x5f426f,_0x13b1fa=arguments,a0_0x846c['xFfJFQ']=!![];}const _0x42cca5=_0x25883d[0x0],_0x14bebf=_0x846c03+_0x42cca5,_0x5bf8b9=_0x13b1fa[_0x14bebf];return!_0x5bf8b9?(_0x2d0e02=a0_0x846c['WZsEMk'](_0x2d0e02),_0x13b1fa[_0x14bebf]=_0x2d0e02):_0x2d0e02=_0x5bf8b9,_0x2d0e02;},a0_0x846c(_0x13b1fa,_0x3d1f8c);}function createEnhancedLogger(_0x354a83){const _0x179461=a0_0x46ec98;return new LoggingService({'console':_0x354a83[_0x179461(0x1f0)][_0x179461(0x19b)]!==![],'file':_0x354a83[_0x179461(0x1f0)]['file']!==![],'logLevel':_0x354a83['logging'][_0x179461(0x1c7)],'logDir':_0x354a83['logging'][_0x179461(0x1db)],'silent':_0x354a83[_0x179461(0x1f0)][_0x179461(0x1b6)]===!![]});}async function initializeCLI(_0x49eaf7,_0x10d3f7){const _0x32a78e=a0_0x46ec98;_0x10d3f7[_0x32a78e(0x1a3)]('Initializing\x20CLI');try{const _0x50a947=new CLI(null,_0x49eaf7,_0x10d3f7);return await validateCLIResources(_0x50a947,_0x49eaf7,_0x10d3f7),_0x10d3f7['info']('CLI\x20initialized\x20successfully'),_0x50a947;}catch(_0x5eedb5){_0x10d3f7[_0x32a78e(0x1e4)]('CLI\x20initialization\x20failed:',_0x5eedb5);throw new Error(_0x32a78e(0x17f)+_0x5eedb5['message']);}}async function validateCLIResources(_0x1bbb6e,_0x29014b,_0x87761d){const _0x2d9883=a0_0x46ec98,_0xd7f7c8=await _0x1bbb6e['getStoredApiKey']()['catch'](()=>null);!_0xd7f7c8&&_0x29014b[_0x2d9883(0x182)]&&_0x87761d[_0x2d9883(0x17d)](_0x2d9883(0x1c2));try{const {getConfigPaths:_0x5ee6d6}=await import('./config/configLoader.js'),_0x4e2917=_0x5ee6d6();await import('fs')['then'](_0x193653=>{const _0xc9af2e=_0x2d9883,_0x35ce84=[];return _0x4e2917[_0xc9af2e(0x17e)]&&_0x35ce84['push'](_0x193653['promises'][_0xc9af2e(0x1c5)](_0x4e2917['global'])[_0xc9af2e(0x1b5)](()=>'no\x20global\x20config')),_0x4e2917['local']&&_0x35ce84['push'](_0x193653['promises']['access'](_0x4e2917['local'])['catch'](()=>_0xc9af2e(0x18f))),Promise['allSettled'](_0x35ce84);});}catch(_0x6b1ee6){_0x87761d['warn'](_0x2d9883(0x1ef),_0x6b1ee6);}}async function initializeOrchestratorIfNeeded(_0x837428,_0xfe8526,_0x1e874c){const _0x494d6f=a0_0x46ec98,_0x57e163=process['argv']['slice'](0x2),_0x2e3425=_0x57e163[0x0],_0x77e3ac=[_0x494d6f(0x1d7),_0x494d6f(0x184),_0x494d6f(0x1fe),_0x494d6f(0x1d4),'-h',_0x494d6f(0x1e3),'-v'];if(_0x77e3ac[_0x494d6f(0x1e9)](_0x2e3425)||_0x57e163['includes']('--help')||_0x57e163['includes']('-h')){_0x1e874c['debug']('Skipping\x20orchestrator\x20initialization\x20for\x20utility\x20command');return;}_0x1e874c[_0x494d6f(0x1a3)](_0x494d6f(0x1a1));try{const _0x58ef05=new ConversationOrchestrator(_0xfe8526,_0x1e874c);await _0x58ef05[_0x494d6f(0x18b)](),_0x837428[_0x494d6f(0x1fd)](_0x58ef05),applicationState['services'][_0x494d6f(0x1df)]=_0x58ef05,_0x1e874c[_0x494d6f(0x1a3)](_0x494d6f(0x1a0));}catch(_0x54eb6e){_0x1e874c['error']('Orchestrator\x20initialization\x20failed:',_0x54eb6e);if(['status','budget'][_0x494d6f(0x1e9)](_0x2e3425))_0x1e874c['warn']('Continuing\x20without\x20orchestrator\x20for\x20status\x20command');else throw new Error('Orchestrator\x20initialization\x20error:\x20'+_0x54eb6e['message']);}}function setupSignalHandlers(_0x58a038){const _0x3f7e32=a0_0x46ec98;process['on']('SIGINT',async()=>{const _0x107940=a0_0x846c;applicationState['isShuttingDown']&&(_0x58a038[_0x107940(0x17d)]('Force\x20shutdown\x20-\x20received\x20second\x20SIGINT'),process[_0x107940(0x1b3)](0x1)),_0x58a038['info']('Received\x20SIGINT,\x20initiating\x20graceful\x20shutdown'),await performGracefulShutdown(_0x58a038,_0x107940(0x1cb));}),process['on'](_0x3f7e32(0x1d9),async()=>{const _0x21f060=_0x3f7e32;applicationState['isShuttingDown']&&(_0x58a038['warn'](_0x21f060(0x1f6)),process['exit'](0x1)),_0x58a038[_0x21f060(0x1a3)]('Received\x20SIGTERM,\x20initiating\x20graceful\x20shutdown'),await performGracefulShutdown(_0x58a038,'SIGTERM');}),process['on']('uncaughtException',async _0x246744=>{const _0x17b1d2=_0x3f7e32;_0x58a038[_0x17b1d2(0x1e4)](_0x17b1d2(0x1bc),_0x246744),_0x246744['stack']&&_0x58a038['error']('Stack\x20trace:',_0x246744[_0x17b1d2(0x1b0)]),await performEmergencyShutdown(_0x58a038),process['exit'](0x1);}),process['on']('unhandledRejection',async(_0x3396a6,_0x57bdc4)=>{const _0x2b1bca=_0x3f7e32;_0x58a038['error'](_0x2b1bca(0x190),{'reason':_0x3396a6?.['message']||_0x3396a6,'promise':_0x57bdc4?.['toString']()}),_0x3396a6?.['stack']&&_0x58a038['error']('Rejection\x20stack\x20trace:',_0x3396a6['stack']),await performEmergencyShutdown(_0x58a038),process[_0x2b1bca(0x1b3)](0x1);}),process['on'](_0x3f7e32(0x1eb),_0x29e19a=>{const _0x546ff5=_0x3f7e32;_0x58a038['warn']('Node.js\x20warning:',{'name':_0x29e19a['name'],'message':_0x29e19a[_0x546ff5(0x1c6)],'stack':_0x29e19a['stack']});}),_0x58a038[_0x3f7e32(0x1f5)](_0x3f7e32(0x1ed));}function setupHealthMonitoring(_0x1c26bf){const _0x533133=a0_0x46ec98,_0x5dfa23=process['argv']['slice'](0x2),_0x28fed5=['do','make','resume','modify'];if(!_0x28fed5[_0x533133(0x1d6)](_0x4e3252=>_0x5dfa23['includes'](_0x4e3252)))return;applicationState[_0x533133(0x1c1)]=setInterval(async()=>{const _0x3307dc=_0x533133;try{await performHealthCheck(_0x1c26bf);}catch(_0x14c838){_0x1c26bf['warn'](_0x3307dc(0x187),_0x14c838);}},SERVICE_HEALTH_CHECK_INTERVAL_MS),_0x1c26bf[_0x533133(0x1f5)](_0x533133(0x1c9));}async function performHealthCheck(_0x237fb8){const _0x12f74c=a0_0x46ec98,_0x35efaf={'timestamp':new Date()[_0x12f74c(0x181)](),'services':{},'overall':'healthy'};if(applicationState['services']['cli'])try{_0x35efaf['services'][_0x12f74c(0x19c)]='healthy';}catch(_0x2f1b54){_0x35efaf['services']['cli']=_0x12f74c(0x18a),_0x35efaf[_0x12f74c(0x1ac)]=_0x12f74c(0x1f7);}if(applicationState['services']['orchestrator'])try{const _0x34e491=await applicationState['services'][_0x12f74c(0x1df)][_0x12f74c(0x1de)]?.()||'unknown';_0x35efaf['services'][_0x12f74c(0x1df)]=_0x34e491[_0x12f74c(0x1ac)]||'healthy',(_0x34e491[_0x12f74c(0x1ac)]===_0x12f74c(0x1f7)||_0x34e491['overall']==='unhealthy')&&(_0x35efaf['overall']=_0x12f74c(0x1f7));}catch(_0x5e512f){_0x35efaf[_0x12f74c(0x18c)][_0x12f74c(0x1df)]='unhealthy',_0x35efaf['overall']=_0x12f74c(0x1f7);}_0x35efaf[_0x12f74c(0x1ac)]!==_0x12f74c(0x1a7)?_0x237fb8[_0x12f74c(0x17d)]('Service\x20health\x20check\x20detected\x20issues:',_0x35efaf):_0x237fb8[_0x12f74c(0x1f5)]('Health\x20check\x20passed:',_0x35efaf);}async function performGracefulShutdown(_0x4e27ec,_0x2f4d1e){const _0x42d0b7=a0_0x46ec98;if(applicationState['isShuttingDown'])return;applicationState[_0x42d0b7(0x19e)]=!![],_0x4e27ec[_0x42d0b7(0x198)]('Graceful\x20shutdown',_0x42d0b7(0x1cc)+_0x2f4d1e);try{applicationState[_0x42d0b7(0x1c1)]&&(clearInterval(applicationState[_0x42d0b7(0x1c1)]),applicationState[_0x42d0b7(0x1c1)]=null);const _0x4e5859=[];applicationState[_0x42d0b7(0x18c)]['orchestrator']?.[_0x42d0b7(0x1f1)]&&_0x4e5859[_0x42d0b7(0x1a6)](Promise['race']([applicationState['services']['orchestrator'][_0x42d0b7(0x1f1)](),new Promise((_0x127510,_0x2f19d1)=>setTimeout(()=>_0x2f19d1(new Error('Orchestrator\x20shutdown\x20timeout')),0x1388))])['catch'](_0x45006d=>{const _0x12b5b4=_0x42d0b7;_0x4e27ec[_0x12b5b4(0x17d)]('Orchestrator\x20shutdown\x20error:',_0x45006d);})),applicationState[_0x42d0b7(0x18c)][_0x42d0b7(0x19c)]?.[_0x42d0b7(0x1f1)]&&_0x4e5859['push'](Promise[_0x42d0b7(0x1a4)]([applicationState['services'][_0x42d0b7(0x19c)][_0x42d0b7(0x1f1)](),new Promise((_0x475479,_0x48f65b)=>setTimeout(()=>_0x48f65b(new Error('CLI\x20shutdown\x20timeout')),0xbb8))])[_0x42d0b7(0x1b5)](_0x3efbf3=>{const _0xc14954=_0x42d0b7;_0x4e27ec['warn'](_0xc14954(0x17c),_0x3efbf3);})),await Promise[_0x42d0b7(0x1a4)]([Promise[_0x42d0b7(0x188)](_0x4e5859),new Promise(_0x234caf=>setTimeout(_0x234caf,GRACEFUL_SHUTDOWN_TIMEOUT_MS))]),_0x4e27ec[_0x42d0b7(0x19f)](_0x42d0b7(0x1bf),!![]),_0x4e27ec[_0x42d0b7(0x1a3)](_0x42d0b7(0x186));}catch(_0x3493ea){_0x4e27ec[_0x42d0b7(0x19f)](_0x42d0b7(0x1bf),![],{'error':_0x3493ea[_0x42d0b7(0x1c6)]}),_0x4e27ec['error'](_0x42d0b7(0x194),_0x3493ea);}finally{setTimeout(()=>{process['exit'](0x0);},0x1f4);}}async function performEmergencyShutdown(_0x466809){const _0xb49e4a=a0_0x46ec98;if(applicationState[_0xb49e4a(0x19e)])return;applicationState['isShuttingDown']=!![],_0x466809['error'](_0xb49e4a(0x1f8));try{applicationState[_0xb49e4a(0x1c1)]&&clearInterval(applicationState[_0xb49e4a(0x1c1)]),applicationState['services'][_0xb49e4a(0x1df)]?.[_0xb49e4a(0x1af)]&&await Promise[_0xb49e4a(0x1a4)]([applicationState['services'][_0xb49e4a(0x1df)][_0xb49e4a(0x1af)](),new Promise(_0x2f8256=>setTimeout(_0x2f8256,0x7d0))])['catch'](()=>{}),_0x466809['error'](_0xb49e4a(0x1dd));}catch(_0x42afc3){console[_0xb49e4a(0x1e4)]('Emergency\x20shutdown\x20failed:',_0x42afc3[_0xb49e4a(0x1c6)]);}}function provideTroubleshootingSuggestions(_0x125738){const _0x2daaf3=a0_0x46ec98,_0x342515=[],_0xbd17a9=_0x125738[_0x2daaf3(0x1c6)][_0x2daaf3(0x1cd)]();_0xbd17a9[_0x2daaf3(0x1e9)](_0x2daaf3(0x1b9))&&(_0x342515['push']('Set\x20your\x20API\x20key\x20with:\x20loxia\x20key\x20--set\x20<your-api-key>'),_0x342515['push']('Get your API key from: https://autopilot.loxia.ai/account/api-keys')),(_0xbd17a9['includes'](_0x2daaf3(0x1d3))||_0xbd17a9['includes']('connection'))&&(_0x342515[_0x2daaf3(0x1a6)]('Check\x20your\x20internet\x20connection'),_0x342515['push']('Verify\x20the\x20server\x20URL\x20in\x20your\x20configuration'),_0x342515['push']('Try\x20using\x20fallback\x20mode:\x20LOXIA_USE_SERVER_LLM=false')),(_0xbd17a9[_0x2daaf3(0x1e9)]('permission')||_0xbd17a9[_0x2daaf3(0x1e9)]('access'))&&(_0x342515['push']('Check\x20file\x20system\x20permissions'),_0x342515[_0x2daaf3(0x1a6)]('Ensure\x20you\x20have\x20write\x20access\x20to\x20the\x20current\x20directory'),_0x342515['push']('Try running from a different directory')),_0xbd17a9['includes']('timeout')&&(_0x342515['push'](_0x2daaf3(0x1e8)),_0x342515['push']('Check\x20network\x20connectivity'),_0x342515['push'](_0x2daaf3(0x1c4))),_0xbd17a9[_0x2daaf3(0x1e9)](_0x2daaf3(0x1da))&&(_0x342515['push'](_0x2daaf3(0x1be)),_0x342515[_0x2daaf3(0x1a6)]('Create default config: loxia config --create'),_0x342515[_0x2daaf3(0x1a6)](_0x2daaf3(0x18e))),_0x342515['length']>0x0&&(console[_0x2daaf3(0x1a5)](a0_0x24eb09['yellow']('\x0aðŸ’¡\x20Troubleshooting\x20suggestions:')),_0x342515['forEach'](_0x3729c7=>{const _0x17b4fd=_0x2daaf3;console['log'](a0_0x24eb09[_0x17b4fd(0x1ca)](_0x17b4fd(0x1ea)+_0x3729c7));})),console['log'](a0_0x24eb09[_0x2daaf3(0x1ab)](_0x2daaf3(0x1ba))),console['log'](a0_0x24eb09['gray']('\x20\x20\x20â€¢\x20Run:\x20loxia\x20--help')),console['log'](a0_0x24eb09['gray'](_0x2daaf3(0x1e0))),console[_0x2daaf3(0x1a5)](a0_0x24eb09['gray']('\x20\x20\x20â€¢\x20Report\x20issues:\x20https://github.com/loxia-ai/cli/issues'));}async function handleBootstrapTimeout(_0x4611c0){const _0x152c86=a0_0x46ec98;_0x4611c0['error']('Bootstrap\x20process\x20timed\x20out'),console['error'](a0_0x24eb09['red']('\x0aâ°\x20Initialization\x20timed\x20out')),console['error'](a0_0x24eb09['yellow'](_0x152c86(0x1b8))),console[_0x152c86(0x1e4)](a0_0x24eb09['yellow'](_0x152c86(0x191))),console[_0x152c86(0x1e4)](a0_0x24eb09['yellow'](_0x152c86(0x1f3))),console['error'](a0_0x24eb09[_0x152c86(0x1d1)](_0x152c86(0x19d))),await performEmergencyShutdown(_0x4611c0),process[_0x152c86(0x1b3)](0x1);}async function main(){const _0x56dcc4=a0_0x46ec98,_0x487fad=Date[_0x56dcc4(0x1b4)]();try{await Promise['race']([bootstrap(),new Promise((_0x20e46b,_0x3f1d1a)=>setTimeout(()=>_0x3f1d1a(new Error('Bootstrap\x20timeout')),INITIALIZATION_TIMEOUT_MS))]);}catch(_0x538deb){const _0x4c933c=Date[_0x56dcc4(0x1b4)]()-_0x487fad;if(_0x538deb['message']==='Bootstrap\x20timeout')await handleBootstrapTimeout(applicationState[_0x56dcc4(0x18c)]['logger']||createInitialLogger());else throw _0x538deb;}}main()[a0_0x46ec98(0x1b5)](_0x46dcb4=>{const _0x4ff7af=a0_0x46ec98,_0x46eb90=applicationState[_0x4ff7af(0x18c)]['logger']||createInitialLogger();_0x46eb90['error']('Fatal\x20error\x20during\x20startup:',_0x46dcb4),console[_0x4ff7af(0x1e4)](a0_0x24eb09['red'](_0x4ff7af(0x193))),console['error'](a0_0x24eb09['red']('\x20\x20\x20'+_0x46dcb4[_0x4ff7af(0x1c6)])),process[_0x4ff7af(0x1ff)][_0x4ff7af(0x1c8)]&&_0x46dcb4[_0x4ff7af(0x1b0)]&&(console['error'](a0_0x24eb09[_0x4ff7af(0x1ab)]('\x0aStack\x20trace:')),console['error'](a0_0x24eb09['gray'](_0x46dcb4[_0x4ff7af(0x1b0)]))),process[_0x4ff7af(0x1b3)](0x1);}),process['on'](a0_0x46ec98(0x1eb),_0x1be8f9=>{const _0xdd13c3=a0_0x46ec98;applicationState[_0xdd13c3(0x18c)][_0xdd13c3(0x1e1)]&&applicationState['services']['logger'][_0xdd13c3(0x17d)](_0xdd13c3(0x1c3),_0x1be8f9);});export{bootstrap,performGracefulShutdown,performHealthCheck};