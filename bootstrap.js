#!/usr/bin/env node

const a0_0xc444=a0_0x7ed7;(function(_0x1726b3,_0x3f71ab){const _0xace044=a0_0x7ed7,_0x4f5549=_0x1726b3();while(!![]){try{const _0x4a353a=-parseInt(_0xace044(0x1be))/0x1*(parseInt(_0xace044(0x1e0))/0x2)+-parseInt(_0xace044(0x1fc))/0x3+-parseInt(_0xace044(0x1bb))/0x4+-parseInt(_0xace044(0x207))/0x5*(-parseInt(_0xace044(0x19c))/0x6)+-parseInt(_0xace044(0x1cb))/0x7+parseInt(_0xace044(0x1e4))/0x8+-parseInt(_0xace044(0x1a4))/0x9*(-parseInt(_0xace044(0x19e))/0xa);if(_0x4a353a===_0x3f71ab)break;else _0x4f5549['push'](_0x4f5549['shift']());}catch(_0x7ac678){_0x4f5549['push'](_0x4f5549['shift']());}}}(a0_0x5b1b,0x33ee2));import a0_0x59f470 from'dotenv';a0_0x59f470[a0_0xc444(0x1af)]();import{CLI}from'./core/cli.js';import{ConversationOrchestrator}from'./core/conversationOrchestrator.js';import{LoggingService}from'./services/loggingService.js';import{loadConfig}from'./config/configLoader.js';function a0_0x7ed7(_0x5d4ce4,_0x5923ce){const _0x5b1b69=a0_0x5b1b();return a0_0x7ed7=function(_0x7ed708,_0x36c1e8){_0x7ed708=_0x7ed708-0x19b;let _0x27f66a=_0x5b1b69[_0x7ed708];if(a0_0x7ed7['xTNWqG']===undefined){var _0x40f2e8=function(_0x59f470){const _0xef779c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x50ccf0='',_0x318b38='';for(let _0x45022b=0x0,_0x50ed08,_0x3c9419,_0x12f118=0x0;_0x3c9419=_0x59f470['charAt'](_0x12f118++);~_0x3c9419&&(_0x50ed08=_0x45022b%0x4?_0x50ed08*0x40+_0x3c9419:_0x3c9419,_0x45022b++%0x4)?_0x50ccf0+=String['fromCharCode'](0xff&_0x50ed08>>(-0x2*_0x45022b&0x6)):0x0){_0x3c9419=_0xef779c['indexOf'](_0x3c9419);}for(let _0x3ea5d7=0x0,_0x1fb9d4=_0x50ccf0['length'];_0x3ea5d7<_0x1fb9d4;_0x3ea5d7++){_0x318b38+='%'+('00'+_0x50ccf0['charCodeAt'](_0x3ea5d7)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x318b38);};a0_0x7ed7['wDqsDJ']=_0x40f2e8,_0x5d4ce4=arguments,a0_0x7ed7['xTNWqG']=!![];}const _0x15aecc=_0x5b1b69[0x0],_0xbcec16=_0x7ed708+_0x15aecc,_0x1bc53e=_0x5d4ce4[_0xbcec16];return!_0x1bc53e?(_0x27f66a=a0_0x7ed7['wDqsDJ'](_0x27f66a),_0x5d4ce4[_0xbcec16]=_0x27f66a):_0x27f66a=_0x1bc53e,_0x27f66a;},a0_0x7ed7(_0x5d4ce4,_0x5923ce);}import a0_0xef779c from'chalk';import{performance}from'perf_hooks';const INITIALIZATION_TIMEOUT_MS=0x7530,GRACEFUL_SHUTDOWN_TIMEOUT_MS=0x2710,SERVICE_HEALTH_CHECK_INTERVAL_MS=0x493e0;function a0_0x5b1b(){const _0x5953f2=['zw5HyMXLza','z29Vz2XL','Dg9mB3DLCKnHC2u','u3rHy2SGDhjHy2u6','C2vYDMLJzxm','zxHPDa','u0Lhsu5u','CMvK','AxntAhv0DgLUz0rVD24','t3jJAgvZDhjHDg9YihnODxrKB3DUihrPBwvVDxq','DgLTzw91Da','vMvYAwz5ihrOzsbZzxj2zxiGvvjmigLUihLVDxiGy29UzMLNDxjHDgLVBG','vhj5ihvZAw5NigzHBgXIywnRig1Vzgu6ieXpweLbx1vtrv9trvjwrvjFteXnpwzHBhnL','zMLSzq','D2fYBMLUzW','D2fYBG','ng5VuM53rG','icaG','qM9VDhn0CMfW','ywXSu2v0DgXLza','mtmZmJK2mef5sg1Zzq','y29UBMvJDgLVBG','q0XjigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','r0vu','Bg9Nz2LUzW','cUkpScbjBML0AwfSAxPHDgLVBIb0Aw1LzcbVDxq','lI9JB25MAwCVy29UzMLNtg9HzgvYlMPZ','qM9VDhn0CMfWihrPBwvVDxq','yxbPigTLEq','CM91BMq','sgvHBhrOig1VBML0B3jPBMCGy29UzMLNDxjLza','Bg9N','Aw5PDgLHBgL6yxrPB25tDgfYDfrPBwu','BMfTzq','BM93','q29UzMLNDxjHDgLVBIbSB2fKzwqGyw5KihzHBgLKyxrLzcbZDwnJzxnZzNvSBhK','q29UzMLNDxjHDgLVBIbMAwXLihzHBgLKyxrPB24GzMfPBgvKoG','uMvJzwL2zwqGu0LhvevstsWGAw5PDgLHDgLUzYbNCMfJzwz1BcbZAhv0zg93BG','C2f2zvnLC3nPB25tDgf0zq','CMfJzq','cVcFKQeGvhjVDwjSzxnOB290Aw5Nihn1z2DLC3rPB25ZoG','DxnLu2vYDMvYteXn','C3rHCNq','r3jHy2vMDwWGC2H1DgrVD24','mJi4odG1u2TbzgLz','cVcFKQuGrMf0ywWGC3rHCNr1CcbLCNjVCJO','A2v5','sgvHBhrOignOzwnRihbHC3nLzdO','vw5JyxvNAhqGzxHJzxb0Aw9UoG','C2H1DgrVD24','uNvUDgLTzsb2ywXPzgf0Aw9UigzHAwXLzdOk','BwfRzq','v19psW','EwvSBg93','AgvHBhrOEq','ntvbrgvvCwW','yNvKz2v0','Aw5JBhvKzxm','u2vYDMvYihzHBgLKyxrPB24GzMfPBgvKlcb3AwXSigf0DgvTChqGzMfSBgjHy2SGDg8GBg9JywWGC2vYDMLJzxm','icaG4OcIifnLCNzLCIbPCYbKB3DUig9Yig92zxjSB2fKzwq','te9ysufFrevcvuC','Aw5MBW','Bg9Nz2vY','AM9PBG','BwvZC2fNzq','vgHPCYbTAwDODcbPBMrPy2f0ztO','C2vYDMvY','sgvHBhrOignOzwnRigzHAwXLzdO','tM9Kzs5QCYb3yxjUAw5NoG','te9ysufFu0Lmru5u','C2XPy2u','q29UDgLUDwLUzYb3AxrOB3v0ig9Yy2HLC3rYyxrVCIbMB3iGC3rHDhvZignVBw1HBMq','rw5ZDxjLihLVDsbOyxzLihDYAxrLigfJy2vZCYb0BYb0AguGy3vYCMvUDcbKAxjLy3rVCNK','AgvHBhrOq2HLy2TjBNrLCNzHBa','mJa2mJC0BuDtBw9U','q0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEq','mJaXmdKWzuDWB0Py','zw52','C29Tzq','icaTia','yxbPs2v5','r3jHy2vMDwWGC2H1DgrVD24Gy29TCgXLDgvKihn1y2nLC3nMDwXSEq','mJe2u0rdBfPI','C3rHCNruyxnR','Dw5RBM93BG','y2f0y2G','sw5PDgLHBgL6Aw5NigfWCgXPy2f0Aw9UignVBxbVBMvUDhm','zgvIDwC','y2XP','Bg9Ntgv2zwW','BM8Gz2XVyMfSignVBMzPzW','Dw5OzwfSDgH5','Dg9tDhjPBMC','y29UzMLN','BwfW','ChvZAa','z3jHEq','DgHLBG','y29TCgXLDgvuyxnR','rw1LCMDLBMn5ihnODxrKB3DUigzHAwXLzdO','BwTKAxi','tg94AweGq0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEsbPBIa','icaG4OcIienVBMzPz3vYyxrPB24GChjVyMXLBxm','C3rHy2S','zgvNCMfKzwq','nJe5otqWvhDJEfjr','DxnHz2veAxi','B3jJAgvZDhjHDg9Y','mJaWmJq2v2TOu21u','ChjVBwLZzxm','B3zLCMfSBa','z2v0sgvHBhrOu3rHDhvZ','BgXTu3rYyxrLz3K','zxjYB3i','q2fUBM90ihjLywnOihnLCNzLCIbHDca','u3rHCNrPBMCGtg94AweGq0XjigfWCgXPy2f0Aw9U','icaG4OcIia','q29UzMLNDxjHDgLVBIbSB2fKAw5NigzHAwXLzdO','y3LHBG','C3rHDhvZ','q2HLy2SGEw91CIbPBNrLCM5LDcbJB25Uzwn0Aw9U','mti4mdq4ovvPtfzbCG','B3bLBMfP','icaG4OcIifjLCg9YDcbPC3n1zxm6igH0DhbZoI8Vz2L0AhvIlMnVBs9SB3HPys1HAs9JBgKVAxnZDwvZ','rMf0ywWGzxjYB3iGzhvYAw5Nihn0yxj0Dxa6','q2HLy2SGBMv0D29YAYbJB25Uzwn0AxzPDhK'];a0_0x5b1b=function(){return _0x5953f2;};return a0_0x5b1b();}let applicationState={'isShuttingDown':![],'initializationStartTime':null,'services':{'logger':null,'config':null,'cli':null,'orchestrator':null},'healthCheckInterval':null};async function bootstrap(){const _0x51e5e9=a0_0xc444;applicationState['initializationStartTime']=performance['now']();const _0x50ccf0=createInitialLogger();applicationState['services'][_0x51e5e9(0x20e)]=_0x50ccf0;try{_0x50ccf0[_0x51e5e9(0x20d)](_0x51e5e9(0x1c5)),_0x50ccf0['startTask']('Bootstrap',_0x51e5e9(0x1a8));const _0x318b38=await initializeConfiguration(_0x50ccf0);applicationState['services'][_0x51e5e9(0x1af)]=_0x318b38;const _0x45022b=createEnhancedLogger(_0x318b38);applicationState[_0x51e5e9(0x1d4)]['logger']=_0x45022b;const _0x50ed08=await initializeCLI(_0x318b38,_0x45022b);applicationState[_0x51e5e9(0x1d4)][_0x51e5e9(0x1aa)]=_0x50ed08,await initializeOrchestratorIfNeeded(_0x50ed08,_0x318b38,_0x45022b),setupSignalHandlers(_0x45022b),setupHealthMonitoring(_0x45022b);const _0x3c9419=performance['now']()-applicationState['initializationStartTime'];_0x45022b['completeTask'](_0x51e5e9(0x1e2),!![],{'initializationTime':Math['round'](_0x3c9419),'serverMode':_0x318b38[_0x51e5e9(0x1f9)],'services':Object['keys'](applicationState[_0x51e5e9(0x1d4)])['filter'](_0x12f118=>applicationState['services'][_0x12f118]!==null)}),_0x45022b['info'](_0x51e5e9(0x1b7)+Math['round'](_0x3c9419)+'ms'),await _0x50ed08[_0x51e5e9(0x1fa)]();}catch(_0x3ea5d7){const _0x1fb9d4=performance[_0x51e5e9(0x1f2)]()-applicationState[_0x51e5e9(0x1f0)];_0x50ccf0['completeTask']('Bootstrap',![],{'error':_0x3ea5d7[_0x51e5e9(0x210)],'initializationTime':Math[_0x51e5e9(0x1ed)](_0x1fb9d4)}),console[_0x51e5e9(0x1c3)](a0_0xef779c[_0x51e5e9(0x1d7)]('\x0a❌\x20Failed\x20to\x20start\x20Loxia\x20CLI:')),console[_0x51e5e9(0x1c3)](a0_0xef779c['red'](_0x51e5e9(0x1e1)+_0x3ea5d7['message'])),_0x3ea5d7[_0x51e5e9(0x1b9)]&&process['env']['LOXIA_DEBUG']&&(console[_0x51e5e9(0x1c3)](a0_0xef779c[_0x51e5e9(0x1b2)]('\x0aStack\x20trace:')),console['error'](a0_0xef779c[_0x51e5e9(0x1b2)](_0x3ea5d7['stack']))),provideTroubleshootingSuggestions(_0x3ea5d7),await performEmergencyShutdown(_0x50ccf0),process[_0x51e5e9(0x1d5)](0x1);}}function createInitialLogger(){const _0x51a595=a0_0xc444;return new LoggingService({'console':![],'file':![],'logLevel':process['env']['LOXIA_LOG_LEVEL']||'info','silent':process[_0x51a595(0x19f)][_0x51a595(0x215)]==='true'});}async function initializeConfiguration(_0x30e381){const _0x3de313=a0_0xc444;_0x30e381['info']('Loading\x20configuration');try{const _0x1f00ce=await loadConfig();return await validateRuntimeConfiguration(_0x1f00ce,_0x30e381),_0x30e381[_0x3de313(0x20d)](_0x3de313(0x1f3),{'serverMode':_0x1f00ce[_0x3de313(0x1f9)],'logLevel':_0x1f00ce['logging'][_0x3de313(0x1ab)],'llmStrategy':_0x1f00ce[_0x3de313(0x1c2)]}),_0x1f00ce;}catch(_0x590e5a){_0x30e381[_0x3de313(0x1c3)](_0x3de313(0x1c7),_0x590e5a);throw new Error('Configuration\x20error:\x20'+_0x590e5a['message']);}}async function validateRuntimeConfiguration(_0x3ff215,_0x44e1c3){const _0x21e3f0=a0_0xc444,_0x49a2f5=[];if(_0x3ff215[_0x21e3f0(0x1f9)])try{const _0x3ad97b=await fetch(_0x3ff215['serverUrl']+'/health',{'method':_0x21e3f0(0x1e7),'timeout':0x1388});!_0x3ad97b['ok']&&_0x49a2f5['push']('Server\x20health\x20check\x20failed:\x20HTTP\x20'+_0x3ad97b[_0x21e3f0(0x1c9)]);}catch(_0x3f5f95){_0x49a2f5[_0x21e3f0(0x1b1)](_0x21e3f0(0x1c4)+_0x3ff215['serverUrl']+':\x20'+_0x3f5f95[_0x21e3f0(0x210)]);}if(!_0x3ff215[_0x21e3f0(0x1f9)]){const _0x49aa73=_0x3ff215[_0x21e3f0(0x1d4)]['anthropic']['apiKey']||_0x3ff215['services']['openai']['apiKey']||_0x3ff215[_0x21e3f0(0x1d4)]['google']['apiKey'];!_0x49aa73&&_0x49a2f5[_0x21e3f0(0x1b1)]('No\x20API\x20keys\x20configured\x20for\x20fallback\x20services');}try{const _0x4d0308=_0x3ff215[_0x21e3f0(0x208)][_0x21e3f0(0x1bc)];await import('fs')[_0x21e3f0(0x1b3)](_0x26c7d2=>_0x26c7d2[_0x21e3f0(0x1bf)][_0x21e3f0(0x1b6)](_0x4d0308,{'recursive':!![]})),await import('fs')[_0x21e3f0(0x1b3)](_0x386753=>_0x386753[_0x21e3f0(0x1bf)]['access'](_0x4d0308,_0x386753['constants'][_0x21e3f0(0x204)]));}catch(_0x47f03f){_0x49a2f5[_0x21e3f0(0x1b1)]('Cannot\x20write\x20to\x20budget\x20directory:\x20'+_0x47f03f[_0x21e3f0(0x210)]);}if(_0x49a2f5['length']>0x0){const _0x3c4bb5=_0x21e3f0(0x202)+_0x49a2f5[_0x21e3f0(0x1b0)](_0xfa059e=>_0x21e3f0(0x1a1)+_0xfa059e)[_0x21e3f0(0x20f)]('\x0a');if(_0x3ff215['useServerLLM']&&_0x49a2f5['some'](_0x3214ea=>_0x3214ea['includes']('server')))_0x44e1c3['warn'](_0x21e3f0(0x20a)),_0x3ff215['useServerLLM']=![],_0x3ff215['services']['anthropic'][_0x21e3f0(0x1d0)]=!!_0x3ff215[_0x21e3f0(0x1d4)]['anthropic']['apiKey'],_0x3ff215[_0x21e3f0(0x1d4)]['openai']['enabled']=!!_0x3ff215['services'][_0x21e3f0(0x1cc)][_0x21e3f0(0x1a2)],_0x3ff215[_0x21e3f0(0x1d4)]['google'][_0x21e3f0(0x1d0)]=!!_0x3ff215[_0x21e3f0(0x1d4)][_0x21e3f0(0x1d1)][_0x21e3f0(0x1a2)];else throw new Error(_0x3c4bb5);}}function createEnhancedLogger(_0xdc4986){const _0x3a651e=a0_0xc444;return new LoggingService({'console':_0xdc4986['logging']['console']!==![],'file':_0xdc4986['logging'][_0x3a651e(0x1dd)]!==![],'logLevel':_0xdc4986[_0x3a651e(0x1e8)]['logLevel'],'logDir':_0xdc4986['logging']['logDir'],'silent':_0xdc4986[_0x3a651e(0x1e8)]['silent']===!![]});}async function initializeCLI(_0x5b59f3,_0x3ab172){const _0x2512a8=a0_0xc444;_0x3ab172['info']('Initializing\x20CLI');try{const _0x540a83=new CLI(null,_0x5b59f3,_0x3ab172);return await validateCLIResources(_0x540a83,_0x5b59f3,_0x3ab172),_0x3ab172[_0x2512a8(0x20d)](_0x2512a8(0x19d)),_0x540a83;}catch(_0x3ed891){_0x3ab172['error']('CLI\x20initialization\x20failed:',_0x3ed891);throw new Error(_0x2512a8(0x1e6)+_0x3ed891['message']);}}async function validateCLIResources(_0x1073fa,_0x4902d0,_0x41f297){const _0x529991=a0_0xc444,_0x5a87d0=await _0x1073fa['getStoredApiKey']()[_0x529991(0x1a7)](()=>null);!_0x5a87d0&&_0x4902d0[_0x529991(0x1f9)]&&_0x41f297[_0x529991(0x1df)]('No\x20API\x20key\x20found\x20-\x20some\x20commands\x20will\x20not\x20be\x20available');try{const {getConfigPaths:_0x52fec2}=await import(_0x529991(0x1ea)),_0x3c4866=_0x52fec2();await import('fs')['then'](_0x5cc7c5=>{const _0x14bf4b=_0x529991,_0xb66d5c=[];return _0x3c4866['global']&&_0xb66d5c[_0x14bf4b(0x1b1)](_0x5cc7c5[_0x14bf4b(0x1bf)]['access'](_0x3c4866['global'])['catch'](()=>_0x14bf4b(0x1ac))),_0x3c4866['local']&&_0xb66d5c['push'](_0x5cc7c5[_0x14bf4b(0x1bf)]['access'](_0x3c4866['local'])['catch'](()=>'no\x20local\x20config')),Promise[_0x14bf4b(0x1e3)](_0xb66d5c);});}catch(_0x433b2b){_0x41f297['warn'](_0x529991(0x1f4),_0x433b2b);}}async function initializeOrchestratorIfNeeded(_0x24c07f,_0x5dd3bb,_0x2762b9){const _0x502e0a=a0_0xc444,_0x18f882=process['argv'][_0x502e0a(0x216)](0x2),_0x5d8d6d=_0x18f882[0x0],_0x13c3a4=[_0x502e0a(0x1fe),_0x502e0a(0x1c9),_0x502e0a(0x208),'--help','-h','--version','-v'];if(_0x13c3a4['includes'](_0x5d8d6d)||_0x18f882[_0x502e0a(0x209)]('--help')||_0x18f882['includes']('-h')){_0x2762b9[_0x502e0a(0x1a9)]('Skipping\x20orchestrator\x20initialization\x20for\x20utility\x20command');return;}_0x2762b9['info']('Initializing\x20conversation\x20orchestrator');try{const _0x347fd5=new ConversationOrchestrator(_0x5dd3bb,_0x2762b9);await _0x347fd5['initializeServices'](),_0x24c07f['setOrchestrator'](_0x347fd5),applicationState['services']['orchestrator']=_0x347fd5,_0x2762b9[_0x502e0a(0x20d)]('Conversation\x20orchestrator\x20initialized\x20successfully');}catch(_0x2f256){_0x2762b9[_0x502e0a(0x1c3)]('Orchestrator\x20initialization\x20failed:',_0x2f256);if([_0x502e0a(0x1c9),'budget']['includes'](_0x5d8d6d))_0x2762b9['warn'](_0x502e0a(0x217));else throw new Error('Orchestrator\x20initialization\x20error:\x20'+_0x2f256[_0x502e0a(0x210)]);}}function setupSignalHandlers(_0x3ea6c8){const _0x3a4f32=a0_0xc444;process['on']('SIGINT',async()=>{const _0x48f5e2=a0_0x7ed7;applicationState['isShuttingDown']&&(_0x3ea6c8[_0x48f5e2(0x1df)]('Force\x20shutdown\x20-\x20received\x20second\x20SIGINT'),process['exit'](0x1)),_0x3ea6c8[_0x48f5e2(0x20d)]('Received\x20SIGINT,\x20initiating\x20graceful\x20shutdown'),await performGracefulShutdown(_0x3ea6c8,_0x48f5e2(0x1d6));}),process['on']('SIGTERM',async()=>{const _0x48d3bd=a0_0x7ed7;applicationState[_0x48d3bd(0x1d8)]&&(_0x3ea6c8[_0x48d3bd(0x1df)]('Force\x20shutdown\x20-\x20received\x20second\x20SIGTERM'),process['exit'](0x1)),_0x3ea6c8[_0x48d3bd(0x20d)](_0x48d3bd(0x1f5)),await performGracefulShutdown(_0x3ea6c8,'SIGTERM');}),process['on']('uncaughtException',async _0x59a060=>{const _0x2c9c2c=a0_0x7ed7;_0x3ea6c8[_0x2c9c2c(0x1c3)](_0x2c9c2c(0x200),_0x59a060),_0x59a060[_0x2c9c2c(0x1b9)]&&_0x3ea6c8['error'](_0x2c9c2c(0x1d3),_0x59a060[_0x2c9c2c(0x1b9)]),await performEmergencyShutdown(_0x3ea6c8),process['exit'](0x1);}),process['on']('unhandledRejection',async(_0x413e4d,_0x14e06f)=>{const _0x5da78e=a0_0x7ed7;_0x3ea6c8['error']('Unhandled\x20promise\x20rejection:',{'reason':_0x413e4d?.['message']||_0x413e4d,'promise':_0x14e06f?.[_0x5da78e(0x1ae)]()}),_0x413e4d?.[_0x5da78e(0x1b9)]&&_0x3ea6c8[_0x5da78e(0x1c3)]('Rejection\x20stack\x20trace:',_0x413e4d[_0x5da78e(0x1b9)]),await performEmergencyShutdown(_0x3ea6c8),process['exit'](0x1);}),process['on'](_0x3a4f32(0x1de),_0x4d73c3=>{const _0x15a784=_0x3a4f32;_0x3ea6c8[_0x15a784(0x1df)](_0x15a784(0x214),{'name':_0x4d73c3[_0x15a784(0x1f1)],'message':_0x4d73c3['message'],'stack':_0x4d73c3[_0x15a784(0x1b9)]});}),_0x3ea6c8[_0x3a4f32(0x1a9)]('Signal\x20handlers\x20configured');}function setupHealthMonitoring(_0x19b8d3){const _0x2a72d5=a0_0xc444,_0x2c63cb=process['argv']['slice'](0x2),_0x5bd6b0=['do',_0x2a72d5(0x203),'resume','modify'];if(!_0x5bd6b0[_0x2a72d5(0x1a0)](_0x23b7c6=>_0x2c63cb['includes'](_0x23b7c6)))return;applicationState['healthCheckInterval']=setInterval(async()=>{const _0x1c9622=_0x2a72d5;try{await performHealthCheck(_0x19b8d3);}catch(_0x495ee2){_0x19b8d3[_0x1c9622(0x1df)](_0x1c9622(0x213),_0x495ee2);}},SERVICE_HEALTH_CHECK_INTERVAL_MS),_0x19b8d3[_0x2a72d5(0x1a9)](_0x2a72d5(0x1ee));}async function performHealthCheck(_0x4fc693){const _0x464e3e=a0_0xc444,_0x1c380b={'timestamp':new Date()['toISOString'](),'services':{},'overall':'healthy'};if(applicationState[_0x464e3e(0x1d4)][_0x464e3e(0x1aa)])try{_0x1c380b['services'][_0x464e3e(0x1aa)]=_0x464e3e(0x206);}catch(_0x5574ca){_0x1c380b['services']['cli']=_0x464e3e(0x1ad),_0x1c380b[_0x464e3e(0x1c0)]='degraded';}if(applicationState[_0x464e3e(0x1d4)]['orchestrator'])try{const _0x35af63=await applicationState[_0x464e3e(0x1d4)][_0x464e3e(0x1bd)][_0x464e3e(0x1c1)]?.()||_0x464e3e(0x1a6);_0x1c380b[_0x464e3e(0x1d4)][_0x464e3e(0x1bd)]=_0x35af63['overall']||'healthy',(_0x35af63['overall']==='degraded'||_0x35af63['overall']===_0x464e3e(0x1ad))&&(_0x1c380b[_0x464e3e(0x1c0)]='degraded');}catch(_0x34888c){_0x1c380b['services']['orchestrator']='unhealthy',_0x1c380b[_0x464e3e(0x1c0)]=_0x464e3e(0x1ba);}_0x1c380b['overall']!=='healthy'?_0x4fc693[_0x464e3e(0x1df)]('Service\x20health\x20check\x20detected\x20issues:',_0x1c380b):_0x4fc693[_0x464e3e(0x1a9)](_0x464e3e(0x1ff),_0x1c380b);}async function performGracefulShutdown(_0x4bb32d,_0x471dbe){const _0x5e26bc=a0_0xc444;if(applicationState['isShuttingDown'])return;applicationState[_0x5e26bc(0x1d8)]=!![],_0x4bb32d[_0x5e26bc(0x1a5)]('Graceful\x20shutdown','Shutting\x20down\x20due\x20to\x20'+_0x471dbe);try{applicationState[_0x5e26bc(0x19b)]&&(clearInterval(applicationState['healthCheckInterval']),applicationState['healthCheckInterval']=null);const _0x35052b=[];applicationState[_0x5e26bc(0x1d4)][_0x5e26bc(0x1bd)]?.['shutdown']&&_0x35052b[_0x5e26bc(0x1b1)](Promise[_0x5e26bc(0x1f7)]([applicationState[_0x5e26bc(0x1d4)]['orchestrator'][_0x5e26bc(0x201)](),new Promise((_0x3b2fe1,_0x5cab30)=>setTimeout(()=>_0x5cab30(new Error(_0x5e26bc(0x1d9))),0x1388))])[_0x5e26bc(0x1a7)](_0x332ed4=>{_0x4bb32d['warn']('Orchestrator\x20shutdown\x20error:',_0x332ed4);})),applicationState[_0x5e26bc(0x1d4)][_0x5e26bc(0x1aa)]?.['shutdown']&&_0x35052b[_0x5e26bc(0x1b1)](Promise[_0x5e26bc(0x1f7)]([applicationState[_0x5e26bc(0x1d4)]['cli']['shutdown'](),new Promise((_0x216881,_0x50e419)=>setTimeout(()=>_0x50e419(new Error('CLI\x20shutdown\x20timeout')),0xbb8))])['catch'](_0x5255c7=>{_0x4bb32d['warn']('CLI\x20shutdown\x20error:',_0x5255c7);})),await Promise[_0x5e26bc(0x1f7)]([Promise[_0x5e26bc(0x1e3)](_0x35052b),new Promise(_0x26d218=>setTimeout(_0x26d218,GRACEFUL_SHUTDOWN_TIMEOUT_MS))]),_0x4bb32d['completeTask'](_0x5e26bc(0x1fb),!![]),_0x4bb32d[_0x5e26bc(0x20d)](_0x5e26bc(0x1a3));}catch(_0x3d1abd){_0x4bb32d[_0x5e26bc(0x1b4)](_0x5e26bc(0x1fb),![],{'error':_0x3d1abd[_0x5e26bc(0x210)]}),_0x4bb32d[_0x5e26bc(0x1c3)]('Error\x20during\x20graceful\x20shutdown:',_0x3d1abd);}finally{setTimeout(()=>{const _0x346e99=_0x5e26bc;process[_0x346e99(0x1d5)](0x0);},0x1f4);}}async function performEmergencyShutdown(_0x498f46){const _0x52be9a=a0_0xc444;if(applicationState[_0x52be9a(0x1d8)])return;applicationState[_0x52be9a(0x1d8)]=!![],_0x498f46[_0x52be9a(0x1c3)]('Performing\x20emergency\x20shutdown');try{applicationState['healthCheckInterval']&&clearInterval(applicationState[_0x52be9a(0x19b)]),applicationState['services']['orchestrator']?.['saveSessionState']&&await Promise[_0x52be9a(0x1f7)]([applicationState['services'][_0x52be9a(0x1bd)][_0x52be9a(0x1f6)](),new Promise(_0x5368b3=>setTimeout(_0x5368b3,0x7d0))])['catch'](()=>{}),_0x498f46[_0x52be9a(0x1c3)]('Emergency\x20shutdown\x20completed');}catch(_0x18c1d3){console[_0x52be9a(0x1c3)](_0x52be9a(0x1b5),_0x18c1d3[_0x52be9a(0x210)]);}}function provideTroubleshootingSuggestions(_0x3a7e83){const _0x5861a3=a0_0xc444,_0x3127f0=[],_0x3d8aac=_0x3a7e83['message'][_0x5861a3(0x1d2)]();_0x3d8aac[_0x5861a3(0x209)](_0x5861a3(0x1ec))&&(_0x3127f0['push']('Set\x20your\x20API\x20key\x20with:\x20loxia\x20key\x20--set\x20<your-api-key>'),_0x3127f0['push']('Get your API key from: https://autopilot.loxia.ai/account/api-keys')),(_0x3d8aac['includes'](_0x5861a3(0x212))||_0x3d8aac[_0x5861a3(0x209)](_0x5861a3(0x1e5)))&&(_0x3127f0[_0x5861a3(0x1b1)](_0x5861a3(0x1ca)),_0x3127f0['push'](_0x5861a3(0x1db)),_0x3127f0[_0x5861a3(0x1b1)](_0x5861a3(0x1dc))),(_0x3d8aac[_0x5861a3(0x209)]('permission')||_0x3d8aac['includes']('access'))&&(_0x3127f0[_0x5861a3(0x1b1)]('Check\x20file\x20system\x20permissions'),_0x3127f0[_0x5861a3(0x1b1)](_0x5861a3(0x218)),_0x3127f0[_0x5861a3(0x1b1)]('Try running from a different directory')),_0x3d8aac['includes'](_0x5861a3(0x1da))&&(_0x3127f0[_0x5861a3(0x1b1)]('Increase\x20timeout\x20settings\x20in\x20configuration'),_0x3127f0[_0x5861a3(0x1b1)](_0x5861a3(0x1cf)),_0x3127f0['push']('Try\x20again\x20in\x20a\x20few\x20moments')),_0x3d8aac[_0x5861a3(0x209)]('config')&&(_0x3127f0['push']('Check\x20configuration\x20file\x20syntax'),_0x3127f0[_0x5861a3(0x1b1)]('Create default config: loxia config --create'),_0x3127f0['push']('Validate\x20configuration:\x20loxia\x20config\x20--validate')),_0x3127f0['length']>0x0&&(console[_0x5861a3(0x1ef)](a0_0xef779c[_0x5861a3(0x205)](_0x5861a3(0x1f8))),_0x3127f0['forEach'](_0x24d7ec=>{const _0x16b722=_0x5861a3;console['log'](a0_0xef779c[_0x16b722(0x1c8)](_0x16b722(0x1c6)+_0x24d7ec));})),console[_0x5861a3(0x1ef)](a0_0xef779c['gray']('\x0a🔍\x20For\x20more\x20help:')),console['log'](a0_0xef779c['gray']('\x20\x20\x20•\x20Run:\x20loxia\x20--help')),console[_0x5861a3(0x1ef)](a0_0xef779c['gray']('\x20\x20\x20•\x20Check\x20documentation:\x20https://docs.loxia.ai')),console['log'](a0_0xef779c['gray'](_0x5861a3(0x1cd)));}async function handleBootstrapTimeout(_0x320248){const _0x353a69=a0_0xc444;_0x320248['error']('Bootstrap\x20process\x20timed\x20out'),console[_0x353a69(0x1c3)](a0_0xef779c[_0x353a69(0x1d7)](_0x353a69(0x1e9))),console['error'](a0_0xef779c[_0x353a69(0x205)](_0x353a69(0x211))),console['error'](a0_0xef779c[_0x353a69(0x205)]('\x20\x20\x20•\x20Network\x20connectivity\x20issues')),console[_0x353a69(0x1c3)](a0_0xef779c[_0x353a69(0x205)](_0x353a69(0x20b))),console['error'](a0_0xef779c[_0x353a69(0x205)](_0x353a69(0x1b8))),await performEmergencyShutdown(_0x320248),process['exit'](0x1);}async function main(){const _0xf50741=a0_0xc444,_0x442892=Date['now']();try{await Promise[_0xf50741(0x1f7)]([bootstrap(),new Promise((_0x1d68a5,_0x158a83)=>setTimeout(()=>_0x158a83(new Error(_0xf50741(0x1eb))),INITIALIZATION_TIMEOUT_MS))]);}catch(_0x29cdef){const _0x5921aa=Date[_0xf50741(0x1f2)]()-_0x442892;if(_0x29cdef[_0xf50741(0x210)]==='Bootstrap\x20timeout')await handleBootstrapTimeout(applicationState['services']['logger']||createInitialLogger());else throw _0x29cdef;}}main()[a0_0xc444(0x1a7)](_0x5b132d=>{const _0x4c04f0=a0_0xc444,_0x5c6acf=applicationState['services']['logger']||createInitialLogger();_0x5c6acf[_0x4c04f0(0x1c3)](_0x4c04f0(0x1ce),_0x5b132d),console[_0x4c04f0(0x1c3)](a0_0xef779c[_0x4c04f0(0x1d7)](_0x4c04f0(0x1fd))),console['error'](a0_0xef779c['red']('\x20\x20\x20'+_0x5b132d['message'])),process['env'][_0x4c04f0(0x20c)]&&_0x5b132d[_0x4c04f0(0x1b9)]&&(console[_0x4c04f0(0x1c3)](a0_0xef779c['gray']('\x0aStack\x20trace:')),console['error'](a0_0xef779c[_0x4c04f0(0x1b2)](_0x5b132d[_0x4c04f0(0x1b9)]))),process['exit'](0x1);}),process['on']('warning',_0x5f29c9=>{const _0x8b88ea=a0_0xc444;applicationState['services']['logger']&&applicationState[_0x8b88ea(0x1d4)][_0x8b88ea(0x20e)]['warn']('Process\x20warning:',_0x5f29c9);});export{bootstrap,performGracefulShutdown,performHealthCheck};