#!/usr/bin/env node

const a0_0x44171e=a0_0x21c6;(function(_0x270315,_0x3328c9){const _0x49363b=a0_0x21c6,_0x3f1d54=_0x270315();while(!![]){try{const _0x4cafa0=-parseInt(_0x49363b(0xca))/0x1*(parseInt(_0x49363b(0x7c))/0x2)+parseInt(_0x49363b(0x83))/0x3+parseInt(_0x49363b(0x97))/0x4*(parseInt(_0x49363b(0xd8))/0x5)+-parseInt(_0x49363b(0xa9))/0x6+parseInt(_0x49363b(0x9a))/0x7+-parseInt(_0x49363b(0xce))/0x8*(parseInt(_0x49363b(0x7e))/0x9)+parseInt(_0x49363b(0xdd))/0xa;if(_0x4cafa0===_0x3328c9)break;else _0x3f1d54['push'](_0x3f1d54['shift']());}catch(_0xbbf81){_0x3f1d54['push'](_0x3f1d54['shift']());}}}(a0_0x13fb,0x61578));import a0_0xfcb92c from'dotenv';a0_0xfcb92c[a0_0x44171e(0xe0)]();import{CLI}from'./core/cli.js';import{ConversationOrchestrator}from'./core/conversationOrchestrator.js';function a0_0x21c6(_0x3c131c,_0x340950){const _0x13fbe1=a0_0x13fb();return a0_0x21c6=function(_0x21c6c1,_0x4c907c){_0x21c6c1=_0x21c6c1-0x69;let _0x1d1dc2=_0x13fbe1[_0x21c6c1];if(a0_0x21c6['wTZLes']===undefined){var _0x4b98dd=function(_0xfcb92c){const _0x1ad13c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x415057='',_0x4a0357='';for(let _0x3234d2=0x0,_0x1841db,_0x215e23,_0x23dda3=0x0;_0x215e23=_0xfcb92c['charAt'](_0x23dda3++);~_0x215e23&&(_0x1841db=_0x3234d2%0x4?_0x1841db*0x40+_0x215e23:_0x215e23,_0x3234d2++%0x4)?_0x415057+=String['fromCharCode'](0xff&_0x1841db>>(-0x2*_0x3234d2&0x6)):0x0){_0x215e23=_0x1ad13c['indexOf'](_0x215e23);}for(let _0x146d65=0x0,_0x582376=_0x415057['length'];_0x146d65<_0x582376;_0x146d65++){_0x4a0357+='%'+('00'+_0x415057['charCodeAt'](_0x146d65)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x4a0357);};a0_0x21c6['spWEFR']=_0x4b98dd,_0x3c131c=arguments,a0_0x21c6['wTZLes']=!![];}const _0x427d4c=_0x13fbe1[0x0],_0x3d7de8=_0x21c6c1+_0x427d4c,_0x515594=_0x3c131c[_0x3d7de8];return!_0x515594?(_0x1d1dc2=a0_0x21c6['spWEFR'](_0x1d1dc2),_0x3c131c[_0x3d7de8]=_0x1d1dc2):_0x1d1dc2=_0x515594,_0x1d1dc2;},a0_0x21c6(_0x3c131c,_0x340950);}import{LoggingService}from'./services/loggingService.js';function a0_0x13fb(){const _0x10ef9a=['u3rHy2SGDhjHy2u6','Aw5PDgLHBgL6yxrPB25tDgfYDfrPBwu','odq2nJHtwhnpu0K','B3zLCMfSBa','rw1LCMDLBMn5ihnODxrKB3DUigzHAwXLzdO','C3rHy2S','ogrSsK5eAa','q0XjigLUAxrPywXPEMf0Aw9UigzHAwXLzdO','AgvHBhrOq2HLy2TjBNrLCNzHBa','BMfTzq','t3jJAgvZDhjHDg9YihnODxrKB3DUihrPBwvVDxq','q0XjihnODxrKB3DUigvYCM9YoG','Aw5MBW','te9ysufFu0Lmru5u','C2vYDMvYvxjS','t3jJAgvZDhjHDg9YigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','mJvyvLrUCK0','CMvK','D2fYBMLUzW','t3jJAgvZDhjHDg9YihnODxrKB3DUigvYCM9YoG','DgHLBG','nJaYmdC0me52sKfwyq','u0Lhsu5u','icaG4OcIie5LDhDVCMSGy29UBMvJDgL2Axr5igLZC3vLCW','y29UzMLN','zw5HyMXLza','C2vYDMLJzxm','q0XjihnODxrKB3DUihrPBwvVDxq','v19psW','BM93','C2H1DgrVD24','Aw5JBhvKzxm','y2f0y2G','r3jHy2vMDwWGC2H1DgrVD24Gy29TCgXLDgvKihn1y2nLC3nMDwXSEq','yw50AhjVCgLJ','zgvNCMfKzwq','vMvYAwz5ihrOzsbZzxj2zxiGvvjmigLUihLVDxiGy29UzMLNDxjHDgLVBG','q29UzMLNDxjHDgLVBIbLCNjVCJOG','u2vYDMvYihzHBgLKyxrPB24GzMfPBgvKlcb3AwXSigf0DgvTChqGzMfSBgjHy2SGDg8GBg9JywWGC2vYDMLJzxm','zgvIDwC','CMvZDw1L','icaG4OcIia','q2fUBM90ihjLywnOihnLCNzLCIbHDca','u2vYDMvYigHLywX0AcbJAgvJAYbMywLSzwq6ieHuvfaG','Bw9KAwz5','BwfW','yxbPigTLEq','z2v0sgvHBhrOu3rHDhvZ','CMfJzq','uMvQzwn0Aw9Uihn0ywnRihrYywnLoG','AxntAhv0DgLUz0rVD24','C2XPy2u','DgLTzw91Da','q0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEq','icaG4OcIifj1BJOGBg94AweGls1OzwXW','mtrjAuPeuMC','rw5ZDxjLihLVDsbOyxzLihDYAxrLigfJy2vZCYb0BYb0AguGy3vYCMvUDcbKAxjLy3rVCNK','ndKYndGZnLv3yKzRCq','BwvZC2fNzq','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbPBML0AwfSAxPLzcbZDwnJzxnZzNvSBhK','y29TCgXLDgvuyxnR','C29Tzq','mti0nJC5mxHiB1bfsa','u3rHCNrPBMCGtg94AweGq0XjigfWCgXPy2f0Aw9U','yNvKz2v0','z3jHEq','icaTia','Bg9JywW','q0XjigLUAxrPywXPEMf0Aw9UigvYCM9YoIa','vw5Oyw5KBgvKihbYB21PC2uGCMvQzwn0Aw9UoG','BgvUz3rO','BM8GBg9JywWGy29UzMLN','sgvHBhrOignOzwnRihbHC3nLzdO','Bg9Nz2vY','q29UzMLNDxjHDgLVBIbSB2fKAw5NigzHAwXLzdO','y2XP','sgvHBhrOig1VBML0B3jPBMCGy29UzMLNDxjLza','CgvYBwLZC2LVBG','Dw5OzwfSDgH5','qM9VDhn0CMfWihbYB2nLC3mGDgLTzwqGB3v0','q2HLy2SGEw91CIbPBNrLCM5LDcbJB25Uzwn0Aw9U','ChvZAa','ndm3mtG4Exj0Dhzh','q2HLy2SGBMv0D29YAYbJB25Uzwn0AxzPDhK','tM8GqvbjigTLEsbMB3vUzcaTihnVBwuGy29TBwfUzhmGD2LSBcbUB3qGyMuGyxzHAwXHyMXL','mZGYmtC5n3viD0zeqG','te9ysufFte9hx0XfvKvm','z2XVyMfS','D2fYBG','icaG','yxjNDG','cVcFLi0GrM9Yig1VCMuGAgvSCdO','tg94AweGq0XjigLUAxrPywXPEMvKihn1y2nLC3nMDwXSEsbPBIa','te9ysufFrevcvuC','qM9VDhn0CMfW','zw52','AgvHBhrOEq','zxHPDa','q2HLy2SGzMLSzsbZExn0zw0GCgvYBwLZC2LVBNm','icaG4OcIifnLCNzLCIbPCYbKB3DUig9Yig92zxjSB2fKzwq','mZqYotiXmfrlBgnzEq','zxjYB3i','DxnLu2vYDMvYteXn','rM9Yy2uGC2H1DgrVD24GlsbYzwnLAxzLzcbZzwnVBMqGu0Lhsu5u','uhjVy2vZCYb3yxjUAw5NoG','Bg9Ntgv2zwW','Bg9N','BgXTu3rYyxrLz3K','C2v0t3jJAgvZDhjHDg9Y','rw1LCMDLBMn5ihnODxrKB3DUignVBxbSzxrLza','r3jHy2vMDwWGC2H1DgrVD24','y29UC3rHBNrZ','EwvSBg93','Dg9ju09tDhjPBMC','Dg9tDhjPBMC','zM9YrwfJAa','sw5PDgLHBgL6Aw5Nienmsq','C3rHCNruyxnR','B3bLBMfP','ywnJzxnZ','B3jJAgvZDhjHDg9Y','Dw5JyxvNAhrfEgnLChrPB24','CM91BMq','cVcFKQuGrMf0ywWGC3rHCNr1CcbLCNjVCJO','vhj5igfNywLUigLUigeGzMv3ig1VBwvUDhm','Bg9NrgLY','Bg9Nz2LUzW','cLn0ywnRihrYywnLoG','yxbPs2v5','u2LNBMfSigHHBMrSzxjZignVBMzPz3vYzwq','DxnHz2veAxi'];a0_0x13fb=function(){return _0x10ef9a;};return a0_0x13fb();}import{loadConfig}from'./config/configLoader.js';import a0_0x1ad13c from'chalk';import{performance}from'perf_hooks';const INITIALIZATION_TIMEOUT_MS=0x7530,GRACEFUL_SHUTDOWN_TIMEOUT_MS=0x2710,SERVICE_HEALTH_CHECK_INTERVAL_MS=0x493e0;let applicationState={'isShuttingDown':![],'initializationStartTime':null,'services':{'logger':null,'config':null,'cli':null,'orchestrator':null},'healthCheckInterval':null};async function bootstrap(){const _0x509a9c=a0_0x44171e;applicationState['initializationStartTime']=performance[_0x509a9c(0xe5)]();const _0x415057=createInitialLogger();applicationState['services']['logger']=_0x415057;try{_0x415057['info'](_0x509a9c(0x84)),_0x415057['startTask'](_0x509a9c(0xa3),'Initializing\x20application\x20components');const _0x4a0357=await initializeConfiguration(_0x415057);applicationState['services'][_0x509a9c(0xe0)]=_0x4a0357;const _0x3234d2=createEnhancedLogger(_0x4a0357);applicationState['services']['logger']=_0x3234d2;const _0x1841db=await initializeCLI(_0x4a0357,_0x3234d2);applicationState[_0x509a9c(0xe2)][_0x509a9c(0x90)]=_0x1841db,await initializeOrchestratorIfNeeded(_0x1841db,_0x4a0357,_0x3234d2),setupSignalHandlers(_0x3234d2),setupHealthMonitoring(_0x3234d2);const _0x215e23=performance['now']()-applicationState[_0x509a9c(0xc9)];_0x3234d2['completeTask'](_0x509a9c(0xa3),!![],{'initializationTime':Math[_0x509a9c(0xbf)](_0x215e23),'serverMode':_0x4a0357[_0x509a9c(0xab)],'services':Object['keys'](applicationState[_0x509a9c(0xe2)])['filter'](_0x23dda3=>applicationState['services'][_0x23dda3]!==null)}),_0x3234d2['info'](_0x509a9c(0xa1)+Math[_0x509a9c(0xbf)](_0x215e23)+'ms'),await _0x1841db['start']();}catch(_0x146d65){const _0x582376=performance[_0x509a9c(0xe5)]()-applicationState[_0x509a9c(0xc9)];_0x415057[_0x509a9c(0x81)](_0x509a9c(0xa3),![],{'error':_0x146d65[_0x509a9c(0x7f)],'initializationTime':Math['round'](_0x582376)}),console['error'](a0_0x1ad13c[_0x509a9c(0xd9)]('\x0a❌\x20Failed\x20to\x20start\x20Loxia\x20CLI:')),console[_0x509a9c(0xaa)](a0_0x1ad13c['red'](_0x509a9c(0x9e)+_0x146d65['message'])),_0x146d65['stack']&&process[_0x509a9c(0xa4)][_0x509a9c(0xa2)]&&(console['error'](a0_0x1ad13c[_0x509a9c(0x86)](_0x509a9c(0xc4))),console['error'](a0_0x1ad13c[_0x509a9c(0x86)](_0x146d65[_0x509a9c(0xcd)]))),provideTroubleshootingSuggestions(_0x146d65),await performEmergencyShutdown(_0x415057),process[_0x509a9c(0xa6)](0x1);}}function createInitialLogger(){const _0x544e0f=a0_0x44171e;return new LoggingService({'console':![],'file':![],'logLevel':process['env'][_0x544e0f(0x9b)]||'info','silent':process[_0x544e0f(0xa4)][_0x544e0f(0xd5)]==='true'});}async function initializeConfiguration(_0x36e0ab){const _0x46ed0b=a0_0x44171e;_0x36e0ab[_0x46ed0b(0xd4)]('Loading\x20configuration');try{const _0x1e5c5d=await loadConfig();return await validateRuntimeConfiguration(_0x1e5c5d,_0x36e0ab),_0x36e0ab['info']('Configuration\x20loaded\x20and\x20validated\x20successfully',{'serverMode':_0x1e5c5d['useServerLLM'],'logLevel':_0x1e5c5d['logging'][_0x46ed0b(0xae)],'llmStrategy':_0x1e5c5d[_0x46ed0b(0xb0)]}),_0x1e5c5d;}catch(_0x44531c){_0x36e0ab[_0x46ed0b(0xaa)](_0x46ed0b(0x8f),_0x44531c);throw new Error(_0x46ed0b(0x6a)+_0x44531c['message']);}}async function validateRuntimeConfiguration(_0x148966,_0x32b4dd){const _0x251c27=a0_0x44171e,_0x3e20fb=[];if(_0x148966['useServerLLM'])try{const _0x58449c=await fetch(_0x148966[_0x251c27(0xd6)]+'/health',{'method':'GET','timeout':0x1388});!_0x58449c['ok']&&_0x3e20fb['push'](_0x251c27(0x70)+_0x58449c['status']);}catch(_0x1ba0d8){_0x3e20fb['push'](_0x251c27(0x6f)+_0x148966[_0x251c27(0xd6)]+':\x20'+_0x1ba0d8[_0x251c27(0x7f)]);}if(!_0x148966[_0x251c27(0xab)]){const _0x5dd077=_0x148966[_0x251c27(0xe2)]['anthropic']['apiKey']||_0x148966['services'][_0x251c27(0xbb)]['apiKey']||_0x148966['services']['google']['apiKey'];!_0x5dd077&&_0x3e20fb[_0x251c27(0x96)]('No\x20API\x20keys\x20configured\x20for\x20fallback\x20services');}try{const _0x329f73=_0x148966[_0x251c27(0x85)][_0x251c27(0xc7)];await import('fs')['then'](_0x4f39c2=>_0x4f39c2['promises']['mkdir'](_0x329f73,{'recursive':!![]})),await import('fs')['then'](_0x39435e=>_0x39435e['promises']['access'](_0x329f73,_0x39435e[_0x251c27(0xb4)][_0x251c27(0xe4)]));}catch(_0x12e58d){_0x3e20fb['push']('Cannot\x20write\x20to\x20budget\x20directory:\x20'+_0x12e58d['message']);}if(_0x3e20fb[_0x251c27(0x8b)]>0x0){const _0x2b3152='Runtime\x20validation\x20failed:\x0a'+_0x3e20fb[_0x251c27(0x72)](_0x292dd5=>_0x251c27(0x87)+_0x292dd5)['join']('\x0a');if(_0x148966[_0x251c27(0xab)]&&_0x3e20fb[_0x251c27(0x82)](_0x511fe0=>_0x511fe0['includes']('server')))_0x32b4dd[_0x251c27(0x9d)](_0x251c27(0x6b)),_0x148966['useServerLLM']=![],_0x148966['services'][_0x251c27(0xea)][_0x251c27(0xe1)]=!!_0x148966['services']['anthropic'][_0x251c27(0xc5)],_0x148966['services']['openai'][_0x251c27(0xe1)]=!!_0x148966['services']['openai'][_0x251c27(0xc5)],_0x148966['services']['google']['enabled']=!!_0x148966['services']['google'][_0x251c27(0xc5)];else throw new Error(_0x2b3152);}}function createEnhancedLogger(_0x596ee6){const _0x271b0b=a0_0x44171e;return new LoggingService({'console':_0x596ee6['logging']['console']!==![],'file':_0x596ee6[_0x271b0b(0xc3)]['file']!==![],'logLevel':_0x596ee6[_0x271b0b(0xc3)]['logLevel'],'logDir':_0x596ee6['logging'][_0x271b0b(0xc2)],'silent':_0x596ee6[_0x271b0b(0xc3)]['silent']===!![]});}async function initializeCLI(_0x324b17,_0x22d8e6){const _0x216d55=a0_0x44171e;_0x22d8e6[_0x216d55(0xd4)](_0x216d55(0xb9));try{const _0x37fc2e=new CLI(null,_0x324b17,_0x22d8e6);return await validateCLIResources(_0x37fc2e,_0x324b17,_0x22d8e6),_0x22d8e6['info'](_0x216d55(0x7a)),_0x37fc2e;}catch(_0x17545b){_0x22d8e6[_0x216d55(0xaa)](_0x216d55(0xcf),_0x17545b);throw new Error(_0x216d55(0x89)+_0x17545b[_0x216d55(0x7f)]);}}async function validateCLIResources(_0x47aa9a,_0x295c95,_0x4b1956){const _0x1493bf=a0_0x44171e,_0x50e834=await _0x47aa9a['getStoredApiKey']()[_0x1493bf(0xe8)](()=>null);!_0x50e834&&_0x295c95['useServerLLM']&&_0x4b1956[_0x1493bf(0x9d)](_0x1493bf(0x99));try{const {getConfigPaths:_0x15dcb8}=await import('./config/configLoader.js'),_0x5868d2=_0x15dcb8();await import('fs')[_0x1493bf(0xdc)](_0xd64562=>{const _0x5cc109=_0x1493bf,_0x2bbdeb=[];return _0x5868d2[_0x5cc109(0x9c)]&&_0x2bbdeb[_0x5cc109(0x96)](_0xd64562['promises'][_0x5cc109(0xbc)](_0x5868d2[_0x5cc109(0x9c)])[_0x5cc109(0xe8)](()=>'no\x20global\x20config')),_0x5868d2[_0x5cc109(0x88)]&&_0x2bbdeb[_0x5cc109(0x96)](_0xd64562['promises']['access'](_0x5868d2[_0x5cc109(0x88)])['catch'](()=>_0x5cc109(0x8c))),Promise['allSettled'](_0x2bbdeb);});}catch(_0x1f0ec5){_0x4b1956['warn']('Configuration\x20file\x20validation\x20failed:',_0x1f0ec5);}}async function initializeOrchestratorIfNeeded(_0x663f14,_0x48c781,_0x40430e){const _0x572bc8=a0_0x44171e,_0x152142=process[_0x572bc8(0x9f)]['slice'](0x2),_0x52e30d=_0x152142[0x0],_0x2b94c9=['key','status','budget','--help','-h','--version','-v'];if(_0x2b94c9['includes'](_0x52e30d)||_0x152142['includes']('--help')||_0x152142[_0x572bc8(0xe7)]('-h')){_0x40430e['debug']('Skipping\x20orchestrator\x20initialization\x20for\x20utility\x20command');return;}_0x40430e[_0x572bc8(0xd4)]('Initializing\x20conversation\x20orchestrator');try{const _0x132cd2=new ConversationOrchestrator(_0x48c781,_0x40430e);await _0x132cd2['initializeServices'](),_0x663f14[_0x572bc8(0xb1)](_0x132cd2),applicationState[_0x572bc8(0xe2)]['orchestrator']=_0x132cd2,_0x40430e['info'](_0x572bc8(0x80));}catch(_0x3b24fc){_0x40430e['error']('Orchestrator\x20initialization\x20failed:',_0x3b24fc);if(['status',_0x572bc8(0x85)][_0x572bc8(0xe7)](_0x52e30d))_0x40430e['warn']('Continuing\x20without\x20orchestrator\x20for\x20status\x20command');else throw new Error(_0x572bc8(0xd7)+_0x3b24fc['message']);}}function setupSignalHandlers(_0x141c6f){const _0xb9c924=a0_0x44171e;process['on']('SIGINT',async()=>{const _0x371032=a0_0x21c6;applicationState[_0x371032(0x77)]&&(_0x141c6f['warn'](_0x371032(0xac)),process['exit'](0x1)),_0x141c6f[_0x371032(0xd4)]('Received\x20SIGINT,\x20initiating\x20graceful\x20shutdown'),await performGracefulShutdown(_0x141c6f,_0x371032(0xde));}),process['on']('SIGTERM',async()=>{const _0x57c01e=a0_0x21c6;applicationState[_0x57c01e(0x77)]&&(_0x141c6f[_0x57c01e(0x9d)]('Force\x20shutdown\x20-\x20received\x20second\x20SIGTERM'),process[_0x57c01e(0xa6)](0x1)),_0x141c6f['info']('Received\x20SIGTERM,\x20initiating\x20graceful\x20shutdown'),await performGracefulShutdown(_0x141c6f,'SIGTERM');}),process['on'](_0xb9c924(0xbe),async _0x4fca4c=>{const _0x54909e=_0xb9c924;_0x141c6f['error']('Uncaught\x20exception:',_0x4fca4c),_0x4fca4c[_0x54909e(0xcd)]&&_0x141c6f['error'](_0x54909e(0xc8),_0x4fca4c['stack']),await performEmergencyShutdown(_0x141c6f),process['exit'](0x1);}),process['on']('unhandledRejection',async(_0x2e1d8e,_0x4d0157)=>{const _0x5f5413=_0xb9c924;_0x141c6f['error'](_0x5f5413(0x8a),{'reason':_0x2e1d8e?.['message']||_0x2e1d8e,'promise':_0x4d0157?.[_0x5f5413(0xb7)]()}),_0x2e1d8e?.[_0x5f5413(0xcd)]&&_0x141c6f[_0x5f5413(0xaa)](_0x5f5413(0x76),_0x2e1d8e['stack']),await performEmergencyShutdown(_0x141c6f),process[_0x5f5413(0xa6)](0x1);}),process['on'](_0xb9c924(0xda),_0x226f52=>{const _0x210e7a=_0xb9c924;_0x141c6f[_0x210e7a(0x9d)]('Node.js\x20warning:',{'name':_0x226f52[_0x210e7a(0xd1)],'message':_0x226f52[_0x210e7a(0x7f)],'stack':_0x226f52['stack']});}),_0x141c6f[_0xb9c924(0x6c)](_0xb9c924(0xc6));}function setupHealthMonitoring(_0x7d4d2c){const _0x4c79a7=a0_0x44171e,_0x12f729=process[_0x4c79a7(0x9f)][_0x4c79a7(0x78)](0x2),_0x41af7b=['do','make',_0x4c79a7(0x6d),_0x4c79a7(0x71)];if(!_0x41af7b['some'](_0x3cd0b1=>_0x12f729[_0x4c79a7(0xe7)](_0x3cd0b1)))return;applicationState[_0x4c79a7(0xd0)]=setInterval(async()=>{const _0x6a60c6=_0x4c79a7;try{await performHealthCheck(_0x7d4d2c);}catch(_0x1c2ea9){_0x7d4d2c[_0x6a60c6(0x9d)]('Health\x20check\x20failed:',_0x1c2ea9);}},SERVICE_HEALTH_CHECK_INTERVAL_MS),_0x7d4d2c[_0x4c79a7(0x6c)](_0x4c79a7(0x91));}async function performHealthCheck(_0x11b720){const _0x173903=a0_0x44171e,_0x529fa2={'timestamp':new Date()[_0x173903(0xb6)](),'services':{},'overall':_0x173903(0xa5)};if(applicationState['services']['cli'])try{_0x529fa2[_0x173903(0xe2)][_0x173903(0x90)]='healthy';}catch(_0x55131d){_0x529fa2[_0x173903(0xe2)][_0x173903(0x90)]='unhealthy',_0x529fa2[_0x173903(0xcb)]='degraded';}if(applicationState[_0x173903(0xe2)][_0x173903(0xbd)])try{const _0x2cb3c5=await applicationState[_0x173903(0xe2)]['orchestrator'][_0x173903(0x74)]?.()||'unknown';_0x529fa2['services']['orchestrator']=_0x2cb3c5[_0x173903(0xcb)]||_0x173903(0xa5),(_0x2cb3c5[_0x173903(0xcb)]===_0x173903(0xeb)||_0x2cb3c5[_0x173903(0xcb)]==='unhealthy')&&(_0x529fa2['overall']='degraded');}catch(_0x58787d){_0x529fa2['services'][_0x173903(0xbd)]=_0x173903(0x93),_0x529fa2['overall']=_0x173903(0xeb);}_0x529fa2[_0x173903(0xcb)]!==_0x173903(0xa5)?_0x11b720['warn']('Service\x20health\x20check\x20detected\x20issues:',_0x529fa2):_0x11b720[_0x173903(0x6c)](_0x173903(0x8d),_0x529fa2);}async function performGracefulShutdown(_0x5458ac,_0x3bb91b){const _0x28d6b9=a0_0x44171e;if(applicationState[_0x28d6b9(0x77)])return;applicationState['isShuttingDown']=!![],_0x5458ac[_0x28d6b9(0xba)](_0x28d6b9(0xb3),'Shutting\x20down\x20due\x20to\x20'+_0x3bb91b);try{applicationState[_0x28d6b9(0xd0)]&&(clearInterval(applicationState['healthCheckInterval']),applicationState[_0x28d6b9(0xd0)]=null);const _0x4096b4=[];applicationState[_0x28d6b9(0xe2)]['orchestrator']?.['shutdown']&&_0x4096b4['push'](Promise['race']([applicationState[_0x28d6b9(0xe2)]['orchestrator'][_0x28d6b9(0xe6)](),new Promise((_0x23feab,_0x25a145)=>setTimeout(()=>_0x25a145(new Error(_0x28d6b9(0xd2))),0x1388))])['catch'](_0x2ad762=>{const _0x24744c=_0x28d6b9;_0x5458ac[_0x24744c(0x9d)](_0x24744c(0xdb),_0x2ad762);})),applicationState['services']['cli']?.['shutdown']&&_0x4096b4[_0x28d6b9(0x96)](Promise[_0x28d6b9(0x75)]([applicationState[_0x28d6b9(0xe2)][_0x28d6b9(0x90)][_0x28d6b9(0xe6)](),new Promise((_0x2d2036,_0x3759d0)=>setTimeout(()=>_0x3759d0(new Error(_0x28d6b9(0xe3))),0xbb8))])['catch'](_0x2da05d=>{const _0x5f1a83=_0x28d6b9;_0x5458ac[_0x5f1a83(0x9d)](_0x5f1a83(0xd3),_0x2da05d);})),await Promise[_0x28d6b9(0x75)]([Promise['allSettled'](_0x4096b4),new Promise(_0x2fc9c5=>setTimeout(_0x2fc9c5,GRACEFUL_SHUTDOWN_TIMEOUT_MS))]),_0x5458ac[_0x28d6b9(0x81)]('Graceful\x20shutdown',!![]),_0x5458ac[_0x28d6b9(0xd4)](_0x28d6b9(0xe9));}catch(_0x19e3a1){_0x5458ac[_0x28d6b9(0x81)]('Graceful\x20shutdown',![],{'error':_0x19e3a1[_0x28d6b9(0x7f)]}),_0x5458ac[_0x28d6b9(0xaa)]('Error\x20during\x20graceful\x20shutdown:',_0x19e3a1);}finally{setTimeout(()=>{const _0x3e90d9=_0x28d6b9;process[_0x3e90d9(0xa6)](0x0);},0x1f4);}}async function performEmergencyShutdown(_0x234efa){const _0xa56c4d=a0_0x44171e;if(applicationState['isShuttingDown'])return;applicationState['isShuttingDown']=!![],_0x234efa[_0xa56c4d(0xaa)]('Performing\x20emergency\x20shutdown');try{applicationState['healthCheckInterval']&&clearInterval(applicationState['healthCheckInterval']),applicationState['services'][_0xa56c4d(0xbd)]?.['saveSessionState']&&await Promise[_0xa56c4d(0x75)]([applicationState[_0xa56c4d(0xe2)][_0xa56c4d(0xbd)]['saveSessionState'](),new Promise(_0x520747=>setTimeout(_0x520747,0x7d0))])['catch'](()=>{}),_0x234efa[_0xa56c4d(0xaa)](_0xa56c4d(0xb2));}catch(_0x554de9){console['error'](_0xa56c4d(0xcc),_0x554de9[_0xa56c4d(0x7f)]);}}function provideTroubleshootingSuggestions(_0x1992d8){const _0x6fe8ed=a0_0x44171e,_0xf522ed=[],_0x564d99=_0x1992d8['message']['toLowerCase']();_0x564d99['includes'](_0x6fe8ed(0x73))&&(_0xf522ed[_0x6fe8ed(0x96)]('Set\x20your\x20API\x20key\x20with:\x20loxia\x20key\x20--set\x20<your-api-key>'),_0xf522ed['push']('Get your API key from: https://autopilot.loxia.ai/account/api-keys')),(_0x564d99['includes']('server')||_0x564d99[_0x6fe8ed(0xe7)]('connection'))&&(_0xf522ed[_0x6fe8ed(0x96)](_0x6fe8ed(0x95)),_0xf522ed['push'](_0x6fe8ed(0x69)),_0xf522ed['push']('Try\x20using\x20fallback\x20mode:\x20LOXIA_USE_SERVER_LLM=false')),(_0x564d99['includes'](_0x6fe8ed(0x92))||_0x564d99[_0x6fe8ed(0xe7)]('access'))&&(_0xf522ed['push'](_0x6fe8ed(0xa7)),_0xf522ed['push'](_0x6fe8ed(0x7d)),_0xf522ed[_0x6fe8ed(0x96)]('Try running from a different directory')),_0x564d99['includes'](_0x6fe8ed(0x79))&&(_0xf522ed[_0x6fe8ed(0x96)]('Increase\x20timeout\x20settings\x20in\x20configuration'),_0xf522ed[_0x6fe8ed(0x96)](_0x6fe8ed(0x98)),_0xf522ed[_0x6fe8ed(0x96)](_0x6fe8ed(0xc1))),_0x564d99[_0x6fe8ed(0xe7)]('config')&&(_0xf522ed[_0x6fe8ed(0x96)]('Check\x20configuration\x20file\x20syntax'),_0xf522ed['push']('Create default config: loxia config --create'),_0xf522ed[_0x6fe8ed(0x96)]('Validate\x20configuration:\x20loxia\x20config\x20--validate')),_0xf522ed['length']>0x0&&(console[_0x6fe8ed(0xaf)](a0_0x1ad13c[_0x6fe8ed(0xb5)]('\x0a💡\x20Troubleshooting\x20suggestions:')),_0xf522ed[_0x6fe8ed(0xb8)](_0x4d2bc5=>{const _0x173989=_0x6fe8ed;console[_0x173989(0xaf)](a0_0x1ad13c['cyan'](_0x173989(0x6e)+_0x4d2bc5));})),console['log'](a0_0x1ad13c['gray'](_0x6fe8ed(0xa0))),console[_0x6fe8ed(0xaf)](a0_0x1ad13c[_0x6fe8ed(0x86)](_0x6fe8ed(0x7b))),console[_0x6fe8ed(0xaf)](a0_0x1ad13c[_0x6fe8ed(0x86)]('\x20\x20\x20•\x20Check\x20documentation:\x20https://docs.loxia.ai')),console[_0x6fe8ed(0xaf)](a0_0x1ad13c[_0x6fe8ed(0x86)]('\x20\x20\x20•\x20Report\x20issues:\x20https://github.com/loxia-ai/cli/issues'));}async function handleBootstrapTimeout(_0x460891){const _0x30f625=a0_0x44171e;_0x460891[_0x30f625(0xaa)](_0x30f625(0x94)),console[_0x30f625(0xaa)](a0_0x1ad13c[_0x30f625(0xd9)]('\x0a⏰\x20Initialization\x20timed\x20out')),console['error'](a0_0x1ad13c['yellow']('This\x20might\x20indicate:')),console['error'](a0_0x1ad13c['yellow'](_0x30f625(0xdf))),console['error'](a0_0x1ad13c[_0x30f625(0xb5)](_0x30f625(0xa8))),console[_0x30f625(0xaa)](a0_0x1ad13c[_0x30f625(0xb5)]('\x20\x20\x20•\x20Configuration\x20problems')),await performEmergencyShutdown(_0x460891),process[_0x30f625(0xa6)](0x1);}async function main(){const _0x2689cd=a0_0x44171e,_0x2916fb=Date[_0x2689cd(0xe5)]();try{await Promise[_0x2689cd(0x75)]([bootstrap(),new Promise((_0x27aebd,_0x26dcc8)=>setTimeout(()=>_0x26dcc8(new Error('Bootstrap\x20timeout')),INITIALIZATION_TIMEOUT_MS))]);}catch(_0x368751){const _0x295a80=Date['now']()-_0x2916fb;if(_0x368751[_0x2689cd(0x7f)]==='Bootstrap\x20timeout')await handleBootstrapTimeout(applicationState[_0x2689cd(0xe2)]['logger']||createInitialLogger());else throw _0x368751;}}main()['catch'](_0x4dfc2c=>{const _0x2dfc7e=a0_0x44171e,_0x423065=applicationState[_0x2dfc7e(0xe2)][_0x2dfc7e(0x8e)]||createInitialLogger();_0x423065[_0x2dfc7e(0xaa)]('Fatal\x20error\x20during\x20startup:',_0x4dfc2c),console[_0x2dfc7e(0xaa)](a0_0x1ad13c[_0x2dfc7e(0xd9)](_0x2dfc7e(0xc0))),console['error'](a0_0x1ad13c[_0x2dfc7e(0xd9)]('\x20\x20\x20'+_0x4dfc2c[_0x2dfc7e(0x7f)])),process[_0x2dfc7e(0xa4)][_0x2dfc7e(0xa2)]&&_0x4dfc2c[_0x2dfc7e(0xcd)]&&(console['error'](a0_0x1ad13c[_0x2dfc7e(0x86)]('\x0aStack\x20trace:')),console['error'](a0_0x1ad13c[_0x2dfc7e(0x86)](_0x4dfc2c['stack']))),process[_0x2dfc7e(0xa6)](0x1);}),process['on']('warning',_0xeb7b08=>{const _0x1a1884=a0_0x44171e;applicationState[_0x1a1884(0xe2)]['logger']&&applicationState['services'][_0x1a1884(0x8e)][_0x1a1884(0x9d)](_0x1a1884(0xad),_0xeb7b08);});export{bootstrap,performGracefulShutdown,performHealthCheck};