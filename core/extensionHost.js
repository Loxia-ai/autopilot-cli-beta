const a0_0x145f40=a0_0x3934;(function(_0x1ea86f,_0x31cc04){const _0xa17721=a0_0x3934,_0x5e1429=_0x1ea86f();while(!![]){try{const _0x2016fb=-parseInt(_0xa17721(0x99))/0x1*(parseInt(_0xa17721(0xa5))/0x2)+parseInt(_0xa17721(0x89))/0x3+parseInt(_0xa17721(0x9d))/0x4+-parseInt(_0xa17721(0x8d))/0x5+parseInt(_0xa17721(0x81))/0x6*(parseInt(_0xa17721(0xab))/0x7)+-parseInt(_0xa17721(0x8a))/0x8+-parseInt(_0xa17721(0xa7))/0x9;if(_0x2016fb===_0x31cc04)break;else _0x5e1429['push'](_0x5e1429['shift']());}catch(_0x184f7b){_0x5e1429['push'](_0x5e1429['shift']());}}}(a0_0x4f31,0xbba29));import*as a0_0x550999 from'vscode';function a0_0x3934(_0x5cd3b1,_0x140c5b){const _0x4f31ea=a0_0x4f31();return a0_0x3934=function(_0x39340e,_0x2d9592){_0x39340e=_0x39340e-0x80;let _0x2e6304=_0x4f31ea[_0x39340e];if(a0_0x3934['GHpXzI']===undefined){var _0x3061b9=function(_0x550999){const _0x56f739='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x280921='',_0x31f7bb='';for(let _0x3b5557=0x0,_0x396f52,_0xa4d374,_0x25eb76=0x0;_0xa4d374=_0x550999['charAt'](_0x25eb76++);~_0xa4d374&&(_0x396f52=_0x3b5557%0x4?_0x396f52*0x40+_0xa4d374:_0xa4d374,_0x3b5557++%0x4)?_0x280921+=String['fromCharCode'](0xff&_0x396f52>>(-0x2*_0x3b5557&0x6)):0x0){_0xa4d374=_0x56f739['indexOf'](_0xa4d374);}for(let _0xae16d5=0x0,_0xc71d4c=_0x280921['length'];_0xae16d5<_0xc71d4c;_0xae16d5++){_0x31f7bb+='%'+('00'+_0x280921['charCodeAt'](_0xae16d5)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x31f7bb);};a0_0x3934['dbpwdR']=_0x3061b9,_0x5cd3b1=arguments,a0_0x3934['GHpXzI']=!![];}const _0x125b03=_0x4f31ea[0x0],_0x31d168=_0x39340e+_0x125b03,_0x4a2adc=_0x5cd3b1[_0x31d168];return!_0x4a2adc?(_0x2e6304=a0_0x3934['dbpwdR'](_0x2e6304),_0x5cd3b1[_0x31d168]=_0x2e6304):_0x2e6304=_0x4a2adc,_0x2e6304;},a0_0x3934(_0x5cd3b1,_0x140c5b);}import{ConversationOrchestrator}from'./conversationOrchestrator.js';function a0_0x4f31(){const _0x2679e3=['C2HVD0vYCM9YtwvZC2fNzq','mK5gs3DMza','CMvNAxn0zxjwAwv3CW','mZu3ndG5wxrpD2Dn','AxnfBxb0Eq','B3jJAgvZDhjHDg9Y','v2HHDcb3B3vSzcb5B3uGBgLRzsbTzsb0BYbOzwXWihLVDsb3AxrOpW','mtmZDxnOv1z3','z2v0vgv4Da','y2HHDfbYB3zPzgvY','C2HVD1DHCM5PBMDnzxnZywDL','qw5HBhL6zsbJB21Tyw5KigzHAwXLzdO','mJq1nZCYDMjSuLbK','CMvNAxn0zxjdB21Tyw5KCW','y29UDgv4Da','BgfUz3vHz2vjza','ugXLyxnLigfUywX5EMuGDgHPCYa','Bg94AwfdAgf0lMzVy3vZ','D2LUzg93','rxH0zw5ZAw9Usg9ZDcbPBML0AwfSAxPLzcbZDwnJzxnZzNvSBhK','ndi3mtaXmg1WCu5pAW','nZqZotCWnhL3swvWwq','C2vSzwn0Aw9U','Bg94AwfdAgf0','mJu3ntaZmgLvBhPisW','BwvZC2fNzq','ChvZAa','y29TBwfUzhm','Aw5PDgLHBgL6zq','Bg94AweUyw5HBhL6zq','y29UzMLN','Aw5MBW','CMvNAxn0zxjdB21Tyw5K','zgLZCg9ZywjSzxm','zxjYB3i','zxHLy3v0zunVBw1HBMq','mZG4ndG5sK1XtKff','cMbGya','AgfUzgXLvxnLCKLUChv0','zg9JDw1LBNq','mtC1oteZnMzZqK53Cq','zgLZCg9Zzq','q2HHDcbJB21Tyw5KigzHAwXLzdO','C2HVD0LUChv0qM94','tM8Gy29KzsbZzwXLy3rLzcbVCIbMAwXLigLZigvTChr5lG','C3vIC2nYAxb0Aw9UCW','Bg9Nz2vY'];a0_0x4f31=function(){return _0x2679e3;};return a0_0x4f31();}import{ChatViewProvider}from'../vscode/chatViewProvider.js';export class ExtensionHost{constructor(_0x56f739,_0x280921,_0x31f7bb){const _0x244334=a0_0x3934;this['context']=_0x56f739,this[_0x244334(0x93)]=_0x280921,this[_0x244334(0xa3)]=_0x31f7bb,this[_0x244334(0xa9)]=null,this['chatProvider']=null,this['disposables']=[];}async[a0_0x145f40(0x91)](){const _0x525842=a0_0x145f40;try{this['orchestrator']=new ConversationOrchestrator(this['config'],this[_0x525842(0xa3)]),this['chatProvider']=new ChatViewProvider(this[_0x525842(0x83)],this['orchestrator'],this['logger']),this[_0x525842(0x82)](),this[_0x525842(0xa6)](),this['logger'][_0x525842(0x94)](_0x525842(0x88));}catch(_0x3b5557){this[_0x525842(0xa3)][_0x525842(0x97)]('Failed\x20to\x20initialize\x20ExtensionHost:',_0x3b5557);throw _0x3b5557;}}[a0_0x145f40(0x82)](){const _0x5413aa=a0_0x145f40,_0x396f52=a0_0x550999[_0x5413aa(0x90)][_0x5413aa(0x95)]('loxia.chat',async()=>{const _0x4185a6=_0x5413aa;try{a0_0x550999['commands'][_0x4185a6(0x98)](_0x4185a6(0x86));const _0x25eb76=await a0_0x550999[_0x4185a6(0x87)][_0x4185a6(0xa0)]({'prompt':_0x4185a6(0xaa),'placeHolder':'Ask\x20anything\x20about\x20your\x20code...'});_0x25eb76&&await this[_0x4185a6(0xad)][_0x4185a6(0x9b)](_0x25eb76);}catch(_0xae16d5){this['logger'][_0x4185a6(0x97)](_0x4185a6(0x9f),_0xae16d5),a0_0x550999[_0x4185a6(0x87)][_0x4185a6(0xa4)]('Chat\x20failed:\x20'+_0xae16d5[_0x4185a6(0x8e)]);}}),_0xa4d374=a0_0x550999['commands'][_0x5413aa(0x95)](_0x5413aa(0x92),async()=>{const _0x3c9d71=_0x5413aa;try{const _0xc71d4c=a0_0x550999['window']['activeTextEditor'];if(!_0xc71d4c){a0_0x550999['window'][_0x3c9d71(0xae)]('No\x20active\x20editor\x20found.\x20Please\x20open\x20a\x20file\x20to\x20analyze.');return;}const _0x2049ef=_0xc71d4c[_0x3c9d71(0x9c)],_0x5d3044=_0xc71d4c[_0x3c9d71(0x8b)],_0x40ecdd=_0x5d3044[_0x3c9d71(0xa8)]?_0x2049ef[_0x3c9d71(0xac)]():_0x2049ef[_0x3c9d71(0xac)](_0x5d3044);if(!_0x40ecdd['trim']()){a0_0x550999['window']['showWarningMessage'](_0x3c9d71(0xa1));return;}const _0x51327f=_0x3c9d71(0x85)+_0x2049ef['languageId']+'\x20code:\x0a\x0a```'+_0x2049ef[_0x3c9d71(0x84)]+'\x0a'+_0x40ecdd+_0x3c9d71(0x9a);await this['chatProvider'][_0x3c9d71(0x9b)](_0x51327f),a0_0x550999['commands']['executeCommand'](_0x3c9d71(0x86));}catch(_0x5c9053){this[_0x3c9d71(0xa3)][_0x3c9d71(0x97)](_0x3c9d71(0x80),_0x5c9053),a0_0x550999['window']['showErrorMessage']('Analysis\x20failed:\x20'+_0x5c9053[_0x3c9d71(0x8e)]);}});this[_0x5413aa(0x96)][_0x5413aa(0x8f)](_0x396f52,_0xa4d374),this['context']['subscriptions']['push'](...this[_0x5413aa(0x96)]);}[a0_0x145f40(0xa6)](){const _0x38d284=a0_0x145f40,_0x41e95b=a0_0x550999['window']['registerWebviewViewProvider'](_0x38d284(0x8c),this[_0x38d284(0xad)],{'webviewOptions':{'retainContextWhenHidden':!![]}});this[_0x38d284(0x96)][_0x38d284(0x8f)](_0x41e95b),this[_0x38d284(0x83)][_0x38d284(0xa2)][_0x38d284(0x8f)](_0x41e95b);}[a0_0x145f40(0x9e)](){const _0x147431=a0_0x145f40;this['logger']['info']('ExtensionHost\x20disposing...'),this[_0x147431(0x96)]['forEach'](_0x3ef6ad=>{const _0x30f6f1=_0x147431;_0x3ef6ad&&typeof _0x3ef6ad[_0x30f6f1(0x9e)]==='function'&&_0x3ef6ad['dispose']();}),this[_0x147431(0x96)]=[],this[_0x147431(0xad)]&&(this[_0x147431(0xad)][_0x147431(0x9e)](),this[_0x147431(0xad)]=null),this[_0x147431(0xa9)]=null;}}