const a0_0x2316bb=a0_0x5c5d;(function(_0x5a7976,_0x2504f3){const _0x45e701=a0_0x5c5d,_0x44404c=_0x5a7976();while(!![]){try{const _0xb824f=parseInt(_0x45e701(0x12e))/0x1+parseInt(_0x45e701(0x195))/0x2*(-parseInt(_0x45e701(0x120))/0x3)+-parseInt(_0x45e701(0x1d4))/0x4+parseInt(_0x45e701(0x1c5))/0x5+parseInt(_0x45e701(0x130))/0x6+-parseInt(_0x45e701(0x101))/0x7+parseInt(_0x45e701(0x15f))/0x8*(parseInt(_0x45e701(0x19b))/0x9);if(_0xb824f===_0x2504f3)break;else _0x44404c['push'](_0x44404c['shift']());}catch(_0x44f644){_0x44404c['push'](_0x44404c['shift']());}}}(a0_0x1eb5,0xa28e0));import{TagParser}from'../utilities/tagParser.js';import{TagParserService}from'../services/tagParserService.js';import a0_0x14f7dd from'path';import{promises as a0_0x58bc73}from'fs';import{v4 as a0_0x127b15}from'uuid';function a0_0x5c5d(_0xeeea94,_0x16c85a){const _0x1eb52b=a0_0x1eb5();return a0_0x5c5d=function(_0x5c5d5d,_0x5b4d8c){_0x5c5d5d=_0x5c5d5d-0xc4;let _0x42af48=_0x1eb52b[_0x5c5d5d];if(a0_0x5c5d['OQYqOa']===undefined){var _0x505299=function(_0x14f7dd){const _0x58bc73='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x127b15='',_0x45841f='';for(let _0x544e65=0x0,_0x2e2f2e,_0x58ee3b,_0x7c7ca1=0x0;_0x58ee3b=_0x14f7dd['charAt'](_0x7c7ca1++);~_0x58ee3b&&(_0x2e2f2e=_0x544e65%0x4?_0x2e2f2e*0x40+_0x58ee3b:_0x58ee3b,_0x544e65++%0x4)?_0x127b15+=String['fromCharCode'](0xff&_0x2e2f2e>>(-0x2*_0x544e65&0x6)):0x0){_0x58ee3b=_0x58bc73['indexOf'](_0x58ee3b);}for(let _0x32e35d=0x0,_0x147420=_0x127b15['length'];_0x32e35d<_0x147420;_0x32e35d++){_0x45841f+='%'+('00'+_0x127b15['charCodeAt'](_0x32e35d)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x45841f);};a0_0x5c5d['uSHdBY']=_0x505299,_0xeeea94=arguments,a0_0x5c5d['OQYqOa']=!![];}const _0x59fdd8=_0x1eb52b[0x0],_0x266a4f=_0x5c5d5d+_0x59fdd8,_0x1419a9=_0xeeea94[_0x266a4f];return!_0x1419a9?(_0x42af48=a0_0x5c5d['uSHdBY'](_0x42af48),_0xeeea94[_0x266a4f]=_0x42af48):_0x42af48=_0x1419a9,_0x42af48;},a0_0x5c5d(_0xeeea94,_0x16c85a);}import{LLMService}from'../services/llmService.js';import{ToolRegistry}from'../services/toolRegistry.js';import{BudgetService}from'../services/budgetService.js';import{displayOnly}from'../utilities/stringOps.js';import a0_0x45841f from'chalk';export const CONVERSATION_CONSTANTS={'STATE_DIR_NAME':'.loxia-state','SESSION_STATE_FILENAME':'session-state.json','INDEX_FILENAME':a0_0x2316bb(0x183),'LAST_SESSION_FILENAME':a0_0x2316bb(0x1a9),'HISTORY_SUFFIX':a0_0x2316bb(0x1aa),'SYSTEM_MESSAGE_ROLE':a0_0x2316bb(0x124),'USER_MESSAGE_ROLE':a0_0x2316bb(0xd2),'ASSISTANT_MESSAGE_ROLE':a0_0x2316bb(0x149),'COMPACTIZATION_THRESHOLD_PERCENTAGE':0.7,'COMPACTIZATION_OUTPUT_RESERVE_PERCENTAGE':0.4,'COMPACTIZATION_BEGIN_PERCENTAGE':0.15,'COMPACTIZATION_END_PERCENTAGE':0.35,'MIN_MESSAGES_TO_KEEP':0x2,'SUMMARY_MARKER_BEGIN':'--Conversation\x20Became\x20Long,\x20This\x20Part\x20Has\x20Been\x20Summarized--','SUMMARY_MARKER_END':'--End\x20of\x20Summary--','TOOL_CALL_FREQUENCY_CHECK_MS':0x2710,'TOOL_STATUS_UPDATE_INTERVAL_MS':0x2710,'DEFAULT_CONTEXT_WINDOW_SIZE':0x186a0,'MAKER_AGENT_DEFAULT_ID':a0_0x2316bb(0x126),'LANGUAGE_MODEL_ID':a0_0x2316bb(0x19e),'PROMPT_ENGINEER_ID':'prompt-engineer'};function a0_0x1eb5(){const _0x1f9e76=['CMvHzezPBgu','CM9Szq','lGOGicaGcIaGicaGicaGww91igfYzsbLEhbLy3rLzcb0BYbWDxqGDgHLihrLEhqGAw50zw5KzwqGzM9YihrOzsbVDgHLCIbHz2vUDcbPBNnPzguGw21LC3nHz2uGDg89iG','Dg9ju09tDhjPBMC','rMfPBgvKihrVihjLC3vTzsbJB252zxjZyxrPB246','ChjVBwLZzq','q29TCgfJDgL6yxrPB246ia','ufjptvbux0vor0Loruvsx0Le','u1Ltvevnx01fu1nbr0vFuK9mrq','C2v0u2vZC2LVBK92zxjYAwrLCW','ic0GCgvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBG','C2vTAs1HDxrV','Bw9KAwz5rxHPC3rPBMDdB250zw50','q291BgqGBM90igzPBMqGAgLZDg9YEsbMB3iG','DgfNugfYC2vYu2vYDMLJzq','y3jLyxrLq29UDMvYC2f0Aw9U','EwvSBg93','y29UDMvYC2f0Aw9UlwLUzgv4lMPZB24','ywnJzxnZ','zgvIDwC','ihn1Bw1HCML6zwqGkYa','B25kB2jeB25L','Bg9Nz2vY','C3LZDgvTuhjVBxb0','ig5VDcbMB3vUzcbMB3iGy29TCgfJDgL6yxrPB24','igzYB20G','u2vZC2LVBIbZDgf0zsbZyxzLzcbZDwnJzxnZzNvSBhKGD2L0AcbPBMrLEcbMAwXLCW','C2vUze1LC3nHz2vuB0nVBNzLCNnHDgLVBG','ignVBxbSzxrLzcb3AxrOihjLC3vSDdO','q29UDMvYC2f0Aw9Uia','y29UDgvUDa','z2v0qNvKz2v0vxnHz2u','y29UDMvYC2f0Aw9Ulq','8j+AQcbqCM9TChqGDg9VigXVBMCGzgv0zwn0zwqGzM9Yicr7y29UDMvYC2f0Aw9Uswr9ic0GCgvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBG','uMvZDw1PBMCGzxHLy3v0Aw9U','mLfnBMX1Aq','CMvZDwX0','BMfTzq','D2HPDgu','z3jHEq','seLtve9swv9tvuzgsvG','ow5Zs0n2qG','C3vIC3rYAw5N','lcbJCMvHDgLUzYbLBxb0EsbJB252zxjZyxrPB24','BgfUz3vHz2uTBw9KzwW','BwvZC2fNzuLUzgLJyxrVCG','C2v0sw50zxjHy3rPB25nB2rL','B3b0Aw9UCW','DxbKyxrLq29UDMvYC2f0Aw9U','Dg9VBeLK','khn5C3rLBsbTzxnZywDLkq','Aw5MBW','y3jLyxrLsw5PDgLHBfbYB21WDezVCKvUz2LUzwvY','icbHBMqGDgHLihn1Bw1HCNKGC2vYDMLJzsbPCYb1BMf2ywLSywjSzs4','CMvWBgfJzq','BgfZDc1ZzxnZAw9UlMPZB24','lwHPC3rVCNKUANnVBG','igr1CMLUzYbZAhv0zg93BG','DxrMltG','z2v0','cIaGicaGicaGvgHLigzVBgXVD2LUzYb0zxH0igLZigeGCgfYDcbVzIbHignVBNzLCNnHDgLVBI4GsxqGAxmGDMvYEsbSB25NlIakicaGicaGicbszxbSywnLihrOAxmGCgfYDcbVzIb0AguGy29UDMvYC2f0Aw9UihDPDgGGysbJB25JAxnLigfSDgvYBMf0AxzLihDOAwXLihbYzxnLCNzPBMCGA2v5igLUzM9YBwf0Aw9UlcbKzwnPC2LVBNmSigfUzcbJB250zxH0cIaGicaGicaGqwDLBNqGC2HVDwXKigjLigfIBguGDg8GChjVy2vLzcb3AxrOigL0CYb0yxnRigj5ihvZAw5NihrOAxmGC2HVCNrLCIbZDw1Tyxj5igLUC3rLywqGB2yGDgHLig9YAwDPBMfSigXVBMCGy29UDMvYC2f0Aw9UlGOGicaGicaGia','yMXVy2TLze1LC3nHz2vZ','z2v0sw5KAwnHDg9Yu3rHDhvZ','oIbbz2vUDcbKB2vZig5VDcbLEgLZDa','DxbKyxrLu3LZDgvTuhjVBxb0C0zVCK1Vzgu','Dg9uAw1Lu3rYAw5N','z2v0uhjVBxb0rw5NAw5LzxjtExn0zw1qCM9TChq','B25vC2vYuhjVBxb0','8j+sOsbzB3vYihbYB2PLy3qGzMLSzxmGAgf2zsbIzwvUihnHDMvKigfUzcbJyw4GyMuGCMvZDw1Lzc4','y3jLyxrPBMCGBMv3ignVBNrLBNq','C2HVDwXKqMXVy2TnzxnZywDL','C2v0uhjVAMvJDerPCMvJDg9YEq','rxjYB3iGC2vUzgLUzYbHDxrVlxbYB2nLzwqGBwvZC2fNztO','AM9PBG','cIbuAgLZihnLy3rPB24GD2LSBcbIzsbZzw50igfWyxj0igzYB20GDgHLihrVB2WGAw5ZDhj1y3rPB25ZlG','tM8GChjVAMvJDcbKAxjLy3rVCNKGC2v0lcbJyw5UB3qGC2f2zsbZzxnZAw9Uihn0yxrL','AxnxywL0Aw5NrM9YvxnLCKLUChv0','igjLz2LUicSG','AwrSzvrPBwvY','rMfPBgvKihrVihnHDMuGC2vZC2LVBIbZDgf0ztO','vg9VBca','u3vTBwfYEsbMywLSDxjLigrLDgfPBhm6','sgfUzgXPBMCGDxnLCIbWCM9TChq6ia','nde4mty1nurovhreBq','yMX1zq','C3bSAxq','su5ervHFrKLmru5btuu','q2fUBM90igrPC3bSyxKGChjVBxb0ihrVihvZzxi6ie5VihbYB21WDcbOyw5KBgvYigLZihjLz2LZDgvYzwqUia','iL08Ew91CIbJB250zw50pLSVBwvZC2fNzv0UcGOGicaGicaGienOywXSzw5Nzsb0AguGywDLBNqSigHLihDPBgWGDhj5ihrVignVDMvYigvHy2GGC3vIAMvJDc9ZDgfNzsb3AxrOAw4GysbZAw5NBguGBwvZC2fNzsWGyxnRigHPBsb0BYbZDxbWBhKGzgv0ywLSCYWGy2HHBgXLBMDLigHPCYbHC3n1Bxb0Aw9UCYWGyw5Kig1HA2uGC3vYzsbOzsDZig5VDcbMB3jNzxr0Aw5NigfUEsbPBxbVCNrHBNqGyxnWzwn0ig9MihrOzsb0yxnRlaOGicaGicaGie9UzsbZCgvJAwzPyYbLEgfTCgXLig9MigeGBwf0DgvYig9MigHPz2GGAw1WB3j0yw5JzsbPCYb0AguGDMvYAwzPy2f0Aw9Uig9MihrOzsb0yxnRignVBxbSzxrPB24GAw4GysbSyxjNzsb2yxjPzxr5ig9MihDHExmUcIaGicaGicaG','AgfZvg9VBa','AxntAhv0DgLUz0rVD24','BgvUz3rO','D2fYBG','Aw5PDgLHBgL6zq','zNjVBuvUDhjPzxm','BwvZC2fNzxm','tg9HzgvKignVBNzLCNnHDgLVBIbOAxn0B3j5igzVCJOG','y2HLy2TbBMrqzxjMB3jTq29TCgfJDgL6yxrPB24','mZK2mtaYmgnhshfstq','zxjYB3i','ugXLyxnLihrYEsbYzxj1BM5PBMCGDgHLienmssb3AxrOigrVlcbTB2rPzNKSig9YihjLC3vTzsbJB21Tyw5KCYbHC2TPBMCGDgHLigfNzw50ihrVignVBNrPBNvLlG','Aw50zxjHy3rPB25nB2rL','w3rVB2XZlwnVBw1HBMrZxsb0ywDZihrVihvZzsb0B29SCYWGB3iGDgHLigzVBgXVD2LUzYbZEw50yxGGDg8GAw50zxjHy3qGD2L0Acb0AguGC3vWzxj2AxnPBMCGAhvTyw4GDxnLCJOGw3bYB21WDcbUyw1LpsjZB21LihbYB21WDcbKAxnWBgf5ihrPDgXLiL08ChjVBxb0ig1LC3nHz2u+w29WDgLVBL08B3b0Aw9UideGDgv4Dd5Bl29WDgLVBL0Gw29WDgLVBL08B3b0Aw9UidiGDgv4Dd5Bl29WDgLVBL0UlI5Bl3bYB21WDf0k','AgfZ','ig1LC3nHz2vZ','ns4Gw1vtrviGufjptvbuuYbesvnbqKXfrcbjtIbbvvrpie1prevDia','CM91DgvnzxnZywDLvg9bz2vUDa','4PYfievYCM9YlxrYAwDNzxjLzcbJB21Wywn0AxPHDgLVBIbJB21WBgv0zwqGzM9Yia','z2v0vg9VBeLKCW','DxbKyxrLq29UDMvYC2f0Aw9Uu3LZDgvTuhjVBxb0','icHTB2rLoIa','C2vZC2LVBLn0yxrL','BgXTu2vYDMLJzq','C3LZDgvTlxbYB21WDa','CMvNAxn0zxjcDwLSDeLUvg9VBhm','q2fUy2vSBgLUzYbVCgvYyxrPB24G','C2H1DgrVD24','twfWCgvKignVBNzLCNnHDgLVBIbjrcbMB3iGzMLSzsbVCgvYyxrPB25ZoIaI','twvZC2fNzsbIBg9JA2vKic0GD2fPDgLUzYbMB3iGDxnLCIbPBNb1Da','igzHAwXLzdO','B3jPz2LUywXtExn0zw1qCM9TChrZ','teXnihnLCNzPy2uGBM90igf2ywLSywjSzsbMB3iGAw1Hz2uGzgvZy3jPChrPB24','DxnLCG','u1vntufswv9nqvjlrvjFqKvhsu4','qvvutYbTB2rLoIbbDxrVlxnLBgvJDgvKici','zw5Oyw5Jzvn5C3rLBvbYB21WDa','ywDLBNrjza','q3jPDgLJywWGzxjYB3i6ienHBM5VDcbJCMvHDguGy29UDMvYC2f0Aw9Uihn1Bw1HCNKGzM9Yia','Dg9VBenVBw1HBMrZ','CYbLBgfWC2vKks4Gt3bLCMf0Aw9UieLeoIa','CMvXDwLYzxnszxnWB25Zzq','zNjVBq','y3LHBG','tuflrvjFquDftLrFrevgqvvmvf9jra','C3rYAw5NAwz5','u2vZC2LVBIbZDgf0zsbZyxzLzcb0BZOG','D3jPDgvgAwXL','CMvTB3zLuhjVBxb0u3LUDgf4rNjVBvn5C3rLBvbYB21WDa','Dhj5tg9HzenVBNzLCNnHDgLVBKHPC3rVCNLcEvbHDhrLCM4','CMfJzq','BwfW','y29UDMvYC2f0Aw9UswrnyxbWAw5N','zxn0Aw1HDgvuB2TLBKnVDw50','8j+AQcbvtLjfq09wrvjbqKXfievsuK9s','ve9ptf9dquXmx0zsrvfvru5dwv9dsevds19nuW','ChjVy2vZC1rVB2XdB21Tyw5KCW','C3vJy2vZCW','surmrv9usu1ft1vux01t','z3jLzw4','vw5YzwnVDMvYywjSzsbLCNjVCIbKDxjPBMCGy29UDMvYC2f0Aw9Uihn1Bw1HCNKUia','Aw5JBhvKzxm','igLZihn0AwXSihj1BM5PBMCGka','AwrSzunOzwnRsw50zxj2ywW','yMvNAw4GBw9KAwzPy2f0Aw9Uig9MignVBNrLBNqGAw4G','rMfPBgvKihrVihf1zxvLihrVB2WG','zMLUza','yNvKz2v0u2vYDMLJzq','lIbnzxnZywDLCYbYzwr1y2vKigzYB20G','C2v0qNvKz2v0tgLTAxq','D2fPDgLUzY1MB3iTBgXT','cGPzB3uGyxjLigv4CgvJDgvKihrVignVBNn1BhqGEw91CIbmte0GywDLBNqGDxnPBMCGDgHLifTTzxnZywDLxsb0ywCGD2L0Acb0AguGzM9SBg93Aw5NigLKCZOG','C2f2zunVBNzLCNnHDgLVBKHPC3rVCNK','w1vZzxiGAw5WDxrDoIa','q29UDMvYC2f0Aw9UihjLC3vTzwqGC3vJy2vZC2z1BgX5lIbby3rPDMuGy29UDMvYC2f0Aw9UCZOG','ywn0AxzLvg9VBhm','C3rHCNrozxDdB252zxjZyxrPB24','rM91BMqGyw5KigXVywrLzcbJB252zxjZyxrPB24GAgLZDg9YEsbMB3iG','ChjVBxb0','jYbHy2nVCMrPBMCGDg8GDgHLC2uGAw5ZDhj1y3rPB25ZoGOGicaGicaGicaGica','ntC3nZeZnxDtu1vuzW','B3bLCMf0Aw9Uswq','vxnLCIbZzwXLy3rLzdOG','CMvHzgrPCG','y29UDgvUDc1TB2rPzMLLCG','DhjHy2Tqzw5KAw5Nt3bLCMf0Aw9U','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbZAhv0igrVD24GC3vJy2vZC2z1BgX5','y29UDgv4DfDPBMrVDW','tMv3ignVBNzLCNnHDgLVBIbZDgfYDgvKigfUzcbZzxnZAw9Uihn0yxrLihnHDMvK','uM91DgLUzYbTzxnZywDLigzYB20G','vxbKyxrLzcbJB252zxjZyxrPB24GB3jJAgvZDhjHDg9YihbYB2PLy3qGzgLYzwn0B3j5oIa','w1vZzxiGAw5WDxrDoG','cGO9psbdB21WBgv0zwqGt3bLCMf0Aw9UCYa9pq','CMvNAxn0zxjvC2vYuhjVBxb0sgfUzgXLCG','zMLSDgvY','cGPuB29SCYbHDMfPBgfIBguGyxjLoGO','BgfUz3vHz2vnB2rLBefNzw50swq','y29UzMLN','AM9Irg9Uzq','C3rYAw5N','ChvZAa','C2L6zq','qMvMB3jLignVBxbHy3rPEMf0Aw9UoIa','BwfRzxjbz2vUDeLK','z2v0tgfUz3vHz2vnB2rLBfn5C3rLBvbYB21WDa','yxv0BW','C3rHCNruAw1L','ms4WlJa','qwDLBNqG','ywn0AxzLq29UDMvYC2f0Aw9UswrZ','CgfYC2u','mJaXodiYwMfXqMD4','rxjYB3iGCgfYC2LUzYbWCM9TChqGzw5NAw5LzxiGCMvZCg9UC2u6','DxbKyxrLtwvZC2fNzuLUzgLJyxrVCG','rMfPBgvKihrVihjLC3vTzsbJB252zxjZyxrPB246ia','C3LZDgvT','y29UDMvYC2f0Aw9UCW','BwfRzxiTywDLBNq','C2v0v2fPDgLUz0zVCLvZzxjjBNb1Da','8j+tPcbtzw5KAw5Nigf1Dg8TChjVy2vLzcbTzxnZywDLlI4U','icaGicbSB3HPysbTB2rPzNKGlI95B3vYlxbYB2PLy3qGiMnVBNrPBNvLigrLDMvSB3bTzw50iG','ic0+ia','ywXSu2v0DgXLza','zMXVB3i','u1rbvevFreLsx05btuu','nJa0mde1wKDrwvjj','cIaGica','ndu1mdy0nKTXDhn2za','CgvUzgLUz1jLC3vSDhm','C3rHDhvZ','z2v0sw1Hz2vezxnJCMLWDgLVBG','AgfUzgXLsM9Irg9UzujHC2vKt25nB2rL','Bg9HzenVBNzLCNnHDgLVBKHPC3rVCNK','jYbUB3qGzM91BMqUief2ywLSywjSzsb0B29SCZOG','zw50CMLLCW','Aw50zxjHy3rPDMu','iIbMB3iGChjVBxb0oIa','q29UDgLUDwuGyxv0B21HDgLJywXSEq','C2vUzfbYB2nLzwrnzxnZywDL','AwrSzq','C2vUze1LC3nHz2u','uhjVy2vZC2LUzYbTzxnZywDLigzYB20G','z2v0vg9VBhnezxnJCMLWDgLVBG','BwvZC2fNzq','Aw5PDgLHBgL6zvDPDgHqCM9Qzwn0','ywKTCM9Szq','Bg9N','CMvNAxn0zxjdB252zxjZyxrPB24','C2v0','icHMAwXLoIa','DxbKyxrLuhjVAMvJDerPCMvJDg9YEq','tefor1vbr0vFtu9eruXFsuq','yxnZAxn0yw50','x2HHBMrSzvn1Bw1HCNLgywLSDxjL','CMvNAxn0zxjkB2jeB25LsgfUzgXLCG','C2XPy2u','DgHLBG','y3jLyxrLu3vTBwfYEvbYB21WDa','C3rHCNrjzgXLtw9UAxrVCMLUzW','ugf1C2LUzYbLEgvJDxrPB24','w09Yy2HLC3rYyxrVCL0GtwvZC2fNAw5Nia','x3nHBML0AxPLq29UDMvYC2f0Aw9UswrgB3jgAwXL','Bw9KzwXZ','cUkCHsbuB29Sia','y2f0y2G','Dg9VBenOzwnRsw50zxj2ywW','ChjVAMvJDerPCG','q29UDMvYC2f0Aw9UihjLC3vTzwq','ww91CIbTzxnZywDLigrPzg4NDcbJB250ywLUigfUEsb0B29SignVBw1HBMrZlcbHig1LC3nHz2uGDg8Gyw5VDgHLCIbHz2vUDcWGB3iGysbWCM9TChqUia','C2f2zvnLC3nPB25tDgf0zq','u0vtu0LptL9tvefurv9gsuXftKfnrq','ihrVia','rxjYB3iGD2fPDgLUzYbMB3iGCgvUzgLUzYbVCgvYyxrPB25Zigr1CMLUzYbZAhv0zg93BJO','igrVzxmGBM90igv4Axn0','mJC5odK2oe9KqurLvW','igLZihn0AwXSihj1BM5PBMCGkg9WzxjHDgLVBIbjrdOG','CxvLDwvqzw5KAw5NuMvZDwX0','CgfYC2vqCM9TChrfBMDPBMvLCLjLC3bVBNnL','q09nuefdveLAqvrjt05Fru5ex1bfuKnftLrbr0u','y2HLy2TuB29SrxHLy3v0Aw9Uu3rHDhvZ','Cgf1C2vK','x2DLDezPBgvtywzLq29UDMvYC2f0Aw9Uswq','Bwf4','BwTKAxi','ihDPDgGGAw5ZDhj1y3rPB25ZoIa','BM93','tM8GBwfRzxiGywDLBNqGzM91BMqGDg8GC2vUzcb1C2vYigLUChv0ihrV','DxnPBMCGDgHLifTTzxnZywDLxsb0ywCGD2L0Acb0AguGzM9SBg93Aw5NigLKCW','rxjYB3iGC3rHCNrPBMCGBMv3ignVBNzLCNnHDgLVBJO','sM9IignVBxbSzxrLzdOG','q29UDMvYC2f0Aw9UihjLC3vTzwqGD2L0Ag91DcbJB21WBgv0zsbOAxn0B3j5','Dg9VBfjLz2LZDhj5','Dg9mB2nHBgvmB3DLCKnHC2u'];a0_0x1eb5=function(){return _0x1f9e76;};return a0_0x1eb5();}export class ConversationOrchestrator{constructor(_0x544e65,_0x2e2f2e){const _0x4bc38a=a0_0x2316bb;this[_0x4bc38a(0x112)]=_0x544e65,this['logger']=_0x2e2f2e,this['tagParserService']=new TagParserService(_0x2e2f2e),this[_0x4bc38a(0xc8)]=new LLMService(_0x544e65,_0x2e2f2e),this['llmService']['registerPromptTooLongHandler'](_0x58ee3b=>this['handlePromptTooLong'](_0x58ee3b)),this['toolRegistry']=new ToolRegistry(_0x544e65,_0x2e2f2e,this['llmService']),this['budgetService']=new BudgetService(_0x544e65,_0x2e2f2e),this[_0x4bc38a(0x125)]=new Map(),this[_0x4bc38a(0xfc)]=new Map(),this['conversationIdMapping']=new Map(),this['interactionMode']='interactive',this['originalSystemPrompts']=new Map(),this['sessionState']={'projectDir':null,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{}},this[_0x4bc38a(0x156)]=setInterval(()=>this[_0x4bc38a(0x164)](),CONVERSATION_CONSTANTS[_0x4bc38a(0xe8)]),this['messageIndicator']='idle',this['lastActivityTime']=Date['now'](),this['idleTimer']=null,this[_0x4bc38a(0xeb)]=0x1388,this[_0x4bc38a(0x1cc)]=![],this[_0x4bc38a(0x14f)]();}async['initializeWithProject'](_0x7c7ca1){const _0x52273f=a0_0x2316bb;this[_0x52273f(0xc7)][_0x52273f(0x157)]=_0x7c7ca1,this['toolRegistry'][_0x52273f(0x1b9)](_0x7c7ca1),this['logger'][_0x52273f(0x1a5)]('Conversation\x20orchestrator\x20initialized\x20with\x20project:\x20'+_0x7c7ca1);}async[a0_0x2316bb(0x141)](_0x32e35d){const _0x1d3717=a0_0x2316bb;this['sessionState'][_0x1d3717(0x157)]=_0x32e35d,this['toolRegistry'][_0x1d3717(0x1b9)](_0x32e35d),this[_0x1d3717(0x188)][_0x1d3717(0x1a5)]('Conversation\x20orchestrator\x20initialized\x20with\x20project:\x20'+_0x32e35d);}[a0_0x2316bb(0x1b9)](_0x147420){const _0x29412c=a0_0x2316bb;this[_0x29412c(0xc7)][_0x29412c(0x157)]=_0x147420,this['toolRegistry']&&this['toolRegistry'][_0x29412c(0x1b9)](_0x147420),this[_0x29412c(0x188)][_0x29412c(0x1a5)](_0x29412c(0x10b)+_0x147420);}async[a0_0x2316bb(0x1cf)](){const _0x479d10=a0_0x2316bb;this['toolRegistry']=new ToolRegistry(this[_0x479d10(0x112)],this[_0x479d10(0x188)]),await this[_0x479d10(0x170)][_0x479d10(0xca)]();}[a0_0x2316bb(0x147)](_0x3d3cae){const _0x487749=a0_0x2316bb;this[_0x487749(0x1b9)](_0x3d3cae);}[a0_0x2316bb(0x14f)](){this['idleCheckInterval']=setInterval(()=>{const _0x22b531=a0_0x5c5d;if(this['isShuttingDown'])return;if(this['interactionMode']===_0x22b531(0x138))return;const _0x22737e=Date['now'](),_0x4862e5=_0x22737e-this['lastActivityTime'];this[_0x22b531(0x19f)]===_0x22b531(0x13c)&&_0x4862e5>=this[_0x22b531(0xeb)]&&this[_0x22b531(0xc7)][_0x22b531(0x118)]&&(this[_0x22b531(0x188)][_0x22b531(0x1a5)]('üîÑ\x20Auto-proceeding\x20after\x203\x20seconds\x20of\x20idle\x20time'),this[_0x22b531(0x13b)]());},0x1f4);}[a0_0x2316bb(0x127)](_0x555a12){const _0x2ed2be=a0_0x2316bb,_0x440c66=this['isWaitingForUserInput'];this['isWaitingForUserInput']=_0x555a12;if(_0x555a12&&!_0x440c66)console['log'](a0_0x45841f['cyan']('üîí\x20Interactive\x20mode:\x20Blocking\x20automatic\x20messages'));else!_0x555a12&&_0x440c66&&(console[_0x2ed2be(0x143)](a0_0x45841f['green']('üîì\x20Interactive\x20mode:\x20Resuming\x20message\x20flow')),this[_0x2ed2be(0x1af)]=[]);}[a0_0x2316bb(0x1b8)](_0x14b579,_0x284119){const _0x51d506=a0_0x2316bb;if(this['interactionMode']!==_0x51d506(0x138)||!this[_0x51d506(0x1be)])return![];if(_0x284119[_0x51d506(0xee)](_0x51d506(0x10c)))return![];if(_0x284119['includes'](_0x51d506(0x1a4)))return![];return!![];}[a0_0x2316bb(0x122)](_0x26257f){const _0x4e824b=a0_0x2316bb,_0x1c6293=this[_0x4e824b(0x19f)];this['messageIndicator']=_0x26257f,this['lastActivityTime']=Date[_0x4e824b(0x16a)]();this[_0x4e824b(0x1c0)]&&(clearTimeout(this['idleTimer']),this[_0x4e824b(0x1c0)]=null);if(_0x1c6293!==_0x26257f){const _0x54066c=this['getIndicatorDisplay'](_0x26257f);console['log'](a0_0x45841f[_0x4e824b(0x199)](_0x54066c+'\x20'+_0x26257f));}}['getIndicatorDisplay'](_0xfe4125){const _0x27ef9d=a0_0x2316bb;switch(_0xfe4125){case'waiting-for-agent':return a0_0x45841f[_0x27ef9d(0x182)]('‚è≥');case'waiting-for-llm':return a0_0x45841f[_0x27ef9d(0x1c6)]('ü§ñ');case _0x27ef9d(0x13c):return a0_0x45841f[_0x27ef9d(0xec)]('‚úì');default:return'‚Ä¢';}}async[a0_0x2316bb(0x13b)](){const _0x1aa533=a0_0x2316bb;if(!this[_0x1aa533(0xc7)][_0x1aa533(0x118)]||this['isShuttingDown'])return;try{this[_0x1aa533(0x122)]('waiting-for-agent'),console['log'](a0_0x45841f['gray'](_0x1aa533(0x128)));const _0x5810a4=new Date()[_0x1aa533(0x1b3)]()[_0x1aa533(0x1c7)]('\x20')[0x0];await this[_0x1aa533(0x18d)](this[_0x1aa533(0xc7)][_0x1aa533(0x118)],'('+_0x5810a4+'\x20system\x20message:)\x20proceed.\x20If\x20stuck\x20for\x20too\x20long\x20use\x20tools\x20or\x20perform\x20operations\x20to\x20effectively\x20continue\x20the\x20task.');}catch(_0x42f575){this[_0x1aa533(0x188)][_0x1aa533(0x1d5)](_0x1aa533(0x1ba),_0x42f575),this['updateMessageIndicator']('idle');}}[a0_0x2316bb(0x1a0)](_0x36e39f){const _0x517982=a0_0x2316bb,_0x499089=this[_0x517982(0x1d7)];this['interactionMode']=_0x36e39f,this[_0x517982(0x188)][_0x517982(0x1a5)]('Interaction\x20mode\x20changed:\x20'+_0x499089+_0x517982(0x12a)+_0x36e39f);if(_0x36e39f===_0x517982(0x138)&&_0x499089!=='interactive')this[_0x517982(0x127)](!![]);else _0x36e39f!==_0x517982(0x138)&&_0x499089===_0x517982(0x138)&&this['setWaitingForUserInput'](![]);this[_0x517982(0x1b2)](_0x36e39f);}['getBlockingStatus'](){const _0x15ceb1=a0_0x2316bb;return{'interactionMode':this[_0x15ceb1(0x1d7)],'isWaitingForUserInput':this['isWaitingForUserInput'],'blockedMessagesCount':this['blockedMessages'][_0x15ceb1(0x1cd)],'indicatorState':this[_0x15ceb1(0x19f)]};}[a0_0x2316bb(0x1b2)](_0x1b9b36){const _0x22eb1f=a0_0x2316bb;for(const [_0x156fbb,_0x5b77df]of this[_0x22eb1f(0x125)]){this[_0x22eb1f(0xc5)](_0x156fbb,_0x1b9b36);}}[a0_0x2316bb(0xc5)](_0x330d9d,_0x1ab9ec){const _0x5149d1=a0_0x2316bb,_0x528ae0=this['conversations']['get'](_0x330d9d);if(!_0x528ae0)return;!this[_0x5149d1(0xd0)][_0x5149d1(0x1d9)](_0x330d9d)&&this['originalSystemPrompts'][_0x5149d1(0x145)](_0x330d9d,_0x528ae0[_0x5149d1(0x189)]);const _0x21de82=this['originalSystemPrompts']['get'](_0x330d9d);let _0x3c8b03;_0x1ab9ec==='auto'?_0x3c8b03=this['removePromptSyntaxFromSystemPrompt'](_0x21de82):_0x3c8b03=_0x21de82,_0x528ae0[_0x5149d1(0x189)]=_0x3c8b03,this[_0x5149d1(0xc8)]&&this['llmService'][_0x5149d1(0xc5)]&&this['llmService'][_0x5149d1(0xc5)](_0x330d9d,_0x3c8b03),this['logger']['debug']('Updated\x20system\x20prompt\x20for\x20'+_0x330d9d+_0x5149d1(0xc6)+_0x1ab9ec+')');}[a0_0x2316bb(0xe1)](_0x477647){const _0x59e29c=a0_0x2316bb;let _0x42c7bb=_0x477647[_0x59e29c(0x1a8)](/5\.\s*If you need user input or a decision[^6]*/,_0x59e29c(0x1db));return _0x42c7bb=_0x42c7bb['replace'](/\[prompt[^\]]*\][^[]*\[\/prompt\]/g,''),_0x42c7bb+='\x0a\x0a/*\x20NOTE:\x20Prompt\x20syntax\x20removed\x20for\x20auto\x20mode.\x20'+'To\x20re-enable,\x20switch\x20to\x20interactive\x20mode\x20or\x20modify\x20enhanceSystemPrompt()\x20*/',_0x42c7bb;}[a0_0x2316bb(0xd5)](_0x34eb15,_0xfcc57,_0x44a74f,_0x1baec8){const _0x5c5609=a0_0x2316bb;let _0x271854=_0x34eb15;return!_0x271854['toLocaleLowerCase']()['includes']('tools\x20available\x20are')&&(_0x271854+=_0x5c5609(0x110)+_0xfcc57),!_0x271854[_0x5c5609(0x171)]()[_0x5c5609(0xee)](_0x5c5609(0x16c))&&(_0x271854+=_0x5c5609(0xf8)+_0x1baec8[_0x5c5609(0x1bb)](',\x20')+_0x5c5609(0x1bc)),!_0x271854[_0x5c5609(0xee)]('conversation\x20rules\x20are')&&(_0x271854+='\x0a\x0aConversation\x20rules\x20are:\x0a\x20\x20\x20\x201.\x20When\x20sending\x20a\x20message\x20to\x20another\x20participant,\x20use\x20[message\x20to=\x22participant_id\x22]\x20format\x0a\x20\x20\x20\x202.\x20When\x20using\x20tools,\x20wrap\x20commands\x20in\x20[tools-commands]\x20and\x20[/tools-commands]\x20tags\x0a\x20\x20\x20\x203.\x20Each\x20tool\x20command\x20should\x20be\x20wrapped\x20in\x20[tool\x20id=\x22tool_id\x22]\x20and\x20[/tool]\x20tags\x0a\x20\x20\x20\x204.\x20You\x20must\x20follow\x20the\x20specific\x20format\x20for\x20each\x20tool\x20as\x20described\x20in\x20the\x20tools\x20section\x0a\x20\x20\x20\x205.\x20If\x20you\x20need\x20user\x20input\x20or\x20a\x20decision,\x20use\x20the\x20[prompt]\x20format(NOTICE:\x20at\x20least\x202\x20option\x20tags\x20are\x20recommended):\x20[prompt\x20name=\x22prompt\x20display\x20title\x22]the\x20message\x20the\x20user\x20will\x20see[option]option\x201\x20text[/option]\x20[option]option\x202\x20text[/option]...more\x20options\x20if\x20needed...[/prompt]\x0a\x20\x20\x20\x206.\x20when\x20you\x20have\x20finished\x20your\x20task\x20including\x20verification\x20and\x20validation\x20of\x20actual\x20content\x20as\x20written\x20on\x20disk\x20as\x20compareed\x20to\x20derived\x20specs,\x20or\x20you\x27re\x20not\x20getting\x20any\x20progress\x20use\x20the\x20[job-done]<your\x20message>[/job-done]\x20special\x20instruction\x20tag.\x20preferrably\x20in\x20its\x20own\x20message\x20(no\x20other\x20instructions).\x0a\x20\x20\x20\x207.\x20never\x20announce\x20job-done\x20before\x20you\x20have\x20completed\x20all\x20stages\x20of\x20the\x20development\x20process,\x20tested\x20and\x20re-validated\x20your\x20solution\x20by\x20observing\x20the\x20created\x20files\x20and\x20artifacts.\x0a\x20\x20\x20\x20Your\x20Project\x20Root\x20Directory\x20Is:\x20'+_0x44a74f+_0x5c5609(0x12f)),_0x271854;}[a0_0x2316bb(0x152)](_0x97868a){const _0x43745f=a0_0x2316bb;if(!_0x97868a||typeof _0x97868a!==_0x43745f(0x114))return _0x43745f(0x192)+Date['now']();let _0x35755a=_0x97868a['replace'](/\s+/g,'-')[_0x43745f(0x1a8)](/[^a-zA-Z0-9_-]/g,'')['replace'](/-+/g,'-')['replace'](/^-+|-+$/g,'')['toLowerCase']();if(!_0x35755a)_0x35755a='conversation-'+Date['now']();else _0x35755a['length']>0x32&&(_0x35755a=_0x35755a[_0x43745f(0x19c)](0x0,0x28)+'-'+Date[_0x43745f(0x16a)]()['toString']()['slice'](-0x8));return _0x35755a;}[a0_0x2316bb(0x166)](_0x232c80){const _0x58a8c7=a0_0x2316bb;if(this['conversationIdMapping']['has'](_0x232c80))return this[_0x58a8c7(0xe5)]['get'](_0x232c80);const _0x33b982=this['_sanitizeConversationIdForFile'](_0x232c80);return this[_0x58a8c7(0xe5)][_0x58a8c7(0x145)](_0x232c80,_0x33b982),_0x33b982!==_0x232c80&&this['logger'][_0x58a8c7(0x1a5)](_0x58a8c7(0xcd)+_0x232c80+'\x22\x20->\x20\x22'+_0x33b982+'\x22'),_0x33b982;}async['initializeServices'](){const _0x56812f=a0_0x2316bb;this[_0x56812f(0xc8)]&&this[_0x56812f(0x170)]&&(this['toolRegistry']['setLLMService'](this['llmService']),this[_0x56812f(0x188)]['info']('LLM\x20service\x20connected\x20to\x20tool\x20registry\x20for\x20vision\x20capabilities'));}async['getImageDescription'](_0x460996,_0x2956a1,_0x1b6f1f={}){const _0x12c8ce=a0_0x2316bb;if(!this[_0x12c8ce(0xc8)])throw new Error(_0x12c8ce(0xd1));return await this[_0x12c8ce(0xc8)][_0x12c8ce(0x133)](_0x460996,_0x2956a1,_0x1b6f1f);}async['handleUserPromptBasedOnMode'](_0x33914a,_0x367c4a){const _0xe0055b=a0_0x2316bb;this['logger']['info']('Handling\x20user\x20prompt:\x20'+_0x367c4a['name']+_0xe0055b(0x18b)+_0x33914a+'\x20(mode:\x20'+this[_0xe0055b(0x1d7)]+')');switch(this['interactionMode']){case _0xe0055b(0x11a):const _0x75b048=_0x367c4a[_0xe0055b(0x1a1)]&&_0x367c4a[_0xe0055b(0x1a1)][_0xe0055b(0x1cd)]>0x0?_0x367c4a[_0xe0055b(0x1a1)][0x0]:_0xe0055b(0x13a);this[_0xe0055b(0x188)]['info'](_0xe0055b(0xd4)+_0x75b048+_0xe0055b(0x139)+_0x367c4a['name']),await this[_0xe0055b(0x18d)](_0x33914a,'[System\x20Auto-Response]:\x20'+_0x75b048);break;case _0xe0055b(0x17d):if(this[_0xe0055b(0x1b5)]){const _0x585904=await this[_0xe0055b(0x1b5)](_0x367c4a[_0xe0055b(0x197)],_0x367c4a['text'],_0x367c4a['options']);await this['sendMessageToConversation'](_0x33914a,_0xe0055b(0x103)+_0x585904);}else await this[_0xe0055b(0x18d)](_0x33914a,_0xe0055b(0x1c9)+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');break;case _0xe0055b(0x138):default:if(this['onUserPrompt']){const _0x39c3e1=await this[_0xe0055b(0x1b5)](_0x367c4a['name'],_0x367c4a['text'],_0x367c4a[_0xe0055b(0x1a1)]);await this['sendMessageToConversation'](_0x33914a,_0xe0055b(0x103)+_0x39c3e1);}else await this['sendMessageToConversation'](_0x33914a,_0xe0055b(0x1c9)+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');break;}}async['handleJobDoneBasedOnMode'](_0x44b1a4){const _0x15fcfc=a0_0x2316bb;this[_0x15fcfc(0x188)]['info']('Job\x20done\x20received:\x20'+_0x44b1a4+_0x15fcfc(0xc6)+this['interactionMode']+')');if(this['onJobDone'])await this[_0x15fcfc(0x187)](_0x44b1a4);else switch(this['interactionMode']){case _0x15fcfc(0x11a):this[_0x15fcfc(0x188)]['info'](_0x44b1a4+'\x0aThank\x20you\x20for\x20choosing\x20Loxia.'),process['exit'](0x0);break;case'semi-auto':this[_0x15fcfc(0x188)]['info'](_0x15fcfc(0x16e)+_0x44b1a4),this[_0x15fcfc(0x188)]['info']('SEMI-AUTO\x20mode:\x20Task\x20completed.\x20Press\x20Ctrl+I\x20to\x20enter\x20interactive\x20mode\x20or\x20exit.');break;case'interactive':default:this['logger']['info']('Job\x20completed:\x20'+_0x44b1a4);break;}}[a0_0x2316bb(0x14b)](_0x75cdc){const _0x434b10=a0_0x2316bb;this[_0x434b10(0x187)]=_0x75cdc;}async['processAgentMessage'](_0x3f6bee,_0x34f890){const _0x5f3367=a0_0x2316bb;this['logger'][_0x5f3367(0x1a5)](_0x5f3367(0x13e)+_0x3f6bee);const _0x4d8edc=this[_0x5f3367(0x180)]['parseMessage'](_0x34f890);_0x4d8edc[_0x5f3367(0xd8)]&&_0x4d8edc['toolCommands'][_0x5f3367(0x1cd)]>0x0&&await this[_0x5f3367(0xe9)](_0x3f6bee,_0x4d8edc[_0x5f3367(0xd8)]);_0x4d8edc['prompt']&&await this['handleUserPromptBasedOnMode'](_0x3f6bee,_0x4d8edc['prompt']);if(_0x4d8edc['jobDone']!=null){await this[_0x5f3367(0x134)](_0x4d8edc[_0x5f3367(0x113)]);return;}if(_0x4d8edc['recipient']){const _0x2758e6=_0x4d8edc['recipient'],_0x26f82c=_0x4d8edc[_0x5f3367(0x190)];await this[_0x5f3367(0x1dc)](_0x3f6bee,_0x2758e6,_0x26f82c),this['logger'][_0x5f3367(0x1a5)]('['+displayOnly(_0x3f6bee,0xa)+_0x5f3367(0x12a)+displayOnly(_0x2758e6,0xa)+']:\x20'+displayOnly(_0x26f82c,0xff)+'\x0a');}!_0x4d8edc['recipient']&&(!_0x4d8edc[_0x5f3367(0xd8)]||_0x4d8edc['toolCommands'][_0x5f3367(0x1cd)]===0x0)&&!_0x4d8edc[_0x5f3367(0xff)]&&!_0x4d8edc[_0x5f3367(0x113)]&&await this['sendMessageToConversation'](_0x3f6bee,_0x5f3367(0x159)+'Please\x20use\x20[message\x20to=\x22...\x22]\x20tags\x20to\x20send\x20a\x20message\x20to\x20another\x20agent,\x20'+_0x5f3367(0x1d8));}[a0_0x2316bb(0x162)](_0xf08bb3){const _0x1b191d=a0_0x2316bb,_0xea6482=CONVERSATION_CONSTANTS['MAKER_AGENT_DEFAULT_ID'],_0x47cf2b='You\x20are\x20an\x20AI\x20assistant\x20tasked\x20with\x20completing\x20the\x20following:\x20';try{const _0xb92d68=TagParser['extractStructured'](_0xf08bb3,{'role':_0x1b191d(0x142),'systemPrompt':_0x1b191d(0xc9)});let _0x1e65c8=_0xb92d68[_0x1b191d(0x173)];_0x1e65c8?_0x1e65c8=_0x1e65c8['replace'](/[\\/]/g,''):(_0x1e65c8=_0xea6482,this['logger']['warn']('Failed to parse role from prompt engineer response, using default'));let _0x3aac28=_0xb92d68['systemPrompt'];return!_0x3aac28&&(_0x3aac28=''+_0x47cf2b+_0xf08bb3,this['logger'][_0x1b191d(0x1ce)]('Failed to parse system prompt from prompt engineer response, using generated one')),{'role':_0x1e65c8,'systemPrompt':_0x3aac28};}catch(_0x2fb80f){return this['logger'][_0x1b191d(0x1d5)](_0x1b191d(0x121),_0x2fb80f),{'role':_0xea6482,'systemPrompt':''+_0x47cf2b+_0xf08bb3};}}async[a0_0x2316bb(0xfd)](_0x53be7a,_0x2a6628,_0x43ba5c,_0x279834){const _0x42ae81=a0_0x2316bb;this['logger']['info']('Starting\x20new\x20conversation\x20for\x20task:\x20'+_0x53be7a),this['sessionState']['projectDir']=_0x2a6628;const _0x50941f=a0_0x14f7dd['join'](_0x2a6628,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x58bc73['mkdir'](_0x50941f,{'recursive':!![]}),this[_0x42ae81(0xc7)]={'projectDir':_0x2a6628,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{},'paused':![]};try{const _0x196234=this[_0x42ae81(0x1b4)](this[_0x42ae81(0x170)]['getToolsDescription']()),_0x439641=CONVERSATION_CONSTANTS['PROMPT_ENGINEER_ID'];await this['createConversation'](_0x439641,_0x196234,[],_0x43ba5c);const _0x17e93c=this[_0x42ae81(0x1a6)](_0x53be7a),_0xd8e73e=await this['sendMessageToConversation'](_0x439641,_0x17e93c),{role:_0x1506a2,systemPrompt:_0x25fb87}=this[_0x42ae81(0x162)](_0xd8e73e),_0x5f524f=_0x1506a2||CONVERSATION_CONSTANTS[_0x42ae81(0xdd)];this[_0x42ae81(0xc7)]['makerAgentId']=_0x5f524f;const _0x5d09cc=this['enhanceSystemPrompt'](_0x25fb87,this['toolRegistry'][_0x42ae81(0x13f)](),this[_0x42ae81(0xc7)][_0x42ae81(0x157)],[CONVERSATION_CONSTANTS[_0x42ae81(0x148)]]);await this[_0x42ae81(0x181)](_0x5f524f,_0x5d09cc,[],_0x43ba5c);const _0x5af359=CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'];this['sessionState']['languageModelAgentId']=_0x5af359;const _0x5d0e8c=this['getLanguageModelSystemPrompt'](this['toolRegistry']['getToolsDescription'](),_0x5f524f);await this[_0x42ae81(0x181)](_0x5af359,_0x5d0e8c,[],_0x43ba5c),this['sessionState'][_0x42ae81(0x11e)]=[_0x5f524f,_0x5af359],await this[_0x42ae81(0x15a)](),await this[_0x42ae81(0x18d)](_0x5f524f,'begin'),this['logger']['info'](_0x42ae81(0x109));}catch(_0x4eed3f){this['logger'][_0x42ae81(0x1d5)](_0x42ae81(0x16d),_0x4eed3f);throw _0x4eed3f;}}async[a0_0x2316bb(0x135)](_0x246ca5,_0x1ee18a){const _0x8bcca1=a0_0x2316bb,_0x7a473e=this[_0x8bcca1(0x166)](_0x1ee18a),_0x8af2d5=a0_0x14f7dd['join'](_0x246ca5,''+_0x7a473e+CONVERSATION_CONSTANTS['HISTORY_SUFFIX']);try{const _0x47b004=await a0_0x58bc73[_0x8bcca1(0x172)](_0x8af2d5,_0x8bcca1(0x1ac)),_0x152e0a=JSON[_0x8bcca1(0x11f)](_0x47b004),_0x4bc912=(_0x152e0a[_0x8bcca1(0x1d1)]||[])[_0x8bcca1(0x10f)](_0x34a266=>_0x34a266['role']!=='system');await this[_0x8bcca1(0x181)](_0x1ee18a,_0x152e0a[_0x8bcca1(0x189)]||_0x8bcca1(0x158),_0x4bc912),this['logger']['info'](_0x8bcca1(0x1d2)+_0x1ee18a+'\x20(file:\x20'+_0x7a473e+')');}catch(_0x16cb99){this['logger']['warn']('Failed\x20to\x20load\x20conversation\x20history\x20for\x20'+_0x1ee18a+':\x20'+_0x16cb99['message']),await this[_0x8bcca1(0xe2)](_0x246ca5,_0x1ee18a);}}async[a0_0x2316bb(0xe2)](_0x4e0bdd,_0x49e89b){const _0x8acfb3=a0_0x2316bb;try{const _0x593fe1=await a0_0x58bc73[_0x8acfb3(0x104)](_0x4e0bdd),_0x5f1c9b=_0x593fe1['filter'](_0x592126=>_0x592126['endsWith'](CONVERSATION_CONSTANTS[_0x8acfb3(0x19a)])),_0x87efe=this['_getFileSafeConversationId'](_0x49e89b);for(const _0x112cce of _0x5f1c9b){const _0x58f12b=_0x112cce['replace'](CONVERSATION_CONSTANTS[_0x8acfb3(0x19a)],'');if(_0x58f12b===_0x87efe||_0x58f12b[_0x8acfb3(0xee)](_0x87efe)||_0x87efe['includes'](_0x58f12b))try{const _0x5ad137=a0_0x14f7dd[_0x8acfb3(0x1bb)](_0x4e0bdd,_0x112cce),_0x153a9a=await a0_0x58bc73['readFile'](_0x5ad137,'utf-8'),_0x366ef7=JSON[_0x8acfb3(0x11f)](_0x153a9a),_0x4d7eed=(_0x366ef7[_0x8acfb3(0x1d1)]||[])[_0x8acfb3(0x10f)](_0x49e82f=>_0x49e82f['role']!=='system');await this['createConversation'](_0x49e89b,_0x366ef7[_0x8acfb3(0x189)]||'Conversation\x20resumed',_0x4d7eed),this[_0x8acfb3(0x188)]['info'](_0x8acfb3(0xfe)+_0x49e89b+'\x20from\x20file\x20'+_0x112cce);return;}catch(_0x2718e2){this['logger'][_0x8acfb3(0x185)]('Could\x20not\x20read/parse\x20'+_0x112cce+':',_0x2718e2);}}this['logger']['warn'](_0x8acfb3(0x17f)+_0x49e89b+_0x8acfb3(0x19d)),await this[_0x8acfb3(0x181)](_0x49e89b,'Conversation\x20resumed\x20without\x20history.');}catch(_0xfb62fa){this['logger'][_0x8acfb3(0x1d5)]('Error\x20searching\x20for\x20conversation\x20history:\x20'+_0xfb62fa[_0x8acfb3(0x140)]),await this[_0x8acfb3(0x181)](_0x49e89b,_0x8acfb3(0x16f));}}async['saveConversationHistory'](_0x31d929){const _0x579e4b=a0_0x2316bb;if(!this['sessionState']['projectDir'])return;const _0x39379f=this[_0x579e4b(0x125)]['get'](_0x31d929);if(!_0x39379f)return;const _0xf139b2=a0_0x14f7dd['join'](this[_0x579e4b(0xc7)]['projectDir'],CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x58bc73[_0x579e4b(0x168)](_0xf139b2,{'recursive':!![]});const _0x5d4cee={'id':_0x31d929,'originalId':_0x31d929,'systemPrompt':_0x39379f[_0x579e4b(0x189)],'messages':_0x39379f[_0x579e4b(0x1d1)],'contextWindow':_0x39379f[_0x579e4b(0x108)],'lastUpdated':new Date()['toISOString']()},_0x24926b=this['_getFileSafeConversationId'](_0x31d929),_0x332060=a0_0x14f7dd['join'](_0xf139b2,''+_0x24926b+CONVERSATION_CONSTANTS['HISTORY_SUFFIX']);await a0_0x58bc73['writeFile'](_0x332060,JSON['stringify'](_0x5d4cee,null,0x2),'utf-8'),this['logger']['info']('Conversation\x20history\x20saved\x20for\x20'+_0x31d929+_0x579e4b(0x146)+_0x24926b+')');}[a0_0x2316bb(0x14a)](_0xd69e2d,_0x1926ba){const _0x385acc=a0_0x2316bb;this['saveSessionState']()['catch'](_0x36343b=>{const _0x44020=a0_0x5c5d;this[_0x44020(0x188)]['error'](_0x44020(0x1c1),_0x36343b);}),this['logger']['error'](_0x385acc(0xd7)+_0xd69e2d+':',_0x1926ba),console[_0x385acc(0x143)]('\x0a'+a0_0x45841f['red'](_0x385acc(0xe7))),console[_0x385acc(0x143)](a0_0x45841f[_0x385acc(0x182)]('‚îÅ'['repeat'](0x3c))),console[_0x385acc(0x143)](a0_0x45841f['red']('‚úó\x20Failed\x20to\x20create\x20conversation\x20summary')),console[_0x385acc(0x143)](a0_0x45841f['gray']('\x20\x20This\x20can\x20happen\x20when\x20the\x20conversation\x20becomes\x20too\x20large')),console[_0x385acc(0x143)](a0_0x45841f[_0x385acc(0x199)](_0x385acc(0x1a7))),console[_0x385acc(0x143)](''),console[_0x385acc(0x143)](a0_0x45841f['bold'][_0x385acc(0xdc)]('üîÑ\x20TO\x20CONTINUE\x20YOUR\x20WORK:')),console['log'](a0_0x45841f[_0x385acc(0x198)]('\x20\x201.\x20Use\x20the\x20resume\x20command\x20to\x20continue\x20this\x20conversation:')),console[_0x385acc(0x143)](a0_0x45841f[_0x385acc(0xdc)]('\x20\x20\x20\x20\x20loxia\x20resume\x20./your-project-directory')),console[_0x385acc(0x143)](''),console['log'](a0_0x45841f[_0x385acc(0x198)]('\x20\x202.\x20Or\x20start\x20a\x20new\x20session\x20asking\x20the\x20agent\x20to\x20continue:')),console['log'](a0_0x45841f[_0x385acc(0xdc)]('\x20\x20\x20\x20\x20loxia\x20do\x20\x22continue\x20the\x20previous\x20work\x20in\x20this\x20directory\x22')),console[_0x385acc(0x143)](''),console['log'](a0_0x45841f[_0x385acc(0x198)]('\x20\x203.\x20Or\x20modify\x20existing\x20content:')),console[_0x385acc(0x143)](a0_0x45841f[_0x385acc(0xdc)](_0x385acc(0x129))),console[_0x385acc(0x143)](''),console[_0x385acc(0x143)](a0_0x45841f['gray'](_0x385acc(0x1b6))),console['log'](a0_0x45841f['yellow']('‚îÅ'['repeat'](0x3c))),this[_0x385acc(0x188)][_0x385acc(0x1d5)](_0x385acc(0x1c3),{'conversationId':_0xd69e2d,'error':_0x1926ba[_0x385acc(0x140)],'errorType':_0x1926ba['errorType']||'unknown','originalError':_0x1926ba['originalError']||null});const _0x4cbaba=new Error(_0x385acc(0xed)+_0x385acc(0x1d6));_0x4cbaba['isUserFriendly']=!![],_0x4cbaba['originalError']=_0x1926ba;throw _0x4cbaba;}async['saveSessionState'](){const _0x2ae373=a0_0x2316bb;if(!this['sessionState']['projectDir']){this[_0x2ae373(0x188)][_0x2ae373(0x1ce)](_0x2ae373(0x1bd));return;}try{const _0x513618=a0_0x14f7dd['join'](this['sessionState'][_0x2ae373(0x157)],CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x58bc73[_0x2ae373(0x168)](_0x513618,{'recursive':!![]}),this[_0x2ae373(0x188)][_0x2ae373(0x185)]('State\x20directory\x20created/verified:\x20'+_0x513618);const _0x2090bd=a0_0x14f7dd[_0x2ae373(0x1bb)](_0x513618,CONVERSATION_CONSTANTS[_0x2ae373(0x15b)]),_0x3f91b6={'projectDir':this[_0x2ae373(0xc7)]['projectDir'],'makerAgentId':this['sessionState']['makerAgentId'],'languageModelAgentId':this[_0x2ae373(0xc7)][_0x2ae373(0x111)],'activeConversationIds':this[_0x2ae373(0xc7)]['activeConversationIds']||[],'conversationHistory':this[_0x2ae373(0xc7)]['conversationHistory']||{},'conversationIdMapping':Object[_0x2ae373(0x1d0)](this['conversationIdMapping']),'paused':this[_0x2ae373(0xc7)][_0x2ae373(0x165)]||![],'lastUpdated':new Date()[_0x2ae373(0x175)](),'version':_0x2ae373(0x11c)};await a0_0x58bc73[_0x2ae373(0xe0)](_0x2090bd,JSON[_0x2ae373(0xde)](_0x3f91b6,null,0x2),'utf-8'),this[_0x2ae373(0x188)][_0x2ae373(0x185)](_0x2ae373(0xdf)+_0x2090bd);const _0x4a58cc=a0_0x14f7dd[_0x2ae373(0x1bb)](_0x513618,CONVERSATION_CONSTANTS[_0x2ae373(0x1c8)]),_0x1e66c6={'projectDir':this['sessionState'][_0x2ae373(0x157)],'lastUpdated':new Date()['toISOString'](),'makerAgentId':this[_0x2ae373(0xc7)]['makerAgentId'],'languageModelAgentId':this[_0x2ae373(0xc7)]['languageModelAgentId'],'activeConversationIds':this['sessionState'][_0x2ae373(0x11e)]||[],'conversationIdMapping':Object['fromEntries'](this[_0x2ae373(0xe5)]),'sessionStateFile':CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME'],'version':'1.0.0'};await a0_0x58bc73[_0x2ae373(0xe0)](_0x4a58cc,JSON['stringify'](_0x1e66c6,null,0x2),'utf-8'),this['logger'][_0x2ae373(0x185)]('Index\x20file\x20saved\x20to:\x20'+_0x4a58cc);const _0x7d0c63=a0_0x14f7dd['join'](_0x513618,CONVERSATION_CONSTANTS['LAST_SESSION_FILENAME']),_0x11ffb3={'projectDir':this[_0x2ae373(0xc7)][_0x2ae373(0x157)],'timestamp':new Date()[_0x2ae373(0x175)](),'makerAgentId':this[_0x2ae373(0xc7)]['makerAgentId'],'languageModelAgentId':this['sessionState']['languageModelAgentId'],'conversationIdMapping':Object[_0x2ae373(0x1d0)](this[_0x2ae373(0xe5)]),'version':'1.0.0'};await a0_0x58bc73[_0x2ae373(0xe0)](_0x7d0c63,JSON[_0x2ae373(0xde)](_0x11ffb3,null,0x2),_0x2ae373(0x1ac)),this['logger'][_0x2ae373(0x185)]('Last\x20session\x20file\x20saved\x20to:\x20'+_0x7d0c63),this[_0x2ae373(0x188)]['info'](_0x2ae373(0x18c));}catch(_0x4ca9a3){this['logger']['error'](_0x2ae373(0x1c1),_0x4ca9a3);throw new Error('Failed\x20to\x20save\x20session\x20state:\x20'+_0x4ca9a3[_0x2ae373(0x140)]);}}async['resumeConversation'](_0x2bbc41){const _0x4a603a=a0_0x2316bb;this[_0x4a603a(0x188)]['info']('Resuming\x20conversation\x20from:\x20'+_0x2bbc41);try{const _0x7c5069=a0_0x14f7dd['join'](_0x2bbc41,CONVERSATION_CONSTANTS[_0x4a603a(0x12d)]);try{await a0_0x58bc73[_0x4a603a(0x184)](_0x7c5069);}catch(_0x486b92){throw new Error('State\x20directory\x20not\x20found:\x20'+_0x7c5069+'.\x20This\x20may\x20not\x20be\x20a\x20valid\x20Loxia\x20project.');}const _0x5de02c=a0_0x14f7dd['join'](_0x7c5069,CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME']);let _0xcb114a;try{const _0x5eb0c9=await a0_0x58bc73[_0x4a603a(0x172)](_0x5de02c,'utf-8');_0xcb114a=JSON[_0x4a603a(0x11f)](_0x5eb0c9),_0xcb114a[_0x4a603a(0xe5)]&&(this['conversationIdMapping']=new Map(Object['entries'](_0xcb114a['conversationIdMapping'])),this['logger']['info']('Restored\x20'+this[_0x4a603a(0xe5)][_0x4a603a(0x116)]+'\x20conversation\x20ID\x20mappings'));}catch(_0x2015a7){this['logger']['warn']('Could\x20not\x20read\x20session\x20state\x20file:\x20'+_0x2015a7['message']);const _0x3d9ac0=a0_0x14f7dd[_0x4a603a(0x1bb)](_0x7c5069,CONVERSATION_CONSTANTS[_0x4a603a(0x1c8)]);try{const _0x4a1bab=await a0_0x58bc73[_0x4a603a(0x172)](_0x3d9ac0,_0x4a603a(0x1ac)),_0x50407b=JSON[_0x4a603a(0x11f)](_0x4a1bab);_0xcb114a={'projectDir':_0x50407b['projectDir']||_0x2bbc41,'makerAgentId':_0x50407b['makerAgentId'],'languageModelAgentId':_0x50407b[_0x4a603a(0x111)],'activeConversationIds':_0x50407b['activeConversationIds']||[],'conversationHistory':{},'conversationIdMapping':_0x50407b['conversationIdMapping']||{}},_0x50407b['conversationIdMapping']&&(this['conversationIdMapping']=new Map(Object['entries'](_0x50407b[_0x4a603a(0xe5)]))),this['logger'][_0x4a603a(0x1a5)]('Recovered session state from index file');}catch(_0x314992){throw new Error('Could\x20not\x20read\x20session\x20state\x20or\x20index\x20file:\x20'+_0x2015a7[_0x4a603a(0x140)]);}}this[_0x4a603a(0xc7)]={..._0xcb114a,'projectDir':_0x2bbc41};const _0x5c1bc0=this[_0x4a603a(0xc7)]['activeConversationIds']||[];for(const _0x44f8f1 of _0x5c1bc0){try{await this[_0x4a603a(0x135)](_0x7c5069,_0x44f8f1);}catch(_0x1d02a1){this['logger'][_0x4a603a(0x1ce)]('Could\x20not\x20load\x20conversation\x20history\x20for\x20'+_0x44f8f1+':\x20'+_0x1d02a1[_0x4a603a(0x140)]),await this[_0x4a603a(0x181)](_0x44f8f1,_0x4a603a(0x16f));}}this[_0x4a603a(0x188)]['info'](_0x4a603a(0xfb)+_0x5c1bc0[_0x4a603a(0x1cd)]);}catch(_0x4b3c36){this[_0x4a603a(0x188)]['error'](_0x4a603a(0x176),_0x4b3c36);throw new Error(_0x4a603a(0x123)+_0x4b3c36['message']);}}async[a0_0x2316bb(0x17e)](_0x457ab0,_0x31f686){const _0x57097e=a0_0x2316bb;this[_0x57097e(0x188)][_0x57097e(0x1a5)]('Modifying\x20content\x20in:\x20'+_0x457ab0+_0x57097e(0x169)+_0x31f686),this[_0x57097e(0xc7)][_0x57097e(0x157)]=_0x457ab0;const _0x47b2a0=a0_0x14f7dd['join'](_0x457ab0,CONVERSATION_CONSTANTS[_0x57097e(0x12d)]);await a0_0x58bc73['mkdir'](_0x47b2a0,{'recursive':!![]});const _0xc4e513=this['getPromptEngineerSystemPrompt'](this['toolRegistry']['getToolsDescription'](),!![]),_0xfa90d8=CONVERSATION_CONSTANTS[_0x57097e(0x179)];await this['createConversation'](_0xfa90d8,_0xc4e513);const _0x85ae3a=this[_0x57097e(0x1a6)](_0x31f686,_0x457ab0,!![]),_0x334b90=await this['sendMessageToConversation'](_0xfa90d8,_0x85ae3a),{role:_0x18aae5,systemPrompt:_0x2bd5fb}=this[_0x57097e(0x162)](_0x334b90),_0x41acb3=_0x18aae5||_0x57097e(0x105);this['sessionState'][_0x57097e(0x118)]=_0x41acb3;const _0x3357c3=this['enhanceSystemPrompt'](_0x2bd5fb,this['toolRegistry'][_0x57097e(0x13f)](),this['sessionState']['projectDir'],[CONVERSATION_CONSTANTS[_0x57097e(0x148)]]);await this['createConversation'](_0x41acb3,_0x3357c3);const _0x30c8a4=CONVERSATION_CONSTANTS[_0x57097e(0x148)];this[_0x57097e(0xc7)]['languageModelAgentId']=_0x30c8a4;const _0x1aa4fd=this['getLanguageModelSystemPrompt'](this[_0x57097e(0x170)]['getToolsDescription'](),_0x41acb3);await this['createConversation'](_0x30c8a4,_0x1aa4fd),this[_0x57097e(0xc7)][_0x57097e(0x11e)]=[_0x41acb3,_0x30c8a4],await this[_0x57097e(0x18d)](_0x41acb3,_0x57097e(0xf1)+_0x457ab0),await this[_0x57097e(0x15a)]();}async['handleUserPrompt'](_0x2056ab,_0x1f53b3){const _0x152997=a0_0x2316bb;this['logger']['info'](_0x152997(0x1c4)+_0x1f53b3['name']+'\x20from\x20'+_0x2056ab);if(this[_0x152997(0x1b5)]){const _0x4a499d=await this['onUserPrompt'](_0x1f53b3[_0x152997(0x197)],_0x1f53b3['text'],_0x1f53b3['options']);await this[_0x152997(0x18d)](_0x2056ab,_0x152997(0x103)+_0x4a499d);}else await this['sendMessageToConversation'](_0x2056ab,'Cannot\x20display\x20prompt\x20to\x20user:\x20No\x20prompt\x20handler\x20is\x20registered.\x20'+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');}async['handlePromptTooLong'](_0x387cc0){const _0x4df584=a0_0x2316bb;this['logger'][_0x4df584(0x1ce)](_0x4df584(0x193)),await this['performCompactization'](_0x387cc0);}async[a0_0x2316bb(0x18d)](_0x262473,_0x228427){const _0x352950=a0_0x2316bb;if(this[_0x352950(0x1b8)](_0x262473,_0x228427))return this['logger'][_0x352950(0x1a5)]('üö´\x20Blocking\x20message\x20in\x20interactive\x20mode:\x20'+displayOnly(_0x228427,0x64)),this['blockedMessages']['push']({'conversationId':_0x262473,'message':_0x228427,'timestamp':Date['now']()}),_0x352950(0xce);const _0x429831=_0x262473===CONVERSATION_CONSTANTS[_0x352950(0x148)],_0x305ccc=_0x429831?_0x352950(0xf7):'waiting-for-agent';!this['isWaitingForUserInput']&&this[_0x352950(0x122)](_0x305ccc);this['logger']['info'](_0x352950(0x151)+_0x262473+':\x0a'+displayOnly(_0x228427,0xff));if(!this[_0x352950(0x125)][_0x352950(0x1d9)](_0x262473)){!this[_0x352950(0x1be)]&&this['updateMessageIndicator']('idle');throw new Error('Conversation\x20'+_0x262473+_0x352950(0x15e));}try{const _0x10e76a=this[_0x352950(0x125)]['get'](_0x262473),_0x5ea964={'systemPrompt':_0x10e76a[_0x352950(0x189)],'messages':_0x10e76a[_0x352950(0x1d1)],'id':_0x262473,'contextWindow':_0x10e76a['contextWindow']},_0x5f4225=await this[_0x352950(0xc8)][_0x352950(0x13d)](_0x262473,_0x228427,_0x5ea964);return await this[_0x352950(0x1d3)](_0x262473),await this[_0x352950(0xf9)](_0x262473),this['sessionState']['activeConversationIds'][_0x352950(0xee)](_0x262473)&&await this['processAgentMessage'](_0x262473,_0x5f4225),!this['isWaitingForUserInput']&&this[_0x352950(0x122)](_0x352950(0x13c)),_0x5f4225;}catch(_0x1605ef){!this[_0x352950(0x1be)]&&this[_0x352950(0x122)]('idle');throw _0x1605ef;}}async[a0_0x2316bb(0x181)](_0x3032e7,_0x582532,_0x5dbcb7=[],_0x576a86=null){const _0x1bea94=a0_0x2316bb;this[_0x1bea94(0x188)]['info']('Creating\x20conversation:\x20'+_0x3032e7),this['originalSystemPrompts'][_0x1bea94(0x145)](_0x3032e7,_0x582532);const _0x4c5a83=this[_0x1bea94(0x1d7)]==='auto'?this['removePromptSyntaxFromSystemPrompt'](_0x582532):_0x582532;let _0x26f65a=[];_0x5dbcb7['length']>0x0&&(_0x26f65a=_0x5dbcb7[_0x1bea94(0x10f)](_0x4eb6d5=>_0x4eb6d5['role']!==_0x1bea94(0x124)));const _0x3df0c1={'id':_0x3032e7,'systemPrompt':_0x4c5a83,'messages':_0x26f65a,'contextWindow':this['getContextWindowSize'](_0x3032e7)};this[_0x1bea94(0x125)]['set'](_0x3032e7,_0x3df0c1),await this['llmService'][_0x1bea94(0x144)](_0x3032e7,_0x4c5a83,_0x576a86),_0x26f65a[_0x1bea94(0x1cd)]>0x0&&await this[_0x1bea94(0xc8)]['updateConversation'](_0x3032e7,_0x3df0c1),this['sessionState']['conversationHistory'][_0x3032e7]={'systemPrompt':_0x4c5a83,'lastUpdateTime':new Date()['toISOString']()},await this[_0x1bea94(0xf9)](_0x3032e7);}['getListOfAvailableAgentIds'](_0xf2415a){const _0x30af27=a0_0x2316bb,_0x3f404c=Array[_0x30af27(0xdb)](this['conversations']['keys']())['filter'](_0x1a260e=>_0x1a260e!==_0xf2415a);return _0x3f404c;}async[a0_0x2316bb(0x1dc)](_0x363350,_0x3393a0,_0x498e75){const _0x5b4c4d=a0_0x2316bb;this[_0x5b4c4d(0x188)][_0x5b4c4d(0x1a5)](_0x5b4c4d(0x10a)+_0x363350+_0x5b4c4d(0x15c)+_0x3393a0);if(!this[_0x5b4c4d(0x125)][_0x5b4c4d(0x1d9)](_0x3393a0)){const _0x2be88a='Agent\x20'+_0x3393a0+'\x20does\x20not\x20exist,\x20cannot\x20route\x20message.\x20Available\x20agents\x20are:\x20'+this['getListOfAvailableAgentIds'](_0x363350)[_0x5b4c4d(0x1bb)](',\x20')+'.\x20if\x20you\x20wish\x20to\x20send\x20a\x20message\x20to\x20the\x20user\x20who\x20requested\x20this\x20task\x20use\x20the\x20[prompt]\x20tool\x20syntax';this['logger'][_0x5b4c4d(0x1ce)](_0x2be88a),await this[_0x5b4c4d(0x18d)](_0x363350,_0x2be88a);return;}const _0xa88d40='[From\x20'+_0x363350+']:\x20'+_0x498e75;await this['sendMessageToConversation'](_0x3393a0,_0xa88d40);}async[a0_0x2316bb(0x1dc)](_0x37b82e,_0x1fe1be,_0x34d4b3){const _0x5cd0e2=a0_0x2316bb;this['logger']['info'](_0x5cd0e2(0x10a)+_0x37b82e+'\x20to\x20'+_0x1fe1be);if(!this[_0x5cd0e2(0x125)]['has'](_0x1fe1be)){this['logger']['warn'](_0x5cd0e2(0x11d)+_0x1fe1be+'\x20does\x20not\x20exist,\x20cannot\x20route\x20message'),await this[_0x5cd0e2(0x18d)](_0x37b82e,'Cannot\x20send\x20message\x20to\x20'+_0x1fe1be+_0x5cd0e2(0x1b1));return;}const _0x5826eb='[From\x20'+_0x37b82e+']:\x20'+_0x34d4b3;await this[_0x5cd0e2(0x18d)](_0x1fe1be,_0x5826eb);}async['checkToolExecutionStatus'](){const _0x587532=a0_0x2316bb;for(const [_0x54a70c,_0x45a53f]of this[_0x587532(0xfc)][_0x587532(0x137)]()){const _0x39c490=Date[_0x587532(0x16a)]()-_0x45a53f[_0x587532(0x11b)];_0x39c490>CONVERSATION_CONSTANTS['TOOL_STATUS_UPDATE_INTERVAL_MS']&&(await this['sendMessageToConversation'](_0x45a53f[_0x587532(0xd6)],_0x587532(0x1c2)+_0x45a53f[_0x587532(0x1a3)]+_0x587532(0xef)+Math[_0x587532(0x12c)](_0x39c490/0x3e8)+_0x587532(0xd9)+_0x54a70c),_0x45a53f[_0x587532(0x11b)]=Date['now']());}}[a0_0x2316bb(0x10e)](_0x170180){const _0x51e38e=a0_0x2316bb;this[_0x51e38e(0x1b5)]=_0x170180;}async['sendUserInput'](_0x8244b2){const _0x31e779=a0_0x2316bb;this[_0x31e779(0x188)]['info']('Received\x20user\x20input:\x20'+_0x8244b2),this[_0x31e779(0x127)](![]),this['sessionState']['makerAgentId']?await this['sendMessageToConversation'](this['sessionState']['makerAgentId'],_0x31e779(0xfa)+_0x8244b2):this[_0x31e779(0x188)][_0x31e779(0x1ce)](_0x31e779(0x16b));}async['checkAndPerformCompactization'](_0x1ac361){const _0x114693=a0_0x2316bb,_0x4e5c56=this['conversations']['get'](_0x1ac361);if(!_0x4e5c56)return;const _0x1f0c05=await this['llmService'][_0x114693(0xe6)](_0x1ac361),_0x3270d6=_0x4e5c56['contextWindow'];_0x1f0c05>_0x3270d6*CONVERSATION_CONSTANTS['COMPACTIZATION_THRESHOLD_PERCENTAGE']&&(this['logger'][_0x114693(0x1a5)]('Performing\x20compactization\x20for\x20conversation\x20'+_0x1ac361),await this['performCompactization'](_0x1ac361));}async['performCompactization'](_0x38e4b8){const _0x2f6cc6=a0_0x2316bb,_0xefe244=this['conversations']['get'](_0x38e4b8);if(!_0xefe244||_0xefe244[_0x2f6cc6(0x1d1)][_0x2f6cc6(0x1cd)]<0x4)return;const _0x2f4e37=CONVERSATION_CONSTANTS['MIN_MESSAGES_TO_KEEP'],_0x3df980=_0xefe244['messages'][_0x2f6cc6(0x14c)](0x0,_0x2f4e37),_0x2500ae=_0xefe244[_0x2f6cc6(0x108)],_0x30b525=Math['floor'](_0x2500ae*CONVERSATION_CONSTANTS['COMPACTIZATION_OUTPUT_RESERVE_PERCENTAGE']),_0x290ed1=_0x2500ae-_0x30b525,_0x71e468=CONVERSATION_CONSTANTS['COMPACTIZATION_BEGIN_PERCENTAGE'],_0x47d5c5=CONVERSATION_CONSTANTS[_0x2f6cc6(0x163)],_0x5a78a2=Math[_0x2f6cc6(0x167)](_0x2f4e37,Math[_0x2f6cc6(0x12c)](_0xefe244['messages']['length']*_0x71e468)),_0x265305=Math['min'](_0xefe244[_0x2f6cc6(0x1d1)]['length']-_0x5a78a2,Math['floor'](_0xefe244['messages']['length']*_0x47d5c5)),_0x184443=_0xefe244[_0x2f6cc6(0x1d1)]['slice'](0x0,_0x5a78a2),_0xfc1114=_0xefe244[_0x2f6cc6(0x1d1)]['slice'](-_0x265305),_0x1922cc=_0xefe244[_0x2f6cc6(0x1d1)]['slice'](_0x5a78a2,_0xefe244[_0x2f6cc6(0x1d1)][_0x2f6cc6(0x1cd)]-_0x265305);if(_0x1922cc[_0x2f6cc6(0x1cd)]===0x0)return;const _0x11c7ed=this['createSummaryPrompt'](_0x1922cc);this['logger']['info'](_0x2f6cc6(0x178)+_0x5a78a2+_0x2f6cc6(0x1bf)+_0x1922cc['length']+_0x2f6cc6(0x186)+_0x265305+'\x20end\x20messages');try{const _0x1d5618=await this['llmService']['getSummary'](_0x38e4b8,_0x11c7ed),_0x1ebc7b={'role':CONVERSATION_CONSTANTS['SYSTEM_MESSAGE_ROLE'],'content':CONVERSATION_CONSTANTS[_0x2f6cc6(0xd3)]+'\x0a'+_0x1d5618+'\x0a'+CONVERSATION_CONSTANTS['SUMMARY_MARKER_END']};_0xefe244['messages']=[..._0x184443,_0x1ebc7b,..._0xfc1114],await this[_0x2f6cc6(0xc8)][_0x2f6cc6(0x1a2)](_0x38e4b8,_0xefe244),this[_0x2f6cc6(0x188)][_0x2f6cc6(0x1a5)]('Compactization\x20completed\x20for\x20'+_0x38e4b8+_0x2f6cc6(0xf5)+(_0x5a78a2+_0x1922cc[_0x2f6cc6(0x1cd)]+_0x265305)+_0x2f6cc6(0x15c)+(_0x184443['length']+0x1+_0xfc1114[_0x2f6cc6(0x1cd)]));}catch(_0x5dd59c){this[_0x2f6cc6(0x188)]['error']('Critical\x20compactization\x20failure:',_0x5dd59c),this['_handleSummaryFailure'](_0x38e4b8,_0x5dd59c);}}[a0_0x2316bb(0x14e)](_0x4cffa7){const _0x383fa4=a0_0x2316bb;return _0x383fa4(0x1ae)+_0x4cffa7[_0x383fa4(0xe4)](_0x2413ee=>_0x2413ee[_0x383fa4(0x173)]+':\x20'+_0x2413ee[_0x383fa4(0x190)])['join']('\x0a\x0a')+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Provide\x20the\x20replacement\x20text.';}['getContextWindowSize'](_0x5c2624){const _0x23f152=a0_0x2316bb,_0x2c8038=this[_0x23f152(0x112)]['models']?.['default']?.[_0x23f152(0x108)]||CONVERSATION_CONSTANTS['DEFAULT_CONTEXT_WINDOW_SIZE'];if(_0x5c2624===CONVERSATION_CONSTANTS[_0x23f152(0x148)])return this['config'][_0x23f152(0x153)]?.['languageModel']?.[_0x23f152(0x108)]||_0x2c8038;return _0x2c8038;}['getPromptEngineerSystemPrompt'](_0x5021ec,_0x592cab=![]){const _0x158ed6=a0_0x2316bb,_0x28d52c=_0x592cab?'modifying\x20existing\x20content':_0x158ed6(0x1b7);return'\x0a\x20\x20\x20\x20You\x20are\x20a\x20prompt\x20engineering\x20expert\x20who\x20designs\x20effective\x20system\x20prompts\x20for\x20AI\x20agents.\x0a\x20\x20\x20\x20We\x20are\x20about\x20to\x20assign\x20the\x20responsibility\x20for\x20'+_0x28d52c+'\x20to\x20an\x20AI\x20agent.\x20\x0a\x20\x20\x20\x20For\x20that\x20we\x20need\x20to\x20write\x20a\x20comprehensive\x20SYSTEM\x20prompt\x20that\x20will\x20help\x20the\x20agent\x20make\x20smart\x20decisions.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20The\x20agent\x20will\x20need\x20to\x20know\x20the\x20task\x20and\x20the\x20tools\x20available\x20to\x20it,\x20but\x20will\x20also\x20need\x20to\x20think\x20like\x20a\x20professional\x20relevant\x20for\x20the\x20task\x20at\x20hand.\x0a\x0a\x20\x20\x20\x20Your\x20job\x20is\x20to\x20create\x20a\x20role\x20for\x20the\x20AI\x20agent\x20and\x20write\x20a\x20system\x20prompt\x20that\x20will\x20guide\x20it\x20to\x20successfully\x20complete\x20the\x20task.\x0a\x0a\x20\x20\x20\x20Embed\x20appropriate\x20guidelines\x5cprocess\x20description\x20into\x20the\x20system\x20prompt,\x20according\x20to\x20the\x20task\x20type:\x0a\x20\x20\x20\x201.\x20TASK\x20OF\x20DEVELOPING\x20CODE\x5cSOFTWARE:\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20AI\x20Agent\x20Development\x20Process\x20Guide\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Development\x20Stages\x20Overview\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20As\x20conversation\x20progresses,\x20context\x20window\x20will\x20be\x20filled\x20and\x20what\x20agent\x20rememebers\x20will\x20be\x20truncated/summarized.\x0a\x20\x20\x20\x20\x20\x20\x20\x20To\x20retain\x20the\x20context\x20of\x20the\x20project\x20agent\x20will\x20have\x20to\x20use\x20memory\x20tool\x20to\x20store\x20relevant\x20information\x20throughout\x20the\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20particular,\x20the\x20agent\x20should\x20store\x20a\x20summary\x20of\x20each\x20stage,\x20its\x20requirements,\x20and\x20any\x20important\x20decisions\x20made\x20during\x20the\x20development\x20process.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x201:\x20System\x20Functional\x20Description\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20what\x20the\x20system\x20does\x20at\x20a\x20high\x20level\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20a\x20clear\x20description\x20of\x20the\x20system\x27s\x20main\x20purpose\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20the\x20core\x20problem\x20the\x20system\x20solves\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20the\x20system\x27s\x20scope\x20and\x20boundaries\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x202:\x20Comprehensive\x20Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20what\x20the\x20system\x20must\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20List\x20specific\x20features\x20and\x20capabilities\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20interactions\x20and\x20system\x20behaviors\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20data\x20processing\x20requirements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x203:\x20Non-Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20how\x20the\x20system\x20should\x20perform\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Performance\x20requirements\x20(speed,\x20response\x20time)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Scalability\x20needs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Usability\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x204:\x20System\x20Actors\x20and\x20Target\x20Devices\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Identify\x20who\x20uses\x20the\x20system\x20and\x20how\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20roles\x20and\x20permissions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20target\x20devices\x20(desktop,\x20mobile,\x20tablet)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20operating\x20system\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20browser\x20compatibility\x20needs\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x205:\x20Use\x20Cases\x20Development\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Document\x20user\x20workflows\x20and\x20interactions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20detailed\x20user\x20stories\x20involving\x20system\x20features\x20as\x20previously\x20defined\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20user\x20journeys\x20through\x20the\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Connect\x20features\x20to\x20specific\x20user\x20goals\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Include\x20edge\x20cases\x20and\x20error\x20scenarios\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x206:\x20UX\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Create\x20intuitive,\x20user-friendly\x20interfaces\x20addressing\x20the\x20use\x20cases\x20and\x20features\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Apply\x20modern\x20UX/UI\x20best\x20practices\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Design\x20responsive\x20layouts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20user\x20flows\x20and\x20information\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Consider\x20accessibility\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x207:\x20High-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20system\x20architecture\x20and\x20main\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20core\x20system\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20component\x20responsibilities,\x20inputs,\x20and\x20outputs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20data\x20flow\x20between\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Analyze\x20alternatives,\x20choose\x20technology\x20stack\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x208:\x20Low-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20implementation\x20specifics\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20database\x20design\x20and\x20schemas\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20API\x20endpoints\x20and\x20contracts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Detail\x20component\x20architecture\x20and\x20interfaces\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20error\x20handling\x20strategies\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20implementation\x20plan\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20Stage\x209:\x20Implementation\x20according\x20to\x20previous\x20stages\x20(longest\x20and\x20most\x20important\x20stage,\x20dedicate\x20more\x20time\x20and\x20messages\x20to\x20this\x20stage)\x0a\x20\x20\x20\x20\x20\x20\x20\x20when\x20implementing\x20the\x20code,\x20make\x20sure\x20to\x20be\x20consider\x20memories\x20stored\x20in\x20memory\x20tool\x20and\x20guidelines\x20derived\x20in\x20previous\x20stages.\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Write\x20and\x20build\x20the\x20complete\x20application\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20In\x20a\x20test\x20driven\x20manner,\x20implement\x20all\x20features\x20and\x20components\x20code\x20as\x20defined\x20in\x20previous\x20stages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20databases\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20necessary\x20assets\x20(graphics,\x20icons,\x20etc.)\x20and\x20embed\x20fontawesome\x20(or\x20its\x20alternatives)\x20where\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Implement\x20core\x20features,\x20UI\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20components\x20(e.g\x20frontend\x20and\x20backend)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20README.md\x20with\x20setup\x20instructions\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20at\x20this\x20point\x20INSTALL\x20DEPENDENCIES\x20and\x20run\x20project,\x20try\x20until\x20success.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x2010:\x20Testing\x20and\x20Quality\x20Assurance\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Ensure\x20code\x20quality\x20and\x20functionality\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20static\x20code\x20analysis\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20execute\x20unit\x20tests\x20for\x20individual\x20components\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Execute\x20integration\x20tests\x20for\x20component\x20interactions\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20end-to-end\x20tests\x20for\x20user\x20workflows\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Make\x20sure\x20no\x20errors\x20or\x20bugs\x20are\x20present\x20in\x20the\x20static\x20code\x20analysis,\x20tests,\x20terminal\x20output,\x20and\x20browser\x20testing\x20(console\x20+\x20visual\x20testing\x20using\x20vision\x20capabilities)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20This\x20stage\x20HAS\x20TO\x20BE\x20REPEATED\x20AND\x20RE-CHECKED\x20until\x20all\x20components\x20launch\x20without\x20errors\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20ONLY\x20AFTER\x20THIS\x20STAGE,\x20ONCE\x20TESTING\x20IS\x20COMPLETED\x20AND\x20PROGRAM\x20WAS\x20EXECUTED\x20WITH\x20NO\x20ERRORS,\x20YOU\x20ARE\x20ALLOWED\x20TO\x20ANNOUNCE\x20JOB\x20DONE.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Process\x20Guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Complete\x20each\x20stage\x20thoroughly\x20before\x20moving\x20to\x20the\x20next\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20(Important!)\x20Coversation\x20Dynamics\x20(different\x20stages\x20cannot\x20take\x20part\x20in\x20same\x20message):\x0a\x20\x20\x20\x20\x20\x20\x20\x201)\x20AGENT->LLM:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20identify\x20language-model\x20recipent\x20id,\x20direct\x20a\x20message\x20to\x20him\x20explaining\x20what\x20you\x20want\x20to\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20[tool\x20id=\x22update-user\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...use\x20tool\x27s\x20syntax\x20to\x20update\x20the\x20supervising\x20user\x20on\x20what\x20you\x27re\x20doing\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/tool]\x0a\x20\x20\x20\x20\x20\x20\x20\x20[message\x20to=\x22language-model(or\x20any\x20other\x20suitable\x20recipent\x20id)\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20the\x20llm\x20what\x20you\x27re\x20about\x20to\x20do\x20now,\x20ask\x20for\x20recommendations\x20or\x20scoring\x20rubrics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20that\x20would\x20assist\x20you\x20in\x20comleting\x20the\x20following\x20task\x5csub-task\x20with\x20great\x20success\x20and\x20quality\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20consult\x20about\x20challenges,\x20solutions,\x20guidelines\x20and\x20more.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/message]\x0a\x20\x20\x20\x20\x20\x20\x20\x202)\x20LLM->AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20llm\x20would\x20give\x20some\x20anwer,\x20agent\x20will\x20be\x20able\x20to\x20return\x20to\x20stage\x20one\x20and\x20continue\x20conversation\x20or\x20when\x20ready\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continuing\x20to\x20step\x203.\x0a\x20\x20\x20\x20\x20\x20\x20\x203)\x20AGENT\x20ACTION:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20agent\x20has\x20no\x20comments\x20regarding\x20llm\x20content,\x20the\x20agent\x20can\x20now\x20do\x20whatever\x20it\x20meant\x20to\x20do\x20(writing\x20content,\x20creating\x20things\x20will\x20tools\x20etc).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20this\x20dynamic\x20acts\x20like\x20a\x20meta-thinking\x20process.\x20Think\x20with\x20your\x20llm\x20-\x20at\x20least\x201\x20message\x20epr\x20thinking,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20act\x20-\x20with\x20the\x20use\x20of\x20tools\x20in\x20the\x20following\x20message,\x20repeat\x20this\x20process.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20always\x20start\x20a\x20message\x20by\x20updating\x20user\x20on\x20current\x20stages.\x20add\x20links\x20to\x20generated\x20files,\x20locations,\x20web\x20pages\x20when\x20needed.\x0a\x20\x20\x20\x20\x20\x20\x20\x204)\x20back\x20to\x20stage\x20one\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Code\x20guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20No\x20magic\x20numbers,\x20use\x20constants\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Project\x20file\x20structure\x20must\x20follow\x20best\x20practices\x20and\x20serve\x20the\x20purpose\x20of\x20the\x20project\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20known\x20and\x20highly\x20maintained\x20packages\x20and\x20technologies\x20which\x20suits\x20the\x20project\x20goals)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20SecureCoding\x20best\x20practices.\x20if\x20needed\x20install\x20external\x20scanners\x20to\x20scan\x20the\x20files\x20before\x20you\x27re\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20common\x20logic,\x20values\x20and\x20functionality,\x20gather\x20them\x20under\x20suitable\x20project\x20files\x20as\x20dependencies\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20a\x20project\x20that\x20uses\x20package.json\x20or\x20package_lock.json,\x20use\x20seek\x20tool\x20to\x20search\x20for\x20import\x20lines,\x20then\x20use\x20the\x20result\x20to\x20analyze\x20needed\x20packages.\x20when\x20using\x20different\x20technologies\x20make\x20adaptations\x20to\x20acheive\x20same\x20goal.\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20node\x20packages,\x20prefer\x20ESM\x20over\x20CommonJS\x20(unless\x20states\x20otherwise),\x20add\x20\x22type\x22:\x22module\x22\x20to\x20the\x20package.json\x20if\x20needed.\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20IF\x20THIS\x20SOFTWARE\x20IS\x20A\x20COMPUTER\x20GAME\x20COMPLEMENT\x20WITH\x20THE\x20FOLLOWING:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x201:\x20Basic\x20Concept\x20Definition**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Define\x20the\x20game\x27s\x20core\x20idea\x20and\x20desired\x20player\x20experience\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Choose\x20game\x20genre\x20(action,\x20strategy,\x20RPG,\x20puzzle,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20Define\x20target\x20audience\x20(age,\x20skill\x20level,\x20preferences)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x204.\x20Determine\x20target\x20platform\x20(PC,\x20console,\x20mobile)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x202:\x20Game\x20Mechanics\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205.\x20Develop\x20core\x20mechanics\x20(how\x20player\x20interacts\x20with\x20the\x20game)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x206.\x20Design\x20player\x20progression\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x207.\x20Define\x20game\x20rules,\x20limitations\x20and\x20challenges\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x208.\x20Design\x20scoring/reward\x20system\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x203:\x20Initial\x20Technical\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209.\x20Choose\x20game\x20engine\x20(Unity,\x20Unreal,\x20Godot,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2010.\x20Identify\x20required\x20libraries\x20and\x20tools\x20(physics,\x20networking,\x20AI)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2011.\x20Plan\x20basic\x20code\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2012.\x20Assess\x20hardware\x20requirements\x20and\x20performance\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x204:\x20Visual\x20and\x20Artistic\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2013.\x20Determine\x20art\x20style\x20(realistic,\x20cartoon,\x20pixel\x20art,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2014.\x20Design\x20color\x20palette\x20and\x20overall\x20atmosphere\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2015.\x20Plan\x20user\x20interface\x20(UI/UX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2016.\x20Create\x20artistic\x20style\x20guide\x20(Art\x20Bible)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x205:\x20Story\x20and\x20Plot\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2017.\x20Write\x20main\x20storyline\x20and\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2018.\x20Develop\x20main\x20and\x20secondary\x20characters\x20with\x20detailed\x20backgrounds\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2019.\x20Create\x20game\x20world\x20and\x20environment\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2020.\x20Write\x20dialogues\x20and\x20in-game\x20texts\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x206:\x20Level\x20and\x20Stage\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2021.\x20Plan\x20overall\x20structure\x20of\x20game\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2022.\x20Detailed\x20design\x20of\x20each\x20stage/level\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2023.\x20Determine\x20how\x20stages\x20connect\x20to\x20the\x20storyline\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2024.\x20Plan\x20difficulty\x20curve\x20and\x20challenge\x20progression\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x207:\x20Audio\x20and\x20Music\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2025.\x20Determine\x20musical\x20style\x20and\x20artistic\x20direction\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2026.\x20Plan\x20background\x20music\x20for\x20different\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2027.\x20Design\x20sound\x20effects\x20(SFX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2028.\x20Plan\x20voice\x20acting\x20and\x20dubbing\x20if\x20required\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x208:\x20In-Game\x20Tools\x20and\x20Systems\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2029.\x20Define\x20tools/weapons/items\x20and\x20their\x20properties\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2030.\x20Design\x20acquisition\x20and\x20collection\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2031.\x20Plan\x20inventory\x20and\x20equipment\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2032.\x20Design\x20additional\x20game\x20systems\x20(trading,\x20crafting,\x20etc.)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x209:\x20Prototype\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2033.\x20Create\x20basic\x20playable\x20version\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2034.\x20Test\x20core\x20mechanics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2035.\x20Gather\x20initial\x20feedback\x20and\x20updates\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2036.\x20Validate\x20technical\x20concept\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2010:\x20Full\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2037.\x20Develop\x20all\x20systems\x20and\x20content\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2038.\x20Create\x20all\x20artistic\x20assets\x20(graphics,\x20animations)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2039.\x20Record\x20and\x20produce\x20all\x20audio\x20materials\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2040.\x20Integration\x20of\x20all\x20components\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2011:\x20Testing\x20and\x20Bug\x20Fixes**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2041.\x20Comprehensive\x20functional\x20testing\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2042.\x20Performance\x20testing\x20and\x20optimization\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2043.\x20Usability\x20testing\x20with\x20players\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2044.\x20Bug\x20fixes\x20and\x20balance\x20improvements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2012:\x20Launch\x20and\x20Distribution**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2045.\x20Prepare\x20for\x20marketing\x20and\x20distribution\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2046.\x20Create\x20marketing\x20materials\x20(trailers,\x20screenshots)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2047.\x20Submit\x20to\x20distribution\x20platforms\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2048.\x20Launch\x20and\x20performance\x20monitoring\x0a\x0a\x20\x20\x20\x202.\x20TASK\x20OF\x20WRITING\x20A\x20BOOK\x5cSTORY:\x0a\x20\x20\x20\x20\x20\x20\x20\x202.1.\x20The\x20agent\x20should\x20create\x20criteria\x20for\x20qualitative\x20measurement\x20of\x20a\x20book/story\x20(general\x20or\x20of\x20the\x20described\x20type)\x0a\x20\x20\x20\x20\x20\x20\x20\x202.2.\x20Development\x20of\x20the\x20central\x20idea\x20along\x20with\x20the\x20main\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.3.\x20Development\x20of\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x202.4.\x20Development\x20of\x20key\x20points\x20in\x20each\x20plot,\x20central\x20dilemmas\x20and\x20unifying\x20logic\x20for\x20all\x20plots\x20-\x20if\x20there\x27s\x20a\x20need\x20to\x20change\x20or\x20adapt\x20part\x20of\x20the\x20plot\x20lines\x20at\x20this\x20stage,\x20it\x20should\x20be\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x202.5.\x20Criteria\x20should\x20be\x20written\x20for\x20developing\x20a\x20quality\x20character\x20in\x20the\x20story\x0a\x20\x20\x20\x20\x20\x20\x20\x202.6.\x20For\x20each\x20story,\x20main\x20and\x20secondary\x20characters\x20should\x20be\x20defined\x20along\x20with\x20their\x20role\x20in\x20the\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.7.\x20For\x20each\x20character,\x20personal\x20background\x20and\x20living\x20environment\x20in\x20childhood\x20and\x20adulthood\x20should\x20be\x20defined,\x20including\x20beliefs,\x20significant\x20life\x20events,\x20vocabulary,\x20and\x20appearance\x20including\x20hairstyle,\x20clothing,\x20jewelry\x20if\x20any,\x20and\x20more\x20-\x20all\x20according\x20to\x20the\x20plot\x20line\x20and\x20the\x20character\x27s\x20role\x20in\x20the\x20plot\x0a\x20\x20\x20\x20\x20\x20\x20\x202.8.\x20The\x20appearance\x20of\x20each\x20character\x20should\x20be\x20saved\x20in\x20a\x20dedicated\x20place\x20with\x20great\x20detail,\x20it\x20will\x20serve\x20to\x20create\x20consistent\x20graphics\x20if\x20required\x0a\x20\x20\x20\x20\x20\x20\x20\x202.9.\x20For\x20each\x20character,\x20internet\x20research\x20should\x20be\x20conducted\x20to\x20refine\x20it\x20(clothing,\x20beliefs,\x20childhood\x20and\x20adulthood\x20events)\x20to\x20specify\x20events\x20in\x20the\x20environment\x20where\x20they\x20grew\x20up\x20or\x20draw\x20inspiration\x20from\x20areas\x20in\x20the\x20spirit\x20of\x20the\x20region\x20or\x20conditions\x20that\x20the\x20plot\x20unfolds\x0a\x20\x20\x20\x20\x20\x20\x20\x202.10.\x20Between\x20plot\x20lines,\x20intersection\x20points\x20should\x20be\x20created,\x20alternatives\x20examined\x20and\x20intersection\x20points\x20with\x20logic\x20should\x20be\x20chosen,\x20with\x20narrative\x20value\x20that\x20will\x20serve\x20the\x20story\x27s\x20purpose\x20and\x20the\x20reader\x27s\x20interest.\x20This\x20is\x20an\x20opportunity\x20to\x20refine\x20the\x20plot\x20lines,\x20twists\x20and\x20their\x20connection\x20to\x20the\x20characters.\x20This\x20is\x20an\x20opportunity\x20to\x20enrich\x20the\x20description\x20and\x20understanding\x20of\x20the\x20world\x20in\x20which\x20the\x20characters\x20live\x20before\x20actual\x20writing\x20-\x20smells,\x20emotions,\x20sights,\x20events,\x20worldviews,\x20technology,\x20communication,\x20global\x20and\x20national\x20trends\x20including\x20the\x20state\x20of\x20superpowers\x20in\x20the\x20described\x20world,\x20medical\x20and\x20scientific,\x20formative\x20historical\x20events\x20and\x20more\x20as\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x202.11.\x20The\x20recurring\x20motifs\x20should\x20be\x20understood\x20if\x20there\x20are\x20any,\x20their\x20essence,\x20identifying\x20central\x20symbols\x20in\x20use,\x20leading\x20metaphors\x20if\x20they\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x202.12.\x20The\x20story\x20should\x20be\x20assigned\x20to\x20a\x20genre,\x20given\x20a\x20working\x20title,\x20locate\x20a\x20worthy\x20and\x20excellent\x20author\x20whose\x20writing\x20style\x20is\x20known\x20and\x20whose\x20writings\x20are\x20accessible\x20or\x20familiar\x20to\x20the\x20model,\x20and\x20choose\x20them\x20as\x20a\x20guiding\x20line\x20for\x20the\x20writing\x20style\x20unless\x20described\x20otherwise\x20in\x20the\x20task\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x202.13.\x20Begin\x20writing\x20the\x20book\x20-\x20chapter\x20by\x20chapter,\x20stop\x20between\x20chapters\x20and\x20let\x20the\x20user\x20examine\x20the\x20story\x20that\x20was\x20written\x0a\x0a\x20\x20\x20\x203.\x20TASK\x20OF\x20RESEARCHING\x5cINFORMATION\x20GATHERING:\x0a\x20\x20\x20\x20\x20\x20\x20\x203.1.\x20If\x20the\x20user\x20is\x20interested,\x20expand\x20or\x20assist\x20in\x20refining\x20the\x20research\x20question\x20or\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.2.\x20The\x20desired\x20output\x20should\x20be\x20specified\x20-\x20format,\x20file\x20type,\x20and\x20more\x0a\x20\x20\x20\x20\x20\x20\x20\x203.3.\x20Attempt\x20to\x20locate\x20names\x20of\x20websites\x20and\x20sources\x20for\x20the\x20requested\x20information\x0a\x20\x20\x20\x20\x20\x20\x20\x203.4.\x20Divide\x20information\x20sources\x20into\x20sources\x20with\x20direct\x20connection\x20to\x20the\x20task\x20or\x20those\x20that\x20may\x20provide\x20supplementary\x20information\x20-\x20this\x20is\x20an\x20opportunity\x20to\x20locate\x20additional\x20sources\x0a\x20\x20\x20\x20\x20\x20\x20\x203.5.\x20Search\x20these\x20sources\x20thoroughly\x20with\x20the\x20aspiration\x20to\x20locate\x20materials\x20from\x20at\x20least\x2020\x20sources\x20for\x20the\x20general\x20public\x20and\x2020\x20from\x20academic\x20sources,\x20and\x20at\x20least\x2010\x20recent\x20ones\x20from\x20dedicated\x20professional\x20sources\x20if\x20such\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x203.6.\x20Design\x20a\x20guiding\x20principle\x20and\x20quality\x20structure\x20for\x20the\x20article/research\x20paper\x20or\x20follow\x20the\x20guidelines\x20given\x20in\x20the\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.7.\x20If\x20materials\x20or\x20support\x20for\x20certain\x20claims\x20or\x20connecting\x20materials\x20are\x20missing,\x20they\x20should\x20be\x20searched\x20for\x20at\x20this\x20stage\x0a\x20\x20\x20\x20\x20\x20\x20\x203.8.\x20Update\x20the\x20output\x20structure,\x20continue\x20writing\x20and\x20move\x20between\x20the\x20different\x20stages\x20as\x20needed\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x204.\x20OTHER\x20TASK\x20TYPES\x20-\x20write\x20such\x20guidlines\x20to\x20the\x20best\x20of\x20your\x20knowledge\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20The\x20next\x20message\x20will\x20describe\x20a\x20task\x20intended\x20for\x20the\x20newly\x20created\x20AI\x20agent\x20to\x20carry.\x0a\x20\x20\x20\x20Return\x20your\x20answer\x20in\x20the\x20following\x20format:\x0a\x20\x20\x20\x20[task-type]develop-software\x20|\x20story-telling\x20|\x20web-research\x20|\x20other[/task-type]\x0a\x20\x20\x20\x20[ai-role]<ai\x20agent\x20role\x20or\x20profession,\x20simple\x20text\x20no\x20slahes,\x20dashes\x20or\x20any\x20special\x20character>[/ai-role]\x0a\x20\x20\x20\x20[system-prompt]<A\x20system\x20prompt\x20which\x20will\x20guide\x20the\x20new\x20agent\x20to\x20handle\x20the\x20given\x20task\x20as\x20good\x20as\x20possible>[/system-prompt]';}[a0_0x2316bb(0x119)](_0x578fc0,_0x30c181){const _0x35e8c8=a0_0x2316bb;return'You\x20are\x20an\x20amazing\x20state-of-the-art\x20AI\x20agent,\x20working\x20with\x20another\x20specialized\x20AI\x20agent\x20that\x20is\x20completing\x20tasks.\x20Your\x20role\x20is\x20to\x20provide\x20information,\x20answer\x20questions,\x20and\x20assist\x20the\x20agent\x20when\x20needed.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20You\x20cannot\x20directly\x20use\x20tools\x20or\x20perform\x20actions\x20on\x20the\x20computer.\x20Your\x20task\x20is\x20simply\x20to\x20provide\x20informative\x20and\x20helpful\x20responses\x20to\x20assist\x20the\x20agent\x20in\x20completing\x20their\x20task.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20When\x20the\x20agent\x20asks\x20you\x20a\x20question\x20or\x20requests\x20information,\x20provide\x20clear\x20and\x20accurate\x20information\x20to\x20the\x20best\x20of\x20your\x20ability.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20from\x20time\x20to\x20time\x20the\x20agent\x20may\x20mistake\x20and\x20use\x20some\x20instruction\x20tag\x20[tool\x20id=\x22...\x22]...[/tool]\x20or\x20similar,\x20in\x20a\x20wrong\x20way.\x20do\x20not\x20try\x20to\x20guide\x20him,\x20you\x20can\x20notify\x20him\x20that\x20since\x20you\x27re\x20not\x20suppose\x20to\x20see\x20such\x20tags\x20(automatically\x20stripped\x20from\x20conversation),\x20there\x20is\x20a\x20possibility\x20that\x20this\x20agent\x20made\x20a\x20syntax\x20error.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20any\x20professional\x20matter,\x20encourage\x20a\x20multistep/multimessage\x20session\x20and\x20assist\x20him,\x20suggest\x20improvements,\x20criticize\x20his\x20work,\x20detect\x20challenges\x20if\x20crucial\x20and\x20suggest\x20overcomes.\x20help\x20him\x20be\x20at\x20his\x20best.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Tools\x20available\x20to\x20the\x20other\x20agent\x20are:\x20'+_0x578fc0+_0x35e8c8(0x174)+_0x30c181+_0x35e8c8(0x1ca);}[a0_0x2316bb(0x1a6)](_0x270416,_0x2ff985=null,_0x78165d=![]){const _0x56342d=a0_0x2316bb,_0x5d5331=a0_0x127b15();return _0x78165d&&_0x2ff985?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20task\x20is\x20to\x20modify\x20content\x20in\x20the\x20directory\x20\x27'+_0x2ff985+_0x56342d(0x100)+JSON['stringify'](_0x270416):'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TASK\x20FOR\x20THE\x20FUTURE\x20AI\x20AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+JSON[_0x56342d(0xde)](_0x270416)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}async[a0_0x2316bb(0xf6)](_0xed7d46){const _0x5242cf=a0_0x2316bb;await this[_0x5242cf(0xf4)][_0x5242cf(0xf6)](_0xed7d46);}async[a0_0x2316bb(0x191)](){const _0x4e5b08=a0_0x2316bb;return await this[_0x4e5b08(0xf4)][_0x4e5b08(0x191)]();}async[a0_0x2316bb(0x17b)](_0x7813e5){const _0x31708a=a0_0x2316bb;this['sessionOverrides']=_0x7813e5,this['logger'][_0x31708a(0x1a5)]('Session\x20overrides\x20set',_0x7813e5);}async['pauseExecution'](){const _0x520300=a0_0x2316bb;this[_0x520300(0x188)][_0x520300(0x1a5)](_0x520300(0x150));const _0x547797='[System]:\x20Execution\x20has\x20been\x20paused\x20by\x20the\x20user.\x20Waiting\x20to\x20resume.';for(const _0xaaf2b of this[_0x520300(0xc7)]['activeConversationIds']){const _0x285133=this['conversations']['get'](_0xaaf2b);_0x285133&&(_0x285133[_0x520300(0x1d1)]['push']({'role':CONVERSATION_CONSTANTS['SYSTEM_MESSAGE_ROLE'],'content':_0x547797}),await this['saveConversationHistory'](_0xaaf2b));}this[_0x520300(0xc7)]['paused']=!![],await this[_0x520300(0x15a)]();}async['resumeExecution'](){const _0x4c6753=a0_0x2316bb;this[_0x4c6753(0x188)][_0x4c6753(0x1a5)](_0x4c6753(0x194));const _0x355693='[System]:\x20Execution\x20has\x20been\x20resumed\x20by\x20the\x20user.';for(const _0x323252 of this['sessionState'][_0x4c6753(0x11e)]){const _0x564e88=this['conversations'][_0x4c6753(0x1ad)](_0x323252);_0x564e88&&(_0x564e88[_0x4c6753(0x1d1)]['push']({'role':CONVERSATION_CONSTANTS[_0x4c6753(0x17a)],'content':_0x355693}),await this['saveConversationHistory'](_0x323252));}this['sessionState'][_0x4c6753(0x165)]=![],await this['saveSessionState']();}['isPaused'](){const _0xeb6243=a0_0x2316bb;return this['sessionState'][_0xeb6243(0x165)]===!![];}async[a0_0x2316bb(0xe9)](_0x263dd9,_0x8d84cd){const _0x4661d0=a0_0x2316bb;this[_0x4661d0(0x188)][_0x4661d0(0x1a5)]('Processing\x20'+_0x8d84cd[_0x4661d0(0x1cd)]+'\x20tool\x20commands\x20from\x20'+_0x263dd9);const _0x11b036=[],_0x35952a=[],_0x4fc69b=[];for(const _0x21f62b of _0x8d84cd){const {toolId:_0x3c5d2d}=_0x21f62b;this[_0x4661d0(0x188)]['info']('Queuing\x20tool:\x20'+_0x3c5d2d);if(!this['toolRegistry'][_0x4661d0(0x1cb)](_0x3c5d2d)){_0x35952a[_0x4661d0(0x115)]({'toolId':_0x3c5d2d,'status':'error','error':'Tool\x20\x27'+_0x3c5d2d+_0x4661d0(0x136)+this['toolRegistry'][_0x4661d0(0xc4)]()['join'](',\x20')});continue;}try{const _0x422b98=this['toolRegistry']['getTool'](_0x3c5d2d),requiresResponse=_0x422b98[_0x4661d0(0xda)]!==![],_0x268e8b=a0_0x127b15();_0x35952a['push']({'operationId':_0x268e8b,'toolId':_0x3c5d2d,'command':_0x21f62b,'status':'pending','requiresResponse':requiresResponse});requiresResponse&&_0x4fc69b['push'](_0x3c5d2d);const _0x274e92=_0x422b98['execute'](_0x21f62b,this[_0x4661d0(0xc7)]['projectDir'])['then'](_0x45ff27=>{const _0x49caae=_0x4661d0;this['logger'][_0x49caae(0x1a5)]('Tool\x20'+_0x3c5d2d+_0x49caae(0x18e),_0x45ff27);const _0x33e4d2=_0x35952a[_0x49caae(0xf3)](_0x46bf95=>_0x46bf95['operationId']===_0x268e8b);return _0x33e4d2&&(_0x33e4d2['status']='success',_0x33e4d2[_0x49caae(0x196)]=_0x45ff27),this['activeTools']['delete'](_0x268e8b),_0x45ff27;})['catch'](_0x3b4ba9=>{const _0x5e4551=_0x4661d0;this[_0x5e4551(0x188)][_0x5e4551(0x1d5)]('Tool\x20'+_0x3c5d2d+_0x5e4551(0xcf),_0x3b4ba9);const _0xf13b56=_0x35952a['find'](_0x14cf97=>_0x14cf97[_0x5e4551(0x102)]===_0x268e8b);_0xf13b56&&(_0xf13b56['status']=_0x5e4551(0x1d5),_0xf13b56['error']=_0x3b4ba9['message']);this[_0x5e4551(0xfc)]['delete'](_0x268e8b);throw _0x3b4ba9;});this['activeTools'][_0x4661d0(0x145)](_0x268e8b,{'promise':_0x274e92,'toolId':_0x3c5d2d,'agentId':_0x263dd9,'startTime':Date[_0x4661d0(0x16a)]()}),_0x11b036['push'](_0x274e92);}catch(_0xac5a52){this['logger']['error'](_0x4661d0(0xf2)+_0x3c5d2d+':',_0xac5a52),_0x35952a['push']({'toolId':_0x3c5d2d,'status':'error','error':_0x4661d0(0xf2)+_0x3c5d2d+':\x20'+_0xac5a52[_0x4661d0(0x140)],'requiresResponse':!![]});}}const _0x4b8655=new Promise(_0x499719=>setTimeout(_0x499719,0x7d0));await Promise['race']([_0x4b8655,Promise[_0x4661d0(0x12b)](_0x11b036)]);const _0x3716cb=_0x35952a['filter'](_0x513be7=>(_0x513be7[_0x4661d0(0x132)]===_0x4661d0(0xea)||_0x513be7['status']===_0x4661d0(0x1d5))&&_0x513be7[_0x4661d0(0xda)]!==![]),_0x23123d=_0x35952a[_0x4661d0(0x10f)](_0x30f028=>_0x30f028['status']==='pending'&&_0x30f028[_0x4661d0(0xda)]!==![]);if(_0x3716cb[_0x4661d0(0x1cd)]>0x0||_0x23123d['length']>0x0){let _0x162aac='Tool\x20execution\x20report\x20('+_0x3716cb[_0x4661d0(0x1cd)]+'\x20completed,\x20'+_0x23123d[_0x4661d0(0x1cd)]+'\x20pending):';if(_0x3716cb['length']>0x0){_0x162aac+=_0x4661d0(0x10d);for(const _0x2f1bf4 of _0x3716cb){_0x2f1bf4[_0x4661d0(0x132)]===_0x4661d0(0xea)?(_0x162aac+=_0x4661d0(0x154)+_0x2f1bf4['toolId']+'\x20completed\x20successfully.',_0x2f1bf4[_0x4661d0(0x196)]&&(_0x162aac+='\x20Result:\x20'+JSON['stringify'](_0x2f1bf4['result'],null,0x2))):_0x162aac+='\x0a‚ùå\x20Tool\x20'+_0x2f1bf4['toolId']+'\x20failed:\x20'+_0x2f1bf4[_0x4661d0(0x1d5)];}}if(_0x23123d[_0x4661d0(0x1cd)]>0x0){_0x162aac+='\x0a\x0a==\x20Pending\x20Operations\x20==';for(const _0x5c9c35 of _0x23123d){_0x162aac+='\x0a‚è≥\x20Tool\x20'+_0x5c9c35['toolId']+_0x4661d0(0x160)+_0x5c9c35[_0x4661d0(0x102)]+').'+'\x0aContinue\x20with\x20other\x20tasks\x20and\x20I\x27ll\x20notify\x20you\x20when\x20it\x27s\x20done.',this[_0x4661d0(0x106)](_0x5c9c35[_0x4661d0(0x102)],_0x263dd9);}}await this[_0x4661d0(0x18d)](_0x263dd9,_0x162aac);}else this[_0x4661d0(0x188)][_0x4661d0(0x1a5)]('All\x20'+_0x8d84cd['length']+'\x20tools\x20were\x20fire-and-forget,\x20no\x20response\x20sent\x20to\x20agent');}['trackPendingOperation'](_0x37e226,_0x43a36c){const _0x506fde=a0_0x2316bb,_0x157114=this['activeTools']['get'](_0x37e226);if(!_0x157114)return;_0x157114[_0x506fde(0x177)][_0x506fde(0x14d)](_0x293494=>{this['queuePendingResult'](_0x43a36c,_0x157114['toolId'],_0x37e226,'success',{'result':_0x293494});})[_0x506fde(0x155)](_0x5f59f2=>{const _0x1f2863=_0x506fde;this[_0x1f2863(0x161)](_0x43a36c,_0x157114[_0x1f2863(0x1a3)],_0x37e226,'error',{'error':_0x5f59f2[_0x1f2863(0x140)]});});}['queuePendingResult'](_0x5c5e56,_0x2caa01,_0x2df18e,_0x3b4d88,_0x2d9379){const _0x102779=a0_0x2316bb;!this[_0x102779(0x131)]&&(this[_0x102779(0x131)]=new Map()),!this[_0x102779(0x131)]['has'](_0x5c5e56)&&this['pendingResults']['set'](_0x5c5e56,[]),this['pendingResults']['get'](_0x5c5e56)[_0x102779(0x115)]({'toolId':_0x2caa01,'operationId':_0x2df18e,'status':_0x3b4d88,'data':_0x2d9379,'timestamp':Date['now']()});}async['handlePromptTooLong'](_0x31de6c){const _0x2add9a=a0_0x2316bb;this['logger'][_0x2add9a(0x1ce)]('üö®\x20Prompt\x20too\x20long\x20detected\x20for\x20'+_0x31de6c+_0x2add9a(0x17c));const _0x2b0e6e=this[_0x2add9a(0x125)]['get'](_0x31de6c);if(!_0x2b0e6e)throw new Error(_0x2add9a(0x18f)+_0x31de6c+_0x2add9a(0x18a));this[_0x2add9a(0x188)]['info'](_0x2add9a(0x117)+_0x2b0e6e['messages'][_0x2add9a(0x1cd)]+'\x20messages'),await this['performCompactization'](_0x31de6c),this[_0x2add9a(0x188)][_0x2add9a(0x1a5)]('After\x20compactization:\x20'+_0x2b0e6e[_0x2add9a(0x1d1)][_0x2add9a(0x1cd)]+_0x2add9a(0x1da)),this[_0x2add9a(0x188)]['info'](_0x2add9a(0x1dd)+_0x31de6c);}async[a0_0x2316bb(0xcc)](){const _0x266540=a0_0x2316bb;this[_0x266540(0x188)][_0x266540(0x1a5)]('Shutting\x20down\x20conversation\x20orchestrator'),this[_0x266540(0x1cc)]=!![];this['idleCheckInterval']&&(clearInterval(this[_0x266540(0xf0)]),this[_0x266540(0xf0)]=null);this['idleTimer']&&(clearTimeout(this[_0x266540(0x1c0)]),this[_0x266540(0x1c0)]=null);clearInterval(this[_0x266540(0x156)]),await this[_0x266540(0x15a)]();const _0x259d2d=Array['from'](this['activeTools']['values']());if(_0x259d2d[_0x266540(0x1cd)]>0x0){this[_0x266540(0x188)]['info']('Waiting\x20for\x20'+_0x259d2d[_0x266540(0x1cd)]+'\x20pending\x20operations\x20to\x20complete\x20or\x20timeout');const _0xebdc5a=this['config']['shutdownTimeout']||0x2710;try{await Promise[_0x266540(0xe3)]([Promise['allSettled'](_0x259d2d['map'](_0x525cab=>_0x525cab['promise'])),new Promise(_0x5bec17=>setTimeout(_0x5bec17,_0xebdc5a))]);}catch(_0x2767c7){this[_0x266540(0x188)][_0x266540(0x1ce)](_0x266540(0x15d),_0x2767c7);}for(const [_0x4def24,_0x55b9cc]of this['activeTools']['entries']()){this['logger']['info'](_0x266540(0xcb)+_0x4def24+_0x266540(0x1ab)),this['activeTools']['delete'](_0x4def24);}}await this[_0x266540(0xc8)][_0x266540(0xcc)](),await this[_0x266540(0x170)]['shutdown'](),await this[_0x266540(0xf4)]['saveUsageData'](),this[_0x266540(0x188)][_0x266540(0x1a5)](_0x266540(0x107));}async['triggerProceed'](){const _0x52467a=a0_0x2316bb;this[_0x52467a(0x19f)]===_0x52467a(0x13c)?await this['sendProceedMessage']():this[_0x52467a(0x188)][_0x52467a(0x1a5)]('Cannot\x20proceed:\x20current\x20state\x20is\x20'+this['messageIndicator']);}[a0_0x2316bb(0x1b0)](){const _0x5055d7=a0_0x2316bb;return{'state':this[_0x5055d7(0x19f)],'lastActivity':this['lastActivityTime'],'timeSinceActivity':Date[_0x5055d7(0x16a)]()-this['lastActivityTime'],'willProceedIn':Math[_0x5055d7(0x167)](0x0,this[_0x5055d7(0xeb)]-(Date['now']()-this['lastActivityTime']))};}}