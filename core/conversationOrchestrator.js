const a0_0xac6c34=a0_0xfcae;(function(_0x22f40f,_0x2666cc){const _0x476965=a0_0xfcae,_0x14ce05=_0x22f40f();while(!![]){try{const _0x2d5277=parseInt(_0x476965(0x114))/0x1+-parseInt(_0x476965(0x17a))/0x2+-parseInt(_0x476965(0x155))/0x3+parseInt(_0x476965(0x12a))/0x4*(parseInt(_0x476965(0x124))/0x5)+-parseInt(_0x476965(0x1bf))/0x6*(parseInt(_0x476965(0xc1))/0x7)+parseInt(_0x476965(0x1a8))/0x8*(parseInt(_0x476965(0x119))/0x9)+parseInt(_0x476965(0x11d))/0xa;if(_0x2d5277===_0x2666cc)break;else _0x14ce05['push'](_0x14ce05['shift']());}catch(_0x492469){_0x14ce05['push'](_0x14ce05['shift']());}}}(a0_0x4125,0x31e0d));function a0_0xfcae(_0x45ee3b,_0x3286ac){const _0x412564=a0_0x4125();return a0_0xfcae=function(_0xfcaef9,_0x68ab4a){_0xfcaef9=_0xfcaef9-0xac;let _0x655477=_0x412564[_0xfcaef9];if(a0_0xfcae['oWAfaH']===undefined){var _0x401577=function(_0x205658){const _0x2fa941='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x16ddd8='',_0xefb2b7='';for(let _0x4cdfec=0x0,_0xebed2c,_0x2233c1,_0x368b3b=0x0;_0x2233c1=_0x205658['charAt'](_0x368b3b++);~_0x2233c1&&(_0xebed2c=_0x4cdfec%0x4?_0xebed2c*0x40+_0x2233c1:_0x2233c1,_0x4cdfec++%0x4)?_0x16ddd8+=String['fromCharCode'](0xff&_0xebed2c>>(-0x2*_0x4cdfec&0x6)):0x0){_0x2233c1=_0x2fa941['indexOf'](_0x2233c1);}for(let _0x12f631=0x0,_0x2f694b=_0x16ddd8['length'];_0x12f631<_0x2f694b;_0x12f631++){_0xefb2b7+='%'+('00'+_0x16ddd8['charCodeAt'](_0x12f631)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xefb2b7);};a0_0xfcae['vjoLgJ']=_0x401577,_0x45ee3b=arguments,a0_0xfcae['oWAfaH']=!![];}const _0x103192=_0x412564[0x0],_0xd03688=_0xfcaef9+_0x103192,_0x128761=_0x45ee3b[_0xd03688];return!_0x128761?(_0x655477=a0_0xfcae['vjoLgJ'](_0x655477),_0x45ee3b[_0xd03688]=_0x655477):_0x655477=_0x128761,_0x655477;},a0_0xfcae(_0x45ee3b,_0x3286ac);}import{TagParser}from'../utilities/tagParser.js';import{TagParserService}from'../services/tagParserService.js';import a0_0x205658 from'path';import{promises as a0_0x2fa941}from'fs';import{v4 as a0_0x16ddd8}from'uuid';import{LLMService}from'../services/llmService.js';import{ToolRegistry}from'../services/toolRegistry.js';import{BudgetService}from'../services/budgetService.js';import{displayOnly}from'../utilities/stringOps.js';import a0_0xefb2b7 from'chalk';export const CONVERSATION_CONSTANTS={'STATE_DIR_NAME':'.loxia-state','SESSION_STATE_FILENAME':'session-state.json','INDEX_FILENAME':a0_0xac6c34(0xba),'LAST_SESSION_FILENAME':'last-session.json','HISTORY_SUFFIX':a0_0xac6c34(0x168),'SYSTEM_MESSAGE_ROLE':'system','USER_MESSAGE_ROLE':'user','ASSISTANT_MESSAGE_ROLE':a0_0xac6c34(0x1d4),'COMPACTIZATION_THRESHOLD_PERCENTAGE':0.7,'COMPACTIZATION_OUTPUT_RESERVE_PERCENTAGE':0.4,'COMPACTIZATION_BEGIN_PERCENTAGE':0.15,'COMPACTIZATION_END_PERCENTAGE':0.35,'MIN_MESSAGES_TO_KEEP':0x2,'SUMMARY_MARKER_BEGIN':a0_0xac6c34(0x177),'SUMMARY_MARKER_END':a0_0xac6c34(0x19f),'TOOL_CALL_FREQUENCY_CHECK_MS':0x2710,'TOOL_STATUS_UPDATE_INTERVAL_MS':0x2710,'DEFAULT_CONTEXT_WINDOW_SIZE':0x186a0,'MAKER_AGENT_DEFAULT_ID':a0_0xac6c34(0x181),'LANGUAGE_MODEL_ID':a0_0xac6c34(0x127),'PROMPT_ENGINEER_ID':a0_0xac6c34(0x196)};function a0_0x4125(){const _0x271872=['CMvNAxn0zxjdB252zxjZyxrPB24','mZKXotCXrxv5CgHj','cGPuB29SCYbHDMfPBgfIBguGyxjLoGO','DxbKyxrLtwvZC2fNzuLUzgLJyxrVCG','C2vUze1LC3nHz2vuB0nVBNzLCNnHDgLVBG','B25vC2vYuhjVBxb0','CMvZDwX0','jYbHy2nVCMrPBMCGDg8GDgHLC2uGAw5ZDhj1y3rPB25ZoGOGicaGicaGicaGica','rM91BMqGyw5KigXVywrLzcbJB252zxjZyxrPB24GAgLZDg9YEsbMB3iG','igrVzxmGBM90igv4Axn0','tuLox01fu1nbr0vtx1rpx0Tfrva','cIaGicaGicaGicaGifrbu0SGrK9sifrirsbgvvrvuKuGquKGquDftLq6cIaGicaGicaGicaGia','C3rHCNruAw1L','q29UDMvYC2f0Aw9UihjLC3vTzwqGC3vJy2vZC2z1BgX5lIbby3rPDMuGy29UDMvYC2f0Aw9UCZOG','igjLz2LUicSG','uMvJzwL2zwqGDxnLCIbPBNb1DdOG','uMvZDw1PBMCGy29UDMvYC2f0Aw9UigzYB206ia','rxjYB3iGC2vUzgLUzYbHDxrVlxbYB2nLzwqGBwvZC2fNztO','C3vIC3rYAw5N','Dg9uAw1Lu3rYAw5N','lwHPC3rVCNKUANnVBG','x2DLDezPBgvtywzLq29UDMvYC2f0Aw9Uswq','u1Ltvevnx01fu1nbr0vFuK9mrq','CMvNAxn0zxjkB2jeB25LsgfUzgXLCG','q3jPDgLJywWGy29TCgfJDgL6yxrPB24GzMfPBhvYztO','z2v0sw5KAwnHDg9Yu3rHDhvZ','zgvSzxrL','C3rHDhvZ','ww91igfYzsbHBIbbssbHC3nPC3rHBNqGDgfZA2vKihDPDgGGy29TCgXLDgLUzYb0AguGzM9SBg93Aw5NoIa','C3LZDgvTuhjVBxb0','z2v0qNvKz2v0vxnHz2u','ywDLBNrjza','AxnqyxvZzwq','CMvNAxn0zxjvC2vYuhjVBxb0sgfUzgXLCG','zxjYB3i','ls1dB252zxjZyxrPB24GqMvJyw1LieXVBMCSifrOAxmGugfYDcbiyxmGqMvLBIbtDw1TyxjPEMvKls0','BwvZC2fNzuLUzgLJyxrVCG','C2H1DgrVD24','ntyZnti2zgzorMTM','igzYB20G','cGPdB252zxjZyxrPB24GCNvSzxmGyxjLoGOGicaGms4Gv2HLBIbZzw5KAw5NigeGBwvZC2fNzsb0BYbHBM90AgvYihbHCNrPy2LWyw50lcb1C2uGw21LC3nHz2uGDg89iNbHCNrPy2LWyw50x2LKiL0GzM9YBwf0cIaGicaYlIbxAgvUihvZAw5NihrVB2XZlcb3CMfWignVBw1HBMrZigLUifT0B29SCY1JB21Tyw5KC10Gyw5KifSVDg9VBhmTy29TBwfUzhnDihrHz3mkicaGidmUievHy2GGDg9VBcbJB21Tyw5KihnOB3vSzcbIzsb3CMfWCgvKigLUifT0B29SigLKpsj0B29Sx2LKiL0Gyw5KifSVDg9VBf0GDgfNCWOGicaGnc4Gww91ig11C3qGzM9SBg93ihrOzsbZCgvJAwzPyYbMB3jTyxqGzM9YigvHy2GGDg9VBcbHCYbKzxnJCMLIzwqGAw4GDgHLihrVB2XZihnLy3rPB24kicaGiduUieLMihLVDsbUzwvKihvZzxiGAw5WDxqGB3iGysbKzwnPC2LVBIWGDxnLihrOzsbBChjVBxb0xsbMB3jTyxqOtK9usunfoIbHDcbSzwfZDcaYig9WDgLVBIb0ywDZigfYzsbYzwnVBw1LBMrLzcK6ifTWCM9TChqGBMfTzt0IChjVBxb0igrPC3bSyxKGDgL0BguIxxrOzsbTzxnZywDLihrOzsb1C2vYihDPBgWGC2vLw29WDgLVBL1VChrPB24Gmsb0zxH0wY9VChrPB25DifTVChrPB25DB3b0Aw9UidiGDgv4DfSVB3b0Aw9Uxs4UlM1VCMuGB3b0Aw9UCYbPzIbUzwvKzwqUlI5Bl3bYB21WDf0kicaGidyUihDOzw4GEw91igHHDMuGzMLUAxnOzwqGEw91CIb0yxnRigLUy2X1zgLUzYb2zxjPzMLJyxrPB24Gyw5KihzHBgLKyxrPB24GB2yGywn0DwfSignVBNrLBNqGyxmGD3jPDhrLBIbVBIbKAxnRigfZignVBxbHCMvLzcb0BYbKzxjPDMvKihnWzwnZlcbVCIb5B3uNCMuGBM90igDLDhrPBMCGyw55ihbYB2DYzxnZihvZzsb0AguGw2PVyI1KB25LxtX5B3vYig1LC3nHz2u+wY9QB2iTzg9Uzv0GC3bLy2LHBcbPBNn0CNvJDgLVBIb0ywCUihbYzwzLCNjHyMX5igLUigL0CYbVD24GBwvZC2fNzsaOBM8GB3rOzxiGAw5ZDhj1y3rPB25Zks4kicaGidCUig5LDMvYigfUBM91BMnLigPVyI1KB25LigjLzM9Yzsb5B3uGAgf2zsbJB21WBgv0zwqGywXSihn0ywDLCYbVzIb0AguGzgv2zwXVCg1LBNqGChjVy2vZCYWGDgvZDgvKigfUzcbYzs12ywXPzgf0zwqGEw91CIbZB2X1DgLVBIbIEsbVyNnLCNzPBMCGDgHLignYzwf0zwqGzMLSzxmGyw5KigfYDgLMywn0CY4kicaGifLVDxiGuhjVAMvJDcbsB290ierPCMvJDg9YEsbjCZOG','AwrSzq','CMvNAxn0zxjqCM9TChruB29mB25NsgfUzgXLCG','icaYlIbpCIbZDgfYDcbHig5LDYbZzxnZAw9UigfZA2LUzYb0AguGywDLBNqGDg8Gy29UDgLUDwu6','CMvNAxn0zxjcDwLSDeLUvg9VBhm','BwfRzxiTywDLBNq','C2vTAs1HDxrV','igvUzcbTzxnZywDLCW','u3rHCNrPBMCGBMv3ignVBNzLCNnHDgLVBIbMB3iGDgfZAZOG','BgvUz3rO','rMfPBgvKihrVihnHDMuGC2vZC2LVBIbZDgf0ztOG','DxbKyxrLu3LZDgvTuhjVBxb0C0zVCK1Vzgu','y3LHBG','q291BgqGBM90ihjLywqGC2vZC2LVBIbZDgf0zsbMAwXLoIa','y3jLyxrPBMCGBMv3ignVBNrLBNq','igrVzxmGBM90igv4Axn0lcbJyw5UB3qGCM91DguGBwvZC2fNzs4GqxzHAwXHyMXLigfNzw50CYbHCMu6ia','CMvWBgfJzq','CgfYC2vqCM9TChrfBMDPBMvLCLjLC3bVBNnL','C2vUzfvZzxjjBNb1Da','Bg9N','ifjLC3vSDdOG','DxbKyxrLq29UDMvYC2f0Aw9U','8j+AQcbqCM9TChqGDg9VigXVBMCGzgv0zwn0zwqGzM9Yicr7y29UDMvYC2f0Aw9Uswr9ic0GCgvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBG','CMvHzezPBgu','zMXVB3i','rxjYB3iGC2vHCMnOAw5NigzVCIbJB252zxjZyxrPB24GAgLZDg9YEtOG','ChjVBxb0lwvUz2LUzwvY','ihbLBMrPBMCPoG','DgHLBG','y29UzMLN','cUkpSYbuB29Sia','y3jLyxrLsw5PDgLHBfbYB21WDezVCKvUz2LUzwvY','BMfTzq','ugXLyxnLihrYEsbYzxj1BM5PBMCGDgHLienmssb3AxrOigrVlcbTB2rPzNKSig9YihjLC3vTzsbJB21Tyw5KCYbHC2TPBMCGDgHLigfNzw50ihrVignVBNrPBNvLlG','Dg9VBenOzwnRsw50zxj2ywW','ls1fBMqGB2yGu3vTBwfYEs0T','y29UDMvYC2f0Aw9UsgLZDg9YEq','BwfW','cIaGicaGicaGicaGifrOzsb0yxnRigLZihrVig1VzgLMEsbJB250zw50igLUihrOzsbKAxjLy3rVCNKGjW','sgfUzgXPBMCGDxnLCIbWCM9TChq6ia','uhjVy2vZC2LUzYbwuYbdB2rLig1LC3nHz2u6','teftvf9trvntsu9ox0zjtevoqu1f','xtOG','Dhj5tg9HzenVBNzLCNnHDgLVBKHPC3rVCNLcEvbHDhrLCM4','mZa5nMzYseTira','ihbLBMrPBMCGB3bLCMf0Aw9UCYb0BYbJB21WBgv0zsbVCIb0Aw1LB3v0','q29TCgfJDgL6yxrPB24Gy29TCgXLDgvKigzVCIa','CgvYzM9YBunVBxbHy3rPEMf0Aw9U','AgfZvg9VBa','sw50zxjHy3rPB24GBw9KzsbJAgfUz2vKoIa','rxjYB3iGC3rHCNrPBMCGBMv3ignVBNzLCNnHDgLVBJO','qwDLBNqG','sM9IignVBxbSzxrLzdOG','ignVBxbSzxrLzcb3AxrOihjLC3vSDdO','z3jHEq','w1n5C3rLBsbbDxrVlvjLC3bVBNnLxtOG','z2v0vg9VBhnezxnJCMLWDgLVBG','u2vZC2LVBIbZDgf0zsbZyxzLzcbZDwnJzxnZzNvSBhKGD2L0AcbPBMrLEcbMAwXLCW','AxntAhv0DgLUz0rVD24','ww91igfYzsbmB3HPysbbssWGysbOzwXWzNvSignVzgLUzYbHC3nPC3rHBNqUifLVDsbHCMuGAw50zwDYyxrLzcbPBNrVifztienVzguGyw5KignHBIbOzwXWihDPDgGGy29KzsbHBMfSExnPCYWGz2vUzxjHDgLVBIWGyw5KigDLBMvYywWGzgv2zwXVCg1LBNqGDgfZA3mUcGPdDxjYzw50ihDVCMTZCgfJztOG','q3jLyxrPBMCGy29UDMvYC2f0Aw9UoIa','uhjVy2vZC2LUzYa','D2fYBG','q291BgqGBM90ihjLywqGC2vZC2LVBIbZDgf0zsbVCIbPBMrLEcbMAwXLoIa','w3rVB2XZlwnVBw1HBMrZxsb0ywDZihrVihvZzsb0B29SCYWGB3iGDgHLigzVBgXVD2LUzYbZEw50yxGGDg8GAw50zxjHy3qGD2L0Acb0AguGC3vWzxj2AxnPBMCGAhvTyw4GDxnLCJOGw3bYB21WDcbUyw1LpsjZB21LihbYB21WDcbKAxnWBgf5ihrPDgXLiL08ChjVBxb0ig1LC3nHz2u+w29WDgLVBL08B3b0Aw9UideGDgv4Dd5Bl29WDgLVBL0Gw29WDgLVBL08B3b0Aw9UidiGDgv4Dd5Bl29WDgLVBL0UlI5Bl3bYB21WDf0k','seLtve9swv9tvuzgsvG','igr1CMLUzYbZAhv0zg93BG','mtaYnZHowhzHseq','ignVBxbSzxrLzcWG','D2fPDgLUzY1MB3iTywDLBNq','z3jLzw4','q09nuefdveLAqvrjt05Fru5ex1bfuKnftLrbr0u','u1vntufswv9nqvjlrvjFqKvhsu4','qwz0zxiGy29TCgfJDgL6yxrPB246ia','sw5KzxGGzMLSzsbZyxzLzcb0BZOG','CMvXDwLYzxnszxnWB25Zzq','vg9VBca','ihrVB2XZihDLCMuGzMLYzs1HBMqTzM9Yz2v0lcbUBYbYzxnWB25ZzsbZzw50ihrVigfNzw50','ve9ptf9dquXmx0zsrvfvru5dwv9dsevds19nuW','B3b0Aw9UCW','q29UDMvYC2f0Aw9UihjLC3vTzwqGD2L0Ag91DcbJB21WBgv0zsbOAxn0B3j5','BgfUz3vHz2vnB2rLBefNzw50swq','tM8GChjVAMvJDcbKAxjLy3rVCNKGC2v0lcbJyw5UB3qGC2f2zsbZzxnZAw9Uihn0yxrL','z2v0tgfUz3vHz2vnB2rLBfn5C3rLBvbYB21WDa','icaXlIbvC2uGDgHLihjLC3vTzsbJB21Tyw5KihrVignVBNrPBNvLihrOAxmGy29UDMvYC2f0Aw9UoG','z2v0sw1Hz2vezxnJCMLWDgLVBG','rMfPBgvKihrVihnHDMuGC2vZC2LVBIbZDgf0ztO','DMfSDwvZ','yxnZAxn0yw50','C3LZDgvT','DxbKyxrLuhjVAMvJDerPCMvJDg9YEq','8j+AQYbcBg9JA2LUzYbTzxnZywDLigLUigLUDgvYywn0AxzLig1Vzgu6ia','BgfZDefJDgL2Axr5vgLTzq','C2v0','lIbnzxnZywDLCYbYzwr1y2vKigzYB20G','CMvJAxbPzw50','Aw5MBW','icaGicbSB3HPysbKBYaIy29UDgLUDwuGDgHLihbYzxzPB3vZihDVCMSGAw4GDgHPCYbKAxjLy3rVCNKI','AgfUzgXLuhjVBxb0vg9Vtg9UzW','z2v0sw5KAwnHDg9YrgLZCgXHEq','C2f2zvvZywDLrgf0yq','Dg9VBfjLz2LZDhj5','y2f0y2G','C2v0qNvKz2v0tgLTAxq','icbHBMqGDgHLihn1Bw1HCNKGC2vYDMLJzsbPCYb1BMf2ywLSywjSzs4','AgfZ','D2HPDgu','Dg9VBenVBw1HBMrZ','yMXVy2TLze1LC3nHz2vZ','rMfPBgvKihrVigXVywqGy29UDMvYC2f0Aw9UigHPC3rVCNKGzM9Yia','CMvHzgrPCG','uM91DgLUzYbTzxnZywDLigzYB20G','y29UDgv4DfDPBMrVDW','BwfRzxjbz2vUDeLK','y29UDMvYC2f0Aw9UlwLUzgv4lMPZB24','tM8GBwfRzxiGywDLBNqGzM91BMqGDg8GC2vUzcb1C2vYigLUChv0ihrV','u3vTBwfYEsbMywLSDxjLigrLDgfPBhm6','DxrMltG','C2v0uhjVAMvJDerPCMvJDg9YEq','y29UDMvYC2f0Aw9Ulq','CM9Szq','mJu5Aw5vqvHl','y29UDMvYC2f0Aw9UCW','tuflrvjFquDftLrFrevgqvvmvf9jra','tg9HzgvKignVBNzLCNnHDgLVBIbOAxn0B3j5igzVCJOG','C2XPy2u','sM9IigrVBMuGCMvJzwL2zwq6ia','rMfPBgvKihrVihf1zxvLihrVB2WG','z2v0q29UDgv4DfDPBMrVD1nPEMu','y29UDgvUDa','CgfYC2u','C2f2zvnLC3nPB25tDgf0zq','y29UDMvYC2f0Aw9UswrnyxbWAw5N','zxn0Aw1HDgvuB2TLBKnVDw50','Bw9KzwW','BgXTu2vYDMLJzq','ugvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBIbMB3iGy29UDMvYC2f0Aw9Uia','iIbMB3iGChjVBxb0oIa','ihn5C3rLBsbTzxnZywDLoIKGChjVy2vLzc4GswyGC3r1y2SGzM9YihrVBYbSB25NihvZzsb0B29SCYbVCIbWzxjMB3jTig9WzxjHDgLVBNmGDg8GzwzMzwn0AxzLBhKGy29UDgLUDwuGDgHLihrHC2SU','BwvZC2fNzxm','icHTB2rLoIa','zw5Oyw5Jzvn5C3rLBvbYB21WDa','yxv0BW','CMvWzwf0','zgvIDwC','C2v0v2fPDgLUz0zVCLvZzxjjBNb1Da','icbuAgLZignHBIbOyxbWzw4GD2HLBIb0AguGy29UDMvYC2f0Aw9UigjLy29TzxmGDg9VigXHCMDL','ugXLyxnLigLTCgXLBwvUDcb0AguGB25vC2vYuhjVBxb0igHHBMrSzxiGAw4GDgHLienmss4','Bg9Nz2vY','Bwf4','EwvSBg93','Bw9KzwXZ','C2vZC2LVBLn0yxrL','z2v0uhjVBxb0rw5NAw5LzxjtExn0zw1qCM9TChq','AxnxywL0Aw5NrM9YvxnLCKLUChv0','B3jPz2LUywXtExn0zw1qCM9TChrZ','BwvZC2fNzq','ywn0AxzLq29UDMvYC2f0Aw9UswrZ','Aw5PDgLHBgL6zvnLCNzPy2vZ','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbZAhv0igrVD24GC3vJy2vZC2z1BgX5','C2f2zunVBNzLCNnHDgLVBKHPC3rVCNK','z2v0qMXVy2TPBMDtDgf0Dxm','BM93','CgvUzgLUz1jLC3vSDhm','ve9ptf9tvefuvvnFvvbeqvrfx0LovevsvKfmx01t','ignVBxbSzxrLzcbZDwnJzxnZzNvSBhKU','CgfYC2vnzxnZywDL','CMvTB3zLuhjVBxb0u3LUDgf4rNjVBvn5C3rLBvbYB21WDa','u3rHDguGzgLYzwn0B3j5ignYzwf0zwqVDMvYAwzPzwq6ia','y3jLyxrLq29UDMvYC2f0Aw9U','x3nHBML0AxPLq29UDMvYC2f0Aw9UswrgB3jgAwXL','D3jPDgvgAwXL','w1n5C3rLBv06iev4zwn1DgLVBIbOyxmGyMvLBIbYzxn1BwvKigj5ihrOzsb1C2vYlG','C2vUze1LC3nHz2u','ChjVy2vZC01LC3nHz2u','zMLSDgvY','4PYfievYCM9YlxrYAwDNzxjLzcbJB21Wywn0AxPHDgLVBIbJB21WBgv0zwqGzM9Yia','q29UDMvYC2f0Aw9Uia','u1rbvevFreLsx05btuu','BwTKAxi','AM9PBG','q291BgqGBM90igzPBMqGAgLZDg9YEsbMB3iG','B3bLCMf0Aw9Uswq','8j+uKYbjBNrLCMfJDgL2zsbTB2rLoIbszxn1BwLUzYbTzxnZywDLigzSB3C','DxbKyxrLq29UDMvYC2f0Aw9Uu3LZDgvTuhjVBxb0','icHMAwXLoIa','vw5RBM93BG','A2v5CW','iIaTpIaI','AwrSzvrPBwvY','tgfZDcbZzxnZAw9UigzPBguGC2f2zwqGDg86ia','B25kB2jeB25L','cIaGicaGicaGicaGia','rMfPBgvKihrVihjLC3vTzsbJB252zxjZyxrPB246','8j+tPcbtzw5KAw5Nigf1Dg8TChjVy2vLzcbTzxnZywDLlI4U','ChjVBxb0','q2fUBM90igrPC3bSyxKGChjVBxb0ihrVihvZzxi6ie5VihbYB21WDcbOyw5KBgvYigLZihjLz2LZDgvYzwqUia','8j+uHcbutYbdt05usu5vrsbzt1vsifDpuKS6','vLmGq29KzsbTzxnZywDLihbYB2nLC3nLzcbZDwnJzxnZzNvSBhK','ChvZAa','y3jLyxrLu3vTBwfYEvbYB21WDa','q09nuefdveLAqvrjt05FveHsrvnit0Xex1bfuKnftLrbr0u','8j+uKIbjBNrLCMfJDgL2zsbTB2rLoIbcBg9JA2LUzYbHDxrVBwf0AwmGBwvZC2fNzxm','AgfUzgXLsM9Irg9UzujHC2vKt25nB2rL','mZqZmJq4DNvjufPe','qvvutYbTB2rLoIbbDxrVlxnLBgvJDgvKici','ig5VDcbMB3vUzcbMB3iGy29TCgfJDgL6yxrPB24','Dgv4Da','zgvMyxvSDa','ndmXmxjVtffoza','zw50CMLLCW','DxnLCG','q3jPDgLJywWGzxjYB3i6ienHBM5VDcbJCMvHDguGy29UDMvYC2f0Aw9Uihn1Bw1HCNKGzM9Yia','ote5nJmWwwDpALLf','D29YA3nWywnLuM9VDa','twvZC2fNzsbIBg9JA2vKic0GD2fPDgLUzYbMB3iGDxnLCIbPBNb1Da','ChjVAMvJDerPCG','igzYB20GzMLSzsa','Aw5PDgLHBgL6zq','tefor1vbr0vFtu9eruXFsuq','nuzMwg5SuG','Dg9VBeLK','ignVBNzLCNnHDgLVBIbjrcbTyxbWAw5NCW','BgfUz3vHz2uTBw9KzwW','Bg9HzenVBNzLCNnHDgLVBKHPC3rVCNK','CMvK','mJm4mdCYvwfwBejo','D2fPDgLUzY1MB3iTBgXT','q09nuefdveLAqvrjt05Ft1vuufvux1jfu0vsvKvFuevsq0vovefhrq','C2HVDwXKqMXVy2TnzxnZywDL','C2vUzfbYB2nLzwrnzxnZywDL','z2v0','ChjVBwLZzq','su5ervHFrKLmru5btuu','ChjVy2vZC1rVB2XdB21Tyw5KCW','C3vJy2vZCW','yMvNAw4GBw9KAwzPy2f0Aw9Uig9MignVBNrLBNqGAw4G','Aw5JBhvKzxm','v2fPDgLUzYbMB3iG','Dg9ju09tDhjPBMC','ig1LC3nHz2vZ','q29UDMvYC2f0Aw9UihjLC3vTzwq','DhjPz2DLCLbYB2nLzwq','zxHLy3v0zq','yMX1zq','CxvLDwvqzw5KAw5NuMvZDwX0','Aw50zxjHy3rPB25nB2rL','y2HLy2TuB29SrxHLy3v0Aw9Uu3rHDhvZ','z2v0tgLZDe9MqxzHAwXHyMXLqwDLBNrjzhm','cKnVBNrPBNvLihDPDgGGB3rOzxiGDgfZA3mGyw5KieKNBgWGBM90Awz5ihLVDsb3AgvUigL0j3mGzg9Uzs4','AwrSzunOzwnRsw50zxj2ywW','zNjVBuvUDhjPzxm','igzHAwXLzdOG','ns4Gw1vtrviGufjptvbuuYbesvnbqKXfrcbjtIbbvvrpie1prevDia','4PYxiezHAwXLzcb0BYbJCMvHDguGy29UDMvYC2f0Aw9Uihn1Bw1HCNK','yM9Sza','8j+uHcbbDxrVlxbYB2nLzwrPBMCGywz0zxiGmYbZzwnVBMrZig9MigLKBguGDgLTzq','C3rYAw5NAwz5','BgfUz3vHz2vnB2rLBa','ms4WlJa','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbPBML0AwfSAxPLzcb3AxrOihbYB2PLy3q6ia','w1vZzxiGAw5WDxrDoG','ChjVy2vZC0fNzw50twvZC2fNzq','ywn0AxzLvg9VBhm','CYbLBgfWC2vKks4Gt3bLCMf0Aw9UieLeoIa','cGPzB3uGyxjLigv4CgvJDgvKihrVignVBNn1BhqGEw91CIbmte0GywDLBNqGDxnPBMCGDgHLifTTzxnZywDLxsb0ywCGD2L0Acb0AguGzM9SBg93Aw5NigLKCZOG','q2fUBM90ihnLBMqGBwvZC2fNzsb0BYa','Aw50zxjHy3rPDMu'];a0_0x4125=function(){return _0x271872;};return a0_0x4125();}export class ConversationOrchestrator{constructor(_0x4cdfec,_0xebed2c){const _0x3a8a43=a0_0xac6c34;this[_0x3a8a43(0x199)]=_0x4cdfec,this['logger']=_0xebed2c,this[_0x3a8a43(0xb4)]=[],this['tagParserService']=new TagParserService(_0xebed2c),this[_0x3a8a43(0xcf)]=new LLMService(_0x4cdfec,_0xebed2c),this[_0x3a8a43(0xcf)][_0x3a8a43(0x17e)](_0x2233c1=>this[_0x3a8a43(0x1de)](_0x2233c1)),this[_0x3a8a43(0xad)]=new ToolRegistry(_0x4cdfec,_0xebed2c,this['llmService']),this['budgetService']=new BudgetService(_0x4cdfec,_0xebed2c),this['conversations']=new Map(),this['activeTools']=new Map(),this['conversationIdMapping']=new Map(),this['interactionMode']='interactive',this['originalSystemPrompts']=new Map(),this[_0x3a8a43(0xe0)]={'projectDir':null,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{}},this[_0x3a8a43(0x19e)]=setInterval(()=>this[_0x3a8a43(0x13f)](),CONVERSATION_CONSTANTS[_0x3a8a43(0x1ca)]),this[_0x3a8a43(0x178)]=_0x3a8a43(0x17d),this['lastActivityTime']=Date[_0x3a8a43(0xea)](),this['idleTimer']=null,this['IDLE_TIMEOUT_MS']=0x1388,this['isShuttingDown']=![],this['startIdleMonitoring']();}async['initializeWithProject'](_0x368b3b){const _0x511c1a=a0_0xac6c34;this['sessionState']['projectDir']=_0x368b3b,this[_0x511c1a(0xad)][_0x511c1a(0xbe)](_0x368b3b),this['logger']['info']('Conversation\x20orchestrator\x20initialized\x20with\x20project:\x20'+_0x368b3b);}async['initializeWithProject'](_0x12f631){const _0x178ce1=a0_0xac6c34;this['sessionState'][_0x178ce1(0x120)]=_0x12f631,this['toolRegistry']['setProjectDirectory'](_0x12f631),this['logger']['info'](_0x178ce1(0x14c)+_0x12f631);}['setProjectDirectory'](_0x2f694b){const _0x126472=a0_0xac6c34;this[_0x126472(0xe0)][_0x126472(0x120)]=_0x2f694b,this['toolRegistry']&&this['toolRegistry'][_0x126472(0xbe)](_0x2f694b),this[_0x126472(0xdc)]['info']('Updated\x20conversation\x20orchestrator\x20project\x20directory:\x20'+_0x2f694b);}async[a0_0xac6c34(0x122)](){const _0x5b1269=a0_0xac6c34;this['toolRegistry']=new ToolRegistry(this['config'],this[_0x5b1269(0xdc)]),await this['toolRegistry'][_0x5b1269(0x180)]();}[a0_0xac6c34(0x1d6)](_0x487e1a){const _0xbd8429=a0_0xac6c34;this[_0xbd8429(0xbe)](_0x487e1a);}['startIdleMonitoring'](){this['idleCheckInterval']=setInterval(()=>{const _0x497fbf=a0_0xfcae;if(this[_0x497fbf(0x1b6)])return;if(this['interactionMode']==='interactive')return;const _0x5c994c=Date[_0x497fbf(0xea)](),_0x53fde2=_0x5c994c-this['lastActivityTime'];this['messageIndicator']==='idle'&&_0x53fde2>=this['IDLE_TIMEOUT_MS']&&this['sessionState'][_0x497fbf(0xb9)]&&(this['logger'][_0x497fbf(0x1dc)](_0x497fbf(0x148)),this['sendProceedMessage']());},0x1f4);}['setWaitingForUserInput'](_0x50bb3d){const _0x11791c=a0_0xac6c34,_0x4c24cf=this[_0x11791c(0xe2)];this['isWaitingForUserInput']=_0x50bb3d;if(_0x50bb3d&&!_0x4c24cf)console[_0x11791c(0x18f)](a0_0xefb2b7[_0x11791c(0x188)](_0x11791c(0x112)));else!_0x50bb3d&&_0x4c24cf&&(console[_0x11791c(0x18f)](a0_0xefb2b7['green'](_0x11791c(0xff))),this[_0x11791c(0xb4)]=[]);}['shouldBlockMessage'](_0x3242b7,_0x10680f){const _0x2abdcb=a0_0xac6c34;if(this['interactionMode']!=='interactive'||!this['isWaitingForUserInput'])return![];if(_0x10680f[_0x2abdcb(0x135)](_0x2abdcb(0x14d)))return![];if(_0x10680f[_0x2abdcb(0x135)]('(system\x20message)'))return![];return!![];}['updateMessageIndicator'](_0xf1a56c){const _0xf6dde4=a0_0xac6c34,_0x399eac=this['messageIndicator'];this['messageIndicator']=_0xf1a56c,this[_0xf6dde4(0x1d8)]=Date[_0xf6dde4(0xea)]();this['idleTimer']&&(clearTimeout(this['idleTimer']),this['idleTimer']=null);if(_0x399eac!==_0xf1a56c){const _0x2a30ad=this['getIndicatorDisplay'](_0xf1a56c);console[_0xf6dde4(0x18f)](a0_0xefb2b7['gray'](_0x2a30ad+'\x20'+_0xf1a56c));}}[a0_0xac6c34(0x1df)](_0xf973ac){const _0x3c54a6=a0_0xac6c34;switch(_0xf973ac){case _0x3c54a6(0x1c1):return a0_0xefb2b7[_0x3c54a6(0xde)]('â³');case _0x3c54a6(0x12b):return a0_0xefb2b7[_0x3c54a6(0x13c)]('ðŸ¤–');case'idle':return a0_0xefb2b7[_0x3c54a6(0x1c2)]('âœ“');default:return'â€¢';}}async[a0_0xac6c34(0x12e)](){const _0xc3ca50=a0_0xac6c34;if(!this[_0xc3ca50(0xe0)]['makerAgentId']||this['isShuttingDown'])return;try{this[_0xc3ca50(0x157)]('waiting-for-agent'),console[_0xc3ca50(0x18f)](a0_0xefb2b7['gray'](_0xc3ca50(0x10a)));const _0x5180e2=new Date()[_0xc3ca50(0x167)]()['split']('\x20')[0x0];await this[_0xc3ca50(0x158)](this[_0xc3ca50(0xe0)]['makerAgentId'],'('+_0x5180e2+_0xc3ca50(0xd2));}catch(_0x243667){this['logger'][_0xc3ca50(0x176)](_0xc3ca50(0x165),_0x243667),this['updateMessageIndicator']('idle');}}['setInteractionMode'](_0x2c5532){const _0xdff89d=a0_0xac6c34,_0x55240c=this['interactionMode'];this[_0xdff89d(0x13e)]=_0x2c5532,this['logger']['info'](_0xdff89d(0x1ad)+_0x55240c+'\x20->\x20'+_0x2c5532);if(_0x2c5532==='interactive'&&_0x55240c!==_0xdff89d(0x153))this[_0xdff89d(0xd9)](!![]);else _0x2c5532!==_0xdff89d(0x153)&&_0x55240c===_0xdff89d(0x153)&&this[_0xdff89d(0xd9)](![]);this['updateSystemPromptsForMode'](_0x2c5532);}[a0_0xac6c34(0xe9)](){const _0x33ab74=a0_0xac6c34;return{'interactionMode':this['interactionMode'],'isWaitingForUserInput':this['isWaitingForUserInput'],'blockedMessagesCount':this['blockedMessages'][_0x33ab74(0x185)],'indicatorState':this['messageIndicator']};}[a0_0xac6c34(0x187)](_0x4c6cfb){const _0x4c5f01=a0_0xac6c34;for(const [_0x33384f,_0x28b95a]of this[_0x4c5f01(0xc2)]){this[_0x4c5f01(0x100)](_0x33384f,_0x4c6cfb);}}['updateConversationSystemPrompt'](_0x15d5fc,_0x1a391f){const _0x7b62b1=a0_0xac6c34,_0x2d7e95=this['conversations'][_0x7b62b1(0x12f)](_0x15d5fc);if(!_0x2d7e95)return;!this['originalSystemPrompts']['has'](_0x15d5fc)&&this[_0x7b62b1(0xe3)]['set'](_0x15d5fc,_0x2d7e95['systemPrompt']);const _0x275abe=this[_0x7b62b1(0xe3)]['get'](_0x15d5fc);let _0x39f8dd;_0x1a391f===_0x7b62b1(0xd6)?_0x39f8dd=this[_0x7b62b1(0xef)](_0x275abe):_0x39f8dd=_0x275abe,_0x2d7e95['systemPrompt']=_0x39f8dd,this['llmService']&&this['llmService']['updateConversationSystemPrompt']&&this[_0x7b62b1(0xcf)][_0x7b62b1(0x100)](_0x15d5fc,_0x39f8dd),this['logger'][_0x7b62b1(0xd8)]('Updated\x20system\x20prompt\x20for\x20'+_0x15d5fc+'\x20(mode:\x20'+_0x1a391f+')');}[a0_0xac6c34(0xef)](_0x27f86c){const _0x23aca6=a0_0xac6c34;let _0x26666e=_0x27f86c[_0x23aca6(0x18c)](/5\.\s*If you need user input or a decision[^6]*/,_0x23aca6(0x145));return _0x26666e=_0x26666e[_0x23aca6(0x18c)](/\[prompt[^\]]*\][^[]*\[\/prompt\]/g,''),_0x26666e+='\x0a\x0a/*\x20NOTE:\x20Prompt\x20syntax\x20removed\x20for\x20auto\x20mode.\x20'+'To\x20re-enable,\x20switch\x20to\x20interactive\x20mode\x20or\x20modify\x20enhanceSystemPrompt()\x20*/',_0x26666e;}[a0_0xac6c34(0xd5)](_0x31ebf5,_0x14cc59,_0x58bbc4,_0x3a7596){const _0x266e65=a0_0xac6c34;let _0x240b98=_0x31ebf5;return!_0x240b98['toLocaleLowerCase']()['includes']('tools\x20available\x20are')&&(_0x240b98+=_0x266e65(0x156)+_0x14cc59),!_0x240b98['toLocaleLowerCase']()['includes']('using\x20the\x20[message]\x20tag\x20with\x20the\x20following\x20ids')&&(_0x240b98+=_0x266e65(0x151)+_0x3a7596['join'](',\x20')+'\x0a\x20This\x20section\x20will\x20be\x20sent\x20apart\x20from\x20the\x20tool\x20instructions.'),!_0x240b98['includes']('conversation\x20rules\x20are')&&(_0x240b98+=_0x266e65(0x17c)+_0x58bbc4+'\x0a\x20\x20\x20\x20'),_0x240b98;}[a0_0xac6c34(0xf2)](_0x58859c){const _0x168762=a0_0xac6c34;if(!_0x58859c||typeof _0x58859c!=='string')return'conversation-'+Date['now']();let _0x1675ff=_0x58859c[_0x168762(0x18c)](/\s+/g,'-')['replace'](/[^a-zA-Z0-9_-]/g,'')['replace'](/-+/g,'-')['replace'](/^-+|-+$/g,'')['toLowerCase']();if(!_0x1675ff)_0x1675ff=_0x168762(0xbf)+Date['now']();else _0x1675ff[_0x168762(0x185)]>0x32&&(_0x1675ff=_0x1675ff[_0x168762(0x166)](0x0,0x28)+'-'+Date['now']()['toString']()[_0x168762(0xc5)](-0x8));return _0x1675ff;}[a0_0xac6c34(0x169)](_0xd24f4d){const _0x337d7f=a0_0xac6c34;if(this[_0x337d7f(0xcc)][_0x337d7f(0xb1)](_0xd24f4d))return this[_0x337d7f(0xcc)][_0x337d7f(0x12f)](_0xd24f4d);const _0x3c70c3=this['_sanitizeConversationIdForFile'](_0xd24f4d);return this[_0x337d7f(0xcc)][_0x337d7f(0x1d9)](_0xd24f4d,_0x3c70c3),_0x3c70c3!==_0xd24f4d&&this[_0x337d7f(0xdc)][_0x337d7f(0x1dc)]('Mapped\x20conversation\x20ID\x20for\x20file\x20operations:\x20\x22'+_0xd24f4d+_0x337d7f(0x104)+_0x3c70c3+'\x22'),_0x3c70c3;}async['initializeServices'](){const _0xc5266a=a0_0xac6c34;this[_0xc5266a(0xcf)]&&this['toolRegistry']&&(this['toolRegistry']['setLLMService'](this[_0xc5266a(0xcf)]),this[_0xc5266a(0xdc)][_0xc5266a(0x1dc)]('LLM\x20service\x20connected\x20to\x20tool\x20registry\x20for\x20vision\x20capabilities'));}async['getImageDescription'](_0x5ea5d9,_0x2ecbeb,_0x53f4cb={}){const _0x100eb6=a0_0xac6c34;if(!this['llmService'])throw new Error('LLM\x20service\x20not\x20available\x20for\x20image\x20description');return await this[_0x100eb6(0xcf)][_0x100eb6(0x1d1)](_0x5ea5d9,_0x2ecbeb,_0x53f4cb);}async['handleUserPromptBasedOnMode'](_0x56ef90,_0x40bc39){const _0x5e0ff0=a0_0xac6c34;this['logger'][_0x5e0ff0(0x1dc)]('Handling\x20user\x20prompt:\x20'+_0x40bc39[_0x5e0ff0(0x19c)]+_0x5e0ff0(0x17b)+_0x56ef90+_0x5e0ff0(0xd4)+this['interactionMode']+')');switch(this[_0x5e0ff0(0x13e)]){case _0x5e0ff0(0xd6):const _0x2da545=_0x40bc39['options']&&_0x40bc39['options'][_0x5e0ff0(0x185)]>0x0?_0x40bc39['options'][0x0]:'Continue\x20automatically';this[_0x5e0ff0(0xdc)][_0x5e0ff0(0x1dc)](_0x5e0ff0(0x115)+_0x2da545+_0x5e0ff0(0xd1)+_0x40bc39[_0x5e0ff0(0x19c)]),await this['sendMessageToConversation'](_0x56ef90,_0x5e0ff0(0x1b3)+_0x2da545);break;case _0x5e0ff0(0x182):if(this[_0x5e0ff0(0x159)]){const _0x1a3792=await this[_0x5e0ff0(0x159)](_0x40bc39['name'],_0x40bc39['text'],_0x40bc39[_0x5e0ff0(0x1cb)]);await this[_0x5e0ff0(0x158)](_0x56ef90,'User\x20selected:\x20'+_0x1a3792);}else await this['sendMessageToConversation'](_0x56ef90,'Cannot\x20display\x20prompt\x20to\x20user:\x20No\x20prompt\x20handler\x20is\x20registered.\x20'+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');break;case _0x5e0ff0(0x153):default:if(this[_0x5e0ff0(0x159)]){const _0x3c4dde=await this['onUserPrompt'](_0x40bc39['name'],_0x40bc39[_0x5e0ff0(0x117)],_0x40bc39[_0x5e0ff0(0x1cb)]);await this['sendMessageToConversation'](_0x56ef90,'User\x20selected:\x20'+_0x3c4dde);}else await this['sendMessageToConversation'](_0x56ef90,_0x5e0ff0(0x10c)+_0x5e0ff0(0xdb));break;}}async[a0_0xac6c34(0x113)](_0x93fcb6){const _0x247303=a0_0xac6c34;this['logger']['info'](_0x247303(0xc6)+_0x93fcb6+_0x247303(0xd4)+this['interactionMode']+')');if(this['onJobDone'])await this[_0x247303(0x107)](_0x93fcb6);else switch(this['interactionMode']){case'auto':this[_0x247303(0xdc)]['info'](_0x93fcb6+'\x0aThank\x20you\x20for\x20choosing\x20Loxia.'),process['exit'](0x0);break;case'semi-auto':this['logger']['info'](_0x247303(0x1b0)+_0x93fcb6),this['logger'][_0x247303(0x1dc)]('SEMI-AUTO\x20mode:\x20Task\x20completed.\x20Press\x20Ctrl+I\x20to\x20enter\x20interactive\x20mode\x20or\x20exit.');break;case _0x247303(0x153):default:this[_0x247303(0xdc)]['info'](_0x247303(0x1b0)+_0x93fcb6);break;}}[a0_0xac6c34(0x16b)](_0x57623a){const _0x1e585e=a0_0xac6c34;this[_0x1e585e(0x107)]=_0x57623a;}async['processAgentMessage'](_0x325394,_0xdbbf0){const _0x49ca3d=a0_0xac6c34;this[_0x49ca3d(0xdc)]['info']('Processing\x20message\x20from\x20'+_0x325394);const _0x507c67=this['tagParserService'][_0x49ca3d(0xee)](_0xdbbf0);_0x507c67['toolCommands']&&_0x507c67[_0x49ca3d(0xb3)]['length']>0x0&&await this[_0x49ca3d(0x132)](_0x325394,_0x507c67[_0x49ca3d(0xb3)]);_0x507c67[_0x49ca3d(0x10b)]&&await this['handleUserPromptBasedOnMode'](_0x325394,_0x507c67[_0x49ca3d(0x10b)]);if(_0x507c67['jobDone']!=null){await this['handleJobDoneBasedOnMode'](_0x507c67['jobDone']);return;}if(_0x507c67[_0x49ca3d(0x1db)]){const _0x216058=_0x507c67['recipient'],_0x7d9754=_0x507c67[_0x49ca3d(0xc9)];await this['routeMessageToAgent'](_0x325394,_0x216058,_0x7d9754),this[_0x49ca3d(0xdc)][_0x49ca3d(0x1dc)]('['+displayOnly(_0x325394,0xa)+'\x20->\x20'+displayOnly(_0x216058,0xa)+']:\x20'+displayOnly(_0x7d9754,0xff)+'\x0a');}!_0x507c67['recipient']&&(!_0x507c67['toolCommands']||_0x507c67['toolCommands']['length']===0x0)&&!_0x507c67['prompt']&&!_0x507c67['jobDone']&&await this[_0x49ca3d(0x158)](_0x325394,'Your\x20message\x20didn\x27t\x20contain\x20any\x20tool\x20commands,\x20a\x20message\x20to\x20another\x20agent,\x20or\x20a\x20prompt.\x20'+'Please\x20use\x20[message\x20to=\x22...\x22]\x20tags\x20to\x20send\x20a\x20message\x20to\x20another\x20agent,\x20'+_0x49ca3d(0x1bc));}[a0_0xac6c34(0x18d)](_0x4c84f0){const _0x49b96a=a0_0xac6c34,_0x56f722=CONVERSATION_CONSTANTS[_0x49b96a(0xc3)],_0x1a4c32=_0x49b96a(0x170);try{const _0x127b40=TagParser['extractStructured'](_0x4c84f0,{'role':'ai-role','systemPrompt':'system-prompt'});let _0x51401e=_0x127b40['role'];_0x51401e?_0x51401e=_0x51401e['replace'](/[\\/]/g,''):(_0x51401e=_0x56f722,this[_0x49b96a(0xdc)]['warn']('Failed to parse role from prompt engineer response, using default'));let _0x36d33a=_0x127b40['systemPrompt'];return!_0x36d33a&&(_0x36d33a=''+_0x1a4c32+_0x4c84f0,this[_0x49b96a(0xdc)]['warn']('Failed to parse system prompt from prompt engineer response, using generated one')),{'role':_0x51401e,'systemPrompt':_0x36d33a};}catch(_0x3ed4cd){return this['logger'][_0x49b96a(0x176)]('Error\x20parsing\x20prompt\x20engineer\x20response:',_0x3ed4cd),{'role':_0x56f722,'systemPrompt':''+_0x1a4c32+_0x4c84f0};}}async['startNewConversation'](_0x482df1,_0x24a9f6,_0x265cbb,_0x484b80){const _0x47f9a8=a0_0xac6c34;this[_0x47f9a8(0xdc)][_0x47f9a8(0x1dc)](_0x47f9a8(0x184)+_0x482df1),this['sessionState']['projectDir']=_0x24a9f6;const _0x4badab=a0_0x205658[_0x47f9a8(0xfc)](_0x24a9f6,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x2fa941[_0x47f9a8(0xfb)](_0x4badab,{'recursive':!![]}),this['sessionState']={'projectDir':_0x24a9f6,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{},'paused':![]};try{const _0xfae970=this['getPromptEngineerSystemPrompt'](this[_0x47f9a8(0xad)][_0x47f9a8(0x1b4)]()),_0x2ecbc7=CONVERSATION_CONSTANTS['PROMPT_ENGINEER_ID'];await this['createConversation'](_0x2ecbc7,_0xfae970,[],_0x265cbb);const _0x1bc215=this['createInitialPromptForEngineer'](_0x482df1),_0x289aa5=await this[_0x47f9a8(0x158)](_0x2ecbc7,_0x1bc215),{role:_0x26f549,systemPrompt:_0xa39639}=this['parsePromptEngineerResponse'](_0x289aa5),_0x2cd566=_0x26f549||CONVERSATION_CONSTANTS['MAKER_AGENT_DEFAULT_ID'];this[_0x47f9a8(0xe0)]['makerAgentId']=_0x2cd566;const _0x5a083c=this['enhanceSystemPrompt'](_0xa39639,this[_0x47f9a8(0xad)][_0x47f9a8(0x1b4)](),this['sessionState']['projectDir'],[CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID']]);await this[_0x47f9a8(0xf1)](_0x2cd566,_0x5a083c,[],_0x265cbb);const _0x1187aa=CONVERSATION_CONSTANTS[_0x47f9a8(0x123)];this['sessionState'][_0x47f9a8(0x1cd)]=_0x1187aa;const _0x42f8ea=this['getLanguageModelSystemPrompt'](this[_0x47f9a8(0xad)][_0x47f9a8(0x1b4)](),_0x2cd566);await this[_0x47f9a8(0xf1)](_0x1187aa,_0x42f8ea,[],_0x265cbb),this['sessionState'][_0x47f9a8(0xe5)]=[_0x2cd566,_0x1187aa],await this['saveSessionState'](),await this[_0x47f9a8(0x158)](_0x2cd566,'begin'),this[_0x47f9a8(0xdc)][_0x47f9a8(0x1dc)]('New\x20conversation\x20started\x20and\x20session\x20state\x20saved');}catch(_0x479b87){this[_0x47f9a8(0xdc)]['error'](_0x47f9a8(0x1ae),_0x479b87);throw _0x479b87;}}async[a0_0xac6c34(0x128)](_0x35c44c,_0x2e508f){const _0xa3b88f=a0_0xac6c34,_0x300037=this[_0xa3b88f(0x169)](_0x2e508f),_0x1ccdf9=a0_0x205658[_0xa3b88f(0xfc)](_0x35c44c,''+_0x300037+CONVERSATION_CONSTANTS['HISTORY_SUFFIX']);try{const _0x50002e=await a0_0x2fa941['readFile'](_0x1ccdf9,'utf-8'),_0x387eec=JSON[_0xa3b88f(0xca)](_0x50002e),_0x951bb5=(_0x387eec[_0xa3b88f(0xd3)]||[])[_0xa3b88f(0xf7)](_0x5a7725=>_0x5a7725[_0xa3b88f(0xc0)]!=='system');await this['createConversation'](_0x2e508f,_0x387eec['systemPrompt']||'Conversation\x20resumed',_0x951bb5),this[_0xa3b88f(0xdc)]['info'](_0xa3b88f(0xc4)+_0x2e508f+_0xa3b88f(0x101)+_0x300037+')');}catch(_0x4217a7){this[_0xa3b88f(0xdc)]['warn'](_0xa3b88f(0xb5)+_0x2e508f+':\x20'+_0x4217a7['message']),await this['tryLoadConversationHistoryByPattern'](_0x35c44c,_0x2e508f);}}async[a0_0xac6c34(0x1a7)](_0x52f21d,_0x276877){const _0xae9f8a=a0_0xac6c34;try{const _0x52db91=await a0_0x2fa941[_0xae9f8a(0xb6)](_0x52f21d),_0x3113e2=_0x52db91[_0xae9f8a(0xf7)](_0x5d598a=>_0x5d598a['endsWith'](CONVERSATION_CONSTANTS[_0xae9f8a(0x1bd)])),_0x2af1ba=this[_0xae9f8a(0x169)](_0x276877);for(const _0x17f1ca of _0x3113e2){const _0x4c3fa1=_0x17f1ca['replace'](CONVERSATION_CONSTANTS[_0xae9f8a(0x1bd)],'');if(_0x4c3fa1===_0x2af1ba||_0x4c3fa1['includes'](_0x2af1ba)||_0x2af1ba[_0xae9f8a(0x135)](_0x4c3fa1))try{const _0x25a216=a0_0x205658['join'](_0x52f21d,_0x17f1ca),_0x1b528c=await a0_0x2fa941[_0xae9f8a(0x193)](_0x25a216,_0xae9f8a(0xbd)),_0x2b618a=JSON[_0xae9f8a(0xca)](_0x1b528c),_0x2fda48=(_0x2b618a[_0xae9f8a(0xd3)]||[])['filter'](_0x4fe905=>_0x4fe905[_0xae9f8a(0xc0)]!==_0xae9f8a(0x1d5));await this[_0xae9f8a(0xf1)](_0x276877,_0x2b618a[_0xae9f8a(0x171)]||_0xae9f8a(0x139),_0x2fda48),this['logger']['info'](_0xae9f8a(0x15c)+_0x276877+_0xae9f8a(0x121)+_0x17f1ca);return;}catch(_0x3d00f2){this[_0xae9f8a(0xdc)]['debug']('Could\x20not\x20read/parse\x20'+_0x17f1ca+':',_0x3d00f2);}}this['logger'][_0xae9f8a(0x1ba)](_0xae9f8a(0xfd)+_0x276877+',\x20creating\x20empty\x20conversation'),await this['createConversation'](_0x276877,'Conversation\x20resumed\x20without\x20history.');}catch(_0x5bef72){this[_0xae9f8a(0xdc)]['error'](_0xae9f8a(0x195)+_0x5bef72['message']),await this['createConversation'](_0x276877,'Conversation\x20resumed\x20without\x20complete\x20history');}}async['saveConversationHistory'](_0xf3214d){const _0x348ef7=a0_0xac6c34;if(!this['sessionState'][_0x348ef7(0x120)])return;const _0x28080c=this[_0x348ef7(0xc2)]['get'](_0xf3214d);if(!_0x28080c)return;const _0x4061ad=a0_0x205658[_0x348ef7(0xfc)](this['sessionState']['projectDir'],CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x2fa941['mkdir'](_0x4061ad,{'recursive':!![]});const _0x305822={'id':_0xf3214d,'originalId':_0xf3214d,'systemPrompt':_0x28080c['systemPrompt'],'messages':_0x28080c[_0x348ef7(0xd3)],'contextWindow':_0x28080c[_0x348ef7(0xb8)],'lastUpdated':new Date()['toISOString']()},_0x310b95=this[_0x348ef7(0x169)](_0xf3214d),_0x4b6964=a0_0x205658[_0x348ef7(0xfc)](_0x4061ad,''+_0x310b95+CONVERSATION_CONSTANTS['HISTORY_SUFFIX']);await a0_0x2fa941[_0x348ef7(0xf3)](_0x4b6964,JSON['stringify'](_0x305822,null,0x2),'utf-8'),this['logger'][_0x348ef7(0x1dc)]('Conversation\x20history\x20saved\x20for\x20'+_0xf3214d+'\x20(file:\x20'+_0x310b95+')');}['_handleSummaryFailure'](_0x5d8899,_0x377ab7){const _0x125098=a0_0xac6c34;this['saveSessionState']()[_0x125098(0xae)](_0x3a71da=>{const _0x422396=_0x125098;this['logger'][_0x422396(0x176)](_0x422396(0x1d2),_0x3a71da);}),this['logger']['error'](_0x125098(0x11c)+_0x5d8899+':',_0x377ab7),console[_0x125098(0x18f)]('\x0a'+a0_0xefb2b7[_0x125098(0x129)]('ðŸš¨\x20UNRECOVERABLE\x20ERROR')),console[_0x125098(0x18f)](a0_0xefb2b7[_0x125098(0xde)]('â”'[_0x125098(0xd7)](0x3c))),console[_0x125098(0x18f)](a0_0xefb2b7['red'](_0x125098(0x146))),console[_0x125098(0x18f)](a0_0xefb2b7[_0x125098(0x1b2)](_0x125098(0xda))),console[_0x125098(0x18f)](a0_0xefb2b7['gray'](_0x125098(0xb0))),console['log'](''),console['log'](a0_0xefb2b7[_0x125098(0x147)][_0x125098(0x188)](_0x125098(0x10d))),console['log'](a0_0xefb2b7['white'](_0x125098(0x1d0))),console['log'](a0_0xefb2b7[_0x125098(0x188)]('\x20\x20\x20\x20\x20loxia\x20resume\x20./your-project-directory')),console['log'](''),console[_0x125098(0x18f)](a0_0xefb2b7[_0x125098(0xb2)](_0x125098(0x17f))),console[_0x125098(0x18f)](a0_0xefb2b7[_0x125098(0x188)](_0x125098(0x1dd))),console['log'](''),console['log'](a0_0xefb2b7[_0x125098(0xb2)]('\x20\x203.\x20Or\x20modify\x20existing\x20content:')),console['log'](a0_0xefb2b7['cyan']('\x20\x20\x20\x20\x20loxia\x20modify\x20./your-project\x20\x22continue\x20development\x22')),console['log'](''),console['log'](a0_0xefb2b7['gray']('ðŸ’¡\x20Your\x20project\x20files\x20have\x20been\x20saved\x20and\x20can\x20be\x20resumed.')),console['log'](a0_0xefb2b7['yellow']('â”'['repeat'](0x3c))),this[_0x125098(0xdc)][_0x125098(0x176)](_0x125098(0xbc),{'conversationId':_0x5d8899,'error':_0x377ab7[_0x125098(0xe4)],'errorType':_0x377ab7['errorType']||'unknown','originalError':_0x377ab7['originalError']||null});const _0x328a46=new Error('Unrecoverable\x20error\x20during\x20conversation\x20summary.\x20'+_0x125098(0x19d));_0x328a46['isUserFriendly']=!![],_0x328a46['originalError']=_0x377ab7;throw _0x328a46;}async['saveSessionState'](){const _0x13b632=a0_0xac6c34;if(!this['sessionState'][_0x13b632(0x120)]){this['logger']['warn'](_0x13b632(0x1ce));return;}try{const _0x374db8=a0_0x205658[_0x13b632(0xfc)](this[_0x13b632(0xe0)]['projectDir'],CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x2fa941[_0x13b632(0xfb)](_0x374db8,{'recursive':!![]}),this['logger']['debug'](_0x13b632(0xf0)+_0x374db8);const _0x45e3b8=a0_0x205658[_0x13b632(0xfc)](_0x374db8,CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME']),_0xc7cc06={'projectDir':this['sessionState']['projectDir'],'makerAgentId':this['sessionState'][_0x13b632(0xb9)],'languageModelAgentId':this['sessionState'][_0x13b632(0x1cd)],'activeConversationIds':this[_0x13b632(0xe0)][_0x13b632(0xe5)]||[],'conversationHistory':this['sessionState'][_0x13b632(0x1a0)]||{},'conversationIdMapping':Object[_0x13b632(0x143)](this[_0x13b632(0xcc)]),'paused':this['sessionState']['paused']||![],'lastUpdated':new Date()[_0x13b632(0x137)](),'version':_0x13b632(0x14b)};await a0_0x2fa941[_0x13b632(0xf3)](_0x45e3b8,JSON[_0x13b632(0x149)](_0xc7cc06,null,0x2),'utf-8'),this['logger']['debug']('Session\x20state\x20saved\x20to:\x20'+_0x45e3b8);const _0x5677a5=a0_0x205658[_0x13b632(0xfc)](_0x374db8,CONVERSATION_CONSTANTS[_0x13b632(0x131)]),_0x251676={'projectDir':this['sessionState'][_0x13b632(0x120)],'lastUpdated':new Date()['toISOString'](),'makerAgentId':this['sessionState']['makerAgentId'],'languageModelAgentId':this[_0x13b632(0xe0)]['languageModelAgentId'],'activeConversationIds':this[_0x13b632(0xe0)]['activeConversationIds']||[],'conversationIdMapping':Object[_0x13b632(0x143)](this[_0x13b632(0xcc)]),'sessionStateFile':CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME'],'version':'1.0.0'};await a0_0x2fa941['writeFile'](_0x5677a5,JSON[_0x13b632(0x149)](_0x251676,null,0x2),_0x13b632(0xbd)),this['logger'][_0x13b632(0xd8)](_0x13b632(0x1c6)+_0x5677a5);const _0x420149=a0_0x205658[_0x13b632(0xfc)](_0x374db8,CONVERSATION_CONSTANTS[_0x13b632(0x1a5)]),_0x2e3e0a={'projectDir':this[_0x13b632(0xe0)]['projectDir'],'timestamp':new Date()['toISOString'](),'makerAgentId':this['sessionState'][_0x13b632(0xb9)],'languageModelAgentId':this['sessionState'][_0x13b632(0x1cd)],'conversationIdMapping':Object[_0x13b632(0x143)](this[_0x13b632(0xcc)]),'version':_0x13b632(0x14b)};await a0_0x2fa941[_0x13b632(0xf3)](_0x420149,JSON['stringify'](_0x2e3e0a,null,0x2),'utf-8'),this[_0x13b632(0xdc)]['debug'](_0x13b632(0x106)+_0x420149),this[_0x13b632(0xdc)][_0x13b632(0x1dc)](_0x13b632(0x1b5));}catch(_0x273fa9){this['logger']['error']('Failed\x20to\x20save\x20session\x20state:',_0x273fa9);throw new Error(_0x13b632(0x186)+_0x273fa9['message']);}}async['resumeConversation'](_0x1a76ab){const _0x5d60d2=a0_0xac6c34;this[_0x5d60d2(0xdc)]['info'](_0x5d60d2(0x164)+_0x1a76ab);try{const _0x391743=a0_0x205658[_0x5d60d2(0xfc)](_0x1a76ab,CONVERSATION_CONSTANTS[_0x5d60d2(0xfa)]);try{await a0_0x2fa941['access'](_0x391743);}catch(_0x3b55fd){throw new Error('State\x20directory\x20not\x20found:\x20'+_0x391743+'.\x20This\x20may\x20not\x20be\x20a\x20valid\x20Loxia\x20project.');}const _0x501cb9=a0_0x205658[_0x5d60d2(0xfc)](_0x391743,CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME']);let _0x132704;try{const _0xeed220=await a0_0x2fa941['readFile'](_0x501cb9,'utf-8');_0x132704=JSON[_0x5d60d2(0xca)](_0xeed220),_0x132704[_0x5d60d2(0xcc)]&&(this[_0x5d60d2(0xcc)]=new Map(Object[_0x5d60d2(0x11a)](_0x132704['conversationIdMapping'])),this['logger'][_0x5d60d2(0x1dc)]('Restored\x20'+this['conversationIdMapping']['size']+_0x5d60d2(0x126)));}catch(_0x4da988){this['logger']['warn'](_0x5d60d2(0x189)+_0x4da988['message']);const _0x2e562d=a0_0x205658['join'](_0x391743,CONVERSATION_CONSTANTS['INDEX_FILENAME']);try{const _0x23f763=await a0_0x2fa941['readFile'](_0x2e562d,_0x5d60d2(0xbd)),_0x3cccd8=JSON[_0x5d60d2(0xca)](_0x23f763);_0x132704={'projectDir':_0x3cccd8['projectDir']||_0x1a76ab,'makerAgentId':_0x3cccd8['makerAgentId'],'languageModelAgentId':_0x3cccd8[_0x5d60d2(0x1cd)],'activeConversationIds':_0x3cccd8['activeConversationIds']||[],'conversationHistory':{},'conversationIdMapping':_0x3cccd8['conversationIdMapping']||{}},_0x3cccd8[_0x5d60d2(0xcc)]&&(this['conversationIdMapping']=new Map(Object[_0x5d60d2(0x11a)](_0x3cccd8['conversationIdMapping']))),this['logger'][_0x5d60d2(0x1dc)]('Recovered session state from index file');}catch(_0x34a193){throw new Error(_0x5d60d2(0x1bb)+_0x4da988['message']);}}this['sessionState']={..._0x132704,'projectDir':_0x1a76ab};const _0x2571c1=this['sessionState'][_0x5d60d2(0xe5)]||[];for(const _0x33feb5 of _0x2571c1){try{await this[_0x5d60d2(0x128)](_0x391743,_0x33feb5);}catch(_0x23b7cb){this['logger']['warn']('Could\x20not\x20load\x20conversation\x20history\x20for\x20'+_0x33feb5+':\x20'+_0x23b7cb[_0x5d60d2(0xe4)]),await this[_0x5d60d2(0xf1)](_0x33feb5,_0x5d60d2(0x1cc));}}this['logger']['info'](_0x5d60d2(0x161)+_0x2571c1[_0x5d60d2(0x185)]);}catch(_0x294b59){this['logger'][_0x5d60d2(0x176)](_0x5d60d2(0x109),_0x294b59);throw new Error('Failed\x20to\x20resume\x20conversation:\x20'+_0x294b59['message']);}}async['modifyExistingContent'](_0x4ef9b9,_0x37dd74){const _0x592ec4=a0_0xac6c34;this['logger']['info']('Modifying\x20content\x20in:\x20'+_0x4ef9b9+'\x20with\x20instructions:\x20'+_0x37dd74),this['sessionState']['projectDir']=_0x4ef9b9;const _0x440ed5=a0_0x205658[_0x592ec4(0xfc)](_0x4ef9b9,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x2fa941[_0x592ec4(0xfb)](_0x440ed5,{'recursive':!![]});const _0x35191b=this[_0x592ec4(0xe1)](this['toolRegistry']['getToolsDescription'](),!![]),_0x81282b=CONVERSATION_CONSTANTS['PROMPT_ENGINEER_ID'];await this[_0x592ec4(0xf1)](_0x81282b,_0x35191b);const _0x27d2a8=this[_0x592ec4(0x19b)](_0x37dd74,_0x4ef9b9,!![]),_0x4c6fcb=await this[_0x592ec4(0x158)](_0x81282b,_0x27d2a8),{role:_0x37688e,systemPrompt:_0x4af544}=this['parsePromptEngineerResponse'](_0x4c6fcb),_0x57543d=_0x37688e||'content-modifier';this[_0x592ec4(0xe0)]['makerAgentId']=_0x57543d;const _0x3fee36=this['enhanceSystemPrompt'](_0x4af544,this['toolRegistry']['getToolsDescription'](),this['sessionState']['projectDir'],[CONVERSATION_CONSTANTS[_0x592ec4(0x123)]]);await this[_0x592ec4(0xf1)](_0x57543d,_0x3fee36);const _0x52064a=CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'];this['sessionState']['languageModelAgentId']=_0x52064a;const _0x482566=this['getLanguageModelSystemPrompt'](this[_0x592ec4(0xad)][_0x592ec4(0x1b4)](),_0x57543d);await this['createConversation'](_0x52064a,_0x482566),this['sessionState']['activeConversationIds']=[_0x57543d,_0x52064a],await this['sendMessageToConversation'](_0x57543d,_0x592ec4(0x134)+_0x4ef9b9),await this[_0x592ec4(0xcb)]();}async['handleUserPrompt'](_0x1229e5,_0x20debe){const _0x2587e8=a0_0xac6c34;this[_0x2587e8(0xdc)][_0x2587e8(0x1dc)](_0x2587e8(0x1a3)+_0x20debe[_0x2587e8(0x19c)]+_0x2587e8(0x17b)+_0x1229e5);if(this['onUserPrompt']){const _0x52d527=await this['onUserPrompt'](_0x20debe['name'],_0x20debe['text'],_0x20debe['options']);await this['sendMessageToConversation'](_0x1229e5,'User\x20selected:\x20'+_0x52d527);}else await this[_0x2587e8(0x158)](_0x1229e5,'Cannot\x20display\x20prompt\x20to\x20user:\x20No\x20prompt\x20handler\x20is\x20registered.\x20'+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');}async[a0_0xac6c34(0x1de)](_0x130ea8){const _0x4a4089=a0_0xac6c34;this[_0x4a4089(0xdc)]['warn'](_0x4a4089(0x192)),await this['performCompactization'](_0x130ea8);}async['sendMessageToConversation'](_0x21d9fe,_0x5314cd){const _0x51c758=a0_0xac6c34;if(this[_0x51c758(0x12d)](_0x21d9fe,_0x5314cd))return this[_0x51c758(0xdc)]['info'](_0x51c758(0x1d7)+displayOnly(_0x5314cd,0x64)),this['blockedMessages']['push']({'conversationId':_0x21d9fe,'message':_0x5314cd,'timestamp':Date[_0x51c758(0xea)]()}),_0x51c758(0x11f);const _0x36b56d=_0x21d9fe===CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'],_0x2f3bac=_0x36b56d?_0x51c758(0x12b):_0x51c758(0x1c1);!this[_0x51c758(0xe2)]&&this['updateMessageIndicator'](_0x2f3bac);this[_0x51c758(0xdc)]['info']('[Orchestrator]\x20Messaging\x20'+_0x21d9fe+':\x0a'+displayOnly(_0x5314cd,0xff));if(!this[_0x51c758(0xc2)]['has'](_0x21d9fe)){!this['isWaitingForUserInput']&&this[_0x51c758(0x157)](_0x51c758(0x17d));throw new Error(_0x51c758(0xf9)+_0x21d9fe+_0x51c758(0x15d));}try{const _0x877052=this[_0x51c758(0xc2)][_0x51c758(0x12f)](_0x21d9fe),_0x11a836={'systemPrompt':_0x877052['systemPrompt'],'messages':_0x877052['messages'],'id':_0x21d9fe,'contextWindow':_0x877052['contextWindow']},_0x3685ad=await this['llmService']['sendMessage'](_0x21d9fe,_0x5314cd,_0x11a836);return await this['checkAndPerformCompactization'](_0x21d9fe),await this[_0x51c758(0xe8)](_0x21d9fe),this['sessionState']['activeConversationIds'][_0x51c758(0x135)](_0x21d9fe)&&await this[_0x51c758(0x14e)](_0x21d9fe,_0x3685ad),!this['isWaitingForUserInput']&&this[_0x51c758(0x157)]('idle'),_0x3685ad;}catch(_0x17038c){!this['isWaitingForUserInput']&&this['updateMessageIndicator'](_0x51c758(0x17d));throw _0x17038c;}}async[a0_0xac6c34(0xf1)](_0x3bb36b,_0x509eb9,_0xdb4315=[],_0x37603c=null){const _0x3ec729=a0_0xac6c34;this[_0x3ec729(0xdc)]['info'](_0x3ec729(0x1b8)+_0x3bb36b),this[_0x3ec729(0xe3)][_0x3ec729(0x1d9)](_0x3bb36b,_0x509eb9);const _0x14c5c6=this['interactionMode']===_0x3ec729(0xd6)?this[_0x3ec729(0xef)](_0x509eb9):_0x509eb9;let _0x54ddde=[];_0xdb4315['length']>0x0&&(_0x54ddde=_0xdb4315['filter'](_0x493855=>_0x493855[_0x3ec729(0xc0)]!==_0x3ec729(0x1d5)));const _0x1aa7ac={'id':_0x3bb36b,'systemPrompt':_0x14c5c6,'messages':_0x54ddde,'contextWindow':this[_0x3ec729(0xc8)](_0x3bb36b)};this[_0x3ec729(0xc2)]['set'](_0x3bb36b,_0x1aa7ac),await this[_0x3ec729(0xcf)][_0x3ec729(0x154)](_0x3bb36b,_0x14c5c6,_0x37603c),_0x54ddde['length']>0x0&&await this['llmService'][_0x3ec729(0x191)](_0x3bb36b,_0x1aa7ac),this['sessionState']['conversationHistory'][_0x3bb36b]={'systemPrompt':_0x14c5c6,'lastUpdateTime':new Date()['toISOString']()},await this['saveConversationHistory'](_0x3bb36b);}['getListOfAvailableAgentIds'](_0x1256cb){const _0x1324e1=a0_0xac6c34,_0x11fc7d=Array['from'](this[_0x1324e1(0xc2)][_0x1324e1(0x103)]())[_0x1324e1(0xf7)](_0x461a47=>_0x461a47!==_0x1256cb);return _0x11fc7d;}async['routeMessageToAgent'](_0x3d946f,_0x59dca3,_0x8258d){const _0x300b28=a0_0xac6c34;this[_0x300b28(0xdc)][_0x300b28(0x1dc)](_0x300b28(0xb7)+_0x3d946f+'\x20to\x20'+_0x59dca3);if(!this[_0x300b28(0xc2)][_0x300b28(0xb1)](_0x59dca3)){const _0x39c032='Agent\x20'+_0x59dca3+_0x300b28(0x18b)+this[_0x300b28(0x140)](_0x3d946f)['join'](',\x20')+'.\x20if\x20you\x20wish\x20to\x20send\x20a\x20message\x20to\x20the\x20user\x20who\x20requested\x20this\x20task\x20use\x20the\x20[prompt]\x20tool\x20syntax';this['logger']['warn'](_0x39c032),await this['sendMessageToConversation'](_0x3d946f,_0x39c032);return;}const _0x48ddfe='[From\x20'+_0x3d946f+_0x300b28(0x1a6)+_0x8258d;await this[_0x300b28(0x158)](_0x59dca3,_0x48ddfe);}async['routeMessageToAgent'](_0xf9ea49,_0x138e67,_0x2f2d3b){const _0x8ed626=a0_0xac6c34;this[_0x8ed626(0xdc)][_0x8ed626(0x1dc)](_0x8ed626(0xb7)+_0xf9ea49+'\x20to\x20'+_0x138e67);if(!this[_0x8ed626(0xc2)][_0x8ed626(0xb1)](_0x138e67)){this[_0x8ed626(0xdc)][_0x8ed626(0x1ba)](_0x8ed626(0x1af)+_0x138e67+'\x20does\x20not\x20exist,\x20cannot\x20route\x20message'),await this['sendMessageToConversation'](_0xf9ea49,_0x8ed626(0x152)+_0x138e67+':\x20Agent\x20does\x20not\x20exist');return;}const _0x4dd8b2='[From\x20'+_0xf9ea49+_0x8ed626(0x1a6)+_0x2f2d3b;await this[_0x8ed626(0x158)](_0x138e67,_0x4dd8b2);}async['checkToolExecutionStatus'](){const _0x3c49d9=a0_0xac6c34;for(const [_0x4f0f1f,_0x4f335d]of this[_0x3c49d9(0x14f)][_0x3c49d9(0x11a)]()){const _0x2f9abe=Date['now']()-_0x4f335d[_0x3c49d9(0x160)];_0x2f9abe>CONVERSATION_CONSTANTS[_0x3c49d9(0xec)]&&(await this['sendMessageToConversation'](_0x4f335d[_0x3c49d9(0x173)],'Tool\x20'+_0x4f335d['toolId']+'\x20is\x20still\x20running\x20('+Math['floor'](_0x2f9abe/0x3e8)+_0x3c49d9(0x150)+_0x4f0f1f),_0x4f335d['startTime']=Date[_0x3c49d9(0xea)]());}}[a0_0xac6c34(0x175)](_0x3289fc){this['onUserPrompt']=_0x3289fc;}async[a0_0xac6c34(0x18e)](_0x1276c7){const _0x4ac2bf=a0_0xac6c34;this['logger']['info'](_0x4ac2bf(0x163)+_0x1276c7),this[_0x4ac2bf(0xd9)](![]),this['sessionState'][_0x4ac2bf(0xb9)]?await this['sendMessageToConversation'](this['sessionState'][_0x4ac2bf(0xb9)],'[User\x20input]:\x20'+_0x1276c7):this[_0x4ac2bf(0xdc)]['warn'](_0x4ac2bf(0xbb));}async['checkAndPerformCompactization'](_0x4e0c30){const _0x4d832=a0_0xac6c34,_0x5361a9=this[_0x4d832(0xc2)][_0x4d832(0x12f)](_0x4e0c30);if(!_0x5361a9)return;const _0x5e7464=await this['llmService'][_0x4d832(0xcd)](_0x4e0c30),_0x5f26f3=_0x5361a9['contextWindow'];_0x5e7464>_0x5f26f3*CONVERSATION_CONSTANTS[_0x4d832(0x111)]&&(this[_0x4d832(0xdc)][_0x4d832(0x1dc)](_0x4d832(0xd0)+_0x4e0c30),await this[_0x4d832(0x1ab)](_0x4e0c30));}async[a0_0xac6c34(0x1ab)](_0x192283){const _0x46da16=a0_0xac6c34,_0x2012d4=this[_0x46da16(0xc2)][_0x46da16(0x12f)](_0x192283);if(!_0x2012d4||_0x2012d4['messages']['length']<0x4)return;const _0x1d14bd=CONVERSATION_CONSTANTS[_0x46da16(0x15e)],_0x39f260=_0x2012d4[_0x46da16(0xd3)][_0x46da16(0xc5)](0x0,_0x1d14bd),_0x492bbc=_0x2012d4[_0x46da16(0xb8)],_0x275175=Math[_0x46da16(0x194)](_0x492bbc*CONVERSATION_CONSTANTS[_0x46da16(0x12c)]),_0x3f2034=_0x492bbc-_0x275175,_0x35383b=CONVERSATION_CONSTANTS['COMPACTIZATION_BEGIN_PERCENTAGE'],_0x4125e9=CONVERSATION_CONSTANTS[_0x46da16(0x1c3)],_0x2faf9a=Math[_0x46da16(0xdd)](_0x1d14bd,Math[_0x46da16(0x194)](_0x2012d4['messages'][_0x46da16(0x185)]*_0x35383b)),_0x246ea5=Math['min'](_0x2012d4['messages']['length']-_0x2faf9a,Math[_0x46da16(0x194)](_0x2012d4[_0x46da16(0xd3)]['length']*_0x4125e9)),_0x203cdc=_0x2012d4['messages']['slice'](0x0,_0x2faf9a),_0x154388=_0x2012d4['messages']['slice'](-_0x246ea5),_0x45faba=_0x2012d4[_0x46da16(0xd3)]['slice'](_0x2faf9a,_0x2012d4[_0x46da16(0xd3)]['length']-_0x246ea5);if(_0x45faba[_0x46da16(0x185)]===0x0)return;const _0x1bbd16=this[_0x46da16(0x110)](_0x45faba);this['logger']['info']('Compactization:\x20'+_0x2faf9a+_0x46da16(0x162)+_0x45faba[_0x46da16(0x185)]+'\x20summarized\x20+\x20'+_0x246ea5+_0x46da16(0x183));try{const _0x2b2e76=await this['llmService']['getSummary'](_0x192283,_0x1bbd16),_0x13597e={'role':CONVERSATION_CONSTANTS['SYSTEM_MESSAGE_ROLE'],'content':CONVERSATION_CONSTANTS[_0x46da16(0x1c4)]+'\x0a'+_0x2b2e76+'\x0a'+CONVERSATION_CONSTANTS['SUMMARY_MARKER_END']};_0x2012d4[_0x46da16(0xd3)]=[..._0x203cdc,_0x13597e,..._0x154388],await this[_0x46da16(0xcf)]['updateConversation'](_0x192283,_0x2012d4),this['logger'][_0x46da16(0x1dc)](_0x46da16(0x1aa)+_0x192283+_0x46da16(0x1da)+(_0x2faf9a+_0x45faba['length']+_0x246ea5)+'\x20to\x20'+(_0x203cdc['length']+0x1+_0x154388['length']));}catch(_0x21e749){this[_0x46da16(0xdc)]['error'](_0x46da16(0x16c),_0x21e749),this['_handleSummaryFailure'](_0x192283,_0x21e749);}}[a0_0xac6c34(0x110)](_0x21c011){const _0x16ab0e=a0_0xac6c34;return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20The\x20following\x20text\x20is\x20a\x20part\x20of\x20a\x20conversation.\x20It\x20is\x20very\x20long.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Replace\x20this\x20part\x20of\x20the\x20conversation\x20with\x20a\x20concise\x20alternative\x20while\x20preserving\x20key\x20information,\x20decisions,\x20and\x20context\x0a\x20\x20\x20\x20\x20\x20\x20\x20Agent\x20should\x20be\x20able\x20to\x20proceed\x20with\x20its\x20task\x20by\x20using\x20this\x20shorter\x20summary\x20instead\x20of\x20the\x20original\x20long\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x21c011[_0x16ab0e(0x1a1)](_0x39e1fc=>_0x39e1fc['role']+':\x20'+_0x39e1fc['content'])[_0x16ab0e(0xfc)]('\x0a\x0a')+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Provide\x20the\x20replacement\x20text.';}[a0_0xac6c34(0xc8)](_0x5424c6){const _0x48506e=a0_0xac6c34,_0x1a4193=this['config']['models']?.[_0x48506e(0x118)]?.[_0x48506e(0xb8)]||CONVERSATION_CONSTANTS['DEFAULT_CONTEXT_WINDOW_SIZE'];if(_0x5424c6===CONVERSATION_CONSTANTS[_0x48506e(0x123)])return this['config'][_0x48506e(0xdf)]?.[_0x48506e(0x14a)]?.[_0x48506e(0xb8)]||_0x1a4193;return _0x1a4193;}['getPromptEngineerSystemPrompt'](_0xd6f28c,_0x565518=![]){const _0x13dd2c=a0_0xac6c34,_0x526f2f=_0x565518?'modifying\x20existing\x20content':_0x13dd2c(0x18a);return'\x0a\x20\x20\x20\x20You\x20are\x20a\x20prompt\x20engineering\x20expert\x20who\x20designs\x20effective\x20system\x20prompts\x20for\x20AI\x20agents.\x0a\x20\x20\x20\x20We\x20are\x20about\x20to\x20assign\x20the\x20responsibility\x20for\x20'+_0x526f2f+'\x20to\x20an\x20AI\x20agent.\x20\x0a\x20\x20\x20\x20For\x20that\x20we\x20need\x20to\x20write\x20a\x20comprehensive\x20SYSTEM\x20prompt\x20that\x20will\x20help\x20the\x20agent\x20make\x20smart\x20decisions.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20The\x20agent\x20will\x20need\x20to\x20know\x20the\x20task\x20and\x20the\x20tools\x20available\x20to\x20it,\x20but\x20will\x20also\x20need\x20to\x20think\x20like\x20a\x20professional\x20relevant\x20for\x20the\x20task\x20at\x20hand.\x0a\x0a\x20\x20\x20\x20Your\x20job\x20is\x20to\x20create\x20a\x20role\x20for\x20the\x20AI\x20agent\x20and\x20write\x20a\x20system\x20prompt\x20that\x20will\x20guide\x20it\x20to\x20successfully\x20complete\x20the\x20task.\x0a\x0a\x20\x20\x20\x20Embed\x20appropriate\x20guidelines\x5cprocess\x20description\x20into\x20the\x20system\x20prompt,\x20according\x20to\x20the\x20task\x20type:\x0a\x20\x20\x20\x201.\x20TASK\x20OF\x20DEVELOPING\x20CODE\x5cSOFTWARE:\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20AI\x20Agent\x20Development\x20Process\x20Guide\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Development\x20Stages\x20Overview\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20As\x20conversation\x20progresses,\x20context\x20window\x20will\x20be\x20filled\x20and\x20what\x20agent\x20rememebers\x20will\x20be\x20truncated/summarized.\x0a\x20\x20\x20\x20\x20\x20\x20\x20To\x20retain\x20the\x20context\x20of\x20the\x20project\x20agent\x20will\x20have\x20to\x20use\x20memory\x20tool\x20to\x20store\x20relevant\x20information\x20throughout\x20the\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20particular,\x20the\x20agent\x20should\x20store\x20a\x20summary\x20of\x20each\x20stage,\x20its\x20requirements,\x20and\x20any\x20important\x20decisions\x20made\x20during\x20the\x20development\x20process.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x201:\x20System\x20Functional\x20Description\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20what\x20the\x20system\x20does\x20at\x20a\x20high\x20level\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20a\x20clear\x20description\x20of\x20the\x20system\x27s\x20main\x20purpose\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20the\x20core\x20problem\x20the\x20system\x20solves\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20the\x20system\x27s\x20scope\x20and\x20boundaries\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x202:\x20Comprehensive\x20Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20what\x20the\x20system\x20must\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20List\x20specific\x20features\x20and\x20capabilities\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20interactions\x20and\x20system\x20behaviors\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20data\x20processing\x20requirements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x203:\x20Non-Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20how\x20the\x20system\x20should\x20perform\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Performance\x20requirements\x20(speed,\x20response\x20time)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Scalability\x20needs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Usability\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x204:\x20System\x20Actors\x20and\x20Target\x20Devices\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Identify\x20who\x20uses\x20the\x20system\x20and\x20how\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20roles\x20and\x20permissions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20target\x20devices\x20(desktop,\x20mobile,\x20tablet)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20operating\x20system\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20browser\x20compatibility\x20needs\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x205:\x20Use\x20Cases\x20Development\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Document\x20user\x20workflows\x20and\x20interactions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20detailed\x20user\x20stories\x20involving\x20system\x20features\x20as\x20previously\x20defined\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20user\x20journeys\x20through\x20the\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Connect\x20features\x20to\x20specific\x20user\x20goals\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Include\x20edge\x20cases\x20and\x20error\x20scenarios\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x206:\x20UX\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Create\x20intuitive,\x20user-friendly\x20interfaces\x20addressing\x20the\x20use\x20cases\x20and\x20features\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Apply\x20modern\x20UX/UI\x20best\x20practices\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Design\x20responsive\x20layouts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20user\x20flows\x20and\x20information\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Consider\x20accessibility\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x207:\x20High-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20system\x20architecture\x20and\x20main\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20core\x20system\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20component\x20responsibilities,\x20inputs,\x20and\x20outputs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20data\x20flow\x20between\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Analyze\x20alternatives,\x20choose\x20technology\x20stack\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x208:\x20Low-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20implementation\x20specifics\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20database\x20design\x20and\x20schemas\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20API\x20endpoints\x20and\x20contracts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Detail\x20component\x20architecture\x20and\x20interfaces\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20error\x20handling\x20strategies\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20implementation\x20plan\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20Stage\x209:\x20Implementation\x20according\x20to\x20previous\x20stages\x20(longest\x20and\x20most\x20important\x20stage,\x20dedicate\x20more\x20time\x20and\x20messages\x20to\x20this\x20stage)\x0a\x20\x20\x20\x20\x20\x20\x20\x20when\x20implementing\x20the\x20code,\x20make\x20sure\x20to\x20be\x20consider\x20memories\x20stored\x20in\x20memory\x20tool\x20and\x20guidelines\x20derived\x20in\x20previous\x20stages.\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Write\x20and\x20build\x20the\x20complete\x20application\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20In\x20a\x20test\x20driven\x20manner,\x20implement\x20all\x20features\x20and\x20components\x20code\x20as\x20defined\x20in\x20previous\x20stages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20databases\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20necessary\x20assets\x20(graphics,\x20icons,\x20etc.)\x20and\x20embed\x20fontawesome\x20(or\x20its\x20alternatives)\x20where\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Implement\x20core\x20features,\x20UI\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20components\x20(e.g\x20frontend\x20and\x20backend)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20README.md\x20with\x20setup\x20instructions\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20at\x20this\x20point\x20INSTALL\x20DEPENDENCIES\x20and\x20run\x20project,\x20try\x20until\x20success.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x2010:\x20Testing\x20and\x20Quality\x20Assurance\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Ensure\x20code\x20quality\x20and\x20functionality\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20static\x20code\x20analysis\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20execute\x20unit\x20tests\x20for\x20individual\x20components\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Execute\x20integration\x20tests\x20for\x20component\x20interactions\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20end-to-end\x20tests\x20for\x20user\x20workflows\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Make\x20sure\x20no\x20errors\x20or\x20bugs\x20are\x20present\x20in\x20the\x20static\x20code\x20analysis,\x20tests,\x20terminal\x20output,\x20and\x20browser\x20testing\x20(console\x20+\x20visual\x20testing\x20using\x20vision\x20capabilities)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20This\x20stage\x20HAS\x20TO\x20BE\x20REPEATED\x20AND\x20RE-CHECKED\x20until\x20all\x20components\x20launch\x20without\x20errors\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20ONLY\x20AFTER\x20THIS\x20STAGE,\x20ONCE\x20TESTING\x20IS\x20COMPLETED\x20AND\x20PROGRAM\x20WAS\x20EXECUTED\x20WITH\x20NO\x20ERRORS,\x20YOU\x20ARE\x20ALLOWED\x20TO\x20ANNOUNCE\x20JOB\x20DONE.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Process\x20Guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Complete\x20each\x20stage\x20thoroughly\x20before\x20moving\x20to\x20the\x20next\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20(Important!)\x20Coversation\x20Dynamics\x20(different\x20stages\x20cannot\x20take\x20part\x20in\x20same\x20message):\x0a\x20\x20\x20\x20\x20\x20\x20\x201)\x20AGENT->LLM:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20identify\x20language-model\x20recipent\x20id,\x20direct\x20a\x20message\x20to\x20him\x20explaining\x20what\x20you\x20want\x20to\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20[tool\x20id=\x22update-user\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...use\x20tool\x27s\x20syntax\x20to\x20update\x20the\x20supervising\x20user\x20on\x20what\x20you\x27re\x20doing\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/tool]\x0a\x20\x20\x20\x20\x20\x20\x20\x20[message\x20to=\x22language-model(or\x20any\x20other\x20suitable\x20recipent\x20id)\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20the\x20llm\x20what\x20you\x27re\x20about\x20to\x20do\x20now,\x20ask\x20for\x20recommendations\x20or\x20scoring\x20rubrics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20that\x20would\x20assist\x20you\x20in\x20comleting\x20the\x20following\x20task\x5csub-task\x20with\x20great\x20success\x20and\x20quality\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20consult\x20about\x20challenges,\x20solutions,\x20guidelines\x20and\x20more.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/message]\x0a\x20\x20\x20\x20\x20\x20\x20\x202)\x20LLM->AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20llm\x20would\x20give\x20some\x20anwer,\x20agent\x20will\x20be\x20able\x20to\x20return\x20to\x20stage\x20one\x20and\x20continue\x20conversation\x20or\x20when\x20ready\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continuing\x20to\x20step\x203.\x0a\x20\x20\x20\x20\x20\x20\x20\x203)\x20AGENT\x20ACTION:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20agent\x20has\x20no\x20comments\x20regarding\x20llm\x20content,\x20the\x20agent\x20can\x20now\x20do\x20whatever\x20it\x20meant\x20to\x20do\x20(writing\x20content,\x20creating\x20things\x20will\x20tools\x20etc).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20this\x20dynamic\x20acts\x20like\x20a\x20meta-thinking\x20process.\x20Think\x20with\x20your\x20llm\x20-\x20at\x20least\x201\x20message\x20epr\x20thinking,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20act\x20-\x20with\x20the\x20use\x20of\x20tools\x20in\x20the\x20following\x20message,\x20repeat\x20this\x20process.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20always\x20start\x20a\x20message\x20by\x20updating\x20user\x20on\x20current\x20stages.\x20add\x20links\x20to\x20generated\x20files,\x20locations,\x20web\x20pages\x20when\x20needed.\x0a\x20\x20\x20\x20\x20\x20\x20\x204)\x20back\x20to\x20stage\x20one\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Code\x20guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20No\x20magic\x20numbers,\x20use\x20constants\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Project\x20file\x20structure\x20must\x20follow\x20best\x20practices\x20and\x20serve\x20the\x20purpose\x20of\x20the\x20project\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20known\x20and\x20highly\x20maintained\x20packages\x20and\x20technologies\x20which\x20suits\x20the\x20project\x20goals)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20SecureCoding\x20best\x20practices.\x20if\x20needed\x20install\x20external\x20scanners\x20to\x20scan\x20the\x20files\x20before\x20you\x27re\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20common\x20logic,\x20values\x20and\x20functionality,\x20gather\x20them\x20under\x20suitable\x20project\x20files\x20as\x20dependencies\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20a\x20project\x20that\x20uses\x20package.json\x20or\x20package_lock.json,\x20use\x20seek\x20tool\x20to\x20search\x20for\x20import\x20lines,\x20then\x20use\x20the\x20result\x20to\x20analyze\x20needed\x20packages.\x20when\x20using\x20different\x20technologies\x20make\x20adaptations\x20to\x20acheive\x20same\x20goal.\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20node\x20packages,\x20prefer\x20ESM\x20over\x20CommonJS\x20(unless\x20states\x20otherwise),\x20add\x20\x22type\x22:\x22module\x22\x20to\x20the\x20package.json\x20if\x20needed.\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20IF\x20THIS\x20SOFTWARE\x20IS\x20A\x20COMPUTER\x20GAME\x20COMPLEMENT\x20WITH\x20THE\x20FOLLOWING:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x201:\x20Basic\x20Concept\x20Definition**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Define\x20the\x20game\x27s\x20core\x20idea\x20and\x20desired\x20player\x20experience\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Choose\x20game\x20genre\x20(action,\x20strategy,\x20RPG,\x20puzzle,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20Define\x20target\x20audience\x20(age,\x20skill\x20level,\x20preferences)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x204.\x20Determine\x20target\x20platform\x20(PC,\x20console,\x20mobile)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x202:\x20Game\x20Mechanics\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205.\x20Develop\x20core\x20mechanics\x20(how\x20player\x20interacts\x20with\x20the\x20game)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x206.\x20Design\x20player\x20progression\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x207.\x20Define\x20game\x20rules,\x20limitations\x20and\x20challenges\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x208.\x20Design\x20scoring/reward\x20system\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x203:\x20Initial\x20Technical\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209.\x20Choose\x20game\x20engine\x20(Unity,\x20Unreal,\x20Godot,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2010.\x20Identify\x20required\x20libraries\x20and\x20tools\x20(physics,\x20networking,\x20AI)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2011.\x20Plan\x20basic\x20code\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2012.\x20Assess\x20hardware\x20requirements\x20and\x20performance\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x204:\x20Visual\x20and\x20Artistic\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2013.\x20Determine\x20art\x20style\x20(realistic,\x20cartoon,\x20pixel\x20art,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2014.\x20Design\x20color\x20palette\x20and\x20overall\x20atmosphere\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2015.\x20Plan\x20user\x20interface\x20(UI/UX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2016.\x20Create\x20artistic\x20style\x20guide\x20(Art\x20Bible)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x205:\x20Story\x20and\x20Plot\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2017.\x20Write\x20main\x20storyline\x20and\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2018.\x20Develop\x20main\x20and\x20secondary\x20characters\x20with\x20detailed\x20backgrounds\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2019.\x20Create\x20game\x20world\x20and\x20environment\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2020.\x20Write\x20dialogues\x20and\x20in-game\x20texts\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x206:\x20Level\x20and\x20Stage\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2021.\x20Plan\x20overall\x20structure\x20of\x20game\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2022.\x20Detailed\x20design\x20of\x20each\x20stage/level\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2023.\x20Determine\x20how\x20stages\x20connect\x20to\x20the\x20storyline\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2024.\x20Plan\x20difficulty\x20curve\x20and\x20challenge\x20progression\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x207:\x20Audio\x20and\x20Music\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2025.\x20Determine\x20musical\x20style\x20and\x20artistic\x20direction\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2026.\x20Plan\x20background\x20music\x20for\x20different\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2027.\x20Design\x20sound\x20effects\x20(SFX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2028.\x20Plan\x20voice\x20acting\x20and\x20dubbing\x20if\x20required\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x208:\x20In-Game\x20Tools\x20and\x20Systems\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2029.\x20Define\x20tools/weapons/items\x20and\x20their\x20properties\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2030.\x20Design\x20acquisition\x20and\x20collection\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2031.\x20Plan\x20inventory\x20and\x20equipment\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2032.\x20Design\x20additional\x20game\x20systems\x20(trading,\x20crafting,\x20etc.)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x209:\x20Prototype\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2033.\x20Create\x20basic\x20playable\x20version\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2034.\x20Test\x20core\x20mechanics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2035.\x20Gather\x20initial\x20feedback\x20and\x20updates\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2036.\x20Validate\x20technical\x20concept\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2010:\x20Full\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2037.\x20Develop\x20all\x20systems\x20and\x20content\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2038.\x20Create\x20all\x20artistic\x20assets\x20(graphics,\x20animations)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2039.\x20Record\x20and\x20produce\x20all\x20audio\x20materials\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2040.\x20Integration\x20of\x20all\x20components\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2011:\x20Testing\x20and\x20Bug\x20Fixes**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2041.\x20Comprehensive\x20functional\x20testing\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2042.\x20Performance\x20testing\x20and\x20optimization\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2043.\x20Usability\x20testing\x20with\x20players\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2044.\x20Bug\x20fixes\x20and\x20balance\x20improvements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2012:\x20Launch\x20and\x20Distribution**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2045.\x20Prepare\x20for\x20marketing\x20and\x20distribution\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2046.\x20Create\x20marketing\x20materials\x20(trailers,\x20screenshots)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2047.\x20Submit\x20to\x20distribution\x20platforms\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2048.\x20Launch\x20and\x20performance\x20monitoring\x0a\x0a\x20\x20\x20\x202.\x20TASK\x20OF\x20WRITING\x20A\x20BOOK\x5cSTORY:\x0a\x20\x20\x20\x20\x20\x20\x20\x202.1.\x20The\x20agent\x20should\x20create\x20criteria\x20for\x20qualitative\x20measurement\x20of\x20a\x20book/story\x20(general\x20or\x20of\x20the\x20described\x20type)\x0a\x20\x20\x20\x20\x20\x20\x20\x202.2.\x20Development\x20of\x20the\x20central\x20idea\x20along\x20with\x20the\x20main\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.3.\x20Development\x20of\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x202.4.\x20Development\x20of\x20key\x20points\x20in\x20each\x20plot,\x20central\x20dilemmas\x20and\x20unifying\x20logic\x20for\x20all\x20plots\x20-\x20if\x20there\x27s\x20a\x20need\x20to\x20change\x20or\x20adapt\x20part\x20of\x20the\x20plot\x20lines\x20at\x20this\x20stage,\x20it\x20should\x20be\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x202.5.\x20Criteria\x20should\x20be\x20written\x20for\x20developing\x20a\x20quality\x20character\x20in\x20the\x20story\x0a\x20\x20\x20\x20\x20\x20\x20\x202.6.\x20For\x20each\x20story,\x20main\x20and\x20secondary\x20characters\x20should\x20be\x20defined\x20along\x20with\x20their\x20role\x20in\x20the\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.7.\x20For\x20each\x20character,\x20personal\x20background\x20and\x20living\x20environment\x20in\x20childhood\x20and\x20adulthood\x20should\x20be\x20defined,\x20including\x20beliefs,\x20significant\x20life\x20events,\x20vocabulary,\x20and\x20appearance\x20including\x20hairstyle,\x20clothing,\x20jewelry\x20if\x20any,\x20and\x20more\x20-\x20all\x20according\x20to\x20the\x20plot\x20line\x20and\x20the\x20character\x27s\x20role\x20in\x20the\x20plot\x0a\x20\x20\x20\x20\x20\x20\x20\x202.8.\x20The\x20appearance\x20of\x20each\x20character\x20should\x20be\x20saved\x20in\x20a\x20dedicated\x20place\x20with\x20great\x20detail,\x20it\x20will\x20serve\x20to\x20create\x20consistent\x20graphics\x20if\x20required\x0a\x20\x20\x20\x20\x20\x20\x20\x202.9.\x20For\x20each\x20character,\x20internet\x20research\x20should\x20be\x20conducted\x20to\x20refine\x20it\x20(clothing,\x20beliefs,\x20childhood\x20and\x20adulthood\x20events)\x20to\x20specify\x20events\x20in\x20the\x20environment\x20where\x20they\x20grew\x20up\x20or\x20draw\x20inspiration\x20from\x20areas\x20in\x20the\x20spirit\x20of\x20the\x20region\x20or\x20conditions\x20that\x20the\x20plot\x20unfolds\x0a\x20\x20\x20\x20\x20\x20\x20\x202.10.\x20Between\x20plot\x20lines,\x20intersection\x20points\x20should\x20be\x20created,\x20alternatives\x20examined\x20and\x20intersection\x20points\x20with\x20logic\x20should\x20be\x20chosen,\x20with\x20narrative\x20value\x20that\x20will\x20serve\x20the\x20story\x27s\x20purpose\x20and\x20the\x20reader\x27s\x20interest.\x20This\x20is\x20an\x20opportunity\x20to\x20refine\x20the\x20plot\x20lines,\x20twists\x20and\x20their\x20connection\x20to\x20the\x20characters.\x20This\x20is\x20an\x20opportunity\x20to\x20enrich\x20the\x20description\x20and\x20understanding\x20of\x20the\x20world\x20in\x20which\x20the\x20characters\x20live\x20before\x20actual\x20writing\x20-\x20smells,\x20emotions,\x20sights,\x20events,\x20worldviews,\x20technology,\x20communication,\x20global\x20and\x20national\x20trends\x20including\x20the\x20state\x20of\x20superpowers\x20in\x20the\x20described\x20world,\x20medical\x20and\x20scientific,\x20formative\x20historical\x20events\x20and\x20more\x20as\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x202.11.\x20The\x20recurring\x20motifs\x20should\x20be\x20understood\x20if\x20there\x20are\x20any,\x20their\x20essence,\x20identifying\x20central\x20symbols\x20in\x20use,\x20leading\x20metaphors\x20if\x20they\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x202.12.\x20The\x20story\x20should\x20be\x20assigned\x20to\x20a\x20genre,\x20given\x20a\x20working\x20title,\x20locate\x20a\x20worthy\x20and\x20excellent\x20author\x20whose\x20writing\x20style\x20is\x20known\x20and\x20whose\x20writings\x20are\x20accessible\x20or\x20familiar\x20to\x20the\x20model,\x20and\x20choose\x20them\x20as\x20a\x20guiding\x20line\x20for\x20the\x20writing\x20style\x20unless\x20described\x20otherwise\x20in\x20the\x20task\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x202.13.\x20Begin\x20writing\x20the\x20book\x20-\x20chapter\x20by\x20chapter,\x20stop\x20between\x20chapters\x20and\x20let\x20the\x20user\x20examine\x20the\x20story\x20that\x20was\x20written\x0a\x0a\x20\x20\x20\x203.\x20TASK\x20OF\x20RESEARCHING\x5cINFORMATION\x20GATHERING:\x0a\x20\x20\x20\x20\x20\x20\x20\x203.1.\x20If\x20the\x20user\x20is\x20interested,\x20expand\x20or\x20assist\x20in\x20refining\x20the\x20research\x20question\x20or\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.2.\x20The\x20desired\x20output\x20should\x20be\x20specified\x20-\x20format,\x20file\x20type,\x20and\x20more\x0a\x20\x20\x20\x20\x20\x20\x20\x203.3.\x20Attempt\x20to\x20locate\x20names\x20of\x20websites\x20and\x20sources\x20for\x20the\x20requested\x20information\x0a\x20\x20\x20\x20\x20\x20\x20\x203.4.\x20Divide\x20information\x20sources\x20into\x20sources\x20with\x20direct\x20connection\x20to\x20the\x20task\x20or\x20those\x20that\x20may\x20provide\x20supplementary\x20information\x20-\x20this\x20is\x20an\x20opportunity\x20to\x20locate\x20additional\x20sources\x0a\x20\x20\x20\x20\x20\x20\x20\x203.5.\x20Search\x20these\x20sources\x20thoroughly\x20with\x20the\x20aspiration\x20to\x20locate\x20materials\x20from\x20at\x20least\x2020\x20sources\x20for\x20the\x20general\x20public\x20and\x2020\x20from\x20academic\x20sources,\x20and\x20at\x20least\x2010\x20recent\x20ones\x20from\x20dedicated\x20professional\x20sources\x20if\x20such\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x203.6.\x20Design\x20a\x20guiding\x20principle\x20and\x20quality\x20structure\x20for\x20the\x20article/research\x20paper\x20or\x20follow\x20the\x20guidelines\x20given\x20in\x20the\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.7.\x20If\x20materials\x20or\x20support\x20for\x20certain\x20claims\x20or\x20connecting\x20materials\x20are\x20missing,\x20they\x20should\x20be\x20searched\x20for\x20at\x20this\x20stage\x0a\x20\x20\x20\x20\x20\x20\x20\x203.8.\x20Update\x20the\x20output\x20structure,\x20continue\x20writing\x20and\x20move\x20between\x20the\x20different\x20stages\x20as\x20needed\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x204.\x20OTHER\x20TASK\x20TYPES\x20-\x20write\x20such\x20guidlines\x20to\x20the\x20best\x20of\x20your\x20knowledge\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20The\x20next\x20message\x20will\x20describe\x20a\x20task\x20intended\x20for\x20the\x20newly\x20created\x20AI\x20agent\x20to\x20carry.\x0a\x20\x20\x20\x20Return\x20your\x20answer\x20in\x20the\x20following\x20format:\x0a\x20\x20\x20\x20[task-type]develop-software\x20|\x20story-telling\x20|\x20web-research\x20|\x20other[/task-type]\x0a\x20\x20\x20\x20[ai-role]<ai\x20agent\x20role\x20or\x20profession,\x20simple\x20text\x20no\x20slahes,\x20dashes\x20or\x20any\x20special\x20character>[/ai-role]\x0a\x20\x20\x20\x20[system-prompt]<A\x20system\x20prompt\x20which\x20will\x20guide\x20the\x20new\x20agent\x20to\x20handle\x20the\x20given\x20task\x20as\x20good\x20as\x20possible>[/system-prompt]';}[a0_0xac6c34(0x1cf)](_0x933f20,_0x28354c){return'You\x20are\x20an\x20amazing\x20state-of-the-art\x20AI\x20agent,\x20working\x20with\x20another\x20specialized\x20AI\x20agent\x20that\x20is\x20completing\x20tasks.\x20Your\x20role\x20is\x20to\x20provide\x20information,\x20answer\x20questions,\x20and\x20assist\x20the\x20agent\x20when\x20needed.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20You\x20cannot\x20directly\x20use\x20tools\x20or\x20perform\x20actions\x20on\x20the\x20computer.\x20Your\x20task\x20is\x20simply\x20to\x20provide\x20informative\x20and\x20helpful\x20responses\x20to\x20assist\x20the\x20agent\x20in\x20completing\x20their\x20task.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20When\x20the\x20agent\x20asks\x20you\x20a\x20question\x20or\x20requests\x20information,\x20provide\x20clear\x20and\x20accurate\x20information\x20to\x20the\x20best\x20of\x20your\x20ability.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20from\x20time\x20to\x20time\x20the\x20agent\x20may\x20mistake\x20and\x20use\x20some\x20instruction\x20tag\x20[tool\x20id=\x22...\x22]...[/tool]\x20or\x20similar,\x20in\x20a\x20wrong\x20way.\x20do\x20not\x20try\x20to\x20guide\x20him,\x20you\x20can\x20notify\x20him\x20that\x20since\x20you\x27re\x20not\x20suppose\x20to\x20see\x20such\x20tags\x20(automatically\x20stripped\x20from\x20conversation),\x20there\x20is\x20a\x20possibility\x20that\x20this\x20agent\x20made\x20a\x20syntax\x20error.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20any\x20professional\x20matter,\x20encourage\x20a\x20multistep/multimessage\x20session\x20and\x20assist\x20him,\x20suggest\x20improvements,\x20criticize\x20his\x20work,\x20detect\x20challenges\x20if\x20crucial\x20and\x20suggest\x20overcomes.\x20help\x20him\x20be\x20at\x20his\x20best.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Tools\x20available\x20to\x20the\x20other\x20agent\x20are:\x20'+_0x933f20+'.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20You\x20are\x20expected\x20to\x20put\x20the\x20text\x20intended\x20for\x20the\x20other\x20agent\x20inside\x20[message\x20to=\x22'+_0x28354c+'\x22]<your\x20content>[/message].\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Challenge\x20the\x20agent,\x20he\x20will\x20try\x20to\x20cover\x20each\x20subject/stage\x20within\x20a\x20single\x20message,\x20ask\x20him\x20to\x20supply\x20details,\x20challenge\x20his\x20assumptions,\x20and\x20make\x20sure\x20he\x27s\x20not\x20forgetting\x20any\x20important\x20aspect\x20of\x20the\x20task,\x0a\x20\x20\x20\x20\x20\x20\x20\x20One\x20specific\x20example\x20of\x20a\x20matter\x20of\x20high\x20importance\x20is\x20the\x20verification\x20of\x20the\x20task\x20completion\x20in\x20a\x20large\x20variety\x20of\x20ways.\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}['createInitialPromptForEngineer'](_0x219734,_0xda5a92=null,_0x2d94c8=![]){const _0x20b1fb=a0_0xac6c34,_0x5879e4=a0_0x16ddd8();return _0x2d94c8&&_0xda5a92?_0x20b1fb(0x1a2)+_0xda5a92+_0x20b1fb(0x15b)+JSON[_0x20b1fb(0x149)](_0x219734):_0x20b1fb(0x15f)+JSON['stringify'](_0x219734)+_0x20b1fb(0x108);}async[a0_0xac6c34(0xaf)](_0x39462a){await this['budgetService']['setBudgetLimit'](_0x39462a);}async[a0_0xac6c34(0x172)](){return await this['budgetService']['getBudgetUsage']();}async['setSessionOverrides'](_0x27e2b0){const _0x535647=a0_0xac6c34;this['sessionOverrides']=_0x27e2b0,this[_0x535647(0xdc)]['info']('Session\x20overrides\x20set',_0x27e2b0);}async['pauseExecution'](){const _0x1e868e=a0_0xac6c34;this[_0x1e868e(0xdc)][_0x1e868e(0x1dc)]('Pausing\x20execution');const _0x3e45c9='[System]:\x20Execution\x20has\x20been\x20paused\x20by\x20the\x20user.\x20Waiting\x20to\x20resume.';for(const _0x18ef91 of this[_0x1e868e(0xe0)]['activeConversationIds']){const _0x2d1b07=this[_0x1e868e(0xc2)][_0x1e868e(0x12f)](_0x18ef91);_0x2d1b07&&(_0x2d1b07[_0x1e868e(0xd3)]['push']({'role':CONVERSATION_CONSTANTS[_0x1e868e(0x16a)],'content':_0x3e45c9}),await this[_0x1e868e(0xe8)](_0x18ef91));}this[_0x1e868e(0xe0)]['paused']=!![],await this[_0x1e868e(0xcb)]();}async['resumeExecution'](){const _0x3e5091=a0_0xac6c34;this['logger'][_0x3e5091(0x1dc)]('Resuming\x20execution');const _0x1f8ce0=_0x3e5091(0xf4);for(const _0x452269 of this[_0x3e5091(0xe0)][_0x3e5091(0xe5)]){const _0x45a52b=this['conversations']['get'](_0x452269);_0x45a52b&&(_0x45a52b['messages'][_0x3e5091(0x10f)]({'role':CONVERSATION_CONSTANTS['SYSTEM_MESSAGE_ROLE'],'content':_0x1f8ce0}),await this[_0x3e5091(0xe8)](_0x452269));}this['sessionState']['paused']=![],await this[_0x3e5091(0xcb)]();}[a0_0xac6c34(0x174)](){const _0x3d729f=a0_0xac6c34;return this[_0x3d729f(0xe0)]['paused']===!![];}async[a0_0xac6c34(0x132)](_0x214082,_0x8e834a){const _0x3c5b48=a0_0xac6c34;this[_0x3c5b48(0xdc)]['info'](_0x3c5b48(0x1b9)+_0x8e834a[_0x3c5b48(0x185)]+'\x20tool\x20commands\x20from\x20'+_0x214082);const _0x20d52b=[],_0x556a6b=[],_0x230181=[];for(const _0x589b45 of _0x8e834a){const {toolId:_0x10331e}=_0x589b45;this['logger'][_0x3c5b48(0x1dc)]('Queuing\x20tool:\x20'+_0x10331e);if(!this['toolRegistry'][_0x3c5b48(0x1ac)](_0x10331e)){_0x556a6b[_0x3c5b48(0x10f)]({'toolId':_0x10331e,'status':_0x3c5b48(0x176),'error':'Tool\x20\x27'+_0x10331e+'\x27\x20not\x20found.\x20Available\x20tools:\x20'+this['toolRegistry']['getToolIds']()['join'](',\x20')});continue;}try{const _0x117995=this['toolRegistry']['getTool'](_0x10331e),requiresResponse=_0x117995[_0x3c5b48(0x1c7)]!==![],_0xce68f4=a0_0x16ddd8();_0x556a6b['push']({'operationId':_0xce68f4,'toolId':_0x10331e,'command':_0x589b45,'status':'pending','requiresResponse':requiresResponse});requiresResponse&&_0x230181[_0x3c5b48(0x10f)](_0x10331e);const _0x44441f=_0x117995[_0x3c5b48(0x13b)](_0x589b45,this[_0x3c5b48(0xe0)]['projectDir'])[_0x3c5b48(0x198)](_0x11c4df=>{const _0x587778=_0x3c5b48;this['logger'][_0x587778(0x1dc)](_0x587778(0x1c8)+_0x10331e+_0x587778(0x1b1),_0x11c4df);const _0x5cb28d=_0x556a6b['find'](_0x33e074=>_0x33e074['operationId']===_0xce68f4);return _0x5cb28d&&(_0x5cb28d[_0x587778(0x16f)]='success',_0x5cb28d['result']=_0x11c4df),this[_0x587778(0x14f)]['delete'](_0xce68f4),_0x11c4df;})[_0x3c5b48(0xae)](_0x31dc07=>{const _0x6ccfcf=_0x3c5b48;this['logger'][_0x6ccfcf(0x176)]('Tool\x20'+_0x10331e+'\x20failed:',_0x31dc07);const _0x15cefa=_0x556a6b['find'](_0x4a4bb0=>_0x4a4bb0['operationId']===_0xce68f4);_0x15cefa&&(_0x15cefa[_0x6ccfcf(0x16f)]='error',_0x15cefa['error']=_0x31dc07['message']);this[_0x6ccfcf(0x14f)]['delete'](_0xce68f4);throw _0x31dc07;});this[_0x3c5b48(0x14f)][_0x3c5b48(0x1d9)](_0xce68f4,{'promise':_0x44441f,'toolId':_0x10331e,'agentId':_0x214082,'startTime':Date['now']()}),_0x20d52b['push'](_0x44441f);}catch(_0x22ed9f){this['logger'][_0x3c5b48(0x176)]('Failed\x20to\x20queue\x20tool\x20'+_0x10331e+':',_0x22ed9f),_0x556a6b['push']({'toolId':_0x10331e,'status':'error','error':_0x3c5b48(0xc7)+_0x10331e+':\x20'+_0x22ed9f['message'],'requiresResponse':!![]});}}const _0x28c484=new Promise(_0x4d54be=>setTimeout(_0x4d54be,0x7d0));await Promise['race']([_0x28c484,Promise['allSettled'](_0x20d52b)]);const _0x3c66b5=_0x556a6b['filter'](_0x53865e=>(_0x53865e[_0x3c5b48(0x16f)]===_0x3c5b48(0x133)||_0x53865e[_0x3c5b48(0x16f)]==='error')&&_0x53865e['requiresResponse']!==![]),_0x18a976=_0x556a6b['filter'](_0x2af9da=>_0x2af9da[_0x3c5b48(0x16f)]==='pending'&&_0x2af9da['requiresResponse']!==![]);if(_0x3c66b5[_0x3c5b48(0x185)]>0x0||_0x18a976[_0x3c5b48(0x185)]>0x0){let _0x144d17='Tool\x20execution\x20report\x20('+_0x3c66b5['length']+_0x3c5b48(0x1c0)+_0x18a976[_0x3c5b48(0x185)]+_0x3c5b48(0x197);if(_0x3c66b5[_0x3c5b48(0x185)]>0x0){_0x144d17+='\x0a\x0a==\x20Completed\x20Operations\x20==';for(const _0x59ab55 of _0x3c66b5){_0x59ab55['status']===_0x3c5b48(0x133)?(_0x144d17+='\x0aâœ…\x20Tool\x20'+_0x59ab55[_0x3c5b48(0x125)]+_0x3c5b48(0xed),_0x59ab55['result']&&(_0x144d17+=_0x3c5b48(0x190)+JSON['stringify'](_0x59ab55[_0x3c5b48(0x15a)],null,0x2))):_0x144d17+='\x0aâŒ\x20Tool\x20'+_0x59ab55['toolId']+_0x3c5b48(0x144)+_0x59ab55['error'];}}if(_0x18a976['length']>0x0){_0x144d17+='\x0a\x0a==\x20Pending\x20Operations\x20==';for(const _0xcff3ec of _0x18a976){_0x144d17+=_0x3c5b48(0x19a)+_0xcff3ec[_0x3c5b48(0x125)]+'\x20is\x20still\x20running\x20(operation\x20ID:\x20'+_0xcff3ec[_0x3c5b48(0xfe)]+').'+_0x3c5b48(0x141),this['trackPendingOperation'](_0xcff3ec['operationId'],_0x214082);}}await this[_0x3c5b48(0x158)](_0x214082,_0x144d17);}else this[_0x3c5b48(0xdc)]['info']('All\x20'+_0x8e834a['length']+_0x3c5b48(0x1c9));}['trackPendingOperation'](_0x14ed3d,_0x4fb6e3){const _0x408e46=a0_0xac6c34,_0x5cb7d3=this['activeTools'][_0x408e46(0x12f)](_0x14ed3d);if(!_0x5cb7d3)return;_0x5cb7d3[_0x408e46(0x130)]['then'](_0x1a4896=>{this['queuePendingResult'](_0x4fb6e3,_0x5cb7d3['toolId'],_0x14ed3d,'success',{'result':_0x1a4896});})[_0x408e46(0xae)](_0x38c72a=>{const _0x4bb17e=_0x408e46;this[_0x4bb17e(0x13d)](_0x4fb6e3,_0x5cb7d3[_0x4bb17e(0x125)],_0x14ed3d,'error',{'error':_0x38c72a[_0x4bb17e(0xe4)]});});}['queuePendingResult'](_0x493674,_0x1d2ec4,_0x58e707,_0x2770ba,_0x399d62){const _0x3d85b0=a0_0xac6c34;!this[_0x3d85b0(0xeb)]&&(this[_0x3d85b0(0xeb)]=new Map()),!this['pendingResults'][_0x3d85b0(0xb1)](_0x493674)&&this['pendingResults'][_0x3d85b0(0x1d9)](_0x493674,[]),this[_0x3d85b0(0xeb)]['get'](_0x493674)[_0x3d85b0(0x10f)]({'toolId':_0x1d2ec4,'operationId':_0x58e707,'status':_0x2770ba,'data':_0x399d62,'timestamp':Date['now']()});}async['handlePromptTooLong'](_0x500cd5){const _0x509240=a0_0xac6c34;this[_0x509240(0xdc)]['warn']('ðŸš¨\x20Prompt\x20too\x20long\x20detected\x20for\x20'+_0x500cd5+'\x20-\x20performing\x20compactization');const _0x53d80c=this['conversations'][_0x509240(0x12f)](_0x500cd5);if(!_0x53d80c)throw new Error(_0x509240(0xf9)+_0x500cd5+_0x509240(0x116));this['logger']['info']('Before\x20compactization:\x20'+_0x53d80c['messages']['length']+_0x509240(0x138)),await this['performCompactization'](_0x500cd5),this[_0x509240(0xdc)][_0x509240(0x1dc)](_0x509240(0x1c5)+_0x53d80c[_0x509240(0xd3)][_0x509240(0x185)]+'\x20messages'),this['logger'][_0x509240(0x1dc)](_0x509240(0xf8)+_0x500cd5);}async[a0_0xac6c34(0x179)](){const _0x4187b8=a0_0xac6c34;this['logger'][_0x4187b8(0x1dc)]('Shutting\x20down\x20conversation\x20orchestrator'),this[_0x4187b8(0x1b6)]=!![];this[_0x4187b8(0x142)]&&(clearInterval(this['idleCheckInterval']),this[_0x4187b8(0x142)]=null);this['idleTimer']&&(clearTimeout(this['idleTimer']),this[_0x4187b8(0x105)]=null);clearInterval(this[_0x4187b8(0x19e)]),await this['saveSessionState']();const _0x19e374=Array['from'](this[_0x4187b8(0x14f)][_0x4187b8(0x1d3)]());if(_0x19e374[_0x4187b8(0x185)]>0x0){this[_0x4187b8(0xdc)][_0x4187b8(0x1dc)](_0x4187b8(0x136)+_0x19e374[_0x4187b8(0x185)]+_0x4187b8(0x1a9));const _0x904e07=this[_0x4187b8(0x199)]['shutdownTimeout']||0x2710;try{await Promise['race']([Promise['allSettled'](_0x19e374[_0x4187b8(0x1a1)](_0x7a4e2c=>_0x7a4e2c['promise'])),new Promise(_0x4e78e2=>setTimeout(_0x4e78e2,_0x904e07))]);}catch(_0x10869f){this['logger']['warn']('Error\x20waiting\x20for\x20pending\x20operations\x20during\x20shutdown:',_0x10869f);}for(const [_0x12a765,_0xb00855]of this[_0x4187b8(0x14f)][_0x4187b8(0x11a)]()){this[_0x4187b8(0xdc)][_0x4187b8(0x1dc)]('Cancelling\x20operation\x20'+_0x12a765+_0x4187b8(0x1be)),this[_0x4187b8(0x14f)][_0x4187b8(0x16e)](_0x12a765);}}await this[_0x4187b8(0xcf)][_0x4187b8(0x179)](),await this['toolRegistry']['shutdown'](),await this['budgetService'][_0x4187b8(0xac)](),this['logger'][_0x4187b8(0x1dc)](_0x4187b8(0xe7));}async[a0_0xac6c34(0x13a)](){const _0x1d4e90=a0_0xac6c34;this['messageIndicator']==='idle'?await this['sendProceedMessage']():this[_0x1d4e90(0xdc)][_0x1d4e90(0x1dc)]('Cannot\x20proceed:\x20current\x20state\x20is\x20'+this['messageIndicator']);}[a0_0xac6c34(0x16d)](){const _0x12dd60=a0_0xac6c34;return{'state':this[_0x12dd60(0x178)],'lastActivity':this['lastActivityTime'],'timeSinceActivity':Date['now']()-this[_0x12dd60(0x1d8)],'willProceedIn':Math['max'](0x0,this['IDLE_TIMEOUT_MS']-(Date['now']()-this['lastActivityTime']))};}async[a0_0xac6c34(0xf6)](_0x5359c9,_0x3a0baf={}){const _0x4918d4=a0_0xac6c34;try{this['logger']['info'](_0x4918d4(0x1a4),_0x5359c9);!this['llmService']&&await this[_0x4918d4(0xe6)]();const _0x3a471b=[{'role':'system','content':_0x4918d4(0x1b7)+(_0x3a0baf[_0x4918d4(0x11e)]||_0x4918d4(0x102))+'\x0aContext:\x20'+(_0x3a0baf['mode']||'vscode')+'\x0a\x0aProvide\x20helpful,\x20concise\x20responses.\x20When\x20showing\x20code,\x20use\x20appropriate\x20language\x20identifiers\x20in\x20code\x20blocks.'},{'role':_0x4918d4(0x11b),'content':_0x5359c9}],_0x35253d=await this[_0x4918d4(0xcf)][_0x4918d4(0xf5)](_0x3a471b,{'model':_0x3a0baf[_0x4918d4(0xce)]||null,'stream':![]});return this['logger'][_0x4918d4(0x1dc)](_0x4918d4(0x10e)),_0x35253d['content']||_0x35253d;}catch(_0x44c363){this['logger'][_0x4918d4(0x176)]('Error\x20processing\x20VS\x20Code\x20message:',_0x44c363);throw new Error('Failed\x20to\x20process\x20message:\x20'+_0x44c363[_0x4918d4(0xe4)]);}}}