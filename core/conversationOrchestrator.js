const a0_0x9f470f=a0_0x2958;function a0_0x2958(_0x52ab6f,_0x13d5c6){const _0x4aab92=a0_0x4aab();return a0_0x2958=function(_0x295809,_0x1845a4){_0x295809=_0x295809-0x17b;let _0x72a57c=_0x4aab92[_0x295809];if(a0_0x2958['vnmmno']===undefined){var _0x5c6b84=function(_0x5d4e50){const _0x53082c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3ceb31='',_0x4f7b32='';for(let _0x3f7d49=0x0,_0xcd2002,_0x5ede93,_0x529c44=0x0;_0x5ede93=_0x5d4e50['charAt'](_0x529c44++);~_0x5ede93&&(_0xcd2002=_0x3f7d49%0x4?_0xcd2002*0x40+_0x5ede93:_0x5ede93,_0x3f7d49++%0x4)?_0x3ceb31+=String['fromCharCode'](0xff&_0xcd2002>>(-0x2*_0x3f7d49&0x6)):0x0){_0x5ede93=_0x53082c['indexOf'](_0x5ede93);}for(let _0x359502=0x0,_0x33bc2d=_0x3ceb31['length'];_0x359502<_0x33bc2d;_0x359502++){_0x4f7b32+='%'+('00'+_0x3ceb31['charCodeAt'](_0x359502)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x4f7b32);};a0_0x2958['GLWVKT']=_0x5c6b84,_0x52ab6f=arguments,a0_0x2958['vnmmno']=!![];}const _0x486126=_0x4aab92[0x0],_0xa9871=_0x295809+_0x486126,_0x32388b=_0x52ab6f[_0xa9871];return!_0x32388b?(_0x72a57c=a0_0x2958['GLWVKT'](_0x72a57c),_0x52ab6f[_0xa9871]=_0x72a57c):_0x72a57c=_0x32388b,_0x72a57c;},a0_0x2958(_0x52ab6f,_0x13d5c6);}(function(_0x48e1ec,_0x44bb7e){const _0x4216d5=a0_0x2958,_0x577453=_0x48e1ec();while(!![]){try{const _0xf7d2e7=parseInt(_0x4216d5(0x252))/0x1*(parseInt(_0x4216d5(0x1e4))/0x2)+parseInt(_0x4216d5(0x1a5))/0x3*(parseInt(_0x4216d5(0x24c))/0x4)+-parseInt(_0x4216d5(0x242))/0x5+parseInt(_0x4216d5(0x255))/0x6*(parseInt(_0x4216d5(0x1a8))/0x7)+-parseInt(_0x4216d5(0x19b))/0x8*(-parseInt(_0x4216d5(0x1a3))/0x9)+parseInt(_0x4216d5(0x199))/0xa+-parseInt(_0x4216d5(0x245))/0xb;if(_0xf7d2e7===_0x44bb7e)break;else _0x577453['push'](_0x577453['shift']());}catch(_0x568986){_0x577453['push'](_0x577453['shift']());}}}(a0_0x4aab,0xc1425));import{TagParser}from'../utilities/tagParser.js';import{TagParserService}from'../services/tagParserService.js';import a0_0x5d4e50 from'path';import{promises as a0_0x53082c}from'fs';function a0_0x4aab(){const _0x21521f=['ntaWoeL0Dgznwq','q29UDMvYC2f0Aw9Uia','ugXLyxnLihvZzsbBBwvZC2fNzsb0BZ0IlI4UiL0GDgfNCYb0BYbZzw5KigeGBwvZC2fNzsb0BYbHBM90AgvYigfNzw50lca','Aw5MBW','Dg9tDhjPBMC','C2v0v2fPDgLUz0zVCLvZzxjjBNb1Da','m0nPt1zMEq','cKnVBNrPBNvLihDPDgGGB3rOzxiGDgfZA3mGyw5KieKNBgWGBM90Awz5ihLVDsb3AgvUigL0j3mGzg9Uzs4','tuflrvjFquDftLrFrevgqvvmvf9jra','nJK3nJq0r05OAfvW','qvvutYbTB2rLoIbbDxrVlxnLBgvJDgvKici','EwvSBg93','C3rHDhvZ','zxjYB3juExbL','ywXSu2v0DgXLza','uMvZDw1PBMCGzxHLy3v0Aw9U','C2v0qNvKz2v0tgLTAxq','y29UDMvYC2f0Aw9UswrnyxbWAw5N','x2DLDezPBgvtywzLq29UDMvYC2f0Aw9Uswq','ugf1C2LUzYbLEgvJDxrPB24','C2HVDwXKqMXVy2TnzxnZywDL','rMfPBgvKihrVihnHDMuGC2vZC2LVBIbZDgf0ztO','B3bLCMf0Aw9Uswq','ufjptvbux0vor0Loruvsx0Le','z2v0vg9VBhnezxnJCMLWDgLVBG','AxntAhv0DgLUz0rVD24','CMvHzezPBgu','ihn5C3rLBsbTzxnZywDLoIKGChjVy2vLzc4GswyGC3r1y2SGzM9YihrVBYbSB25NihvZzsb0B29SCYbVCIbWzxjMB3jTig9WzxjHDgLVBNmGDg8GzwzMzwn0AxzLBhKGy29UDgLUDwuGDgHLihrHC2SU','D2fPDgLUzY1MB3iTBgXT','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbZAhv0igrVD24GC3vJy2vZC2z1BgX5','ihrVB2XZihDLCMuGzMLYzs1HBMqTzM9Yz2v0lcbUBYbYzxnWB25ZzsbZzw50ihrVigfNzw50','yxnZAxn0yw50','xtOG','y29UDgvUDa','seLtve9swv9tvuzgsvG','lwHPC3rVCNKUANnVBG','BwvZC2fNzq','Dg9uAw1Lu3rYAw5N','zw5Oyw5Jzvn5C3rLBvbYB21WDa','BwvZC2fNzxm','8j+AQcbqCM9TChqGDg9VigXVBMCGzgv0zwn0zwqGzM9Yia','AgfZ','q2fUBM90ihnLBMqGBwvZC2fNzsb0BYa','CM9Szq','CgfYC2vqCM9TChrfBMDPBMvLCLjLC3bVBNnL','q2fUy2vSBgLUzYbVCgvYyxrPB24G','yNvKz2v0u2vYDMLJzq','w1vZzxiGAw5WDxrDoIa','u3rHDguGzgLYzwn0B3j5ig5VDcbMB3vUzdOG','q29UDMvYC2f0Aw9UihjLC3vTzwqGC3vJy2vZC2z1BgX5lIbby3rPDMuGy29UDMvYC2f0Aw9UCZOG','DxbKyxrLq29UDMvYC2f0Aw9Uu3LZDgvTuhjVBxb0','u2vZC2LVBIbZDgf0zsbZyxzLzcbZDwnJzxnZzNvSBhKGD2L0AcbPBMrLEcbMAwXLCW','B3jPz2LUywXfCNjVCG','u3vTBwfYEsbMywLSDxjLigrLDgfPBhm6','q09nuefdveLAqvrjt05Ft1vuufvux1jfu0vsvKvFuevsq0vovefhrq','B3b0Aw9UCW','AgfUzgXLvxnLCLbYB21WDa','y2HLy2TuB29SrxHLy3v0Aw9Uu3rHDhvZ','AgfUzgXLsM9Irg9UzujHC2vKt25nB2rL','cUkCHsbuB29Sia','igjLz2LUicSG','khn5C3rLBsbTzxnZywDLkq','jYbHy2nVCMrPBMCGDg8GDgHLC2uGAw5ZDhj1y3rPB25ZoGOGicaGicaGicaGica','C3rHCNrjzgXLtw9UAxrVCMLUzW','C2vUze1LC3nHz2vuB0nVBNzLCNnHDgLVBG','z2v0sw5KAwnHDg9YrgLZCgXHEq','z3jLzw4','lMXVEgLHlxn0yxrL','z2v0tgfUz3vHz2vnB2rLBfn5C3rLBvbYB21WDa','DxbKyxrLu3LZDgvTuhjVBxb0C0zVCK1Vzgu','CgfYC2u','rMfPBgvKihrVihjLC3vTzsbJB252zxjZyxrPB246ia','B3jPz2LUywXtExn0zw1qCM9TChrZ','DxbKyxrLq29UDMvYC2f0Aw9U','C3vJy2vZCW','ywn0AxzLq29UDMvYC2f0Aw9UswrZ','zMLUza','cGOVkIbot1rfoIbqCM9TChqGC3LUDgf4ihjLBw92zwqGzM9Yigf1Dg8GBw9Kzs4G','zgvMyxvSDa','y29UDgvUDc1TB2rPzMLLCG','Dg9ju09tDhjPBMC','A2v5CW','DxnPBMCGDgHLifTTzxnZywDLxsb0ywCGD2L0Acb0AguGzM9SBg93Aw5NigLKCW','yMvNAw4GBw9KAwzPy2f0Aw9Uig9MignVBNrLBNqGAw4G','B25kB2jeB25L','ls1dB252zxjZyxrPB24GqMvJyw1LieXVBMCSifrOAxmGugfYDcbiyxmGqMvLBIbtDw1TyxjPEMvKls0','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbPBML0AwfSAxPLzcb3AxrOihbYB2PLy3q6ia','rMfPBgvKihrVihf1zxvLihrVB2WG','igLZihn0AwXSihj1BM5PBMCGkg9WzxjHDgLVBIbjrdOG','C2v0sw50zxjHy3rPB25nB2rL','z2v0qMXVy2TPBMDtDgf0Dxm','cLrOyw5RihLVDsbMB3iGy2HVB3nPBMCGtg94AweU','Bwf4','Dhj5tg9HzenVBNzLCNnHDgLVBKHPC3rVCNLcEvbHDhrLCM4','cIaGicaGicaGvgHLigzVBgXVD2LUzYb0zxH0igLZigeGCgfYDcbVzIbHignVBNzLCNnHDgLVBI4GsxqGAxmGDMvYEsbSB25NlIakicaGicaGicbszxbSywnLihrOAxmGCgfYDcbVzIb0AguGy29UDMvYC2f0Aw9UihDPDgGGysbJB25JAxnLigfSDgvYBMf0AxzLihDOAwXLihbYzxnLCNzPBMCGA2v5igLUzM9YBwf0Aw9UlcbKzwnPC2LVBNmSigfUzcbJB250zxH0cIaGicaGicaGqwDLBNqGC2HVDwXKigjLigfIBguGDg8GChjVy2vLzcb3AxrOigL0CYb0yxnRigj5ihvZAw5NihrOAxmGC2HVCNrLCIbZDw1Tyxj5igLUC3rLywqGB2yGDgHLig9YAwDPBMfSigXVBMCGy29UDMvYC2f0Aw9UlGOGicaGicaGia','zxHPDa','DxbKyxrLtwvZC2fNzuLUzgLJyxrVCG','vg9VBcaN','igzHAwXLzdOG','Bg9N','igLZihn0AwXSihj1BM5PBMCGka','CMvZDwX0','CMvXDwLYzxnszxnWB25Zzq','Aw50zxjHy3rPB25nB2rL','C2H1DgrVD24','z2v0qNvKz2v0vxnHz2u','Cgf1C2vK','zgvIDwC','Dg9mB3DLCKnHC2u','u3rHDguGzgLYzwn0B3j5ignYzwf0zwqVDMvYAwzPzwq6ia','CM91DgvnzxnZywDLvg9bz2vUDa','ntyZoty4mgLeEMLWwa','C2v0','odu0oty4CwvICxvt','cUkpSYbuB29Sia','C3LZDgvT','D2HPDgu','C2vZC2LVBLn0yxrL','u2vZC2LVBIbZDgf0zsbZyxzLzcb0BZOG','w1n5C3rLBv06iev4zwn1DgLVBIbOyxmGyMvLBIbYzxn1BwvKigj5ihrOzsb1C2vYlG','DgfNugfYC2vYu2vYDMLJzq','otbPy2fbAMK','q2fUBM90igrPC3bSyxKGChjVBxb0ihrVihvZzxi6ie5VihbYB21WDcbOyw5KBgvYigLZihjLz2LZDgvYzwqUia','oda3wvDAzfL5','BwfRzxjbz2vUDeLK','surmrv9usu1ft1vux01t','mJfUCvnWt2i','y29UDgv4DfDPBMrVDW','cIbuAgLZihnLy3rPB24GD2LSBcbIzsbZzw50igfWyxj0igzYB20GDgHLihrVB2WGAw5ZDhj1y3rPB25ZlG','C2vUze1LC3nHz2u','q29UDMvYC2f0Aw9UihjLC3vTzwqGD2L0Ag91DcbJB21WBgv0zsbOAxn0B3j5','Dg9VBeLK','ywDLBNrjza','igrVzxmGBM90igv4Axn0','BwTKAxi','DxnLCG','CgvYzM9YBunVBxbHy3rPEMf0Aw9U','q29UDMvYC2f0Aw9UigHPC3rVCNKGC2f2zwqGzM9Yia','ChjVBwLZzq','BgfZDefJDgL2Axr5vgLTzq','C3rYAw5NAwz5','z3jHEq','C2f2zvnLC3nPB25tDgf0zq','AgfZvg9VBa','ChjVy2vZC01LC3nHz2u','x3nHBML0AxPLq29UDMvYC2f0Aw9UswrgB3jgAwXL','AgfUzgXLvxnLCLbYB21WDejHC2vKt25nB2rL','CMvNAxn0zxjcDwLSDeLUvg9VBhm','cGOGicaGicaGifbYB3zPzguGDgHLihjLCgXHy2vTzw50ihrLEhqU','Dgv4Da','rMfPBgvKihrVihbYB2nLC3mGBwvZC2fNztOG','Bg9Nz2vY','uM91DgLUzYbTzxnZywDLigzYB20G','tM8GBwfRzxiGywDLBNqGzM91BMqGDg8GC2vUzcb1C2vYigLUChv0ihrV','AgfUzgXLuhjVBxb0vg9Vtg9UzW','8j+uHcbbDxrVlxbYB2nLzwrPBMCGywz0zxiGmYbZzwnVBMrZig9MigLKBguGDgLTzq','tefor1vbr0vFtu9eruXFsuq','yM9Sza','tg9HzgvKignVBNzLCNnHDgLVBIbOAxn0B3j5igzVCJOG','C2f2zunVBNzLCNnHDgLVBKHPC3rVCNK','BM93','D29YA3nWywnLuM9VDa','ig1LC3nHz2vZ','ww91igfYzsbmB3HPysbbssWGysbOzwXWzNvSignVzgLUzYbHC3nPC3rHBNqUifLVDsbHCMuGAw50zwDYyxrLzcbPBNrVifztienVzguGyw5KignHBIbOzwXWihDPDgGGy29KzsbHBMfSExnPCYWGz2vUzxjHDgLVBIWGyw5KigDLBMvYywWGzgv2zwXVCg1LBNqGDgfZA3mUcGPdDxjYzw50ihDVCMTZCgfJztOG','ywn0AxzLvg9VBhm','ww91CIbTzxnZywDLigrPzg4NDcbJB250ywLUigfUEsb0B29SignVBw1HBMrZlcbHig1LC3nHz2uGDg8Gyw5VDgHLCIbHz2vUDcWGB3iGysbWCM9TChqUia','CMvWBgfJzq','zxn0Aw1HDgvuB2TLBKnVDw50','C2vUzfvZzxjjBNb1Da','zxjYB3i','y29UDMvYC2f0Aw9UCW','lcbJCMvHDgLUzYbLBxb0EsbJB252zxjZyxrPB24','w1n5C3rLBv06iev4zwn1DgLVBIbOyxmGyMvLBIbWyxvZzwqGyNKGDgHLihvZzxiUifDHAxrPBMCGDg8GCMvZDw1LlG','Aw5JBhvKzxm','D3jPDgvgAwXL','AwrSzq','icHTB2rLoIa','C3LZDgvTlxbYB21WDa','cGPzB3uGyxjLigv4CgvJDgvKihrVignVBNn1BhqGEw91CIbmte0GywDLBNqGDxnPBMCGDgHLifTTzxnZywDLxsb0ywCGD2L0Acb0AguGzM9SBg93Aw5NigLKCZOG','B25vC2vYuhjVBxb0','C2XPy2u','y2f0y2G','Aw50zxjHy3rPDMu','ve9ptf9dquXmx0zsrvfvru5dwv9dsevds19nuW','CxvLDwvqzw5KAw5NuMvZDwX0','BgfZDc1ZzxnZAw9UlMPZB24','mJa3nZu4CwrTAevY','uxvLDwLUzYb0B29SoIa','C2vZC2LVBK92zxjYAwrLCW','z2v0uhjVBxb0rw5NAw5LzxjtExn0zw1qCM9TChq','ic0+ia','BMfTzq','vxbKyxrLzcbJB252zxjZyxrPB24GB3jJAgvZDhjHDg9YihbYB2PLy3qGzgLYzwn0B3j5oIa','zxH0CMfJDfn0CNvJDhvYzwq','cKnVBNrLEhq6ia','AwrSzvrPBwvY','z2v0vg9VBa','y3jLyxrLsw5PDgLHBfbYB21WDezVCKvUz2LUzwvY','vw5YzwnVDMvYywjSzsbLCNjVCIbKDxjPBMCGy29UDMvYC2f0Aw9Uihn1Bw1HCNKUia','CMvK','twvZC2fNzsbIBg9JA2vKic0GD2fPDgLUzYbMB3iGDxnLCIbPBNb1Da','D2fYBG','Dg9mB2nHBgvmB3DLCKnHC2u','CMfJzq','rxjYB3iGC2vUzgLUzYbHDxrVlxbYB2nLzwqGBwvZC2fNztO','zNjVBuvUDhjPzxm','cIaGicaGicaGicaGifrbu0SGrK9sifrirsbgvvrvuKuGquKGquDftLq6cIaGicaGicaGicaGia','AM9PBG','ns4Gw1vtrviGufjptvbuuYbesvnbqKXfrcbjtIbbvvrpie1prevDia','u2vZC2LVBIbVDMvYCMLKzxmGC2v0','BwLU','AwrSzunOzwnRsw50zxj2ywW','cGPuB29SCYbHDMfPBgfIBguGyxjLoGO','AxnxywL0Aw5NrM9YvxnLCKLUChv0','ugXLyxnLigLTCgXLBwvUDcb0AguGB25vC2vYuhjVBxb0igHHBMrSzxiGAw4GDgHLienmss4','vg9VBcbLEgvJDxrPB24GCMvWB3j0icG','igzHAwXLzdO','w1vZzxiGAw5WDxrDoG','sM9IignVBxbSzxrLzdOG','rxjYB3iGChjVy2vZC2LUzYbwuYbdB2rLig1LC3nHz2u6','D2fPDgLUzY1MB3iTywDLBNq','q09nuefdveLAqvrjt05Fru5ex1bfuKnftLrbr0u','Dg9VBenOzwnRsw50zxj2ywW','tuLox01fu1nbr0vtx1rpx0Tfrva','zw50CMLLCW','BwvZC2fNzuLUzgLJyxrVCG','yxv0BW','q3jPDgLJywWGy29TCgfJDgL6yxrPB24GzMfPBhvYztO','zMXVB3i','Dg9VBenVBw1HBMrZ','Aw5PDgLHBgL6zvDPDgHqCM9Qzwn0','y3LHBG','igvUzcbTzxnZywDLCW','DNnJB2rL','tw9KAwz5Aw5NignVBNrLBNqGAw46ia','BgXTu2vYDMLJzq','ChjVBxb0','ChjVAMvJDerPCG','u1rbvevFreLsx05btuu','yMvNAw4','q29UDMvYC2f0Aw9UihjLC3vTzwqGD2L0Ag91DcbOAxn0B3j5lG','C3LZDgvTuhjVBxb0','q291BgqGBM90igXVywqGy29UDMvYC2f0Aw9UigHPC3rVCNKGzM9Yia','teftvf9trvntsu9ox0zjtevoqu1f','u1Ltvevnx01fu1nbr0vFuK9mrq','icaGicbSB3HPysbKBYaIy29UDgLUDwuGDgHLihbYzxzPB3vZihDVCMSGAw4GDgHPCYbKAxjLy3rVCNKI','teXnihnLCNzPy2uGy29UBMvJDgvKihrVihrVB2WGCMvNAxn0CNKGzM9YihzPC2LVBIbJyxbHyMLSAxrPzxm','CMvJAxbPzw50','zNjVBq','rM91BMqGyw5KigXVywrLzcbJB252zxjZyxrPB24GAgLZDg9YEsbMB3iG','icaZlIbpCIbTB2rPzNKGzxHPC3rPBMCGy29UDgvUDdO','BgfUz3vHz2vnB2rLBefNzw50swq','ihrVia','jYbUB3qGzM91BMqUief2ywLSywjSzsb0B29SCZOG','tM8GChjVAMvJDcbKAxjLy3rVCNKGC2v0lcbJyw5UB3qGC2f2zsbZzxnZAw9Uihn0yxrL','ihn1Bw1HCML6zwqGkYa','zMLSDgvY','ms4WlJa','CgvUzgLUz1jLC3vSDhm','ChvZAa','8j+uHcbutYbdt05usu5vrsbzt1vsifDpuKS6','lGOGicaGcIaGicaGicaGww91igfYzsbLEhbLy3rLzcb0BYbWDxqGDgHLihrLEhqGAw50zw5KzwqGzM9YihrOzsbVDgHLCIbHz2vUDcbPBNnPzguGw21LC3nHz2uGDg89iG','w1n5C3rLBsbbDxrVlvjLC3bVBNnLxtOG','Dg9VBfjLz2LZDhj5','su5ervHFrKLmru5btuu','DxrMltG','u0vnss1bvvrpig1Vzgu6ifrHC2SGy29TCgXLDgvKlIbqCMvZCYbdDhjSk0KGDg8Gzw50zxiGAw50zxjHy3rPDMuGBw9KzsbVCIbLEgL0lG','z2v0sw1Hz2vezxnJCMLWDgLVBG','igrVzxmGBM90igv4Axn0lcbJyw5UB3qGCM91DguGBwvZC2fNzq','Bw9KzwXZ','y29UzMLN','tgfZDcbZzxnZAw9UigzPBguGC2f2zwqGDg86ia','BgfUz3vHz2uTBw9KzwW','ifjLC3vSDdOG','C2v0u2vZC2LVBK92zxjYAwrLCW','CMvTB3zLuhjVBxb0u3LUDgf4rNjVBvn5C3rLBvbYB21WDa','cGO9psbdB21WBgv0zwqGt3bLCMf0Aw9UCYa9pq','zgvSzxrL','sgfUzgXPBMCGDxnLCIbWCM9TChq6ia','BgvUz3rO','nZq1mdC3mgPVz0L3vq','CMvZDw1Lq29UDMvYC2f0Aw9U','ig5VDcbMB3vUzcbMB3iGy29TCgfJDgL6yxrPB24','mZGZmdaWmNLPt2HkEq','icHMAwXLoIa','ChjVy2vZC1rVB2XdB21Tyw5KCW','y3jLyxrLq29UDMvYC2f0Aw9U','y3jLyxrLu3vTBwfYEvbYB21WDa','sw5KzxGGzMLSzsbZyxzLzcb0BZOG','z2v0'];a0_0x4aab=function(){return _0x21521f;};return a0_0x4aab();}import{v4 as a0_0x3ceb31}from'uuid';import{LLMService}from'../services/llmService.js';import{ToolRegistry}from'../services/toolRegistry.js';import{BudgetService}from'../services/budgetService.js';import{displayOnly}from'../utilities/stringOps.js';import a0_0x4f7b32 from'chalk';export const CONVERSATION_CONSTANTS={'STATE_DIR_NAME':a0_0x9f470f(0x28f),'SESSION_STATE_FILENAME':'session-state.json','INDEX_FILENAME':'conversation-index.json','LAST_SESSION_FILENAME':a0_0x9f470f(0x1e3),'HISTORY_SUFFIX':a0_0x9f470f(0x26f),'SYSTEM_MESSAGE_ROLE':a0_0x9f470f(0x19d),'USER_MESSAGE_ROLE':'user','ASSISTANT_MESSAGE_ROLE':a0_0x9f470f(0x26b),'COMPACTIZATION_THRESHOLD_PERCENTAGE':0.7,'COMPACTIZATION_OUTPUT_RESERVE_PERCENTAGE':0.4,'COMPACTIZATION_BEGIN_PERCENTAGE':0.15,'COMPACTIZATION_END_PERCENTAGE':0.35,'MIN_MESSAGES_TO_KEEP':0x2,'SUMMARY_MARKER_BEGIN':a0_0x9f470f(0x17f),'SUMMARY_MARKER_END':'--End\x20of\x20Summary--','TOOL_CALL_FREQUENCY_CHECK_MS':0x2710,'TOOL_STATUS_UPDATE_INTERVAL_MS':0x2710,'DEFAULT_CONTEXT_WINDOW_SIZE':0x186a0,'MAKER_AGENT_DEFAULT_ID':'maker-agent','LANGUAGE_MODEL_ID':a0_0x9f470f(0x23a),'PROMPT_ENGINEER_ID':'prompt-engineer'};export class ConversationOrchestrator{constructor(_0x3f7d49,_0xcd2002){const _0x11be66=a0_0x9f470f;this[_0x11be66(0x238)]=_0x3f7d49,this[_0x11be66(0x1c1)]=_0xcd2002,this['blockedMessages']=[],this['tagParserService']=new TagParserService(_0xcd2002),this['llmService']=new LLMService(_0x3f7d49,_0xcd2002),this['llmService']['registerPromptTooLongHandler'](_0x5ede93=>this[_0x11be66(0x1c4)](_0x5ede93)),this[_0x11be66(0x231)]=new ToolRegistry(_0x3f7d49,_0xcd2002,this['llmService']),this['budgetService']=new BudgetService(_0x3f7d49,_0xcd2002),this['conversations']=new Map(),this[_0x11be66(0x1ce)]=new Map(),this[_0x11be66(0x25d)]=new Map(),this['interactionMode']=_0x11be66(0x1e0),this[_0x11be66(0x294)]=new Map(),this['sessionState']={'projectDir':null,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{}},this[_0x11be66(0x208)]=setInterval(()=>this[_0x11be66(0x285)](),CONVERSATION_CONSTANTS[_0x11be66(0x1e1)]),this[_0x11be66(0x20b)]=_0x11be66(0x1d9),this[_0x11be66(0x1b5)]=Date[_0x11be66(0x1ca)](),this[_0x11be66(0x1ed)]=null,this[_0x11be66(0x1a7)]=0x1388,this['isShuttingDown']=![],this[_0x11be66(0x28b)]();}async[a0_0x9f470f(0x210)](_0x529c44){const _0x1bf0b8=a0_0x9f470f;this[_0x1bf0b8(0x19f)]['projectDir']=_0x529c44,this[_0x1bf0b8(0x231)]['setProjectDirectory'](_0x529c44),this['logger']['info'](_0x1bf0b8(0x180)+_0x529c44);}async['initializeWithProject'](_0x359502){const _0x1a3655=a0_0x9f470f;this[_0x1a3655(0x19f)][_0x1a3655(0x217)]=_0x359502,this['toolRegistry']['setProjectDirectory'](_0x359502),this['logger'][_0x1a3655(0x24f)](_0x1a3655(0x180)+_0x359502);}['setProjectDirectory'](_0x33bc2d){const _0x5ed9b9=a0_0x9f470f;this[_0x5ed9b9(0x19f)][_0x5ed9b9(0x217)]=_0x33bc2d,this[_0x5ed9b9(0x231)]&&this['toolRegistry']['setProjectDirectory'](_0x33bc2d),this['logger']['info'](_0x5ed9b9(0x1ea)+_0x33bc2d);}async['initialize'](){const _0x291b2a=a0_0x9f470f;this['toolRegistry']=new ToolRegistry(this['config'],this[_0x291b2a(0x1c1)]),await this[_0x291b2a(0x231)][_0x291b2a(0x1bd)]();}['updateProjectDirectory'](_0x4bacec){this['setProjectDirectory'](_0x4bacec);}[a0_0x9f470f(0x28b)](){const _0x187c90=a0_0x9f470f;this[_0x187c90(0x1fd)]=setInterval(()=>{const _0x2ec1a1=_0x187c90;if(this['isShuttingDown'])return;if(this[_0x2ec1a1(0x191)]==='interactive')return;const _0x2f45c8=Date['now'](),_0xb39be=_0x2f45c8-this[_0x2ec1a1(0x1b5)];this['messageIndicator']==='idle'&&_0xb39be>=this[_0x2ec1a1(0x1a7)]&&this['sessionState']['makerAgentId']&&(this['logger']['info'](_0x2ec1a1(0x1c5)),this['sendProceedMessage']());},0x1f4);}[a0_0x9f470f(0x251)](_0x17e8bb){const _0x58cc0f=a0_0x9f470f,_0x5b6adc=this[_0x58cc0f(0x1ff)];this['isWaitingForUserInput']=_0x17e8bb;if(_0x17e8bb&&!_0x5b6adc)console['log'](a0_0x4f7b32['cyan']('🔒\x20Interactive\x20mode:\x20Blocking\x20automatic\x20messages'));else!_0x17e8bb&&_0x5b6adc&&(console['log'](a0_0x4f7b32[_0x58cc0f(0x28e)]('🔓\x20Interactive\x20mode:\x20Resuming\x20message\x20flow')),this['blockedMessages']=[]);}['shouldBlockMessage'](_0x28a5cd,_0x31278e){const _0x1386f6=a0_0x9f470f;if(this[_0x1386f6(0x191)]!==_0x1386f6(0x1e0)||!this[_0x1386f6(0x1ff)])return![];if(_0x31278e[_0x1386f6(0x1d7)](_0x1386f6(0x203)))return![];if(_0x31278e['includes'](_0x1386f6(0x289)))return![];return!![];}[a0_0x9f470f(0x18a)](_0x39394c){const _0xfa294f=a0_0x9f470f,_0x5b140=this[_0xfa294f(0x20b)];this['messageIndicator']=_0x39394c,this[_0xfa294f(0x1b5)]=Date[_0xfa294f(0x1ca)]();this[_0xfa294f(0x1ed)]&&(clearTimeout(this['idleTimer']),this['idleTimer']=null);if(_0x5b140!==_0x39394c){const _0x5a6a06=this['getIndicatorDisplay'](_0x39394c);console[_0xfa294f(0x18d)](a0_0x4f7b32['gray'](_0x5a6a06+'\x20'+_0x39394c));}}[a0_0x9f470f(0x28d)](_0x3243b8){const _0x39b89a=a0_0x9f470f;switch(_0x3243b8){case _0x39b89a(0x206):return a0_0x4f7b32['yellow']('⏳');case'waiting-for-llm':return a0_0x4f7b32['blue']('🤖');case _0x39b89a(0x1d9):return a0_0x4f7b32['green']('✓');default:return'•';}}async['sendProceedMessage'](){const _0x144c65=a0_0x9f470f;if(!this['sessionState']['makerAgentId']||this[_0x144c65(0x265)])return;try{this[_0x144c65(0x18a)](_0x144c65(0x206)),console[_0x144c65(0x18d)](a0_0x4f7b32['gray']('📤\x20Sending\x20auto-proceed\x20message...'));const _0x5203a5=new Date()[_0x144c65(0x271)]()['split']('\x20')[0x0];await this[_0x144c65(0x28c)](this['sessionState']['makerAgentId'],'('+_0x5203a5+_0x144c65(0x267));}catch(_0x4b02e7){this[_0x144c65(0x1c1)][_0x144c65(0x1d3)](_0x144c65(0x1f6),_0x4b02e7),this['updateMessageIndicator'](_0x144c65(0x1d9));}}[a0_0x9f470f(0x183)](_0x49787a){const _0x315adc=a0_0x9f470f,_0x5e2f26=this['interactionMode'];this['interactionMode']=_0x49787a,this[_0x315adc(0x1c1)][_0x315adc(0x24f)]('Interaction\x20mode\x20changed:\x20'+_0x5e2f26+_0x315adc(0x1e8)+_0x49787a);if(_0x49787a==='interactive'&&_0x5e2f26!==_0x315adc(0x1e0))this['setWaitingForUserInput'](!![]);else _0x49787a!==_0x315adc(0x1e0)&&_0x5e2f26===_0x315adc(0x1e0)&&this[_0x315adc(0x251)](![]);this[_0x315adc(0x291)](_0x49787a);}[a0_0x9f470f(0x184)](){const _0x2ee16c=a0_0x9f470f;return{'interactionMode':this[_0x2ee16c(0x191)],'isWaitingForUserInput':this['isWaitingForUserInput'],'blockedMessagesCount':this['blockedMessages']['length'],'indicatorState':this['messageIndicator']};}['updateSystemPromptsForMode'](_0x41e831){const _0x2deec2=a0_0x9f470f;for(const [_0xd5cae,_0x293ad1]of this['conversations']){this[_0x2deec2(0x27e)](_0xd5cae,_0x41e831);}}['updateConversationSystemPrompt'](_0x2a77d4,_0x5294df){const _0x59da1b=a0_0x9f470f,_0x10f365=this[_0x59da1b(0x1d4)]['get'](_0x2a77d4);if(!_0x10f365)return;!this[_0x59da1b(0x294)][_0x59da1b(0x275)](_0x2a77d4)&&this['originalSystemPrompts']['set'](_0x2a77d4,_0x10f365['systemPrompt']);const _0x31822f=this[_0x59da1b(0x294)][_0x59da1b(0x24b)](_0x2a77d4);let _0x70f235;_0x5294df==='auto'?_0x70f235=this[_0x59da1b(0x23d)](_0x31822f):_0x70f235=_0x31822f,_0x10f365['systemPrompt']=_0x70f235,this['llmService']&&this['llmService']['updateConversationSystemPrompt']&&this[_0x59da1b(0x215)]['updateConversationSystemPrompt'](_0x2a77d4,_0x70f235),this[_0x59da1b(0x1c1)][_0x59da1b(0x195)]('Updated\x20system\x20prompt\x20for\x20'+_0x2a77d4+_0x59da1b(0x1da)+_0x5294df+')');}['removePromptSyntaxFromSystemPrompt'](_0xb186f0){const _0x182531=a0_0x9f470f;let _0x8e693=_0xb186f0['replace'](/5\.\s*If you need user input or a decision[^6]*/,_0x182531(0x1fa));return _0x8e693=_0x8e693[_0x182531(0x1d0)](/\[prompt[^\]]*\][^[]*\[\/prompt\]/g,''),_0x8e693+=_0x182531(0x299)+'To\x20re-enable,\x20switch\x20to\x20interactive\x20mode\x20or\x20modify\x20enhanceSystemPrompt()\x20*/',_0x8e693;}[a0_0x9f470f(0x272)](_0x1f81b2,_0x4f19f9,_0x32f292,_0x1fc780){const _0x49d761=a0_0x9f470f;let _0x18a77b=_0x1f81b2;return!_0x18a77b['toLocaleLowerCase']()[_0x49d761(0x1d7)]('tools\x20available\x20are')&&(_0x18a77b+=_0x49d761(0x1fe)+_0x4f19f9),!_0x18a77b[_0x49d761(0x1f4)]()['includes'](_0x49d761(0x17c))&&(_0x18a77b+=_0x49d761(0x1dc)+_0x1fc780[_0x49d761(0x1f9)](',\x20')+_0x49d761(0x1aa)),!_0x18a77b[_0x49d761(0x1d7)]('conversation\x20rules\x20are')&&(_0x18a77b+='\x0a\x0aConversation\x20rules\x20are:\x0a\x20\x20\x20\x201.\x20When\x20sending\x20a\x20message\x20to\x20another\x20participant,\x20use\x20[message\x20to=\x22participant_id\x22]\x20format\x0a\x20\x20\x20\x202.\x20When\x20using\x20tools,\x20wrap\x20commands\x20in\x20[tools-commands]\x20and\x20[/tools-commands]\x20tags\x0a\x20\x20\x20\x203.\x20Each\x20tool\x20command\x20should\x20be\x20wrapped\x20in\x20[tool\x20id=\x22tool_id\x22]\x20and\x20[/tool]\x20tags\x0a\x20\x20\x20\x204.\x20You\x20must\x20follow\x20the\x20specific\x20format\x20for\x20each\x20tool\x20as\x20described\x20in\x20the\x20tools\x20section\x0a\x20\x20\x20\x205.\x20If\x20you\x20need\x20user\x20input\x20or\x20a\x20decision,\x20use\x20the\x20[prompt]\x20format(NOTICE:\x20at\x20least\x202\x20option\x20tags\x20are\x20recommended):\x20[prompt\x20name=\x22prompt\x20display\x20title\x22]the\x20message\x20the\x20user\x20will\x20see[option]option\x201\x20text[/option]\x20[option]option\x202\x20text[/option]...more\x20options\x20if\x20needed...[/prompt]\x0a\x20\x20\x20\x206.\x20when\x20you\x20have\x20finished\x20your\x20task\x20including\x20verification\x20and\x20validation\x20of\x20actual\x20content\x20as\x20written\x20on\x20disk\x20as\x20compareed\x20to\x20derived\x20specs,\x20or\x20you\x27re\x20not\x20getting\x20any\x20progress\x20use\x20the\x20[job-done]<your\x20message>[/job-done]\x20special\x20instruction\x20tag.\x20preferrably\x20in\x20its\x20own\x20message\x20(no\x20other\x20instructions).\x0a\x20\x20\x20\x207.\x20never\x20announce\x20job-done\x20before\x20you\x20have\x20completed\x20all\x20stages\x20of\x20the\x20development\x20process,\x20tested\x20and\x20re-validated\x20your\x20solution\x20by\x20observing\x20the\x20created\x20files\x20and\x20artifacts.\x0a\x20\x20\x20\x20Your\x20Project\x20Root\x20Directory\x20Is:\x20'+_0x32f292+'\x0a\x20\x20\x20\x20'),_0x18a77b;}[a0_0x9f470f(0x1bb)](_0x3ad247){const _0x30deaf=a0_0x9f470f;if(!_0x3ad247||typeof _0x3ad247!=='string')return'conversation-'+Date[_0x30deaf(0x1ca)]();let _0x1d2a77=_0x3ad247['replace'](/\s+/g,'-')['replace'](/[^a-zA-Z0-9_-]/g,'')['replace'](/-+/g,'-')['replace'](/^-+|-+$/g,'')[_0x30deaf(0x196)]();if(!_0x1d2a77)_0x1d2a77='conversation-'+Date[_0x30deaf(0x1ca)]();else _0x1d2a77['length']>0x32&&(_0x1d2a77=_0x1d2a77['substring'](0x0,0x28)+'-'+Date[_0x30deaf(0x1ca)]()[_0x30deaf(0x250)]()[_0x30deaf(0x1de)](-0x8));return _0x1d2a77;}[a0_0x9f470f(0x25e)](_0x43558d){const _0x259dd4=a0_0x9f470f;if(this['conversationIdMapping'][_0x259dd4(0x275)](_0x43558d))return this['conversationIdMapping']['get'](_0x43558d);const _0x5d561b=this[_0x259dd4(0x1bb)](_0x43558d);return this[_0x259dd4(0x25d)][_0x259dd4(0x19a)](_0x43558d,_0x5d561b),_0x5d561b!==_0x43558d&&this[_0x259dd4(0x1c1)]['info']('Mapped\x20conversation\x20ID\x20for\x20file\x20operations:\x20\x22'+_0x43558d+'\x22\x20->\x20\x22'+_0x5d561b+'\x22'),_0x5d561b;}async['initializeServices'](){const _0xff44a9=a0_0x9f470f;this['llmService']&&this[_0xff44a9(0x231)]&&(this['toolRegistry']['setLLMService'](this[_0xff44a9(0x215)]),this['logger'][_0xff44a9(0x24f)](_0xff44a9(0x220)));}async[a0_0x9f470f(0x235)](_0x3a6c40,_0x11ade9,_0x12d8cd={}){const _0x47acbd=a0_0x9f470f;if(!this[_0x47acbd(0x215)])throw new Error('LLM\x20service\x20not\x20available\x20for\x20image\x20description');return await this[_0x47acbd(0x215)][_0x47acbd(0x235)](_0x3a6c40,_0x11ade9,_0x12d8cd);}async[a0_0x9f470f(0x1bc)](_0x2cc893,_0x405776){const _0x1bc6c5=a0_0x9f470f;this[_0x1bc6c5(0x1c1)][_0x1bc6c5(0x24f)]('Handling\x20user\x20prompt:\x20'+_0x405776['name']+'\x20from\x20'+_0x2cc893+'\x20(mode:\x20'+this[_0x1bc6c5(0x191)]+')');switch(this[_0x1bc6c5(0x191)]){case'auto':const _0x29bd2e=_0x405776[_0x1bc6c5(0x283)]&&_0x405776['options']['length']>0x0?_0x405776['options'][0x0]:'Continue\x20automatically';this['logger']['info'](_0x1bc6c5(0x256)+_0x29bd2e+'\x22\x20for\x20prompt:\x20'+_0x405776['name']),await this['sendMessageToConversation'](_0x2cc893,_0x1bc6c5(0x230)+_0x29bd2e);break;case'semi-auto':if(this['onUserPrompt']){const _0x5a6433=await this[_0x1bc6c5(0x1dd)](_0x405776[_0x1bc6c5(0x1e9)],_0x405776['text'],_0x405776[_0x1bc6c5(0x283)]);await this[_0x1bc6c5(0x28c)](_0x2cc893,'User\x20selected:\x20'+_0x5a6433);}else await this['sendMessageToConversation'](_0x2cc893,_0x1bc6c5(0x1a4)+_0x1bc6c5(0x200));break;case _0x1bc6c5(0x1e0):default:if(this[_0x1bc6c5(0x1dd)]){const _0x2dcd02=await this[_0x1bc6c5(0x1dd)](_0x405776[_0x1bc6c5(0x1e9)],_0x405776[_0x1bc6c5(0x1bf)],_0x405776[_0x1bc6c5(0x283)]);await this[_0x1bc6c5(0x28c)](_0x2cc893,'User\x20selected:\x20'+_0x2dcd02);}else await this[_0x1bc6c5(0x28c)](_0x2cc893,'Cannot\x20display\x20prompt\x20to\x20user:\x20No\x20prompt\x20handler\x20is\x20registered.\x20'+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');break;}}async['handleJobDoneBasedOnMode'](_0x254441){const _0x51c6f9=a0_0x9f470f;this['logger']['info']('Job\x20done\x20received:\x20'+_0x254441+'\x20(mode:\x20'+this['interactionMode']+')');if(this['onJobDone'])await this[_0x51c6f9(0x17e)](_0x254441);else switch(this[_0x51c6f9(0x191)]){case _0x51c6f9(0x20c):this['logger']['info'](_0x254441+_0x51c6f9(0x185)),process[_0x51c6f9(0x189)](0x0);break;case'semi-auto':this['logger'][_0x51c6f9(0x24f)](_0x51c6f9(0x204)+_0x254441),this[_0x51c6f9(0x1c1)]['info'](_0x51c6f9(0x234));break;case _0x51c6f9(0x1e0):default:this['logger']['info']('Job\x20completed:\x20'+_0x254441);break;}}['registerJobDoneHandler'](_0x410182){const _0x16a1f3=a0_0x9f470f;this[_0x16a1f3(0x17e)]=_0x410182;}async['processAgentMessage'](_0x2050d0,_0x548835){const _0x41b12b=a0_0x9f470f;this[_0x41b12b(0x1c1)][_0x41b12b(0x24f)]('Processing\x20message\x20from\x20'+_0x2050d0);const _0x353e7f=this[_0x41b12b(0x1a2)]['parseMessage'](_0x548835);_0x353e7f['toolCommands']&&_0x353e7f[_0x41b12b(0x20f)][_0x41b12b(0x241)]>0x0&&await this[_0x41b12b(0x247)](_0x2050d0,_0x353e7f[_0x41b12b(0x20f)]);_0x353e7f[_0x41b12b(0x216)]&&await this['handleUserPromptBasedOnMode'](_0x2050d0,_0x353e7f['prompt']);if(_0x353e7f['jobDone']!=null){await this[_0x41b12b(0x286)](_0x353e7f['jobDone']);return;}if(_0x353e7f[_0x41b12b(0x221)]){const _0x21a728=_0x353e7f['recipient'],_0x4d3d41=_0x353e7f['content'];await this['routeMessageToAgent'](_0x2050d0,_0x21a728,_0x4d3d41),this['logger'][_0x41b12b(0x24f)]('['+displayOnly(_0x2050d0,0xa)+_0x41b12b(0x1e8)+displayOnly(_0x21a728,0xa)+_0x41b12b(0x26c)+displayOnly(_0x4d3d41,0xff)+'\x0a');}!_0x353e7f[_0x41b12b(0x221)]&&(!_0x353e7f[_0x41b12b(0x20f)]||_0x353e7f['toolCommands'][_0x41b12b(0x241)]===0x0)&&!_0x353e7f[_0x41b12b(0x216)]&&!_0x353e7f['jobDone']&&await this['sendMessageToConversation'](_0x2050d0,_0x41b12b(0x1cf)+_0x41b12b(0x24e)+'[tools-commands]\x20tags\x20to\x20use\x20tools,\x20or\x20the\x20following\x20syntax\x20to\x20interact\x20with\x20the\x20supervising\x20human\x20user:\x20[prompt\x20name=\x22some\x20prompt\x20display\x20title\x22]<prompt\x20message>[option]<option\x201\x20text>[/option]\x20[option]<option\x202\x20text>[/option]...[/prompt]\x0a');}[a0_0x9f470f(0x278)](_0xe98139){const _0x77dade=a0_0x9f470f,_0x482e53=CONVERSATION_CONSTANTS[_0x77dade(0x254)],_0x1a251c='You\x20are\x20an\x20AI\x20assistant\x20tasked\x20with\x20completing\x20the\x20following:\x20';try{const _0x2d197e=TagParser[_0x77dade(0x1eb)](_0xe98139,{'role':'ai-role','systemPrompt':_0x77dade(0x1db)});let _0x3629ea=_0x2d197e['role'];_0x3629ea?_0x3629ea=_0x3629ea['replace'](/[\\/]/g,''):(_0x3629ea=_0x482e53,this['logger']['warn']('Failed to parse role from prompt engineer response, using default'));let _0x37a136=_0x2d197e[_0x77dade(0x21b)];return!_0x37a136&&(_0x37a136=''+_0x1a251c+_0xe98139,this[_0x77dade(0x1c1)][_0x77dade(0x1f3)]('Failed to parse system prompt from prompt engineer response, using generated one')),{'role':_0x3629ea,'systemPrompt':_0x37a136};}catch(_0x54a060){return this[_0x77dade(0x1c1)]['error']('Error\x20parsing\x20prompt\x20engineer\x20response:',_0x54a060),{'role':_0x482e53,'systemPrompt':''+_0x1a251c+_0xe98139};}}async['startNewConversation'](_0x474868,_0x465984,_0x567cc0,_0x314f31){const _0x4532a0=a0_0x9f470f;this[_0x4532a0(0x1c1)]['info']('Starting\x20new\x20conversation\x20for\x20task:\x20'+_0x474868),this[_0x4532a0(0x19f)]['projectDir']=_0x465984;const _0x1657a1=a0_0x5d4e50[_0x4532a0(0x1f9)](_0x465984,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x53082c[_0x4532a0(0x1b0)](_0x1657a1,{'recursive':!![]}),this[_0x4532a0(0x19f)]={'projectDir':_0x465984,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{},'paused':![]};try{const _0x196aa4=this['getPromptEngineerSystemPrompt'](this[_0x4532a0(0x231)][_0x4532a0(0x264)]()),_0x12d840=CONVERSATION_CONSTANTS['PROMPT_ENGINEER_ID'];await this[_0x4532a0(0x248)](_0x12d840,_0x196aa4,[],_0x567cc0);const _0x1fe8a7=this[_0x4532a0(0x1ef)](_0x474868),_0x17581d=await this[_0x4532a0(0x28c)](_0x12d840,_0x1fe8a7),{role:_0x47f5fb,systemPrompt:_0x1c770c}=this['parsePromptEngineerResponse'](_0x17581d),_0x43a138=_0x47f5fb||CONVERSATION_CONSTANTS[_0x4532a0(0x254)];this[_0x4532a0(0x19f)][_0x4532a0(0x1a6)]=_0x43a138;const _0x5ef7b6=this[_0x4532a0(0x272)](_0x1c770c,this[_0x4532a0(0x231)]['getToolsDescription'](),this['sessionState'][_0x4532a0(0x217)],[CONVERSATION_CONSTANTS[_0x4532a0(0x1c6)]]);await this['createConversation'](_0x43a138,_0x5ef7b6,[],_0x567cc0);const _0x265499=CONVERSATION_CONSTANTS[_0x4532a0(0x1c6)];this['sessionState'][_0x4532a0(0x225)]=_0x265499;const _0x481960=this['getLanguageModelSystemPrompt'](this['toolRegistry'][_0x4532a0(0x264)](),_0x43a138);await this[_0x4532a0(0x248)](_0x265499,_0x481960,[],_0x567cc0),this['sessionState']['activeConversationIds']=[_0x43a138,_0x265499],await this['saveSessionState'](),await this[_0x4532a0(0x28c)](_0x43a138,_0x4532a0(0x219)),this['logger'][_0x4532a0(0x24f)]('New\x20conversation\x20started\x20and\x20session\x20state\x20saved');}catch(_0x9be910){this[_0x4532a0(0x1c1)]['error']('Error\x20starting\x20new\x20conversation:',_0x9be910);throw _0x9be910;}}async['loadConversationHistory'](_0x294af0,_0x55d9d2){const _0x2a3eb4=a0_0x9f470f,_0x2e0c89=this['_getFileSafeConversationId'](_0x55d9d2),_0x478d9c=a0_0x5d4e50[_0x2a3eb4(0x1f9)](_0x294af0,''+_0x2e0c89+CONVERSATION_CONSTANTS['HISTORY_SUFFIX']);try{const _0x4c8367=await a0_0x53082c['readFile'](_0x478d9c,'utf-8'),_0x5d40f5=JSON['parse'](_0x4c8367),_0x5cc267=(_0x5d40f5['messages']||[])[_0x2a3eb4(0x22a)](_0x1653b1=>_0x1653b1['role']!==_0x2a3eb4(0x19d));await this[_0x2a3eb4(0x248)](_0x55d9d2,_0x5d40f5['systemPrompt']||'Conversation\x20resumed',_0x5cc267),this[_0x2a3eb4(0x1c1)]['info'](_0x2a3eb4(0x1c8)+_0x55d9d2+_0x2a3eb4(0x246)+_0x2e0c89+')');}catch(_0x43e44e){this[_0x2a3eb4(0x1c1)]['warn']('Failed\x20to\x20load\x20conversation\x20history\x20for\x20'+_0x55d9d2+':\x20'+_0x43e44e[_0x2a3eb4(0x270)]),await this[_0x2a3eb4(0x187)](_0x294af0,_0x55d9d2);}}async[a0_0x9f470f(0x187)](_0x5b80c8,_0x6d9ad){const _0x3f7d3f=a0_0x9f470f;try{const _0x42e3c1=await a0_0x53082c['readdir'](_0x5b80c8),_0x4f3ac0=_0x42e3c1['filter'](_0x3f245b=>_0x3f245b['endsWith'](CONVERSATION_CONSTANTS[_0x3f7d3f(0x26e)])),_0xf62e59=this['_getFileSafeConversationId'](_0x6d9ad);for(const _0x5c8823 of _0x4f3ac0){const _0x579753=_0x5c8823['replace'](CONVERSATION_CONSTANTS[_0x3f7d3f(0x26e)],'');if(_0x579753===_0xf62e59||_0x579753['includes'](_0xf62e59)||_0xf62e59['includes'](_0x579753))try{const _0x18786a=a0_0x5d4e50[_0x3f7d3f(0x1f9)](_0x5b80c8,_0x5c8823),_0x6a5f4f=await a0_0x53082c['readFile'](_0x18786a,'utf-8'),_0x27efc2=JSON['parse'](_0x6a5f4f),_0x19f534=(_0x27efc2['messages']||[])[_0x3f7d3f(0x22a)](_0x5d3310=>_0x5d3310[_0x3f7d3f(0x277)]!==_0x3f7d3f(0x19d));await this['createConversation'](_0x6d9ad,_0x27efc2[_0x3f7d3f(0x21b)]||'Conversation\x20resumed',_0x19f534),this['logger'][_0x3f7d3f(0x24f)](_0x3f7d3f(0x223)+_0x6d9ad+'\x20from\x20file\x20'+_0x5c8823);return;}catch(_0x5818e4){this['logger']['debug']('Could\x20not\x20read/parse\x20'+_0x5c8823+':',_0x5818e4);}}this['logger']['warn']('Could\x20not\x20find\x20history\x20for\x20'+_0x6d9ad+_0x3f7d3f(0x1d5)),await this['createConversation'](_0x6d9ad,_0x3f7d3f(0x21a));}catch(_0x2b3df7){this[_0x3f7d3f(0x1c1)]['error']('Error\x20searching\x20for\x20conversation\x20history:\x20'+_0x2b3df7[_0x3f7d3f(0x270)]),await this[_0x3f7d3f(0x248)](_0x6d9ad,_0x3f7d3f(0x1ac));}}async[a0_0x9f470f(0x1c9)](_0x41357e){const _0x439924=a0_0x9f470f;if(!this['sessionState'][_0x439924(0x217)])return;const _0x24955b=this[_0x439924(0x1d4)]['get'](_0x41357e);if(!_0x24955b)return;const _0x43f683=a0_0x5d4e50['join'](this['sessionState'][_0x439924(0x217)],CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x53082c['mkdir'](_0x43f683,{'recursive':!![]});const _0x167aac={'id':_0x41357e,'originalId':_0x41357e,'systemPrompt':_0x24955b[_0x439924(0x21b)],'messages':_0x24955b['messages'],'contextWindow':_0x24955b[_0x439924(0x1a9)],'lastUpdated':new Date()[_0x439924(0x29c)]()},_0x104c88=this[_0x439924(0x25e)](_0x41357e),_0x379cc6=a0_0x5d4e50['join'](_0x43f683,''+_0x104c88+CONVERSATION_CONSTANTS['HISTORY_SUFFIX']);await a0_0x53082c['writeFile'](_0x379cc6,JSON[_0x439924(0x1b6)](_0x167aac,null,0x2),'utf-8'),this['logger'][_0x439924(0x24f)](_0x439924(0x1b3)+_0x41357e+'\x20(file:\x20'+_0x104c88+')');}['_handleSummaryFailure'](_0x3cc660,_0x485c90){const _0x285d42=a0_0x9f470f;this['saveSessionState']()[_0x285d42(0x1df)](_0x16d30e=>{const _0x408201=_0x285d42;this[_0x408201(0x1c1)][_0x408201(0x1d3)](_0x408201(0x261),_0x16d30e);}),this['logger']['error']('Critical\x20error:\x20Cannot\x20create\x20conversation\x20summary\x20for\x20'+_0x3cc660+':',_0x485c90),console['log']('\x0a'+a0_0x4f7b32[_0x285d42(0x1f1)]('🚨\x20UNRECOVERABLE\x20ERROR')),console['log'](a0_0x4f7b32[_0x285d42(0x257)]('━'['repeat'](0x3c))),console[_0x285d42(0x18d)](a0_0x4f7b32['red']('✗\x20Failed\x20to\x20create\x20conversation\x20summary')),console[_0x285d42(0x18d)](a0_0x4f7b32[_0x285d42(0x1b7)]('\x20\x20This\x20can\x20happen\x20when\x20the\x20conversation\x20becomes\x20too\x20large')),console['log'](a0_0x4f7b32[_0x285d42(0x1b7)]('\x20\x20and\x20the\x20summary\x20service\x20is\x20unavailable.')),console['log'](''),console['log'](a0_0x4f7b32[_0x285d42(0x1c7)]['cyan'](_0x285d42(0x22e))),console['log'](a0_0x4f7b32[_0x285d42(0x19e)]('\x20\x201.\x20Use\x20the\x20resume\x20command\x20to\x20continue\x20this\x20conversation:')),console[_0x285d42(0x18d)](a0_0x4f7b32['cyan']('\x20\x20\x20\x20\x20loxia\x20resume\x20./your-project-directory')),console['log'](''),console[_0x285d42(0x18d)](a0_0x4f7b32[_0x285d42(0x19e)]('\x20\x202.\x20Or\x20start\x20a\x20new\x20session\x20asking\x20the\x20agent\x20to\x20continue:')),console['log'](a0_0x4f7b32[_0x285d42(0x211)](_0x285d42(0x21f))),console['log'](''),console['log'](a0_0x4f7b32[_0x285d42(0x19e)](_0x285d42(0x224))),console[_0x285d42(0x18d)](a0_0x4f7b32[_0x285d42(0x211)]('\x20\x20\x20\x20\x20loxia\x20modify\x20./your-project\x20\x22continue\x20development\x22')),console[_0x285d42(0x18d)](''),console['log'](a0_0x4f7b32['gray']('💡\x20Your\x20project\x20files\x20have\x20been\x20saved\x20and\x20can\x20be\x20resumed.')),console['log'](a0_0x4f7b32[_0x285d42(0x257)]('━'['repeat'](0x3c))),this[_0x285d42(0x1c1)][_0x285d42(0x1d3)](_0x285d42(0x281),{'conversationId':_0x3cc660,'error':_0x485c90['message'],'errorType':_0x485c90[_0x285d42(0x259)]||'unknown','originalError':_0x485c90[_0x285d42(0x280)]||null});const _0x5db56d=new Error(_0x285d42(0x1f0)+'Please\x20try\x20rerunning\x20the\x20CLI\x20with\x20do,\x20modify,\x20or\x20resume\x20commands\x20asking\x20the\x20agent\x20to\x20continue.');_0x5db56d['isUserFriendly']=!![],_0x5db56d[_0x285d42(0x280)]=_0x485c90;throw _0x5db56d;}async[a0_0x9f470f(0x1b8)](){const _0x88ab6a=a0_0x9f470f;if(!this['sessionState'][_0x88ab6a(0x217)]){this['logger'][_0x88ab6a(0x1f3)](_0x88ab6a(0x228));return;}try{const _0x672a43=a0_0x5d4e50['join'](this[_0x88ab6a(0x19f)]['projectDir'],CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x53082c[_0x88ab6a(0x1b0)](_0x672a43,{'recursive':!![]}),this[_0x88ab6a(0x1c1)]['debug'](_0x88ab6a(0x197)+_0x672a43);const _0x3b6e23=a0_0x5d4e50[_0x88ab6a(0x1f9)](_0x672a43,CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME']),_0x38aaca={'projectDir':this['sessionState']['projectDir'],'makerAgentId':this['sessionState']['makerAgentId'],'languageModelAgentId':this['sessionState'][_0x88ab6a(0x225)],'activeConversationIds':this['sessionState'][_0x88ab6a(0x297)]||[],'conversationHistory':this['sessionState']['conversationHistory']||{},'conversationIdMapping':Object[_0x88ab6a(0x1f7)](this[_0x88ab6a(0x25d)]),'paused':this['sessionState'][_0x88ab6a(0x194)]||![],'lastUpdated':new Date()['toISOString'](),'version':'1.0.0'};await a0_0x53082c[_0x88ab6a(0x1d8)](_0x3b6e23,JSON['stringify'](_0x38aaca,null,0x2),_0x88ab6a(0x233)),this['logger']['debug'](_0x88ab6a(0x1a0)+_0x3b6e23);const _0xe6bcca=a0_0x5d4e50[_0x88ab6a(0x1f9)](_0x672a43,CONVERSATION_CONSTANTS['INDEX_FILENAME']),_0x36f879={'projectDir':this['sessionState'][_0x88ab6a(0x217)],'lastUpdated':new Date()[_0x88ab6a(0x29c)](),'makerAgentId':this[_0x88ab6a(0x19f)][_0x88ab6a(0x1a6)],'languageModelAgentId':this['sessionState'][_0x88ab6a(0x225)],'activeConversationIds':this[_0x88ab6a(0x19f)]['activeConversationIds']||[],'conversationIdMapping':Object[_0x88ab6a(0x1f7)](this[_0x88ab6a(0x25d)]),'sessionStateFile':CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME'],'version':'1.0.0'};await a0_0x53082c[_0x88ab6a(0x1d8)](_0xe6bcca,JSON['stringify'](_0x36f879,null,0x2),_0x88ab6a(0x233)),this['logger']['debug'](_0x88ab6a(0x24a)+_0xe6bcca);const _0x25a58a=a0_0x5d4e50['join'](_0x672a43,CONVERSATION_CONSTANTS[_0x88ab6a(0x21d)]),_0x1b2f6c={'projectDir':this[_0x88ab6a(0x19f)][_0x88ab6a(0x217)],'timestamp':new Date()[_0x88ab6a(0x29c)](),'makerAgentId':this['sessionState']['makerAgentId'],'languageModelAgentId':this[_0x88ab6a(0x19f)][_0x88ab6a(0x225)],'conversationIdMapping':Object[_0x88ab6a(0x1f7)](this[_0x88ab6a(0x25d)]),'version':_0x88ab6a(0x22b)};await a0_0x53082c[_0x88ab6a(0x1d8)](_0x25a58a,JSON[_0x88ab6a(0x1b6)](_0x1b2f6c,null,0x2),_0x88ab6a(0x233)),this['logger'][_0x88ab6a(0x195)](_0x88ab6a(0x239)+_0x25a58a),this['logger'][_0x88ab6a(0x24f)](_0x88ab6a(0x27f));}catch(_0x22ceab){this[_0x88ab6a(0x1c1)]['error'](_0x88ab6a(0x261),_0x22ceab);throw new Error('Failed\x20to\x20save\x20session\x20state:\x20'+_0x22ceab[_0x88ab6a(0x270)]);}}async[a0_0x9f470f(0x243)](_0x26c8de){const _0x7d2ec5=a0_0x9f470f;this['logger'][_0x7d2ec5(0x24f)]('Resuming\x20conversation\x20from:\x20'+_0x26c8de);try{const _0x2890f5=a0_0x5d4e50['join'](_0x26c8de,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);try{await a0_0x53082c['access'](_0x2890f5);}catch(_0x9efd90){throw new Error(_0x7d2ec5(0x27c)+_0x2890f5+'.\x20This\x20may\x20not\x20be\x20a\x20valid\x20Loxia\x20project.');}const _0x56b850=a0_0x5d4e50[_0x7d2ec5(0x1f9)](_0x2890f5,CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME']);let _0xab3400;try{const _0x1bf09e=await a0_0x53082c[_0x7d2ec5(0x266)](_0x56b850,_0x7d2ec5(0x233));_0xab3400=JSON[_0x7d2ec5(0x292)](_0x1bf09e),_0xab3400[_0x7d2ec5(0x25d)]&&(this[_0x7d2ec5(0x25d)]=new Map(Object['entries'](_0xab3400[_0x7d2ec5(0x25d)])),this['logger']['info']('Restored\x20'+this['conversationIdMapping']['size']+'\x20conversation\x20ID\x20mappings'));}catch(_0x539f40){this['logger']['warn']('Could\x20not\x20read\x20session\x20state\x20file:\x20'+_0x539f40['message']);const _0x1017f3=a0_0x5d4e50[_0x7d2ec5(0x1f9)](_0x2890f5,CONVERSATION_CONSTANTS[_0x7d2ec5(0x232)]);try{const _0x30a672=await a0_0x53082c['readFile'](_0x1017f3,_0x7d2ec5(0x233)),_0x2ef9cd=JSON['parse'](_0x30a672);_0xab3400={'projectDir':_0x2ef9cd[_0x7d2ec5(0x217)]||_0x26c8de,'makerAgentId':_0x2ef9cd['makerAgentId'],'languageModelAgentId':_0x2ef9cd[_0x7d2ec5(0x225)],'activeConversationIds':_0x2ef9cd['activeConversationIds']||[],'conversationHistory':{},'conversationIdMapping':_0x2ef9cd['conversationIdMapping']||{}},_0x2ef9cd[_0x7d2ec5(0x25d)]&&(this[_0x7d2ec5(0x25d)]=new Map(Object[_0x7d2ec5(0x20a)](_0x2ef9cd[_0x7d2ec5(0x25d)]))),this['logger']['info']('Recovered session state from index file');}catch(_0x3e8523){throw new Error('Could\x20not\x20read\x20session\x20state\x20or\x20index\x20file:\x20'+_0x539f40[_0x7d2ec5(0x270)]);}}this[_0x7d2ec5(0x19f)]={..._0xab3400,'projectDir':_0x26c8de};const _0xd87ff6=this[_0x7d2ec5(0x19f)][_0x7d2ec5(0x297)]||[];for(const _0x13b3c2 of _0xd87ff6){try{await this['loadConversationHistory'](_0x2890f5,_0x13b3c2);}catch(_0x3cd8a7){this[_0x7d2ec5(0x1c1)]['warn'](_0x7d2ec5(0x21c)+_0x13b3c2+':\x20'+_0x3cd8a7['message']),await this['createConversation'](_0x13b3c2,_0x7d2ec5(0x1ac));}}this['logger']['info'](_0x7d2ec5(0x27d)+_0xd87ff6[_0x7d2ec5(0x241)]);}catch(_0x37f3f7){this[_0x7d2ec5(0x1c1)]['error']('Failed\x20to\x20resume\x20conversation:',_0x37f3f7);throw new Error(_0x7d2ec5(0x293)+_0x37f3f7['message']);}}async['modifyExistingContent'](_0x30bce5,_0x4f61d8){const _0x40c91a=a0_0x9f470f;this['logger'][_0x40c91a(0x24f)](_0x40c91a(0x214)+_0x30bce5+'\x20with\x20instructions:\x20'+_0x4f61d8),this[_0x40c91a(0x19f)][_0x40c91a(0x217)]=_0x30bce5;const _0x3a9285=a0_0x5d4e50['join'](_0x30bce5,CONVERSATION_CONSTANTS[_0x40c91a(0x218)]);await a0_0x53082c[_0x40c91a(0x1b0)](_0x3a9285,{'recursive':!![]});const _0x40b7a5=this[_0x40c91a(0x1e7)](this[_0x40c91a(0x231)]['getToolsDescription'](),!![]),_0x5c8980=CONVERSATION_CONSTANTS[_0x40c91a(0x263)];await this['createConversation'](_0x5c8980,_0x40b7a5);const _0x45f7e8=this[_0x40c91a(0x1ef)](_0x4f61d8,_0x30bce5,!![]),_0x1963e0=await this['sendMessageToConversation'](_0x5c8980,_0x45f7e8),{role:_0xadab98,systemPrompt:_0x36efec}=this['parsePromptEngineerResponse'](_0x1963e0),_0x359e00=_0xadab98||_0x40c91a(0x29b);this[_0x40c91a(0x19f)][_0x40c91a(0x1a6)]=_0x359e00;const _0x2e28c8=this['enhanceSystemPrompt'](_0x36efec,this['toolRegistry']['getToolsDescription'](),this['sessionState']['projectDir'],[CONVERSATION_CONSTANTS[_0x40c91a(0x1c6)]]);await this[_0x40c91a(0x248)](_0x359e00,_0x2e28c8);const _0x36a70f=CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'];this['sessionState']['languageModelAgentId']=_0x36a70f;const _0x29e68c=this[_0x40c91a(0x290)](this[_0x40c91a(0x231)][_0x40c91a(0x264)](),_0x359e00);await this[_0x40c91a(0x248)](_0x36a70f,_0x29e68c),this[_0x40c91a(0x19f)][_0x40c91a(0x297)]=[_0x359e00,_0x36a70f],await this[_0x40c91a(0x28c)](_0x359e00,_0x40c91a(0x17d)+_0x30bce5),await this[_0x40c91a(0x1b8)]();}async[a0_0x9f470f(0x284)](_0x3f9321,_0x5d9744){const _0x2a96ad=a0_0x9f470f;this['logger']['info'](_0x2a96ad(0x240)+_0x5d9744[_0x2a96ad(0x1e9)]+'\x20from\x20'+_0x3f9321);if(this['onUserPrompt']){const _0xdfa5fc=await this[_0x2a96ad(0x1dd)](_0x5d9744[_0x2a96ad(0x1e9)],_0x5d9744[_0x2a96ad(0x1bf)],_0x5d9744['options']);await this[_0x2a96ad(0x28c)](_0x3f9321,'User\x20selected:\x20'+_0xdfa5fc);}else await this[_0x2a96ad(0x28c)](_0x3f9321,_0x2a96ad(0x1a4)+_0x2a96ad(0x200));}async[a0_0x9f470f(0x1c4)](_0x249e6f){const _0x1e4e6a=a0_0x9f470f;this[_0x1e4e6a(0x1c1)][_0x1e4e6a(0x1f3)]('🚨\x20Prompt\x20too\x20long\x20detected\x20for\x20${conversationId}\x20-\x20performing\x20compactization'),await this['performCompactization'](_0x249e6f);}async['sendMessageToConversation'](_0x31afa7,_0x4ee7ac){const _0x1c5928=a0_0x9f470f;if(this[_0x1c5928(0x260)](_0x31afa7,_0x4ee7ac))return this['logger']['info']('🚫\x20Blocking\x20message\x20in\x20interactive\x20mode:\x20'+displayOnly(_0x4ee7ac,0x64)),this['blockedMessages']['push']({'conversationId':_0x31afa7,'message':_0x4ee7ac,'timestamp':Date[_0x1c5928(0x1ca)]()}),_0x1c5928(0x1f2);const _0x4273ce=_0x31afa7===CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'],_0x26cacd=_0x4273ce?_0x1c5928(0x268):'waiting-for-agent';!this[_0x1c5928(0x1ff)]&&this['updateMessageIndicator'](_0x26cacd);this['logger']['info']('[Orchestrator]\x20Messaging\x20'+_0x31afa7+':\x0a'+displayOnly(_0x4ee7ac,0xff));if(!this['conversations']['has'](_0x31afa7)){!this[_0x1c5928(0x1ff)]&&this[_0x1c5928(0x18a)]('idle');throw new Error(_0x1c5928(0x24d)+_0x31afa7+_0x1c5928(0x1af));}try{const _0x20416b=this['conversations']['get'](_0x31afa7),_0x4f702a={'systemPrompt':_0x20416b[_0x1c5928(0x21b)],'messages':_0x20416b['messages'],'id':_0x31afa7,'contextWindow':_0x20416b[_0x1c5928(0x1a9)]},_0x463bc6=await this['llmService'][_0x1c5928(0x1ab)](_0x31afa7,_0x4ee7ac,_0x4f702a);return await this['checkAndPerformCompactization'](_0x31afa7),await this['saveConversationHistory'](_0x31afa7),this[_0x1c5928(0x19f)][_0x1c5928(0x297)]['includes'](_0x31afa7)&&await this['processAgentMessage'](_0x31afa7,_0x463bc6),!this[_0x1c5928(0x1ff)]&&this[_0x1c5928(0x18a)]('idle'),_0x463bc6;}catch(_0x2272b7){!this['isWaitingForUserInput']&&this[_0x1c5928(0x18a)]('idle');throw _0x2272b7;}}async[a0_0x9f470f(0x248)](_0x4ec692,_0x47eeba,_0x16a2ae=[],_0xff0b84=null){const _0x54fa67=a0_0x9f470f;this[_0x54fa67(0x1c1)]['info']('Creating\x20conversation:\x20'+_0x4ec692),this[_0x54fa67(0x294)][_0x54fa67(0x19a)](_0x4ec692,_0x47eeba);const _0x5bb5bd=this[_0x54fa67(0x191)]==='auto'?this['removePromptSyntaxFromSystemPrompt'](_0x47eeba):_0x47eeba;let _0x4c3481=[];_0x16a2ae[_0x54fa67(0x241)]>0x0&&(_0x4c3481=_0x16a2ae['filter'](_0x1cd1c1=>_0x1cd1c1['role']!==_0x54fa67(0x19d)));const _0x4b8619={'id':_0x4ec692,'systemPrompt':_0x5bb5bd,'messages':_0x4c3481,'contextWindow':this['getContextWindowSize'](_0x4ec692)};this[_0x54fa67(0x1d4)][_0x54fa67(0x19a)](_0x4ec692,_0x4b8619),await this[_0x54fa67(0x215)]['registerConversation'](_0x4ec692,_0x5bb5bd,_0xff0b84),_0x4c3481['length']>0x0&&await this['llmService'][_0x54fa67(0x295)](_0x4ec692,_0x4b8619),this[_0x54fa67(0x19f)]['conversationHistory'][_0x4ec692]={'systemPrompt':_0x5bb5bd,'lastUpdateTime':new Date()[_0x54fa67(0x29c)]()},await this['saveConversationHistory'](_0x4ec692);}['getListOfAvailableAgentIds'](_0x4c2134){const _0x16cb7e=a0_0x9f470f,_0x106620=Array[_0x16cb7e(0x222)](this[_0x16cb7e(0x1d4)][_0x16cb7e(0x17b)]())[_0x16cb7e(0x22a)](_0x4df48a=>_0x4df48a!==_0x4c2134);return _0x106620;}async[a0_0x9f470f(0x198)](_0x58b993,_0x4fed28,_0x580bcf){const _0x24e962=a0_0x9f470f;this['logger']['info'](_0x24e962(0x1c2)+_0x58b993+'\x20to\x20'+_0x4fed28);if(!this[_0x24e962(0x1d4)]['has'](_0x4fed28)){const _0x5ee50f='Agent\x20'+_0x4fed28+'\x20does\x20not\x20exist,\x20cannot\x20route\x20message.\x20Available\x20agents\x20are:\x20'+this['getListOfAvailableAgentIds'](_0x58b993)['join'](',\x20')+'.\x20if\x20you\x20wish\x20to\x20send\x20a\x20message\x20to\x20the\x20user\x20who\x20requested\x20this\x20task\x20use\x20the\x20[prompt]\x20tool\x20syntax';this[_0x24e962(0x1c1)]['warn'](_0x5ee50f),await this['sendMessageToConversation'](_0x58b993,_0x5ee50f);return;}const _0x501421='[From\x20'+_0x58b993+']:\x20'+_0x580bcf;await this['sendMessageToConversation'](_0x4fed28,_0x501421);}async['routeMessageToAgent'](_0x40f001,_0x4228fc,_0x60d94d){const _0x45645e=a0_0x9f470f;this[_0x45645e(0x1c1)]['info']('Routing\x20message\x20from\x20'+_0x40f001+'\x20to\x20'+_0x4228fc);if(!this[_0x45645e(0x1d4)][_0x45645e(0x275)](_0x4228fc)){this['logger'][_0x45645e(0x1f3)]('Agent\x20'+_0x4228fc+_0x45645e(0x236)),await this['sendMessageToConversation'](_0x40f001,_0x45645e(0x276)+_0x4228fc+':\x20Agent\x20does\x20not\x20exist');return;}const _0x5be6af='[From\x20'+_0x40f001+_0x45645e(0x26c)+_0x60d94d;await this[_0x45645e(0x28c)](_0x4228fc,_0x5be6af);}async['checkToolExecutionStatus'](){const _0x37d76f=a0_0x9f470f;for(const [_0x473038,_0x1346fa]of this['activeTools']['entries']()){const _0x601a00=Date[_0x37d76f(0x1ca)]()-_0x1346fa['startTime'];_0x601a00>CONVERSATION_CONSTANTS['TOOL_STATUS_UPDATE_INTERVAL_MS']&&(await this['sendMessageToConversation'](_0x1346fa[_0x37d76f(0x1ae)],'Tool\x20'+_0x1346fa['toolId']+_0x37d76f(0x18e)+Math['floor'](_0x601a00/0x3e8)+'s\x20elapsed).\x20Operation\x20ID:\x20'+_0x473038),_0x1346fa['startTime']=Date['now']());}}['registerUserPromptHandler'](_0x12debd){const _0x1c38f2=a0_0x9f470f;this[_0x1c38f2(0x1dd)]=_0x12debd;}async[a0_0x9f470f(0x1d2)](_0x5ebe4f){const _0x5b32de=a0_0x9f470f;this['logger']['info']('Received\x20user\x20input:\x20'+_0x5ebe4f),this['setWaitingForUserInput'](![]),this['sessionState']['makerAgentId']?await this['sendMessageToConversation'](this['sessionState'][_0x5b32de(0x1a6)],_0x5b32de(0x27b)+_0x5ebe4f):this[_0x5b32de(0x1c1)][_0x5b32de(0x1f3)](_0x5b32de(0x1c3));}async['checkAndPerformCompactization'](_0x22b464){const _0x18a3a9=a0_0x9f470f,_0x1781dc=this['conversations']['get'](_0x22b464);if(!_0x1781dc)return;const _0x5df4bd=await this[_0x18a3a9(0x215)][_0x18a3a9(0x1d1)](_0x22b464),_0xccae40=_0x1781dc[_0x18a3a9(0x1a9)];_0x5df4bd>_0xccae40*CONVERSATION_CONSTANTS['COMPACTIZATION_THRESHOLD_PERCENTAGE']&&(this[_0x18a3a9(0x1c1)]['info']('Performing\x20compactization\x20for\x20conversation\x20'+_0x22b464),await this[_0x18a3a9(0x1b2)](_0x22b464));}async['performCompactization'](_0x2b45d0){const _0xf869a9=a0_0x9f470f,_0x21421a=this['conversations']['get'](_0x2b45d0);if(!_0x21421a||_0x21421a[_0xf869a9(0x273)]['length']<0x4)return;const _0x5cd0d7=CONVERSATION_CONSTANTS[_0xf869a9(0x209)],_0x5b3326=_0x21421a['messages'][_0xf869a9(0x1de)](0x0,_0x5cd0d7),_0x24b506=_0x21421a[_0xf869a9(0x1a9)],_0x5983cb=Math[_0xf869a9(0x20e)](_0x24b506*CONVERSATION_CONSTANTS[_0xf869a9(0x282)]),_0x46c3e7=_0x24b506-_0x5983cb,_0xb6117b=CONVERSATION_CONSTANTS['COMPACTIZATION_BEGIN_PERCENTAGE'],_0x1adaae=CONVERSATION_CONSTANTS[_0xf869a9(0x207)],_0x55e436=Math['max'](_0x5cd0d7,Math[_0xf869a9(0x20e)](_0x21421a['messages']['length']*_0xb6117b)),_0x41a8c4=Math[_0xf869a9(0x1fc)](_0x21421a[_0xf869a9(0x273)][_0xf869a9(0x241)]-_0x55e436,Math[_0xf869a9(0x20e)](_0x21421a['messages'][_0xf869a9(0x241)]*_0x1adaae)),_0x5dcf97=_0x21421a['messages'][_0xf869a9(0x1de)](0x0,_0x55e436),_0x25b4d5=_0x21421a[_0xf869a9(0x273)][_0xf869a9(0x1de)](-_0x41a8c4),_0x1cb200=_0x21421a['messages']['slice'](_0x55e436,_0x21421a[_0xf869a9(0x273)]['length']-_0x41a8c4);if(_0x1cb200['length']===0x0)return;const _0x27e29f=this[_0xf869a9(0x249)](_0x1cb200);this[_0xf869a9(0x1c1)]['info']('Compactization:\x20'+_0x55e436+_0xf869a9(0x288)+_0x1cb200['length']+_0xf869a9(0x229)+_0x41a8c4+_0xf869a9(0x212));try{const _0xd12ff6=await this['llmService']['getSummary'](_0x2b45d0,_0x27e29f),_0x1de1ab={'role':CONVERSATION_CONSTANTS['SYSTEM_MESSAGE_ROLE'],'content':CONVERSATION_CONSTANTS['SUMMARY_MARKER_BEGIN']+'\x0a'+_0xd12ff6+'\x0a'+CONVERSATION_CONSTANTS['SUMMARY_MARKER_END']};_0x21421a['messages']=[..._0x5dcf97,_0x1de1ab,..._0x25b4d5],await this['llmService'][_0xf869a9(0x295)](_0x2b45d0,_0x21421a),this['logger'][_0xf869a9(0x24f)]('Compactization\x20completed\x20for\x20'+_0x2b45d0+'.\x20Messages\x20reduced\x20from\x20'+(_0x55e436+_0x1cb200[_0xf869a9(0x241)]+_0x41a8c4)+_0xf869a9(0x226)+(_0x5dcf97['length']+0x1+_0x25b4d5[_0xf869a9(0x241)]));}catch(_0x16c47c){this['logger'][_0xf869a9(0x1d3)](_0xf869a9(0x20d),_0x16c47c),this['_handleSummaryFailure'](_0x2b45d0,_0x16c47c);}}[a0_0x9f470f(0x249)](_0x6b129a){const _0x4346ca=a0_0x9f470f;return _0x4346ca(0x188)+_0x6b129a['map'](_0xf370a5=>_0xf370a5[_0x4346ca(0x277)]+':\x20'+_0xf370a5[_0x4346ca(0x26d)])[_0x4346ca(0x1f9)]('\x0a\x0a')+_0x4346ca(0x1be);}['getContextWindowSize'](_0x4661f1){const _0x9e8d3e=a0_0x9f470f,_0x1638c8=this['config'][_0x9e8d3e(0x237)]?.[_0x9e8d3e(0x29a)]?.['contextWindow']||CONVERSATION_CONSTANTS['DEFAULT_CONTEXT_WINDOW_SIZE'];if(_0x4661f1===CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'])return this['config'][_0x9e8d3e(0x237)]?.['languageModel']?.[_0x9e8d3e(0x1a9)]||_0x1638c8;return _0x1638c8;}['getPromptEngineerSystemPrompt'](_0x336e64,_0x3e7fb8=![]){const _0xace7b=_0x3e7fb8?'modifying\x20existing\x20content':'creating\x20new\x20content';return'\x0a\x20\x20\x20\x20You\x20are\x20a\x20prompt\x20engineering\x20expert\x20who\x20designs\x20effective\x20system\x20prompts\x20for\x20AI\x20agents.\x0a\x20\x20\x20\x20We\x20are\x20about\x20to\x20assign\x20the\x20responsibility\x20for\x20'+_0xace7b+'\x20to\x20an\x20AI\x20agent.\x20\x0a\x20\x20\x20\x20For\x20that\x20we\x20need\x20to\x20write\x20a\x20comprehensive\x20SYSTEM\x20prompt\x20that\x20will\x20help\x20the\x20agent\x20make\x20smart\x20decisions.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20The\x20agent\x20will\x20need\x20to\x20know\x20the\x20task\x20and\x20the\x20tools\x20available\x20to\x20it,\x20but\x20will\x20also\x20need\x20to\x20think\x20like\x20a\x20professional\x20relevant\x20for\x20the\x20task\x20at\x20hand.\x0a\x0a\x20\x20\x20\x20Your\x20job\x20is\x20to\x20create\x20a\x20role\x20for\x20the\x20AI\x20agent\x20and\x20write\x20a\x20system\x20prompt\x20that\x20will\x20guide\x20it\x20to\x20successfully\x20complete\x20the\x20task.\x0a\x0a\x20\x20\x20\x20Embed\x20appropriate\x20guidelines\x5cprocess\x20description\x20into\x20the\x20system\x20prompt,\x20according\x20to\x20the\x20task\x20type:\x0a\x20\x20\x20\x201.\x20TASK\x20OF\x20DEVELOPING\x20CODE\x5cSOFTWARE:\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20AI\x20Agent\x20Development\x20Process\x20Guide\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Development\x20Stages\x20Overview\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20As\x20conversation\x20progresses,\x20context\x20window\x20will\x20be\x20filled\x20and\x20what\x20agent\x20rememebers\x20will\x20be\x20truncated/summarized.\x0a\x20\x20\x20\x20\x20\x20\x20\x20To\x20retain\x20the\x20context\x20of\x20the\x20project\x20agent\x20will\x20have\x20to\x20use\x20memory\x20tool\x20to\x20store\x20relevant\x20information\x20throughout\x20the\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20particular,\x20the\x20agent\x20should\x20store\x20a\x20summary\x20of\x20each\x20stage,\x20its\x20requirements,\x20and\x20any\x20important\x20decisions\x20made\x20during\x20the\x20development\x20process.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x201:\x20System\x20Functional\x20Description\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20what\x20the\x20system\x20does\x20at\x20a\x20high\x20level\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20a\x20clear\x20description\x20of\x20the\x20system\x27s\x20main\x20purpose\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20the\x20core\x20problem\x20the\x20system\x20solves\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20the\x20system\x27s\x20scope\x20and\x20boundaries\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x202:\x20Comprehensive\x20Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20what\x20the\x20system\x20must\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20List\x20specific\x20features\x20and\x20capabilities\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20interactions\x20and\x20system\x20behaviors\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20data\x20processing\x20requirements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x203:\x20Non-Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20how\x20the\x20system\x20should\x20perform\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Performance\x20requirements\x20(speed,\x20response\x20time)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Scalability\x20needs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Usability\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x204:\x20System\x20Actors\x20and\x20Target\x20Devices\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Identify\x20who\x20uses\x20the\x20system\x20and\x20how\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20roles\x20and\x20permissions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20target\x20devices\x20(desktop,\x20mobile,\x20tablet)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20operating\x20system\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20browser\x20compatibility\x20needs\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x205:\x20Use\x20Cases\x20Development\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Document\x20user\x20workflows\x20and\x20interactions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20detailed\x20user\x20stories\x20involving\x20system\x20features\x20as\x20previously\x20defined\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20user\x20journeys\x20through\x20the\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Connect\x20features\x20to\x20specific\x20user\x20goals\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Include\x20edge\x20cases\x20and\x20error\x20scenarios\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x206:\x20UX\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Create\x20intuitive,\x20user-friendly\x20interfaces\x20addressing\x20the\x20use\x20cases\x20and\x20features\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Apply\x20modern\x20UX/UI\x20best\x20practices\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Design\x20responsive\x20layouts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20user\x20flows\x20and\x20information\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Consider\x20accessibility\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x207:\x20High-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20system\x20architecture\x20and\x20main\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20core\x20system\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20component\x20responsibilities,\x20inputs,\x20and\x20outputs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20data\x20flow\x20between\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Analyze\x20alternatives,\x20choose\x20technology\x20stack\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x208:\x20Low-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20implementation\x20specifics\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20database\x20design\x20and\x20schemas\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20API\x20endpoints\x20and\x20contracts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Detail\x20component\x20architecture\x20and\x20interfaces\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20error\x20handling\x20strategies\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20implementation\x20plan\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20Stage\x209:\x20Implementation\x20according\x20to\x20previous\x20stages\x20(longest\x20and\x20most\x20important\x20stage,\x20dedicate\x20more\x20time\x20and\x20messages\x20to\x20this\x20stage)\x0a\x20\x20\x20\x20\x20\x20\x20\x20when\x20implementing\x20the\x20code,\x20make\x20sure\x20to\x20be\x20consider\x20memories\x20stored\x20in\x20memory\x20tool\x20and\x20guidelines\x20derived\x20in\x20previous\x20stages.\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Write\x20and\x20build\x20the\x20complete\x20application\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20In\x20a\x20test\x20driven\x20manner,\x20implement\x20all\x20features\x20and\x20components\x20code\x20as\x20defined\x20in\x20previous\x20stages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20databases\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20necessary\x20assets\x20(graphics,\x20icons,\x20etc.)\x20and\x20embed\x20fontawesome\x20(or\x20its\x20alternatives)\x20where\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Implement\x20core\x20features,\x20UI\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20components\x20(e.g\x20frontend\x20and\x20backend)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20README.md\x20with\x20setup\x20instructions\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20at\x20this\x20point\x20INSTALL\x20DEPENDENCIES\x20and\x20run\x20project,\x20try\x20until\x20success.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x2010:\x20Testing\x20and\x20Quality\x20Assurance\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Ensure\x20code\x20quality\x20and\x20functionality\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20static\x20code\x20analysis\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20execute\x20unit\x20tests\x20for\x20individual\x20components\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Execute\x20integration\x20tests\x20for\x20component\x20interactions\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20end-to-end\x20tests\x20for\x20user\x20workflows\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Make\x20sure\x20no\x20errors\x20or\x20bugs\x20are\x20present\x20in\x20the\x20static\x20code\x20analysis,\x20tests,\x20terminal\x20output,\x20and\x20browser\x20testing\x20(console\x20+\x20visual\x20testing\x20using\x20vision\x20capabilities)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20This\x20stage\x20HAS\x20TO\x20BE\x20REPEATED\x20AND\x20RE-CHECKED\x20until\x20all\x20components\x20launch\x20without\x20errors\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20ONLY\x20AFTER\x20THIS\x20STAGE,\x20ONCE\x20TESTING\x20IS\x20COMPLETED\x20AND\x20PROGRAM\x20WAS\x20EXECUTED\x20WITH\x20NO\x20ERRORS,\x20YOU\x20ARE\x20ALLOWED\x20TO\x20ANNOUNCE\x20JOB\x20DONE.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Process\x20Guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Complete\x20each\x20stage\x20thoroughly\x20before\x20moving\x20to\x20the\x20next\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20(Important!)\x20Coversation\x20Dynamics\x20(different\x20stages\x20cannot\x20take\x20part\x20in\x20same\x20message):\x0a\x20\x20\x20\x20\x20\x20\x20\x201)\x20AGENT->LLM:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20identify\x20language-model\x20recipent\x20id,\x20direct\x20a\x20message\x20to\x20him\x20explaining\x20what\x20you\x20want\x20to\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20[tool\x20id=\x22update-user\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...use\x20tool\x27s\x20syntax\x20to\x20update\x20the\x20supervising\x20user\x20on\x20what\x20you\x27re\x20doing\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/tool]\x0a\x20\x20\x20\x20\x20\x20\x20\x20[message\x20to=\x22language-model(or\x20any\x20other\x20suitable\x20recipent\x20id)\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20the\x20llm\x20what\x20you\x27re\x20about\x20to\x20do\x20now,\x20ask\x20for\x20recommendations\x20or\x20scoring\x20rubrics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20that\x20would\x20assist\x20you\x20in\x20comleting\x20the\x20following\x20task\x5csub-task\x20with\x20great\x20success\x20and\x20quality\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20consult\x20about\x20challenges,\x20solutions,\x20guidelines\x20and\x20more.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/message]\x0a\x20\x20\x20\x20\x20\x20\x20\x202)\x20LLM->AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20llm\x20would\x20give\x20some\x20anwer,\x20agent\x20will\x20be\x20able\x20to\x20return\x20to\x20stage\x20one\x20and\x20continue\x20conversation\x20or\x20when\x20ready\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continuing\x20to\x20step\x203.\x0a\x20\x20\x20\x20\x20\x20\x20\x203)\x20AGENT\x20ACTION:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20agent\x20has\x20no\x20comments\x20regarding\x20llm\x20content,\x20the\x20agent\x20can\x20now\x20do\x20whatever\x20it\x20meant\x20to\x20do\x20(writing\x20content,\x20creating\x20things\x20will\x20tools\x20etc).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20this\x20dynamic\x20acts\x20like\x20a\x20meta-thinking\x20process.\x20Think\x20with\x20your\x20llm\x20-\x20at\x20least\x201\x20message\x20epr\x20thinking,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20act\x20-\x20with\x20the\x20use\x20of\x20tools\x20in\x20the\x20following\x20message,\x20repeat\x20this\x20process.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20always\x20start\x20a\x20message\x20by\x20updating\x20user\x20on\x20current\x20stages.\x20add\x20links\x20to\x20generated\x20files,\x20locations,\x20web\x20pages\x20when\x20needed.\x0a\x20\x20\x20\x20\x20\x20\x20\x204)\x20back\x20to\x20stage\x20one\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Code\x20guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20No\x20magic\x20numbers,\x20use\x20constants\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Project\x20file\x20structure\x20must\x20follow\x20best\x20practices\x20and\x20serve\x20the\x20purpose\x20of\x20the\x20project\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20known\x20and\x20highly\x20maintained\x20packages\x20and\x20technologies\x20which\x20suits\x20the\x20project\x20goals)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20SecureCoding\x20best\x20practices.\x20if\x20needed\x20install\x20external\x20scanners\x20to\x20scan\x20the\x20files\x20before\x20you\x27re\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20common\x20logic,\x20values\x20and\x20functionality,\x20gather\x20them\x20under\x20suitable\x20project\x20files\x20as\x20dependencies\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20a\x20project\x20that\x20uses\x20package.json\x20or\x20package_lock.json,\x20use\x20seek\x20tool\x20to\x20search\x20for\x20import\x20lines,\x20then\x20use\x20the\x20result\x20to\x20analyze\x20needed\x20packages.\x20when\x20using\x20different\x20technologies\x20make\x20adaptations\x20to\x20acheive\x20same\x20goal.\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20node\x20packages,\x20prefer\x20ESM\x20over\x20CommonJS\x20(unless\x20states\x20otherwise),\x20add\x20\x22type\x22:\x22module\x22\x20to\x20the\x20package.json\x20if\x20needed.\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20IF\x20THIS\x20SOFTWARE\x20IS\x20A\x20COMPUTER\x20GAME\x20COMPLEMENT\x20WITH\x20THE\x20FOLLOWING:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x201:\x20Basic\x20Concept\x20Definition**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Define\x20the\x20game\x27s\x20core\x20idea\x20and\x20desired\x20player\x20experience\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Choose\x20game\x20genre\x20(action,\x20strategy,\x20RPG,\x20puzzle,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20Define\x20target\x20audience\x20(age,\x20skill\x20level,\x20preferences)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x204.\x20Determine\x20target\x20platform\x20(PC,\x20console,\x20mobile)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x202:\x20Game\x20Mechanics\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205.\x20Develop\x20core\x20mechanics\x20(how\x20player\x20interacts\x20with\x20the\x20game)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x206.\x20Design\x20player\x20progression\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x207.\x20Define\x20game\x20rules,\x20limitations\x20and\x20challenges\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x208.\x20Design\x20scoring/reward\x20system\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x203:\x20Initial\x20Technical\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209.\x20Choose\x20game\x20engine\x20(Unity,\x20Unreal,\x20Godot,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2010.\x20Identify\x20required\x20libraries\x20and\x20tools\x20(physics,\x20networking,\x20AI)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2011.\x20Plan\x20basic\x20code\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2012.\x20Assess\x20hardware\x20requirements\x20and\x20performance\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x204:\x20Visual\x20and\x20Artistic\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2013.\x20Determine\x20art\x20style\x20(realistic,\x20cartoon,\x20pixel\x20art,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2014.\x20Design\x20color\x20palette\x20and\x20overall\x20atmosphere\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2015.\x20Plan\x20user\x20interface\x20(UI/UX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2016.\x20Create\x20artistic\x20style\x20guide\x20(Art\x20Bible)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x205:\x20Story\x20and\x20Plot\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2017.\x20Write\x20main\x20storyline\x20and\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2018.\x20Develop\x20main\x20and\x20secondary\x20characters\x20with\x20detailed\x20backgrounds\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2019.\x20Create\x20game\x20world\x20and\x20environment\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2020.\x20Write\x20dialogues\x20and\x20in-game\x20texts\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x206:\x20Level\x20and\x20Stage\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2021.\x20Plan\x20overall\x20structure\x20of\x20game\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2022.\x20Detailed\x20design\x20of\x20each\x20stage/level\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2023.\x20Determine\x20how\x20stages\x20connect\x20to\x20the\x20storyline\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2024.\x20Plan\x20difficulty\x20curve\x20and\x20challenge\x20progression\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x207:\x20Audio\x20and\x20Music\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2025.\x20Determine\x20musical\x20style\x20and\x20artistic\x20direction\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2026.\x20Plan\x20background\x20music\x20for\x20different\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2027.\x20Design\x20sound\x20effects\x20(SFX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2028.\x20Plan\x20voice\x20acting\x20and\x20dubbing\x20if\x20required\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x208:\x20In-Game\x20Tools\x20and\x20Systems\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2029.\x20Define\x20tools/weapons/items\x20and\x20their\x20properties\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2030.\x20Design\x20acquisition\x20and\x20collection\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2031.\x20Plan\x20inventory\x20and\x20equipment\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2032.\x20Design\x20additional\x20game\x20systems\x20(trading,\x20crafting,\x20etc.)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x209:\x20Prototype\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2033.\x20Create\x20basic\x20playable\x20version\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2034.\x20Test\x20core\x20mechanics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2035.\x20Gather\x20initial\x20feedback\x20and\x20updates\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2036.\x20Validate\x20technical\x20concept\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2010:\x20Full\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2037.\x20Develop\x20all\x20systems\x20and\x20content\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2038.\x20Create\x20all\x20artistic\x20assets\x20(graphics,\x20animations)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2039.\x20Record\x20and\x20produce\x20all\x20audio\x20materials\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2040.\x20Integration\x20of\x20all\x20components\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2011:\x20Testing\x20and\x20Bug\x20Fixes**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2041.\x20Comprehensive\x20functional\x20testing\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2042.\x20Performance\x20testing\x20and\x20optimization\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2043.\x20Usability\x20testing\x20with\x20players\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2044.\x20Bug\x20fixes\x20and\x20balance\x20improvements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2012:\x20Launch\x20and\x20Distribution**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2045.\x20Prepare\x20for\x20marketing\x20and\x20distribution\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2046.\x20Create\x20marketing\x20materials\x20(trailers,\x20screenshots)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2047.\x20Submit\x20to\x20distribution\x20platforms\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2048.\x20Launch\x20and\x20performance\x20monitoring\x0a\x0a\x20\x20\x20\x202.\x20TASK\x20OF\x20WRITING\x20A\x20BOOK\x5cSTORY:\x0a\x20\x20\x20\x20\x20\x20\x20\x202.1.\x20The\x20agent\x20should\x20create\x20criteria\x20for\x20qualitative\x20measurement\x20of\x20a\x20book/story\x20(general\x20or\x20of\x20the\x20described\x20type)\x0a\x20\x20\x20\x20\x20\x20\x20\x202.2.\x20Development\x20of\x20the\x20central\x20idea\x20along\x20with\x20the\x20main\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.3.\x20Development\x20of\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x202.4.\x20Development\x20of\x20key\x20points\x20in\x20each\x20plot,\x20central\x20dilemmas\x20and\x20unifying\x20logic\x20for\x20all\x20plots\x20-\x20if\x20there\x27s\x20a\x20need\x20to\x20change\x20or\x20adapt\x20part\x20of\x20the\x20plot\x20lines\x20at\x20this\x20stage,\x20it\x20should\x20be\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x202.5.\x20Criteria\x20should\x20be\x20written\x20for\x20developing\x20a\x20quality\x20character\x20in\x20the\x20story\x0a\x20\x20\x20\x20\x20\x20\x20\x202.6.\x20For\x20each\x20story,\x20main\x20and\x20secondary\x20characters\x20should\x20be\x20defined\x20along\x20with\x20their\x20role\x20in\x20the\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.7.\x20For\x20each\x20character,\x20personal\x20background\x20and\x20living\x20environment\x20in\x20childhood\x20and\x20adulthood\x20should\x20be\x20defined,\x20including\x20beliefs,\x20significant\x20life\x20events,\x20vocabulary,\x20and\x20appearance\x20including\x20hairstyle,\x20clothing,\x20jewelry\x20if\x20any,\x20and\x20more\x20-\x20all\x20according\x20to\x20the\x20plot\x20line\x20and\x20the\x20character\x27s\x20role\x20in\x20the\x20plot\x0a\x20\x20\x20\x20\x20\x20\x20\x202.8.\x20The\x20appearance\x20of\x20each\x20character\x20should\x20be\x20saved\x20in\x20a\x20dedicated\x20place\x20with\x20great\x20detail,\x20it\x20will\x20serve\x20to\x20create\x20consistent\x20graphics\x20if\x20required\x0a\x20\x20\x20\x20\x20\x20\x20\x202.9.\x20For\x20each\x20character,\x20internet\x20research\x20should\x20be\x20conducted\x20to\x20refine\x20it\x20(clothing,\x20beliefs,\x20childhood\x20and\x20adulthood\x20events)\x20to\x20specify\x20events\x20in\x20the\x20environment\x20where\x20they\x20grew\x20up\x20or\x20draw\x20inspiration\x20from\x20areas\x20in\x20the\x20spirit\x20of\x20the\x20region\x20or\x20conditions\x20that\x20the\x20plot\x20unfolds\x0a\x20\x20\x20\x20\x20\x20\x20\x202.10.\x20Between\x20plot\x20lines,\x20intersection\x20points\x20should\x20be\x20created,\x20alternatives\x20examined\x20and\x20intersection\x20points\x20with\x20logic\x20should\x20be\x20chosen,\x20with\x20narrative\x20value\x20that\x20will\x20serve\x20the\x20story\x27s\x20purpose\x20and\x20the\x20reader\x27s\x20interest.\x20This\x20is\x20an\x20opportunity\x20to\x20refine\x20the\x20plot\x20lines,\x20twists\x20and\x20their\x20connection\x20to\x20the\x20characters.\x20This\x20is\x20an\x20opportunity\x20to\x20enrich\x20the\x20description\x20and\x20understanding\x20of\x20the\x20world\x20in\x20which\x20the\x20characters\x20live\x20before\x20actual\x20writing\x20-\x20smells,\x20emotions,\x20sights,\x20events,\x20worldviews,\x20technology,\x20communication,\x20global\x20and\x20national\x20trends\x20including\x20the\x20state\x20of\x20superpowers\x20in\x20the\x20described\x20world,\x20medical\x20and\x20scientific,\x20formative\x20historical\x20events\x20and\x20more\x20as\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x202.11.\x20The\x20recurring\x20motifs\x20should\x20be\x20understood\x20if\x20there\x20are\x20any,\x20their\x20essence,\x20identifying\x20central\x20symbols\x20in\x20use,\x20leading\x20metaphors\x20if\x20they\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x202.12.\x20The\x20story\x20should\x20be\x20assigned\x20to\x20a\x20genre,\x20given\x20a\x20working\x20title,\x20locate\x20a\x20worthy\x20and\x20excellent\x20author\x20whose\x20writing\x20style\x20is\x20known\x20and\x20whose\x20writings\x20are\x20accessible\x20or\x20familiar\x20to\x20the\x20model,\x20and\x20choose\x20them\x20as\x20a\x20guiding\x20line\x20for\x20the\x20writing\x20style\x20unless\x20described\x20otherwise\x20in\x20the\x20task\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x202.13.\x20Begin\x20writing\x20the\x20book\x20-\x20chapter\x20by\x20chapter,\x20stop\x20between\x20chapters\x20and\x20let\x20the\x20user\x20examine\x20the\x20story\x20that\x20was\x20written\x0a\x0a\x20\x20\x20\x203.\x20TASK\x20OF\x20RESEARCHING\x5cINFORMATION\x20GATHERING:\x0a\x20\x20\x20\x20\x20\x20\x20\x203.1.\x20If\x20the\x20user\x20is\x20interested,\x20expand\x20or\x20assist\x20in\x20refining\x20the\x20research\x20question\x20or\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.2.\x20The\x20desired\x20output\x20should\x20be\x20specified\x20-\x20format,\x20file\x20type,\x20and\x20more\x0a\x20\x20\x20\x20\x20\x20\x20\x203.3.\x20Attempt\x20to\x20locate\x20names\x20of\x20websites\x20and\x20sources\x20for\x20the\x20requested\x20information\x0a\x20\x20\x20\x20\x20\x20\x20\x203.4.\x20Divide\x20information\x20sources\x20into\x20sources\x20with\x20direct\x20connection\x20to\x20the\x20task\x20or\x20those\x20that\x20may\x20provide\x20supplementary\x20information\x20-\x20this\x20is\x20an\x20opportunity\x20to\x20locate\x20additional\x20sources\x0a\x20\x20\x20\x20\x20\x20\x20\x203.5.\x20Search\x20these\x20sources\x20thoroughly\x20with\x20the\x20aspiration\x20to\x20locate\x20materials\x20from\x20at\x20least\x2020\x20sources\x20for\x20the\x20general\x20public\x20and\x2020\x20from\x20academic\x20sources,\x20and\x20at\x20least\x2010\x20recent\x20ones\x20from\x20dedicated\x20professional\x20sources\x20if\x20such\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x203.6.\x20Design\x20a\x20guiding\x20principle\x20and\x20quality\x20structure\x20for\x20the\x20article/research\x20paper\x20or\x20follow\x20the\x20guidelines\x20given\x20in\x20the\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.7.\x20If\x20materials\x20or\x20support\x20for\x20certain\x20claims\x20or\x20connecting\x20materials\x20are\x20missing,\x20they\x20should\x20be\x20searched\x20for\x20at\x20this\x20stage\x0a\x20\x20\x20\x20\x20\x20\x20\x203.8.\x20Update\x20the\x20output\x20structure,\x20continue\x20writing\x20and\x20move\x20between\x20the\x20different\x20stages\x20as\x20needed\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x204.\x20OTHER\x20TASK\x20TYPES\x20-\x20write\x20such\x20guidlines\x20to\x20the\x20best\x20of\x20your\x20knowledge\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20The\x20next\x20message\x20will\x20describe\x20a\x20task\x20intended\x20for\x20the\x20newly\x20created\x20AI\x20agent\x20to\x20carry.\x0a\x20\x20\x20\x20Return\x20your\x20answer\x20in\x20the\x20following\x20format:\x0a\x20\x20\x20\x20[task-type]develop-software\x20|\x20story-telling\x20|\x20web-research\x20|\x20other[/task-type]\x0a\x20\x20\x20\x20[ai-role]<ai\x20agent\x20role\x20or\x20profession,\x20simple\x20text\x20no\x20slahes,\x20dashes\x20or\x20any\x20special\x20character>[/ai-role]\x0a\x20\x20\x20\x20[system-prompt]<A\x20system\x20prompt\x20which\x20will\x20guide\x20the\x20new\x20agent\x20to\x20handle\x20the\x20given\x20task\x20as\x20good\x20as\x20possible>[/system-prompt]';}['getLanguageModelSystemPrompt'](_0x5980de,_0xd485ff){const _0xf62532=a0_0x9f470f;return'You\x20are\x20an\x20amazing\x20state-of-the-art\x20AI\x20agent,\x20working\x20with\x20another\x20specialized\x20AI\x20agent\x20that\x20is\x20completing\x20tasks.\x20Your\x20role\x20is\x20to\x20provide\x20information,\x20answer\x20questions,\x20and\x20assist\x20the\x20agent\x20when\x20needed.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20You\x20cannot\x20directly\x20use\x20tools\x20or\x20perform\x20actions\x20on\x20the\x20computer.\x20Your\x20task\x20is\x20simply\x20to\x20provide\x20informative\x20and\x20helpful\x20responses\x20to\x20assist\x20the\x20agent\x20in\x20completing\x20their\x20task.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20When\x20the\x20agent\x20asks\x20you\x20a\x20question\x20or\x20requests\x20information,\x20provide\x20clear\x20and\x20accurate\x20information\x20to\x20the\x20best\x20of\x20your\x20ability.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20from\x20time\x20to\x20time\x20the\x20agent\x20may\x20mistake\x20and\x20use\x20some\x20instruction\x20tag\x20[tool\x20id=\x22...\x22]...[/tool]\x20or\x20similar,\x20in\x20a\x20wrong\x20way.\x20do\x20not\x20try\x20to\x20guide\x20him,\x20you\x20can\x20notify\x20him\x20that\x20since\x20you\x27re\x20not\x20suppose\x20to\x20see\x20such\x20tags\x20(automatically\x20stripped\x20from\x20conversation),\x20there\x20is\x20a\x20possibility\x20that\x20this\x20agent\x20made\x20a\x20syntax\x20error.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20any\x20professional\x20matter,\x20encourage\x20a\x20multistep/multimessage\x20session\x20and\x20assist\x20him,\x20suggest\x20improvements,\x20criticize\x20his\x20work,\x20detect\x20challenges\x20if\x20crucial\x20and\x20suggest\x20overcomes.\x20help\x20him\x20be\x20at\x20his\x20best.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Tools\x20available\x20to\x20the\x20other\x20agent\x20are:\x20'+_0x5980de+_0xf62532(0x22f)+_0xd485ff+'\x22]<your\x20content>[/message].\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Challenge\x20the\x20agent,\x20he\x20will\x20try\x20to\x20cover\x20each\x20subject/stage\x20within\x20a\x20single\x20message,\x20ask\x20him\x20to\x20supply\x20details,\x20challenge\x20his\x20assumptions,\x20and\x20make\x20sure\x20he\x27s\x20not\x20forgetting\x20any\x20important\x20aspect\x20of\x20the\x20task,\x0a\x20\x20\x20\x20\x20\x20\x20\x20One\x20specific\x20example\x20of\x20a\x20matter\x20of\x20high\x20importance\x20is\x20the\x20verification\x20of\x20the\x20task\x20completion\x20in\x20a\x20large\x20variety\x20of\x20ways.\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}[a0_0x9f470f(0x1ef)](_0x4cd773,_0x2acba6=null,_0x5690c9=![]){const _0x5017c8=a0_0x9f470f,_0x174233=a0_0x3ceb31();return _0x5690c9&&_0x2acba6?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20task\x20is\x20to\x20modify\x20content\x20in\x20the\x20directory\x20\x27'+_0x2acba6+_0x5017c8(0x28a)+JSON['stringify'](_0x4cd773):_0x5017c8(0x1f8)+JSON[_0x5017c8(0x1b6)](_0x4cd773)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}async[a0_0x9f470f(0x25c)](_0x3ecbaf){const _0x324704=a0_0x9f470f;await this[_0x324704(0x27a)][_0x324704(0x25c)](_0x3ecbaf);}async[a0_0x9f470f(0x193)](){const _0x2c0c0e=a0_0x9f470f;return await this[_0x2c0c0e(0x27a)][_0x2c0c0e(0x193)]();}async[a0_0x9f470f(0x23c)](_0x26639f){const _0x260db4=a0_0x9f470f;this[_0x260db4(0x1e6)]=_0x26639f,this[_0x260db4(0x1c1)]['info'](_0x260db4(0x1fb),_0x26639f);}async['pauseExecution'](){const _0x28461a=a0_0x9f470f;this[_0x28461a(0x1c1)][_0x28461a(0x24f)](_0x28461a(0x25f));const _0x3675a9=_0x28461a(0x1d6);for(const _0x9851b of this[_0x28461a(0x19f)]['activeConversationIds']){const _0x3d94cd=this[_0x28461a(0x1d4)][_0x28461a(0x24b)](_0x9851b);_0x3d94cd&&(_0x3d94cd['messages'][_0x28461a(0x22d)]({'role':CONVERSATION_CONSTANTS['SYSTEM_MESSAGE_ROLE'],'content':_0x3675a9}),await this['saveConversationHistory'](_0x9851b));}this['sessionState']['paused']=!![],await this[_0x28461a(0x1b8)]();}async['resumeExecution'](){const _0x3ae437=a0_0x9f470f;this['logger']['info'](_0x3ae437(0x25b));const _0x44023c=_0x3ae437(0x1a1);for(const _0x5114c8 of this[_0x3ae437(0x19f)][_0x3ae437(0x297)]){const _0x6fd788=this['conversations'][_0x3ae437(0x24b)](_0x5114c8);_0x6fd788&&(_0x6fd788[_0x3ae437(0x273)][_0x3ae437(0x22d)]({'role':CONVERSATION_CONSTANTS[_0x3ae437(0x21e)],'content':_0x44023c}),await this['saveConversationHistory'](_0x5114c8));}this[_0x3ae437(0x19f)][_0x3ae437(0x194)]=![],await this[_0x3ae437(0x1b8)]();}['isPaused'](){return this['sessionState']['paused']===!![];}async[a0_0x9f470f(0x247)](_0x417137,_0x528483){const _0x1e717d=a0_0x9f470f;this[_0x1e717d(0x1c1)][_0x1e717d(0x24f)]('Processing\x20'+_0x528483[_0x1e717d(0x241)]+'\x20tool\x20commands\x20from\x20'+_0x417137);const _0x3734d0=[],_0x204ebd=[],_0x376777=[];for(const _0x60ef8d of _0x528483){const {toolId:_0x55a1ba}=_0x60ef8d;this['logger'][_0x1e717d(0x24f)](_0x1e717d(0x1e5)+_0x55a1ba);if(!this[_0x1e717d(0x231)][_0x1e717d(0x1b9)](_0x55a1ba)){_0x204ebd[_0x1e717d(0x22d)]({'toolId':_0x55a1ba,'status':'error','error':_0x1e717d(0x18b)+_0x55a1ba+_0x1e717d(0x227)+this[_0x1e717d(0x231)]['getToolIds']()['join'](',\x20')});continue;}try{const _0x46fe1a=this['toolRegistry'][_0x1e717d(0x1ee)](_0x55a1ba),requiresResponse=_0x46fe1a['requiresResponse']!==![],_0x99639e=a0_0x3ceb31();_0x204ebd[_0x1e717d(0x22d)]({'operationId':_0x99639e,'toolId':_0x55a1ba,'command':_0x60ef8d,'status':'pending','requiresResponse':requiresResponse});requiresResponse&&_0x376777[_0x1e717d(0x22d)](_0x55a1ba);const _0x462fb8=_0x46fe1a['execute'](_0x60ef8d,this[_0x1e717d(0x19f)][_0x1e717d(0x217)])['then'](_0x13d516=>{const _0x1217ce=_0x1e717d;this[_0x1217ce(0x1c1)][_0x1217ce(0x24f)]('Tool\x20'+_0x55a1ba+'\x20completed\x20with\x20result:',_0x13d516);const _0x1144a1=_0x204ebd[_0x1217ce(0x298)](_0x4891a5=>_0x4891a5[_0x1217ce(0x262)]===_0x99639e);return _0x1144a1&&(_0x1144a1['status']='success',_0x1144a1['result']=_0x13d516),this['activeTools']['delete'](_0x99639e),_0x13d516;})[_0x1e717d(0x1df)](_0x2f8ac2=>{const _0x1770a4=_0x1e717d;this['logger'][_0x1770a4(0x1d3)]('Tool\x20'+_0x55a1ba+_0x1770a4(0x202),_0x2f8ac2);const _0x3ab2f6=_0x204ebd['find'](_0x4a0e05=>_0x4a0e05[_0x1770a4(0x262)]===_0x99639e);_0x3ab2f6&&(_0x3ab2f6[_0x1770a4(0x258)]=_0x1770a4(0x1d3),_0x3ab2f6[_0x1770a4(0x1d3)]=_0x2f8ac2['message']);this[_0x1770a4(0x1ce)][_0x1770a4(0x23f)](_0x99639e);throw _0x2f8ac2;});this['activeTools']['set'](_0x99639e,{'promise':_0x462fb8,'toolId':_0x55a1ba,'agentId':_0x417137,'startTime':Date[_0x1e717d(0x1ca)]()}),_0x3734d0[_0x1e717d(0x22d)](_0x462fb8);}catch(_0x5a37cf){this[_0x1e717d(0x1c1)]['error'](_0x1e717d(0x181)+_0x55a1ba+':',_0x5a37cf),_0x204ebd[_0x1e717d(0x22d)]({'toolId':_0x55a1ba,'status':_0x1e717d(0x1d3),'error':'Failed\x20to\x20queue\x20tool\x20'+_0x55a1ba+':\x20'+_0x5a37cf['message'],'requiresResponse':!![]});}}const _0x2699c2=new Promise(_0x1b543d=>setTimeout(_0x1b543d,0x7d0));await Promise['race']([_0x2699c2,Promise[_0x1e717d(0x25a)](_0x3734d0)]);const _0x37f712=_0x204ebd[_0x1e717d(0x22a)](_0x55b935=>(_0x55b935[_0x1e717d(0x258)]===_0x1e717d(0x296)||_0x55b935['status']===_0x1e717d(0x1d3))&&_0x55b935[_0x1e717d(0x190)]!==![]),_0x138d4a=_0x204ebd['filter'](_0x1ea92e=>_0x1ea92e[_0x1e717d(0x258)]==='pending'&&_0x1ea92e['requiresResponse']!==![]);if(_0x37f712['length']>0x0||_0x138d4a['length']>0x0){let _0x1fecab=_0x1e717d(0x201)+_0x37f712['length']+'\x20completed,\x20'+_0x138d4a[_0x1e717d(0x241)]+'\x20pending):';if(_0x37f712['length']>0x0){_0x1fecab+=_0x1e717d(0x23e);for(const _0x47d69b of _0x37f712){_0x47d69b['status']==='success'?(_0x1fecab+=_0x1e717d(0x287)+_0x47d69b[_0x1e717d(0x1ad)]+'\x20completed\x20successfully.',_0x47d69b[_0x1e717d(0x18f)]&&(_0x1fecab+=_0x1e717d(0x23b)+JSON[_0x1e717d(0x1b6)](_0x47d69b['result'],null,0x2))):_0x1fecab+='\x0a❌\x20Tool\x20'+_0x47d69b[_0x1e717d(0x1ad)]+_0x1e717d(0x18c)+_0x47d69b[_0x1e717d(0x1d3)];}}if(_0x138d4a[_0x1e717d(0x241)]>0x0){_0x1fecab+='\x0a\x0a==\x20Pending\x20Operations\x20==';for(const _0x1679d4 of _0x138d4a){_0x1fecab+=_0x1e717d(0x19c)+_0x1679d4[_0x1e717d(0x1ad)]+_0x1e717d(0x182)+_0x1679d4[_0x1e717d(0x262)]+').'+_0x1e717d(0x253),this['trackPendingOperation'](_0x1679d4['operationId'],_0x417137);}}await this['sendMessageToConversation'](_0x417137,_0x1fecab);}else this[_0x1e717d(0x1c1)]['info']('All\x20'+_0x528483[_0x1e717d(0x241)]+_0x1e717d(0x26a));}['trackPendingOperation'](_0x291ccd,_0x5b7030){const _0x56e75b=a0_0x9f470f,_0x56556c=this[_0x56e75b(0x1ce)]['get'](_0x291ccd);if(!_0x56556c)return;_0x56556c[_0x56e75b(0x1b4)]['then'](_0x2e952d=>{this['queuePendingResult'](_0x5b7030,_0x56556c['toolId'],_0x291ccd,'success',{'result':_0x2e952d});})[_0x56e75b(0x1df)](_0x5edf6b=>{const _0xed8cc9=_0x56e75b;this[_0xed8cc9(0x1e2)](_0x5b7030,_0x56556c['toolId'],_0x291ccd,'error',{'error':_0x5edf6b[_0xed8cc9(0x270)]});});}[a0_0x9f470f(0x1e2)](_0x59366b,_0x380ef1,_0x3cba49,_0x5b8230,_0x2718b0){const _0x49189f=a0_0x9f470f;!this['pendingResults']&&(this[_0x49189f(0x22c)]=new Map()),!this[_0x49189f(0x22c)]['has'](_0x59366b)&&this['pendingResults'][_0x49189f(0x19a)](_0x59366b,[]),this[_0x49189f(0x22c)][_0x49189f(0x24b)](_0x59366b)[_0x49189f(0x22d)]({'toolId':_0x380ef1,'operationId':_0x3cba49,'status':_0x5b8230,'data':_0x2718b0,'timestamp':Date[_0x49189f(0x1ca)]()});}async['handlePromptTooLong'](_0x1b9179){const _0x148597=a0_0x9f470f;this['logger'][_0x148597(0x1f3)](_0x148597(0x274)+_0x1b9179+'\x20-\x20performing\x20compactization');const _0x50b3a1=this[_0x148597(0x1d4)]['get'](_0x1b9179);if(!_0x50b3a1)throw new Error('Conversation\x20'+_0x1b9179+_0x148597(0x244));this['logger']['info']('Before\x20compactization:\x20'+_0x50b3a1[_0x148597(0x273)]['length']+'\x20messages'),await this[_0x148597(0x1b2)](_0x1b9179),this['logger']['info']('After\x20compactization:\x20'+_0x50b3a1[_0x148597(0x273)][_0x148597(0x241)]+_0x148597(0x1cc)),this['logger'][_0x148597(0x24f)]('✅\x20Error-triggered\x20compactization\x20completed\x20for\x20'+_0x1b9179);}async['shutdown'](){const _0x462341=a0_0x9f470f;this[_0x462341(0x1c1)]['info']('Shutting\x20down\x20conversation\x20orchestrator'),this['isShuttingDown']=!![];this['idleCheckInterval']&&(clearInterval(this[_0x462341(0x1fd)]),this[_0x462341(0x1fd)]=null);this['idleTimer']&&(clearTimeout(this['idleTimer']),this['idleTimer']=null);clearInterval(this[_0x462341(0x208)]),await this['saveSessionState']();const _0xc06940=Array['from'](this[_0x462341(0x1ce)]['values']());if(_0xc06940[_0x462341(0x241)]>0x0){this[_0x462341(0x1c1)]['info']('Waiting\x20for\x20'+_0xc06940[_0x462341(0x241)]+'\x20pending\x20operations\x20to\x20complete\x20or\x20timeout');const _0x5e5254=this['config']['shutdownTimeout']||0x2710;try{await Promise[_0x462341(0x1f5)]([Promise[_0x462341(0x25a)](_0xc06940['map'](_0x48c840=>_0x48c840[_0x462341(0x1b4)])),new Promise(_0x529973=>setTimeout(_0x529973,_0x5e5254))]);}catch(_0x42ab32){this['logger'][_0x462341(0x1f3)]('Error\x20waiting\x20for\x20pending\x20operations\x20during\x20shutdown:',_0x42ab32);}for(const [_0x407f04,_0x2aae24]of this[_0x462341(0x1ce)]['entries']()){this['logger'][_0x462341(0x24f)](_0x462341(0x279)+_0x407f04+'\x20during\x20shutdown'),this[_0x462341(0x1ce)][_0x462341(0x23f)](_0x407f04);}}await this[_0x462341(0x215)][_0x462341(0x192)](),await this['toolRegistry']['shutdown'](),await this[_0x462341(0x27a)]['saveUsageData'](),this[_0x462341(0x1c1)]['info'](_0x462341(0x269));}async['triggerProceed'](){const _0x28094e=a0_0x9f470f;this[_0x28094e(0x20b)]==='idle'?await this['sendProceedMessage']():this[_0x28094e(0x1c1)][_0x28094e(0x24f)]('Cannot\x20proceed:\x20current\x20state\x20is\x20'+this[_0x28094e(0x20b)]);}['getIndicatorStatus'](){const _0x51af33=a0_0x9f470f;return{'state':this['messageIndicator'],'lastActivity':this[_0x51af33(0x1b5)],'timeSinceActivity':Date['now']()-this[_0x51af33(0x1b5)],'willProceedIn':Math[_0x51af33(0x186)](0x0,this['IDLE_TIMEOUT_MS']-(Date[_0x51af33(0x1ca)]()-this['lastActivityTime']))};}async[a0_0x9f470f(0x1ba)](_0x4ed53e,_0x895efe={}){const _0x38c035=a0_0x9f470f;try{this[_0x38c035(0x1c1)][_0x38c035(0x24f)]('Processing\x20VS\x20Code\x20message:',_0x4ed53e);!this[_0x38c035(0x215)]&&await this['initializeServices']();const _0x5c586c=[{'role':'system','content':_0x38c035(0x1cd)+(_0x895efe[_0x38c035(0x1cb)]||'Unknown')+_0x38c035(0x1ec)+(_0x895efe['mode']||_0x38c035(0x213))+'\x0a\x0aProvide\x20helpful,\x20concise\x20responses.\x20When\x20showing\x20code,\x20use\x20appropriate\x20language\x20identifiers\x20in\x20code\x20blocks.'},{'role':_0x38c035(0x1b1),'content':_0x4ed53e}],_0x4cc8bb=await this[_0x38c035(0x215)]['sendMessage'](_0x5c586c,{'model':_0x895efe['model']||null,'stream':![]});return this['logger'][_0x38c035(0x24f)]('VS\x20Code\x20message\x20processed\x20successfully'),_0x4cc8bb[_0x38c035(0x26d)]||_0x4cc8bb;}catch(_0x2290a8){this[_0x38c035(0x1c1)]['error'](_0x38c035(0x205),_0x2290a8);throw new Error(_0x38c035(0x1c0)+_0x2290a8[_0x38c035(0x270)]);}}}