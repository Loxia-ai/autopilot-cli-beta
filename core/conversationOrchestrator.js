const a0_0xd5ff40=a0_0x4582;(function(_0xa2f774,_0x49077c){const _0x37f9e7=a0_0x4582,_0x593029=_0xa2f774();while(!![]){try{const _0xc5a454=parseInt(_0x37f9e7(0x1a1))/0x1+-parseInt(_0x37f9e7(0x1ae))/0x2*(-parseInt(_0x37f9e7(0x1b2))/0x3)+parseInt(_0x37f9e7(0x1dd))/0x4+-parseInt(_0x37f9e7(0x156))/0x5+-parseInt(_0x37f9e7(0x151))/0x6*(parseInt(_0x37f9e7(0x123))/0x7)+parseInt(_0x37f9e7(0x168))/0x8*(-parseInt(_0x37f9e7(0x18c))/0x9)+-parseInt(_0x37f9e7(0xfb))/0xa*(parseInt(_0x37f9e7(0xd1))/0xb);if(_0xc5a454===_0x49077c)break;else _0x593029['push'](_0x593029['shift']());}catch(_0x5e035d){_0x593029['push'](_0x593029['shift']());}}}(a0_0x51bd,0xb8c06));import{TagParser}from'../utilities/tagParser.js';function a0_0x4582(_0xb3f97f,_0x1481d5){const _0x51bd6d=a0_0x51bd();return a0_0x4582=function(_0x45820d,_0x287347){_0x45820d=_0x45820d-0xa6;let _0x31a781=_0x51bd6d[_0x45820d];if(a0_0x4582['oknsSW']===undefined){var _0x6d70e5=function(_0x37b9cf){const _0x4549d6='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x36be49='',_0x281f16='';for(let _0x4b3cca=0x0,_0x191bef,_0x1751c8,_0x53188d=0x0;_0x1751c8=_0x37b9cf['charAt'](_0x53188d++);~_0x1751c8&&(_0x191bef=_0x4b3cca%0x4?_0x191bef*0x40+_0x1751c8:_0x1751c8,_0x4b3cca++%0x4)?_0x36be49+=String['fromCharCode'](0xff&_0x191bef>>(-0x2*_0x4b3cca&0x6)):0x0){_0x1751c8=_0x4549d6['indexOf'](_0x1751c8);}for(let _0x45c5cf=0x0,_0x9cc19f=_0x36be49['length'];_0x45c5cf<_0x9cc19f;_0x45c5cf++){_0x281f16+='%'+('00'+_0x36be49['charCodeAt'](_0x45c5cf)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x281f16);};a0_0x4582['TDaZSC']=_0x6d70e5,_0xb3f97f=arguments,a0_0x4582['oknsSW']=!![];}const _0x2f73f2=_0x51bd6d[0x0],_0x21d511=_0x45820d+_0x2f73f2,_0x425273=_0xb3f97f[_0x21d511];return!_0x425273?(_0x31a781=a0_0x4582['TDaZSC'](_0x31a781),_0xb3f97f[_0x21d511]=_0x31a781):_0x31a781=_0x425273,_0x31a781;},a0_0x4582(_0xb3f97f,_0x1481d5);}import{TagParserService}from'../services/tagParserService.js';import a0_0x37b9cf from'path';import{promises as a0_0x4549d6}from'fs';import{v4 as a0_0x36be49}from'uuid';function a0_0x51bd(){const _0x27a8c7=['BMfTzq','cIaGica','4PYxiezHAwXLzcb0BYbJCMvHDguGy29UDMvYC2f0Aw9Uihn1Bw1HCNK','DxrMltG','C2v0qNvKz2v0tgLTAxq','seLtve9swv9tvuzgsvG','BM93','nta2mtyWmgvqA1zkCW','icHTB2rLoIa','ihn5C3rLBsbTzxnZywDLoIKGChjVy2vLzc4GswyGC3r1y2SGzM9YihrVBYbSB25NihvZzsb0B29SCYbVCIbWzxjMB3jTig9WzxjHDgLVBNmGDg8GzwzMzwn0AxzLBhKGy29UDgLUDwuGDgHLihrHC2SU','ig1LC3nHz2vZ','igjLz2LUicSG','CM91DgvnzxnZywDLvg9bz2vUDa','DxbKyxrLq29UDMvYC2f0Aw9U','w3rVB2XZlwnVBw1HBMrZxsb0ywDZihrVihvZzsb0B29SCYWGB3iGDgHLigzVBgXVD2LUzYbZEw50yxGGDg8GAw50zxjHy3qGD2L0Acb0AguGC3vWzxj2AxnPBMCGAhvTyw4GDxnLCJOGw3bYB21WDcbUyw1LpsjZB21LihbYB21WDcbKAxnWBgf5ihrPDgXLiL08ChjVBxb0ig1LC3nHz2u+w29WDgLVBL08B3b0Aw9UideGDgv4Dd5Bl29WDgLVBL0Gw29WDgLVBL08B3b0Aw9UidiGDgv4Dd5Bl29WDgLVBL0UlI5Bl3bYB21WDf0k','lIbPzIb5B3uGD2LZAcb0BYbZzw5KigeGBwvZC2fNzsb0BYb0AguGDxnLCIb3Ag8GCMvXDwvZDgvKihrOAxmGDgfZAYb1C2uGDgHLifTWCM9TChrDihrVB2WGC3LUDgf4','ihDPDgGGAw5ZDhj1y3rPB25ZoIa','u3rHCNrPBMCGBMv3ignVBNzLCNnHDgLVBIbMB3iGDgfZAZOG','AgfUzgXLvxnLCLbYB21WDa','lMXVEgLHlxn0yxrL','CYbLBgfWC2vKks4Gt3bLCMf0Aw9UieLeoIa','icaYlIbpCIbZDgfYDcbHig5LDYbZzxnZAw9UigfZA2LUzYb0AguGywDLBNqGDg8Gy29UDgLUDwu6','y29UDgv4DfDPBMrVDW','C3vJy2vZCW','C2vZC2LVBK92zxjYAwrLCW','y3jLyxrLu3vTBwfYEvbYB21WDa','zgvSzxrL','AxntAhv0DgLUz0rVD24','y29TCgXLDgvkB2i','cGOVkIbot1rfoIbqCM9TChqGC3LUDgf4ihjLBw92zwqGzM9Yigf1Dg8GBw9Kzs4G','ywXSu2v0DgXLza','AM9Irg9Uzq','Dg9ju09tDhjPBMC','rMfPBgvKihrVihnHDMuGC2vZC2LVBIbZDgf0ztOG','C3bSAxq','8j+AQcbvtLjfq09wrvjbqKXfievsuK9s','C3rHDhvZ','CMvZDw1LrxHLy3v0Aw9U','sM9IignVBxbSzxrPB24Gy29UzMLYBwvKigj5igfNzw50lIbqCM9JzwvKAw5NihDPDgGGAM9IignVBxbSzxrPB24U','AM9Irg9UzunVBMzPCM1HDgLVBLn0yxrL','vg8GCMuTzw5HyMXLlcbZD2L0y2GGDg8GAw50zxjHy3rPDMuGBw9KzsbVCIbTB2rPzNKGzw5Oyw5Jzvn5C3rLBvbYB21WDcGPicOV','CMvTB3zLuhjVBxb0u3LUDgf4rNjVBvn5C3rLBvbYB21WDa','z2v0tgfUz3vHz2vnB2rLBfn5C3rLBvbYB21WDa','8j+tPcbtzw5KAw5Nigf1Dg8TChjVy2vLzcbTzxnZywDLlI4U','CMfJzq','w09Yy2HLC3rYyxrVCL0GtwvZC2fNAw5Nia','AxnvC2vYrNjPzw5KBhK','Aw5PDgLHBgL6zq','u2vZC2LVBIbVDMvYCMLKzxmGC2v0','C2vUzfbYB2nLzwrnzxnZywDL','DgHLBG','CMvWBgfJzq','ugXLyxnLigLTCgXLBwvUDcb0AguGB25vC2vYuhjVBxb0igHHBMrSzxiGAw4GDgHLienmss4','cKnVBNrPBNvLihDPDgGGB3rOzxiGDgfZA3mGyw5KieKNBgWGBM90Awz5ihLVDsb3AgvUigL0j3mGzg9Uzs4','C2vUze1LC3nHz2vuB0nVBNzLCNnHDgLVBG','rMfPBgvKihrVihnHDMuGC2vZC2LVBIbZDgf0ztO','mtfkuNnczNa','B3b0Aw9UCW','Aw50zxjHy3rPDMu','z2v0qNvKz2v0vxnHz2u','AgfUzgXLsM9Irg9UzujHC2vKt25nB2rL','cUkCHsbuB29Sia','y2f0y2G','B25vC2vYuhjVBxb0','sw50zxjHy3rPB24GBw9KzsbJAgfUz2vKoIa','Aw5MBW','tg9HzgvKignVBNzLCNnHDgLVBIbOAxn0B3j5igzVCJOG','lIbnzxnZywDLCYbYzwr1y2vKigzYB20G','tM8GBwfRzxiGywDLBNqGzM91BMqGDg8GC2vUzcb1C2vYigLUChv0ihrV','w0zYB20G','w1n5C3rLBsbbDxrVlvjLC3bVBNnLxtOG','u1rbvevFreLsx05btuu','zMLSDgvY','uxvLDwLUzYb0B29SoIa','cGPuB29SCYbHDMfPBgfIBguGyxjLoGO','zMLUza','zxjYB3juExbL','Dg9VBeLK','Bw9Kzq','Bw9KAwz5rxHPC3rPBMDdB250zw50','C3rYAw5NAwz5','sM9IigrVBMuGCMvJzwL2zwq6ia','C2f2zunVBNzLCNnHDgLVBKHPC3rVCNK','z3jHEq','q2fUBM90ihnLBMqGy29UzMLYBwf0Aw9UihbYB21WDcaTig5Vig1HA2vYigfNzw50ieLeigzVDw5K','yNjVD3nLCG','vxnLCIbZzwXLy3rLzdOG','y29UDMvYC2f0Aw9UCW','vxbKyxrLzcbZExn0zw0GChjVBxb0igzVCIa','igLZihn0AwXSihj1BM5PBMCGka','ChjVBxb0','C29Tzq','C2vTAs1HDxrV','CgvYzM9YBunVBxbHy3rPEMf0Aw9U','y2HLy2TuB29SrxHLy3v0Aw9Uu3rHDhvZ','DNnJB2rL','z2v0vg9VBa','u0vtu0LptL9tvefurv9gsuXftKfnrq','nZGXmdeWCg55weXl','yxr0zw1WDenVDw50','DxbKyxrLq29UDMvYC2f0Aw9Uu3LZDgvTuhjVBxb0','Bg9HzenVBNzLCNnHDgLVBKHPC3rVCNK','C2v0teXnu2vYDMLJzq','ywn0AxzLvg9VBhm','teXnihnLCNzPy2uGBM90igf2ywLSywjSzsbMB3iGAw1Hz2uGzgvZy3jPChrPB24','ihrVB2WGy29TBwfUzhmGzNjVBsa','ihrVia','icaZlIbpCIbTB2rPzNKGzxHPC3rPBMCGy29UDgvUDdO','twfWCgvKignVBNzLCNnHDgLVBIbjrcbMB3iGzMLSzsbVCgvYyxrPB25ZoIaI','CMvZzxrkB2jeB25Lq29UzMLYBwf0Aw9Uu3rHDgu','uhjVy2vZC2LUzYbwuYbdB2rLig1LC3nHz2u6','Aw5PDgLHBgL6zvnLCNzPy2vZ','ms4WlJa','C2HVDwXKqMXVy2TnzxnZywDL','BgXTu2vYDMLJzq','zgvIDwC','BwvZC2fNzq','D2fPDgLUzY1MB3iTywDLBNq','Dg9VBfjLz2LZDhj5','BwfRzxjbz2vUDeLK','q2fUy2vSBgLUzYbVCgvYyxrPB24G','uMvZDg9YzwqG','z2v0sw1Hz2vezxnJCMLWDgLVBG','CMvNAxn0zxjkB2jeB25LsgfUzgXLCG','DxnPBMCGDgHLifTTzxnZywDLxsb0ywCGD2L0Acb0AguGzM9SBg93Aw5NigLKCW','C2v0uhjVAMvJDerPCMvJDg9YEq','8j+AQcbqCM9TChqGDg9VigXVBMCGzgv0zwn0zwqGzM9Yicr7y29UDMvYC2f0Aw9Uswr9ic0GCgvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBG','qwXSia','x2DLDezPBgvtywzLq29UDMvYC2f0Aw9Uswq','BwvZC2fNzuLUzgLJyxrVCG','v2fPDgLUzYbMB3iG','y3LHBG','yM9Sza','ww91igfYzsbHBIbHBwf6Aw5Nihn0yxrLlw9MlxrOzs1HCNqGquKGywDLBNqSihDVCMTPBMCGD2L0AcbHBM90AgvYihnWzwnPywXPEMvKiefjigfNzw50ihrOyxqGAxmGy29TCgXLDgLUzYb0yxnRCY4Gww91CIbYB2XLigLZihrVihbYB3zPzguGAw5MB3jTyxrPB24SigfUC3DLCIbXDwvZDgLVBNmSigfUzcbHC3nPC3qGDgHLigfNzw50ihDOzw4GBMvLzgvKlGOGicaGcIaGicaGicaGww91ignHBM5VDcbKAxjLy3rSEsb1C2uGDg9VBhmGB3iGCgvYzM9YBsbHy3rPB25Zig9UihrOzsbJB21WDxrLCI4Gww91CIb0yxnRigLZihnPBxbSEsb0BYbWCM92AwrLigLUzM9YBwf0AxzLigfUzcbOzwXWzNvSihjLC3bVBNnLCYb0BYbHC3nPC3qGDgHLigfNzw50igLUignVBxbSzxrPBMCGDgHLAxiGDgfZAY4kicaGiaOGicaGicaGifDOzw4GDgHLigfNzw50igfZA3mGEw91igeGCxvLC3rPB24GB3iGCMvXDwvZDhmGAw5MB3jTyxrPB24SihbYB3zPzguGy2XLyxiGyw5KigfJy3vYyxrLigLUzM9YBwf0Aw9UihrVihrOzsbIzxn0ig9MihLVDxiGywjPBgL0Es4kicaGicaGicakicaGicaGicbMCM9TihrPBwuGDg8GDgLTzsb0AguGywDLBNqGBwf5ig1PC3rHA2uGyw5KihvZzsbZB21LigLUC3rYDwn0Aw9UihrHzYbBDg9VBcbPzd0IlI4UiL0UlI5Bl3rVB2XDig9YihnPBwLSyxiSigLUigeGD3jVBMCGD2f5lIbKBYbUB3qGDhj5ihrVigD1AwrLigHPBsWGEw91ignHBIbUB3rPzNKGAgLTihrOyxqGC2LUy2uGEw91j3jLig5VDcbZDxbWB3nLihrVihnLzsbZDwnOihrHz3mGkgf1Dg9TyxrPy2fSBhKGC3rYAxbWzwqGzNjVBsbJB252zxjZyxrPB24Plcb0AgvYzsbPCYbHihbVC3nPyMLSAxr5ihrOyxqGDgHPCYbHz2vUDcbTywrLigeGC3LUDgf4igvYCM9YlGOkicaGicaGicbjBIbHBNKGChjVzMvZC2LVBMfSig1HDhrLCIWGzw5JB3vYywDLigeGBxvSDgLZDgvWl211BhrPBwvZC2fNzsbZzxnZAw9UigfUzcbHC3nPC3qGAgLTlcbZDwDNzxn0igLTChjVDMvTzw50CYWGy3jPDgLJAxPLigHPCYb3B3jRlcbKzxrLy3qGy2HHBgXLBMDLCYbPzIbJCNvJAwfSigfUzcbZDwDNzxn0ig92zxjJB21LCY4GAgvSCcbOAw0GyMuGyxqGAgLZigjLC3qUcGOGicaGicaGifrVB2XZigf2ywLSywjSzsb0BYb0AguGB3rOzxiGywDLBNqGyxjLoIa','ChvZAa','CMvHzezPBgu','8j+uHcbbDxrVlxbYB2nLzwrPBMCGywz0zxiGmYbZzwnVBMrZig9MigLKBguGDgLTzq','ywDLBNrjza','odrMEurcz0K','lIbuAgLZig1HEsbUB3qGyMuGysb2ywXPzcbmB3HPysbWCM9Qzwn0lG','Dg9uAw1Lu3rYAw5N','cLrOyw5RihLVDsbMB3iGy2HVB3nPBMCGtg94AweU','cGO9psbdB21WBgv0zwqGt3bLCMf0Aw9UCYa9pq','CMvZDwX0','DgfNugfYC2vYu2vYDMLJzq','ic0GCgvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBG','A2v5CW','B25kB2jeB25L','CxvLDwvqzw5KAw5NuMvZDwX0','u2vZC2LVBIbZDgf0zsbZyxzLzcb0BZOG','Aw5PDgLHBgL6zvDPDgHqCM9Qzwn0','DxbKyxrLtwvZC2fNzuLUzgLJyxrVCG','q09nuefdveLAqvrjt05Ft1vuufvux1jfu0vsvKvFuevsq0vovefhrq','yMXVy2TLze1LC3nHz2vZ','C2vZC2LVBI1ZDgf0zs5QC29U','q3jPDgLJywWGzxjYB3i6ienHBM5VDcbJCMvHDguGy29UDMvYC2f0Aw9Uihn1Bw1HCNKGzM9Yia','igzHAwXLzdOG','y29UDMvYC2f0Aw9UlwLUzgv4lMPZB24','iGOkqMvMB3jLieKGy2fUig1HCMSGDgHPCYbQB2iGyxmGzMLUAxnOzwqSihbSzwfZzsb2zxjPzNKGEw91igHHDMuGy29TCgXLDgvKiefmtcbVzIb0AguGzM9SBg93Aw5NoGOk8j+uJsaQkLrfu1rjtKCGjIbwquXjrefusu9ooIOQcUkCHsbvC2vKihrLC3rPBMCGDg9VBhmGDg8GDMvYAwz5igz1BMn0Aw9UywXPDhKGkhrLCM1PBMfSlcbKzxaTCMvZB2X2zxiSigLTCg9YDc1HBMfSExPLCIKk4PYfifjHBIb0AguGyxbWBgLJyxrPB24Vy29Kzsb0BYbLBNn1CMuGAxqGD29YA3mGyxmGzxHWzwn0zwqk4PYfienOzwnRzwqGzM9YigfUzcbYzxnVBhzLzcbHBNKGzxjYB3jZlcb3yxjUAw5NCYWGB3iGAxnZDwvZcUkCHsbwzxjPzMLLzcbHBgWGzgvWzw5Kzw5JAwvZigfYzsbWCM9WzxjSEsbPBNn0ywXSzwqGyw5KignVBxbHDgLIBgukcVcFK4eGkIPgsuXfifzfuKLgsunbveLptJOQkGRINiuGuMv2Awv3zwqGywn0DwfSigzPBguGy29UDgvUDhmGB24GzgLZAYb0BYbJB25MAxjTigLTCgXLBwvUDgf0Aw9Uig1HDgnOzxmGC3bLy2LMAwnHDgLVBNmk4PYfievUC3vYzwqGywXSihjLCxvPCMvKigzPBgvZigHHDMuGyMvLBIbJCMvHDgvKigfUzcbHCMuGAw4Gy29YCMvJDcbSB2nHDgLVBNmk4PYfifzHBgLKyxrLzcb0Agf0ignVzguGC3rYDwn0DxjLigfUzcbVCMDHBML6yxrPB24GzM9SBg93CYbIzxn0ihbYywn0AwnLCWOk8j+oRYaQkKnptvbmrvrftKvtuYbdsevdsZOQkGRINiuGqwXSig9YAwDPBMfSihjLCxvPCMvTzw50CYbOyxzLigjLzw4GzNvSBhKGAw1WBgvTzw50zwqk4PYfievKz2uGy2fZzxmGyw5KigvYCM9YigHHBMrSAw5NigHHDMuGyMvLBIbJB25ZAwrLCMvKcUkCHsbeB2n1BwvUDgf0Aw9Ul2nVBw1LBNrZigfYzsbHzgvXDwf0zsb3AgvYzsbUzwvKzwqk4PYfie5Vifrpre8GAxrLBxmGB3iGAw5JB21WBgv0zsbZzwn0Aw9UCYbYzw1HAw4kcKLMihLVDsbOyxzLihzLCMLMAwvKiefmtcbVzIb0AguGywjVDMuGyw5KigfYzsbJB25MAwrLBNqGDgHLigPVyIbPCYb0CNvSEsbJB21WBgv0zsWGzgvJBgfYzsaQkLTQB2iTzg9Uzv0QkIbHz2fPBIb0BYbJB25MAxjTlGOkswyGEw91igrPC2nVDMvYigfUEsbPC3n1zxmGB3iGAw5JB21WBgv0zsb3B3jRigr1CMLUzYb0AgLZihzLCMLMAwnHDgLVBIWGCgXLyxnLignVBNrPBNvLihDVCMTPBMCGDg8GywrKCMvZCYb0AgvTigjLzM9YzsbKzwnSyxjPBMCGAM9IlwrVBMuGywDHAw4UcGOQkLjLBwvTyMvYoIOQiff1ywXPDhKGB3zLCIbZCgvLzc4Gqsb0Ag9YB3vNAcbMAw5HBcbJAgvJAYbLBNn1CMvZigeGChjVzMvZC2LVBMfSigrLBgL2zxjHyMXLlG','q291BgqGBM90ihjLywqVCgfYC2uG','rMfPBgvKihrVigXVywqGy29UDMvYC2f0Aw9UigHPC3rVCNKGzM9Yia','jYbUB3qGzM91BMqUief2ywLSywjSzsb0B29SCZOG','rMLYC3qGAM9IlwrVBMuGCMvJzwL2zwqUifjLCxvLC3rPBMCGDMvYAwzPy2f0Aw9UignVBMzPCM1HDgLVBI4UlG','q29UDMvYC2f0Aw9UihjLC3vTzwq','AwrSzunOzwnRsw50zxj2ywW','DMfSDwvZ','z2v0vg9VBhnezxnJCMLWDgLVBG','Cgf1C2vK','y3jLyxrLq29UDMvYC2f0Aw9U','ChjVy2vZC01LC3nHz2u','C3rHCNrozxDdB252zxjZyxrPB24','ww91CIbTzxnZywDLigrPzg4NDcbJB250ywLUigfUEsb0B29SignVBw1HBMrZlcbHig1LC3nHz2uGDg8Gyw5VDgHLCIbHz2vUDcWGB3iGysbWCM9TChqUia','C3LZDgvT','Dg9VBenVBw1HBMrZ','rxjYB3iGC2vHCMnOAw5NigzVCIbJB252zxjZyxrPB24GAgLZDg9YEtOG','DhjHy2Tqzw5KAw5Nt3bLCMf0Aw9U','Aw5JBhvKzxm','AxnxywL0Aw5NrM9YvxnLCKLUChv0','C2vUzePVyKrVBMvdB25MAxjTyxrPB25qCM9TChq','BwTKAxi','D2HPDgu','Aw50zxjHy3rPB25nB2rL','DxnLCG','BwfRzxiTywDLBNq','mZyYotG4z2rjAMDg','Bg9N','DxbKyxrLu3LZDgvTuhjVBxb0C0zVCK1Vzgu','u2H1DhrPBMCGzg93BIbJB252zxjZyxrPB24GB3jJAgvZDhjHDg9Y','C3LZDgvTuhjVBxb0','nta0otK5nuP4qvDNva','z2v0qMXVy2TPBMDtDgf0Dxm','ic0+ia','igrVzxmGBM90igv4Axn0','C2v0v2fPDgLUz0zVCLvZzxjjBNb1Da','yxv0BW','C2vUzfvZzxjjBNb1Da','yNvKz2v0u2vYDMLJzq','ChjVy2vZC1rVB2XdB21Tyw5KCW','u3rHDguGzgLYzwn0B3j5ig5VDcbMB3vUzdOG','tuflrvjFquDftLrFrevgqvvmvf9jra','yMX1zq','ywn0AxzLq29UDMvYC2f0Aw9UswrZ','BwfW','AM9PBG','AwrSzvrPBwvY','q29UDMvYC2f0Aw9UihjLC3vTzwqGC3vJy2vZC2z1BgX5lIbby3rPDMuGy29UDMvYC2f0Aw9UCZOG','ywKTCM9Szq','odu4mZy4ognAsLPnsq','C2v0','CMvNAxn0zxjdB252zxjZyxrPB24','su5ervHFrKLmru5btuu','icaGicbSB3HPysbYzxn1BwuGlI95B3vYlxbYB2PLy3qTzgLYzwn0B3j5','ig5VDcbMB3vUzcbMB3iGy29TCgfJDgL6yxrPB24','zgvMyxvSDa','z2v0','surmrv9usu1ft1vux01t','vw5YzwnVDMvYywjSzsbLCNjVCIbKDxjPBMCGy29UDMvYC2f0Aw9Uihn1Bw1HCNKUia','oIbbz2vUDcbKB2vZig5VDcbLEgLZDa','ihbLBMrPBMCGB3bLCMf0Aw9UCYb0BYbJB21WBgv0zsbVCIb0Aw1LB3v0','Dgv4Da','uhjVy2vZC2LUzYa','CMvJAxbPzw50','ChjVAMvJDerPCG','Bg9Nz2vY','zxjYB3i','BgfUz3vHz2vnB2rLBefNzw50swq','x3nHBML0AxPLq29UDMvYC2f0Aw9UswrgB3jgAwXL','q09nuefdveLAqvrjt05FveHsrvnit0Xex1bfuKnftLrbr0u','vg9VBcaN','BgfZDefJDgL2Axr5vgLTzq','uhjVy2vZC2LUzYbTzxnZywDLigzYB20G','y2HLy2TbBMrqzxjMB3jTq29TCgfJDgL6yxrPB24','CMvZDw1Lq29UDMvYC2f0Aw9U','cGPdB252zxjZyxrPB24GCNvSzxmGyxjLoGOGicaGms4Gv2HLBIbZzw5KAw5NigeGBwvZC2fNzsb0BYbHBM90AgvYihbHCNrPy2LWyw50lcb1C2uGw21LC3nHz2uGDg89iNbHCNrPy2LWyw50x2LKiL0GzM9YBwf0cIaGicaYlIbxAgvUihvZAw5NihrVB2XZlcb3CMfWignVBw1HBMrZigLUifT0B29SCY1JB21Tyw5KC10Gyw5KifSVDg9VBhmTy29TBwfUzhnDihrHz3mkicaGidmUievHy2GGDg9VBcbJB21Tyw5KihnOB3vSzcbIzsb3CMfWCgvKigLUifT0B29SigLKpsj0B29Sx2LKiL0Gyw5KifSVDg9VBf0GDgfNCWOGicaGnc4Gww91ig11C3qGzM9SBg93ihrOzsbZCgvJAwzPyYbMB3jTyxqGzM9YigvHy2GGDg9VBcbHCYbKzxnJCMLIzwqGAw4GDgHLihrVB2XZihnLy3rPB24kicaGiduUieLMihLVDsbUzwvKihvZzxiGAw5WDxqGB3iGysbKzwnPC2LVBIWGDxnLihrOzsbBChjVBxb0xsbMB3jTyxqOtK9usunfoIbHDcbSzwfZDcaYig9WDgLVBIb0ywDZigfYzsbYzwnVBw1LBMrLzcK6ifTWCM9TChqGBMfTzt0IChjVBxb0igrPC3bSyxKGDgL0BguIxxrOzsbTzxnZywDLihrOzsb1C2vYihDPBgWGC2vLw29WDgLVBL1VChrPB24Gmsb0zxH0wY9VChrPB25DifTVChrPB25DB3b0Aw9UidiGDgv4DfSVB3b0Aw9Uxs4UlM1VCMuGB3b0Aw9UCYbPzIbUzwvKzwqUlI5Bl3bYB21WDf0kicaGidyUihDOzw4GEw91igHHDMuGzMLUAxnOzwqGEw91CIb0yxnRigLUy2X1zgLUzYb2zxjPzMLJyxrPB24Gyw5KihzHBgLKyxrPB24GB2yGywn0DwfSignVBNrLBNqGyxmGD3jPDhrLBIbVBIbKAxnRigfZignVBxbHCMvKihrVigrLCML2zwqGC3bLy3mSig9YihLVDsDYzsbUB3qGz2v0DgLUzYbHBNKGChjVz3jLC3mGDxnLihrOzsbBAM9IlwrVBMvDphLVDxiGBwvZC2fNzt5Bl2PVyI1KB25LxsbZCgvJAwfSigLUC3rYDwn0Aw9UihrHzY4GChjLzMvYywjSEsbPBIbPDhmGB3DUig1LC3nHz2uGkg5Vig90AgvYigLUC3rYDwn0Aw9UCYKUcIaGica3lIbjtvbpuLrbtLq6ifrOzsbMAxjZDcb0Aw1LihLVDsbKzwnSyxjLifTQB2iTzg9Uzv0SihrOzsbZExn0zw0GD2LSBcbHC2SGEw91ihrVihzLCMLMEsb5B3vYihDVCMSGDxnPBMCGDgvZDgLUzYb0B29SCY4Gt25SEsbHzNrLCIb5B3uGy29UzMLYBsbJB21WBgv0Aw9UihDPDgGGysbZzwnVBMqGw2PVyI1KB25Lxsb3AwXSihrOzsb0yxnRigjLig1HCMTLzcbHCYbJB21WBgv0zs4kicaGidGUig5LDMvYigfUBM91BMnLigPVyI1KB25LigjLzM9Yzsb5B3uGAgf2zsbJB21WBgv0zwqGywXSihn0ywDLCYbVzIb0AguGzgv2zwXVCg1LBNqGChjVy2vZCYWGDgvZDgvKigfUzcbYzs12ywXPzgf0zwqGEw91CIbZB2X1DgLVBIbIEsbVyNnLCNzPBMCGDgHLignYzwf0zwqGzMLSzxmGyw5KigfYDgLMywn0CY4kicaGifLVDxiGuhjVAMvJDcbsB290ierPCMvJDg9YEsbjCZOG','BwvZC2fNzxm','igrVzxmGBM90igv4Axn0lcbJyw5UB3qGCM91DguGBwvZC2fNzs4GqxzHAwXHyMXLigfNzw50CYbHCMu6ia','BwLU','tefor1vbr0vFtu9eruXFsuq','Dg9mB3DLCKnHC2u','BgvUz3rO','CgvUzgLUz1jLC3vSDhm','iL08Ew91CIbJB250zw50pLSVBwvZC2fNzv0UcGOGicaGicaGienOywXSzw5Nzsb0AguGywDLBNqSigHLihDPBgWGDhj5ihrVignVDMvYigvHy2GGC3vIAMvJDc9ZDgfNzsb3AxrOAw4GysbZAw5NBguGBwvZC2fNzsWGyxnRigHPBsb0BYbZDxbWBhKGzgv0ywLSCYWGy2HHBgXLBMDLigHPCYbHC3n1Bxb0Aw9UCYWGyw5Kig1HA2uGC3vYzsbOzsDZig5VDcbMB3jNzxr0Aw5NigfUEsbPBxbVCNrHBNqGyxnWzwn0ig9MihrOzsb0yxnRlaOGicaGicaGie9UzsbZCgvJAwzPyYbLEgfTCgXLig9MigeGBwf0DgvYig9MigHPz2GGAw1WB3j0yw5JzsbPCYb0AguGDMvYAwzPy2f0Aw9Uig9MihrOzsb0yxnRignVBxbSzxrPB24GAw4GysbSyxjNzsb2yxjPzxr5ig9MihDHExmUcIaGicaGicaG','qwDLBNqG','ou9vDML0va','B3bLCMf0Aw9Uswq','vg9VBca','Dhj5tg9HzenVBNzLCNnHDgLVBKHPC3rVCNLcEvbHDhrLCM4','C2XPy2u','CMvNAxn0zxjqCM9TChruB29mB25NsgfUzgXLCG','iIaTpIaI','vw5RBM93BG','ve9ptf9dquXmx0zsrvfvru5dwv9dsevds19nuW','z2v0uhjVBxb0rw5NAw5LzxjtExn0zw1qCM9TChq','tM8GChjVAMvJDcbKAxjLy3rVCNKGC2v0lcbJyw5UB3qGC2f2zsbZzxnZAw9Uihn0yxrL','D2fYBG','EwvSBg93','Cgf1C2vfEgvJDxrPB24','q29UDMvYC2f0Aw9UihjLC3vTzwqGD2L0Ag91DcbJB21WBgv0zsbOAxn0B3j5','zNjVBuvUDhjPzxm','B3jPz2LUywXtExn0zw1qCM9TChrZ','y29UDMvYC2f0Aw9UsgLZDg9YEq','y29UzMLN','CM9Szq','ks4GuhjVy2vLzgLUzYb3AxrOigPVyIbJB21WBgv0Aw9UlI4U','mtmYmtKWmKzxsgnJvG','C2f2zvvZywDLrgf0yq','rMfPBgvKihrVihjLC3vTzsbJB252zxjZyxrPB246','y29UDMvYC2f0Aw9UswrnyxbWAw5N','vg9VBcbLEgvJDxrPB24GCMvWB3j0icG','Dg9mB2nHBgvmB3DLCKnHC2u','CMvHzgrPCG','4PQG77IpicaQkKPpqIbdt01qtevusu9oifzfuKLgsunbveLptIbsrvfvsvjfrcOQiokAOo+4JWOkww91igrLy2XHCMvKihrOzsbQB2iGy29TCgXLDguGD2L0AdOGiG','xtOG','rMfPBgvKihrVihf1zxvLihrVB2WG','Bw9KzwW','qwz0zxiGy29TCgfJDgL6yxrPB246ia','z2v0q29UDgv4DfDPBMrVD1nPEMu','ndiYq0n5DujT','C2vUze1LC3nHz2u','C2vZC2LVBLn0yxrL','u1Ltvevnx01fu1nbr0vFuK9mrq','mtuWmJfOA2zXruK','icbuAgLZignHBIbOyxbWzw4GD2HLBIb0AguGy29UDMvYC2f0Aw9UigjLy29TzxmGDg9VigXHCMDL','q2fUBM90ihnLBMqGBwvZC2fNzsb0BYa','CMvNAxn0zxjvC2vYuhjVBxb0sgfUzgXLCG','Dg9VBenOzwnRsw50zxj2ywW','DhjPz2DLCLbYB2nLzwq','qMvMB3jLignVBxbHy3rPEMf0Aw9UoIa','CMvXDwLYzxnszxnWB25Zzq','q29UDMvYC2f0Aw9Uia','q2fUBM90igrPC3bSyxKGChjVBxb0ihrVihvZzxi6ie5VihbYB21WDcbOyw5KBgvYigLZihjLz2LZDgvYzwqUia','CgfYC2u','8j+uHcbutYbdt05usu5vrsbzt1vsifDpuKS6','rxjYB3iGD2fPDgLUzYbMB3iGCgvUzgLUzYbVCgvYyxrPB25Zigr1CMLUzYbZAhv0zg93BJO','AwrSzq','cGO9psbqzw5KAw5Nie9WzxjHDgLVBNmGpt0','igr1CMLUzYbZAhv0zg93BG','C2H1DgrVD24','sgfUzgXPBMCGDxnLCIbWCM9TChq6ia','q291BgqGBM90igzPBMqGAgLZDg9YEsbMB3iG','sM9IignVBxbSzxrLzdOG','C2v0u2vZC2LVBK92zxjYAwrLCW','y3jLyxrLsw5PDgLHBfbYB21WDezVCKvUz2LUzwvY','zNjVBq','AgfZ','zw5Oyw5Jzvn5C3rLBvbYB21WDa','igzYB20GzMLSzsa','C2H1DgrVD25uAw1LB3v0','igzYB20G','uM91DgLUzYbTzxnZywDLigzYB20G','CgvUzgLUzW','z2v0sw5KAwnHDg9Yu3rHDhvZ','vxbKyxrLzcbJB252zxjZyxrPB24GB3jJAgvZDhjHDg9YihbYB2PLy3qGzgLYzwn0B3j5oIa','DxbKyxrLuhjVAMvJDerPCMvJDg9YEq','C2f2zvnLC3nPB25tDgf0zq','zw50CMLLCW','qvvutYbTB2rLoIbbDxrVlxnLBgvJDgvKici'];a0_0x51bd=function(){return _0x27a8c7;};return a0_0x51bd();}import{LLMService}from'../services/llmService.js';import{ToolRegistry}from'../services/toolRegistry.js';import{BudgetService}from'../services/budgetService.js';import{displayOnly}from'../utilities/stringOps.js';import a0_0x281f16 from'chalk';export const CONVERSATION_CONSTANTS={'STATE_DIR_NAME':a0_0xd5ff40(0xac),'SESSION_STATE_FILENAME':a0_0xd5ff40(0x133),'INDEX_FILENAME':a0_0xd5ff40(0x136),'LAST_SESSION_FILENAME':'last-session.json','HISTORY_SUFFIX':'-history.json','SYSTEM_MESSAGE_ROLE':a0_0xd5ff40(0x145),'USER_MESSAGE_ROLE':a0_0xd5ff40(0x14f),'ASSISTANT_MESSAGE_ROLE':'assistant','COMPACTIZATION_THRESHOLD_PERCENTAGE':0.7,'COMPACTIZATION_OUTPUT_RESERVE_PERCENTAGE':0.4,'COMPACTIZATION_BEGIN_PERCENTAGE':0.15,'COMPACTIZATION_END_PERCENTAGE':0.35,'MIN_MESSAGES_TO_KEEP':0x2,'SUMMARY_MARKER_BEGIN':'--Conversation\x20Became\x20Long,\x20This\x20Part\x20Has\x20Been\x20Summarized--','SUMMARY_MARKER_END':'--End\x20of\x20Summary--','TOOL_CALL_FREQUENCY_CHECK_MS':0x2710,'TOOL_STATUS_UPDATE_INTERVAL_MS':0x2710,'DEFAULT_CONTEXT_WINDOW_SIZE':0x186a0,'MAKER_AGENT_DEFAULT_ID':a0_0xd5ff40(0x150),'LANGUAGE_MODEL_ID':'language-model','PROMPT_ENGINEER_ID':'prompt-engineer'};export class ConversationOrchestrator{constructor(_0x4b3cca,_0x191bef){const _0x5712fc=a0_0xd5ff40;this[_0x5712fc(0x19e)]=_0x4b3cca,this[_0x5712fc(0x178)]=_0x191bef,this['blockedMessages']=[],this['tagParserService']=new TagParserService(_0x191bef),this['llmService']=new LLMService(_0x4b3cca,_0x191bef),this[_0x5712fc(0x10b)][_0x5712fc(0x191)](_0x1751c8=>this['handlePromptTooLong'](_0x1751c8)),this['toolRegistry']=new ToolRegistry(_0x4b3cca,_0x191bef,this[_0x5712fc(0x10b)]),this['budgetService']=new BudgetService(_0x4b3cca,_0x191bef),this['conversations']=new Map(),this[_0x5712fc(0x100)]=new Map(),this[_0x5712fc(0x1a4)]=new Map(),this['interactionMode']='interactive',this['originalSystemPrompts']=new Map(),this['sessionState']={'projectDir':null,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{}},this['jobDoneConfirmationState']={'pending':![],'message':null,'attemptCount':0x0,'timestamp':null},this['toolCheckInterval']=setInterval(()=>this[_0x5712fc(0xf7)](),CONVERSATION_CONSTANTS[_0x5712fc(0x194)]),this[_0x5712fc(0x11a)]='idle',this['lastActivityTime']=Date['now'](),this[_0x5712fc(0x165)]=null,this[_0x5712fc(0x170)]=0x1388,this['isShuttingDown']=![],this['startIdleMonitoring']();}async[a0_0xd5ff40(0x12f)](_0x53188d){const _0x506dee=a0_0xd5ff40;this[_0x506dee(0x1b0)]['projectDir']=_0x53188d,this[_0x506dee(0x10f)]['setProjectDirectory'](_0x53188d),this[_0x506dee(0x178)]['info']('Conversation\x20orchestrator\x20initialized\x20with\x20project:\x20'+_0x53188d);}async['initializeWithProject'](_0x45c5cf){const _0xfc173d=a0_0xd5ff40;this['sessionState']['projectDir']=_0x45c5cf,this['toolRegistry'][_0xfc173d(0x116)](_0x45c5cf),this[_0xfc173d(0x178)]['info']('Conversation\x20orchestrator\x20initialized\x20with\x20project:\x20'+_0x45c5cf);}['setProjectDirectory'](_0x9cc19f){const _0x3767da=a0_0xd5ff40;this['sessionState'][_0x3767da(0x177)]=_0x9cc19f,this[_0x3767da(0x10f)]&&this['toolRegistry'][_0x3767da(0x116)](_0x9cc19f),this['logger'][_0x3767da(0xda)](_0x3767da(0x1d1)+_0x9cc19f);}async[a0_0xd5ff40(0xc8)](){const _0x517f6c=a0_0xd5ff40;this['toolRegistry']=new ToolRegistry(this[_0x517f6c(0x19e)],this[_0x517f6c(0x178)]),await this['toolRegistry']['registerBuiltInTools']();}[a0_0xd5ff40(0x1d2)](_0x51c9ae){this['setProjectDirectory'](_0x51c9ae);}['startIdleMonitoring'](){const _0x1aaf31=a0_0xd5ff40;this[_0x1aaf31(0x13d)]=setInterval(()=>{const _0x4c3ca8=_0x1aaf31;if(this['isShuttingDown'])return;if(this['interactionMode']===_0x4c3ca8(0xd3))return;const _0x355b24=Date['now'](),_0x7bc631=_0x355b24-this['lastActivityTime'];this[_0x4c3ca8(0x11a)]==='idle'&&_0x7bc631>=this[_0x4c3ca8(0x170)]&&this['sessionState']['makerAgentId']&&(this['logger'][_0x4c3ca8(0xda)](_0x4c3ca8(0x121)),this[_0x4c3ca8(0xca)]());},0x1f4);}[a0_0xd5ff40(0x15a)](_0x274dd3){const _0x348a36=a0_0xd5ff40,_0x2bed64=this[_0x348a36(0x14a)];this[_0x348a36(0x14a)]=_0x274dd3;if(_0x274dd3&&!_0x2bed64)console['log'](a0_0x281f16[_0x348a36(0x11c)]('ðŸ”’\x20Interactive\x20mode:\x20Blocking\x20automatic\x20messages'));else!_0x274dd3&&_0x2bed64&&(console['log'](a0_0x281f16['green']('ðŸ”“\x20Interactive\x20mode:\x20Resuming\x20message\x20flow')),this['blockedMessages']=[]);}[a0_0xd5ff40(0x10a)](_0x4dd3b1,_0x24287b){const _0x29b352=a0_0xd5ff40;if(this[_0x29b352(0x14e)]!=='interactive'||!this[_0x29b352(0x14a)])return![];if(_0x24287b[_0x29b352(0x149)]('[User\x20input]:'))return![];if(_0x24287b[_0x29b352(0x149)]('(system\x20message)'))return![];return!![];}['updateMessageIndicator'](_0x3c8ded){const _0x1d3086=a0_0xd5ff40,_0x207233=this['messageIndicator'];this['messageIndicator']=_0x3c8ded,this[_0x1d3086(0x17e)]=Date['now']();this['idleTimer']&&(clearTimeout(this[_0x1d3086(0x165)]),this['idleTimer']=null);if(_0x207233!==_0x3c8ded){const _0x229905=this['getIndicatorDisplay'](_0x3c8ded);console[_0x1d3086(0x152)](a0_0x281f16['gray'](_0x229905+'\x20'+_0x3c8ded));}}['getIndicatorDisplay'](_0x2f4cb6){const _0x5f15a6=a0_0xd5ff40;switch(_0x2f4cb6){case _0x5f15a6(0x10e):return a0_0x281f16['yellow']('â³');case'waiting-for-llm':return a0_0x281f16[_0x5f15a6(0x161)]('ðŸ¤–');case _0x5f15a6(0x1bf):return a0_0x281f16['green']('âœ“');default:return'â€¢';}}async[a0_0xd5ff40(0xca)](){const _0x658035=a0_0xd5ff40;if(!this[_0x658035(0x1b0)]['makerAgentId']||this[_0x658035(0xb4)])return;try{this['updateMessageIndicator']('waiting-for-agent'),console[_0x658035(0x152)](a0_0x281f16[_0x658035(0xec)](_0x658035(0xc4)));const _0x3c81ac=new Date()[_0x658035(0x125)]()[_0x658035(0xbb)]('\x20')[0x0];await this[_0x658035(0xcf)](this[_0x658035(0x1b0)]['makerAgentId'],'('+_0x3c81ac+_0x658035(0x1df));}catch(_0x52ec5b){this[_0x658035(0x178)][_0x658035(0x179)]('Error\x20sending\x20auto-proceed\x20message:',_0x52ec5b),this[_0x658035(0x130)](_0x658035(0x1bf));}}['setInteractionMode'](_0x246095){const _0x53c92b=a0_0xd5ff40,_0x910289=this['interactionMode'];this[_0x53c92b(0x14e)]=_0x246095,this[_0x53c92b(0x178)][_0x53c92b(0xda)](_0x53c92b(0xd9)+_0x910289+_0x53c92b(0x158)+_0x246095);if(_0x246095===_0x53c92b(0xd3)&&_0x910289!==_0x53c92b(0xd3))this[_0x53c92b(0x15a)](!![]);else _0x246095!==_0x53c92b(0xd3)&&_0x910289==='interactive'&&this['setWaitingForUserInput'](![]);this[_0x53c92b(0x153)](_0x246095);}[a0_0xd5ff40(0x157)](){const _0x4a3ccc=a0_0xd5ff40;return{'interactionMode':this[_0x4a3ccc(0x14e)],'isWaitingForUserInput':this['isWaitingForUserInput'],'blockedMessagesCount':this['blockedMessages']['length'],'indicatorState':this['messageIndicator']};}[a0_0xd5ff40(0x153)](_0xb6a894){const _0x1ec1d4=a0_0xd5ff40;for(const [_0x5bf97b,_0xff4800]of this[_0x1ec1d4(0xf0)]){this[_0x1ec1d4(0xfd)](_0x5bf97b,_0xb6a894);}}[a0_0xd5ff40(0xfd)](_0x5d1d70,_0x2d74b9){const _0x10850a=a0_0xd5ff40,_0x538c1a=this['conversations']['get'](_0x5d1d70);if(!_0x538c1a)return;!this[_0x10850a(0x19c)][_0x10850a(0x1c9)](_0x5d1d70)&&this[_0x10850a(0x19c)]['set'](_0x5d1d70,_0x538c1a['systemPrompt']);const _0x9aa7ab=this['originalSystemPrompts']['get'](_0x5d1d70);let _0x3817dc;_0x2d74b9==='auto'?_0x3817dc=this[_0x10850a(0xc2)](_0x9aa7ab):_0x3817dc=_0x9aa7ab,_0x538c1a[_0x10850a(0x155)]=_0x3817dc,this['llmService']&&this['llmService']['updateConversationSystemPrompt']&&this[_0x10850a(0x10b)]['updateConversationSystemPrompt'](_0x5d1d70,_0x3817dc),this[_0x10850a(0x178)][_0x10850a(0x10c)](_0x10850a(0xf1)+_0x5d1d70+'\x20(mode:\x20'+_0x2d74b9+')');}[a0_0xd5ff40(0xc2)](_0x2ef42f){const _0x2c2cc4=a0_0xd5ff40;let _0x388285=_0x2ef42f[_0x2c2cc4(0xcc)](/5\.\s*If you need user input or a decision[^6]*/,'5.\x20[USER\x20PROMPTS\x20DISABLED\x20IN\x20AUTO\x20MODE]\x20');return _0x388285=_0x388285['replace'](/\[prompt[^\]]*\][^[]*\[\/prompt\]/g,''),_0x388285+=_0x2c2cc4(0xb6)+_0x2c2cc4(0xc1),_0x388285;}['enhanceSystemPrompt'](_0x533741,_0x30796b,_0x1dbcbb,_0x37c998){const _0x39ca0a=a0_0xd5ff40;let _0x17dbd8=_0x533741;return!_0x17dbd8['toLocaleLowerCase']()['includes']('tools\x20available\x20are')&&(_0x17dbd8+=_0x39ca0a(0xe3)+_0x30796b),!_0x17dbd8[_0x39ca0a(0x1a6)]()[_0x39ca0a(0x149)](_0x39ca0a(0x115))&&(_0x17dbd8+='\x0a\x0aYou\x20are\x20expected\x20to\x20consult\x20your\x20LLM\x20agent\x20using\x20the\x20[message]\x20tag\x20with\x20the\x20following\x20ids:\x20'+_0x37c998[_0x39ca0a(0x164)](',\x20')+'\x0a\x20This\x20section\x20will\x20be\x20sent\x20apart\x20from\x20the\x20tool\x20instructions.'),!_0x17dbd8['includes']('conversation\x20rules\x20are')&&(_0x17dbd8+=_0x39ca0a(0x182)+_0x1dbcbb+_0x39ca0a(0x1d7)),_0x17dbd8;}[a0_0xd5ff40(0x17b)](_0x653e5e){const _0x1d9e2f=a0_0xd5ff40;if(!_0x653e5e||typeof _0x653e5e!=='string')return'conversation-'+Date['now']();let _0x5c07e6=_0x653e5e['replace'](/\s+/g,'-')['replace'](/[^a-zA-Z0-9_-]/g,'')['replace'](/-+/g,'-')[_0x1d9e2f(0xcc)](/^-+|-+$/g,'')[_0x1d9e2f(0x187)]();if(!_0x5c07e6)_0x5c07e6='conversation-'+Date['now']();else _0x5c07e6['length']>0x32&&(_0x5c07e6=_0x5c07e6['substring'](0x0,0x28)+'-'+Date[_0x1d9e2f(0x1dc)]()['toString']()[_0x1d9e2f(0x190)](-0x8));return _0x5c07e6;}[a0_0xd5ff40(0x119)](_0x5b7887){const _0x142e85=a0_0xd5ff40;if(this[_0x142e85(0x1a4)]['has'](_0x5b7887))return this['conversationIdMapping'][_0x142e85(0x16f)](_0x5b7887);const _0x551915=this[_0x142e85(0x17b)](_0x5b7887);return this[_0x142e85(0x1a4)]['set'](_0x5b7887,_0x551915),_0x551915!==_0x5b7887&&this['logger'][_0x142e85(0xda)](_0x142e85(0x105)+_0x5b7887+_0x142e85(0x192)+_0x551915+'\x22'),_0x551915;}async[a0_0xd5ff40(0x108)](){const _0x2ba644=a0_0xd5ff40;this['llmService']&&this[_0x2ba644(0x10f)]&&(this['toolRegistry'][_0x2ba644(0xff)](this[_0x2ba644(0x10b)]),this[_0x2ba644(0x178)][_0x2ba644(0xda)]('LLM\x20service\x20connected\x20to\x20tool\x20registry\x20for\x20vision\x20capabilities'));}async['getImageDescription'](_0x4406a8,_0x28037e,_0x34a905={}){const _0x514e35=a0_0xd5ff40;if(!this[_0x514e35(0x10b)])throw new Error(_0x514e35(0x101));return await this['llmService'][_0x514e35(0x113)](_0x4406a8,_0x28037e,_0x34a905);}async['handleUserPromptBasedOnMode'](_0x2f475c,_0x2905f5){const _0x4220ef=a0_0xd5ff40;this[_0x4220ef(0x178)][_0x4220ef(0xda)](_0x4220ef(0x1c3)+_0x2905f5[_0x4220ef(0x1d6)]+_0x4220ef(0x1cd)+_0x2f475c+_0x4220ef(0x1de)+this[_0x4220ef(0x14e)]+')');switch(this[_0x4220ef(0x14e)]){case _0x4220ef(0x15b):const _0x464875=_0x2905f5[_0x4220ef(0xd2)]&&_0x2905f5[_0x4220ef(0xd2)]['length']>0x0?_0x2905f5['options'][0x0]:'Continue\x20automatically';this['logger']['info'](_0x4220ef(0x1d5)+_0x464875+'\x22\x20for\x20prompt:\x20'+_0x2905f5[_0x4220ef(0x1d6)]),await this['sendMessageToConversation'](_0x2f475c,_0x4220ef(0xdf)+_0x464875);break;case _0x4220ef(0xf5):if(this[_0x4220ef(0xd8)]){const _0x1e19eb=await this[_0x4220ef(0xd8)](_0x2905f5[_0x4220ef(0x1d6)],_0x2905f5['text'],_0x2905f5['options']);await this['sendMessageToConversation'](_0x2f475c,_0x4220ef(0xef)+_0x1e19eb);}else await this[_0x4220ef(0xcf)](_0x2f475c,'Cannot\x20display\x20prompt\x20to\x20user:\x20No\x20prompt\x20handler\x20is\x20registered.\x20'+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');break;case'interactive':default:if(this[_0x4220ef(0xd8)]){const _0x2d36dc=await this[_0x4220ef(0xd8)](_0x2905f5[_0x4220ef(0x1d6)],_0x2905f5['text'],_0x2905f5['options']);await this[_0x4220ef(0xcf)](_0x2f475c,_0x4220ef(0xef)+_0x2d36dc);}else await this['sendMessageToConversation'](_0x2f475c,_0x4220ef(0x1bb)+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');break;}}async[a0_0xd5ff40(0xd5)](_0x3d11a7){const _0x1a70c5=a0_0xd5ff40;this['logger']['info'](_0x1a70c5(0xea)+_0x3d11a7+'\x20(mode:\x20'+this[_0x1a70c5(0x14e)]+')');if(!this['jobDoneConfirmationState']['pending']){this['jobDoneConfirmationState']['pending']=!![],this[_0x1a70c5(0xc0)][_0x1a70c5(0x10d)]=_0x3d11a7,this[_0x1a70c5(0xc0)][_0x1a70c5(0xfc)]=0x1,this[_0x1a70c5(0xc0)]['timestamp']=new Date()[_0x1a70c5(0xb9)](),this[_0x1a70c5(0x178)][_0x1a70c5(0xda)](_0x1a70c5(0x13b)),await this['sendJobDoneConfirmationPrompt'](_0x3d11a7);return;}else this[_0x1a70c5(0xc0)][_0x1a70c5(0xfc)]++,this[_0x1a70c5(0x178)][_0x1a70c5(0xda)]('Job\x20confirmation\x20received\x20(attempt\x20'+this['jobDoneConfirmationState']['attemptCount']+_0x1a70c5(0x1a0)),this[_0x1a70c5(0x106)](),await this['completeJob'](_0x3d11a7);}async[a0_0xd5ff40(0x14b)](_0x24398f){const _0x5264d2=a0_0xd5ff40,_0x50f07a=_0x5264d2(0x1a8)+_0x24398f+_0x5264d2(0x137);this[_0x5264d2(0x1b0)][_0x5264d2(0x110)]?await this[_0x5264d2(0xcf)](this[_0x5264d2(0x1b0)]['makerAgentId'],_0x50f07a):this['logger']['error'](_0x5264d2(0xed));}async[a0_0xd5ff40(0xb5)](_0x3ab961){const _0x56f9a=a0_0xd5ff40;this[_0x56f9a(0x178)][_0x56f9a(0xda)](_0x56f9a(0xbf));if(this[_0x56f9a(0x12c)])await this['onJobDone'](_0x3ab961);else switch(this['interactionMode']){case'auto':this['logger'][_0x56f9a(0xda)](_0x3ab961+_0x56f9a(0x126)),process['exit'](0x0);break;case'semi-auto':this['logger']['info'](_0x56f9a(0x1c5)+_0x3ab961),this[_0x56f9a(0x178)]['info']('SEMI-AUTO\x20mode:\x20Task\x20completed.\x20Press\x20Ctrl+I\x20to\x20enter\x20interactive\x20mode\x20or\x20exit.');break;case'interactive':default:this['logger'][_0x56f9a(0xda)](_0x56f9a(0x1c5)+_0x3ab961);break;}}[a0_0xd5ff40(0x106)](){this['jobDoneConfirmationState']={'pending':![],'message':null,'attemptCount':0x0,'timestamp':null};}[a0_0xd5ff40(0x114)](_0x20bdfe){this['onJobDone']=_0x20bdfe;}async['processAgentMessage'](_0x324519,_0x407bc5){const _0x5f33bf=a0_0xd5ff40;this['logger'][_0x5f33bf(0xda)](_0x5f33bf(0x17f)+_0x324519);const _0x2ebd31=this[_0x5f33bf(0x129)]['parseMessage'](_0x407bc5);_0x2ebd31['toolCommands']&&_0x2ebd31[_0x5f33bf(0x146)][_0x5f33bf(0x188)]>0x0&&await this['processToolCommands'](_0x324519,_0x2ebd31[_0x5f33bf(0x146)]);_0x2ebd31['prompt']&&await this['handleUserPromptBasedOnMode'](_0x324519,_0x2ebd31['prompt']);if(_0x2ebd31['jobDone']!=null){await this[_0x5f33bf(0xd5)](_0x2ebd31[_0x5f33bf(0xb8)]);return;}if(_0x2ebd31[_0x5f33bf(0x176)]){const _0x113fd5=_0x2ebd31[_0x5f33bf(0x176)],_0x2cb041=_0x2ebd31['content'];await this[_0x5f33bf(0x1e2)](_0x324519,_0x113fd5,_0x2cb041),this['logger']['info']('['+displayOnly(_0x324519,0xa)+_0x5f33bf(0x158)+displayOnly(_0x113fd5,0xa)+']:\x20'+displayOnly(_0x2cb041,0xff)+'\x0a');}!_0x2ebd31[_0x5f33bf(0x176)]&&(!_0x2ebd31[_0x5f33bf(0x146)]||_0x2ebd31['toolCommands']['length']===0x0)&&!_0x2ebd31[_0x5f33bf(0xf3)]&&!_0x2ebd31[_0x5f33bf(0xb8)]&&await this['sendMessageToConversation'](_0x324519,_0x5f33bf(0x144)+'Please\x20use\x20[message\x20to=\x22...\x22]\x20tags\x20to\x20send\x20a\x20message\x20to\x20another\x20agent,\x20'+_0x5f33bf(0xa7));}['parsePromptEngineerResponse'](_0x22dbde){const _0x3c1a3b=a0_0xd5ff40,_0x4d366d=CONVERSATION_CONSTANTS[_0x3c1a3b(0x160)],_0x99e184='You\x20are\x20an\x20AI\x20assistant\x20tasked\x20with\x20completing\x20the\x20following:\x20';try{const _0x135dc9=TagParser['extractStructured'](_0x22dbde,{'role':_0x3c1a3b(0x167),'systemPrompt':'system-prompt'});let _0x3887e2=_0x135dc9[_0x3c1a3b(0x19f)];_0x3887e2?_0x3887e2=_0x3887e2['replace'](/[\\/]/g,''):(_0x3887e2=_0x4d366d,this[_0x3c1a3b(0x178)][_0x3c1a3b(0x197)]('Failed to parse role from prompt engineer response, using default'));let _0x5efa63=_0x135dc9[_0x3c1a3b(0x155)];return!_0x5efa63&&(_0x5efa63=''+_0x99e184+_0x22dbde,this['logger']['warn']('Failed to parse system prompt from prompt engineer response, using generated one')),{'role':_0x3887e2,'systemPrompt':_0x5efa63};}catch(_0x35bfb6){return this['logger'][_0x3c1a3b(0x179)]('Error\x20parsing\x20prompt\x20engineer\x20response:',_0x35bfb6),{'role':_0x4d366d,'systemPrompt':''+_0x99e184+_0x22dbde};}}async[a0_0xd5ff40(0x143)](_0x229bd2,_0x1d275d,_0x3dc461,_0x32174c){const _0x2c1442=a0_0xd5ff40;this[_0x2c1442(0x178)]['info'](_0x2c1442(0xaa)+_0x229bd2),this[_0x2c1442(0x1b0)]['projectDir']=_0x1d275d;const _0xdd1ebc=a0_0x37b9cf['join'](_0x1d275d,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x4549d6[_0x2c1442(0x14c)](_0xdd1ebc,{'recursive':!![]}),this['sessionState']={'projectDir':_0x1d275d,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{},'paused':![]};try{const _0x2f2d82=this[_0x2c1442(0x195)](this[_0x2c1442(0x10f)]['getToolsDescription']()),_0x51364a=CONVERSATION_CONSTANTS['PROMPT_ENGINEER_ID'];await this['createConversation'](_0x51364a,_0x2f2d82,[],_0x3dc461);const _0x564adf=this[_0x2c1442(0x1c7)](_0x229bd2),_0x5d383f=await this[_0x2c1442(0xcf)](_0x51364a,_0x564adf),{role:_0x304f6c,systemPrompt:_0x46a5d9}=this['parsePromptEngineerResponse'](_0x5d383f),_0x22ab5a=_0x304f6c||CONVERSATION_CONSTANTS['MAKER_AGENT_DEFAULT_ID'];this[_0x2c1442(0x1b0)][_0x2c1442(0x110)]=_0x22ab5a;const _0x33ac81=this['enhanceSystemPrompt'](_0x46a5d9,this[_0x2c1442(0x10f)][_0x2c1442(0x13f)](),this[_0x2c1442(0x1b0)]['projectDir'],[CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID']]);await this[_0x2c1442(0x141)](_0x22ab5a,_0x33ac81,[],_0x3dc461);const _0x347c9e=CONVERSATION_CONSTANTS[_0x2c1442(0x186)];this[_0x2c1442(0x1b0)][_0x2c1442(0x17a)]=_0x347c9e;const _0x4feeaf=this['getLanguageModelSystemPrompt'](this['toolRegistry'][_0x2c1442(0x13f)](),_0x22ab5a);await this[_0x2c1442(0x141)](_0x347c9e,_0x4feeaf,[],_0x3dc461),this['sessionState']['activeConversationIds']=[_0x22ab5a,_0x347c9e],await this[_0x2c1442(0x1d3)](),await this[_0x2c1442(0xcf)](_0x22ab5a,'begin'),this[_0x2c1442(0x178)]['info']('New\x20conversation\x20started\x20and\x20session\x20state\x20saved');}catch(_0x594ce9){this['logger'][_0x2c1442(0x179)]('Error\x20starting\x20new\x20conversation:',_0x594ce9);throw _0x594ce9;}}async['loadConversationHistory'](_0xab66a8,_0x59c2f4){const _0x3ca16a=a0_0xd5ff40,_0x4474ea=this[_0x3ca16a(0x119)](_0x59c2f4),_0x639896=a0_0x37b9cf[_0x3ca16a(0x164)](_0xab66a8,''+_0x4474ea+CONVERSATION_CONSTANTS[_0x3ca16a(0x1db)]);try{const _0x57c13d=await a0_0x4549d6['readFile'](_0x639896,_0x3ca16a(0x1d9)),_0x2e0e94=JSON[_0x3ca16a(0x1bc)](_0x57c13d),_0x27b144=(_0x2e0e94['messages']||[])[_0x3ca16a(0xe1)](_0x213d6d=>_0x213d6d['role']!==_0x3ca16a(0x145));await this[_0x3ca16a(0x141)](_0x59c2f4,_0x2e0e94['systemPrompt']||_0x3ca16a(0x13c),_0x27b144),this['logger'][_0x3ca16a(0xda)](_0x3ca16a(0xdb)+_0x59c2f4+'\x20(file:\x20'+_0x4474ea+')');}catch(_0x14a6ac){this[_0x3ca16a(0x178)][_0x3ca16a(0x197)](_0x3ca16a(0x139)+_0x59c2f4+':\x20'+_0x14a6ac[_0x3ca16a(0x10d)]),await this['tryLoadConversationHistoryByPattern'](_0xab66a8,_0x59c2f4);}}async[a0_0xd5ff40(0x18f)](_0x48ceb7,_0x35f15f){const _0x5d29fc=a0_0xd5ff40;try{const _0x33f90d=await a0_0x4549d6[_0x5d29fc(0x1a7)](_0x48ceb7),_0x4d3009=_0x33f90d['filter'](_0x5f2c2b=>_0x5f2c2b['endsWith'](CONVERSATION_CONSTANTS['HISTORY_SUFFIX'])),_0x54a04b=this['_getFileSafeConversationId'](_0x35f15f);for(const _0x5e2f80 of _0x4d3009){const _0x2f39a8=_0x5e2f80['replace'](CONVERSATION_CONSTANTS['HISTORY_SUFFIX'],'');if(_0x2f39a8===_0x54a04b||_0x2f39a8['includes'](_0x54a04b)||_0x54a04b['includes'](_0x2f39a8))try{const _0x4e08f8=a0_0x37b9cf[_0x5d29fc(0x164)](_0x48ceb7,_0x5e2f80),_0x406404=await a0_0x4549d6[_0x5d29fc(0x120)](_0x4e08f8,'utf-8'),_0x1f030e=JSON['parse'](_0x406404),_0x1edbea=(_0x1f030e['messages']||[])[_0x5d29fc(0xe1)](_0x51a2eb=>_0x51a2eb['role']!=='system');await this[_0x5d29fc(0x141)](_0x35f15f,_0x1f030e['systemPrompt']||'Conversation\x20resumed',_0x1edbea),this[_0x5d29fc(0x178)][_0x5d29fc(0xda)]('Found\x20and\x20loaded\x20conversation\x20history\x20for\x20'+_0x35f15f+_0x5d29fc(0x1cb)+_0x5e2f80);return;}catch(_0x55124d){this['logger'][_0x5d29fc(0x10c)](_0x5d29fc(0x138)+_0x5e2f80+':',_0x55124d);}}this['logger'][_0x5d29fc(0x197)](_0x5d29fc(0x1c4)+_0x35f15f+',\x20creating\x20empty\x20conversation'),await this['createConversation'](_0x35f15f,'Conversation\x20resumed\x20without\x20history.');}catch(_0x481002){this[_0x5d29fc(0x178)]['error'](_0x5d29fc(0x147)+_0x481002[_0x5d29fc(0x10d)]),await this[_0x5d29fc(0x141)](_0x35f15f,'Conversation\x20resumed\x20without\x20complete\x20history');}}async[a0_0xd5ff40(0xeb)](_0x11f198){const _0x200e52=a0_0xd5ff40;if(!this['sessionState']['projectDir'])return;const _0x50de1d=this[_0x200e52(0xf0)]['get'](_0x11f198);if(!_0x50de1d)return;const _0x25de82=a0_0x37b9cf['join'](this['sessionState'][_0x200e52(0x177)],CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x4549d6['mkdir'](_0x25de82,{'recursive':!![]});const _0x44790f={'id':_0x11f198,'originalId':_0x11f198,'systemPrompt':_0x50de1d['systemPrompt'],'messages':_0x50de1d['messages'],'contextWindow':_0x50de1d['contextWindow'],'lastUpdated':new Date()[_0x200e52(0xb9)]()},_0x3dff4d=this['_getFileSafeConversationId'](_0x11f198),_0x472ac3=a0_0x37b9cf[_0x200e52(0x164)](_0x25de82,''+_0x3dff4d+CONVERSATION_CONSTANTS[_0x200e52(0x1db)]);await a0_0x4549d6['writeFile'](_0x472ac3,JSON['stringify'](_0x44790f,null,0x2),'utf-8'),this['logger'][_0x200e52(0xda)]('Conversation\x20history\x20saved\x20for\x20'+_0x11f198+'\x20(file:\x20'+_0x3dff4d+')');}['_handleSummaryFailure'](_0x5d4088,_0x2975a0){const _0x2bedf6=a0_0xd5ff40;this['saveSessionState']()['catch'](_0x27f04d=>{const _0x1d76af=a0_0x4582;this['logger'][_0x1d76af(0x179)](_0x1d76af(0xd0),_0x27f04d);}),this['logger']['error'](_0x2bedf6(0x134)+_0x5d4088+':',_0x2975a0),console['log']('\x0a'+a0_0x281f16['red'](_0x2bedf6(0xbc))),console['log'](a0_0x281f16[_0x2bedf6(0x198)]('â”'['repeat'](0x3c))),console[_0x2bedf6(0x152)](a0_0x281f16['red'](_0x2bedf6(0x1d8))),console[_0x2bedf6(0x152)](a0_0x281f16[_0x2bedf6(0xec)](_0x2bedf6(0x1b3))),console[_0x2bedf6(0x152)](a0_0x281f16[_0x2bedf6(0xec)]('\x20\x20and\x20the\x20summary\x20service\x20is\x20unavailable.')),console['log'](''),console['log'](a0_0x281f16[_0x2bedf6(0x11d)][_0x2bedf6(0x11c)](_0x2bedf6(0x1bd))),console['log'](a0_0x281f16['white']('\x20\x201.\x20Use\x20the\x20resume\x20command\x20to\x20continue\x20this\x20conversation:')),console[_0x2bedf6(0x152)](a0_0x281f16[_0x2bedf6(0x11c)](_0x2bedf6(0x16c))),console['log'](''),console[_0x2bedf6(0x152)](a0_0x281f16[_0x2bedf6(0x14d)](_0x2bedf6(0xae))),console['log'](a0_0x281f16['cyan']('\x20\x20\x20\x20\x20loxia\x20do\x20\x22continue\x20the\x20previous\x20work\x20in\x20this\x20directory\x22')),console[_0x2bedf6(0x152)](''),console['log'](a0_0x281f16['white'](_0x2bedf6(0x104))),console['log'](a0_0x281f16['cyan']('\x20\x20\x20\x20\x20loxia\x20modify\x20./your-project\x20\x22continue\x20development\x22')),console[_0x2bedf6(0x152)](''),console[_0x2bedf6(0x152)](a0_0x281f16['gray']('ðŸ’¡\x20Your\x20project\x20files\x20have\x20been\x20saved\x20and\x20can\x20be\x20resumed.')),console[_0x2bedf6(0x152)](a0_0x281f16[_0x2bedf6(0x198)]('â”'['repeat'](0x3c))),this['logger']['error']('Summary\x20failure\x20details:',{'conversationId':_0x5d4088,'error':_0x2975a0[_0x2bedf6(0x10d)],'errorType':_0x2975a0[_0x2bedf6(0xe5)]||'unknown','originalError':_0x2975a0['originalError']||null});const _0x15bcc0=new Error(_0x2bedf6(0x171)+'Please\x20try\x20rerunning\x20the\x20CLI\x20with\x20do,\x20modify,\x20or\x20resume\x20commands\x20asking\x20the\x20agent\x20to\x20continue.');_0x15bcc0[_0x2bedf6(0xc7)]=!![],_0x15bcc0['originalError']=_0x2975a0;throw _0x15bcc0;}async['saveSessionState'](){const _0x2f787d=a0_0xd5ff40;if(!this['sessionState']['projectDir']){this['logger']['warn'](_0x2f787d(0x196));return;}try{const _0x439fbe=a0_0x37b9cf['join'](this[_0x2f787d(0x1b0)][_0x2f787d(0x177)],CONVERSATION_CONSTANTS[_0x2f787d(0xe0)]);await a0_0x4549d6[_0x2f787d(0x14c)](_0x439fbe,{'recursive':!![]}),this[_0x2f787d(0x178)]['debug']('State\x20directory\x20created/verified:\x20'+_0x439fbe);const _0x526172=a0_0x37b9cf['join'](_0x439fbe,CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME']),_0x5b2448={'projectDir':this[_0x2f787d(0x1b0)][_0x2f787d(0x177)],'makerAgentId':this['sessionState'][_0x2f787d(0x110)],'languageModelAgentId':this[_0x2f787d(0x1b0)]['languageModelAgentId'],'activeConversationIds':this[_0x2f787d(0x1b0)][_0x2f787d(0x162)]||[],'conversationHistory':this[_0x2f787d(0x1b0)]['conversationHistory']||{},'conversationIdMapping':Object[_0x2f787d(0x19b)](this['conversationIdMapping']),'paused':this[_0x2f787d(0x1b0)][_0x2f787d(0x140)]||![],'lastUpdated':new Date()['toISOString'](),'version':_0x2f787d(0x109)};await a0_0x4549d6['writeFile'](_0x526172,JSON[_0x2f787d(0xe9)](_0x5b2448,null,0x2),'utf-8'),this['logger'][_0x2f787d(0x10c)](_0x2f787d(0x12e)+_0x526172);const _0x238b63=a0_0x37b9cf[_0x2f787d(0x164)](_0x439fbe,CONVERSATION_CONSTANTS[_0x2f787d(0x16b)]),_0x479c8a={'projectDir':this[_0x2f787d(0x1b0)][_0x2f787d(0x177)],'lastUpdated':new Date()[_0x2f787d(0xb9)](),'makerAgentId':this['sessionState']['makerAgentId'],'languageModelAgentId':this['sessionState'][_0x2f787d(0x17a)],'activeConversationIds':this['sessionState'][_0x2f787d(0x162)]||[],'conversationIdMapping':Object[_0x2f787d(0x19b)](this['conversationIdMapping']),'sessionStateFile':CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME'],'version':_0x2f787d(0x109)};await a0_0x4549d6['writeFile'](_0x238b63,JSON['stringify'](_0x479c8a,null,0x2),_0x2f787d(0x1d9)),this['logger']['debug']('Index\x20file\x20saved\x20to:\x20'+_0x238b63);const _0x63e18=a0_0x37b9cf[_0x2f787d(0x164)](_0x439fbe,CONVERSATION_CONSTANTS['LAST_SESSION_FILENAME']),_0xcaadd6={'projectDir':this['sessionState']['projectDir'],'timestamp':new Date()[_0x2f787d(0xb9)](),'makerAgentId':this['sessionState']['makerAgentId'],'languageModelAgentId':this[_0x2f787d(0x1b0)]['languageModelAgentId'],'conversationIdMapping':Object['fromEntries'](this['conversationIdMapping']),'version':'1.0.0'};await a0_0x4549d6['writeFile'](_0x63e18,JSON['stringify'](_0xcaadd6,null,0x2),'utf-8'),this[_0x2f787d(0x178)]['debug']('Last\x20session\x20file\x20saved\x20to:\x20'+_0x63e18),this['logger'][_0x2f787d(0xda)]('Session\x20state\x20saved\x20successfully\x20with\x20index\x20files');}catch(_0xd7b74f){this['logger']['error'](_0x2f787d(0xd0),_0xd7b74f);throw new Error(_0x2f787d(0xba)+_0xd7b74f[_0x2f787d(0x10d)]);}}async[a0_0xd5ff40(0x181)](_0x34eab0){const _0x248592=a0_0xd5ff40;this['logger'][_0x248592(0xda)]('Resuming\x20conversation\x20from:\x20'+_0x34eab0);try{const _0xa69b49=a0_0x37b9cf['join'](_0x34eab0,CONVERSATION_CONSTANTS[_0x248592(0xe0)]);try{await a0_0x4549d6['access'](_0xa69b49);}catch(_0x1d2e8b){throw new Error(_0x248592(0x15f)+_0xa69b49+_0x248592(0x124));}const _0x1046c0=a0_0x37b9cf['join'](_0xa69b49,CONVERSATION_CONSTANTS[_0x248592(0xfa)]);let _0x54c3ca;try{const _0x1eada6=await a0_0x4549d6[_0x248592(0x120)](_0x1046c0,'utf-8');_0x54c3ca=JSON[_0x248592(0x1bc)](_0x1eada6),_0x54c3ca['conversationIdMapping']&&(this['conversationIdMapping']=new Map(Object['entries'](_0x54c3ca[_0x248592(0x1a4)])),this[_0x248592(0x178)][_0x248592(0xda)](_0x248592(0x112)+this[_0x248592(0x1a4)]['size']+'\x20conversation\x20ID\x20mappings'));}catch(_0xe00775){this['logger']['warn']('Could\x20not\x20read\x20session\x20state\x20file:\x20'+_0xe00775[_0x248592(0x10d)]);const _0x3ca963=a0_0x37b9cf['join'](_0xa69b49,CONVERSATION_CONSTANTS[_0x248592(0x16b)]);try{const _0xc2e412=await a0_0x4549d6['readFile'](_0x3ca963,'utf-8'),_0x10be96=JSON[_0x248592(0x1bc)](_0xc2e412);_0x54c3ca={'projectDir':_0x10be96['projectDir']||_0x34eab0,'makerAgentId':_0x10be96[_0x248592(0x110)],'languageModelAgentId':_0x10be96[_0x248592(0x17a)],'activeConversationIds':_0x10be96[_0x248592(0x162)]||[],'conversationHistory':{},'conversationIdMapping':_0x10be96['conversationIdMapping']||{}},_0x10be96['conversationIdMapping']&&(this[_0x248592(0x1a4)]=new Map(Object[_0x248592(0x1d4)](_0x10be96['conversationIdMapping']))),this[_0x248592(0x178)]['info']('Recovered session state from index file');}catch(_0x2c6175){throw new Error('Could\x20not\x20read\x20session\x20state\x20or\x20index\x20file:\x20'+_0xe00775['message']);}}this['sessionState']={..._0x54c3ca,'projectDir':_0x34eab0};const _0x3b5766=this[_0x248592(0x1b0)]['activeConversationIds']||[];for(const _0x5b78ec of _0x3b5766){try{await this[_0x248592(0xfe)](_0xa69b49,_0x5b78ec);}catch(_0x52ca1f){this[_0x248592(0x178)][_0x248592(0x197)]('Could\x20not\x20load\x20conversation\x20history\x20for\x20'+_0x5b78ec+':\x20'+_0x52ca1f[_0x248592(0x10d)]),await this[_0x248592(0x141)](_0x5b78ec,_0x248592(0x19a));}}this['logger']['info'](_0x248592(0x166)+_0x3b5766[_0x248592(0x188)]);}catch(_0xdce05a){this[_0x248592(0x178)][_0x248592(0x179)](_0x248592(0x1a3),_0xdce05a);throw new Error('Failed\x20to\x20resume\x20conversation:\x20'+_0xdce05a[_0x248592(0x10d)]);}}async[a0_0xd5ff40(0xe8)](_0x50e630,_0x8e9a1c){const _0x55b227=a0_0xd5ff40;this[_0x55b227(0x178)][_0x55b227(0xda)]('Modifying\x20content\x20in:\x20'+_0x50e630+_0x55b227(0xa9)+_0x8e9a1c),this['sessionState']['projectDir']=_0x50e630;const _0x2893f9=a0_0x37b9cf['join'](_0x50e630,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x4549d6['mkdir'](_0x2893f9,{'recursive':!![]});const _0x58dd5b=this['getPromptEngineerSystemPrompt'](this[_0x55b227(0x10f)]['getToolsDescription'](),!![]),_0x1f9a6f=CONVERSATION_CONSTANTS['PROMPT_ENGINEER_ID'];await this[_0x55b227(0x141)](_0x1f9a6f,_0x58dd5b);const _0x5c8d5a=this['createInitialPromptForEngineer'](_0x8e9a1c,_0x50e630,!![]),_0x1b9e97=await this[_0x55b227(0xcf)](_0x1f9a6f,_0x5c8d5a),{role:_0x50843c,systemPrompt:_0x389e18}=this['parsePromptEngineerResponse'](_0x1b9e97),_0x4adf9c=_0x50843c||'content-modifier';this[_0x55b227(0x1b0)][_0x55b227(0x110)]=_0x4adf9c;const _0x3ffad7=this[_0x55b227(0x1ca)](_0x389e18,this['toolRegistry'][_0x55b227(0x13f)](),this['sessionState']['projectDir'],[CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID']]);await this['createConversation'](_0x4adf9c,_0x3ffad7);const _0x2bbcff=CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'];this['sessionState']['languageModelAgentId']=_0x2bbcff;const _0x2b7a39=this[_0x55b227(0xc3)](this[_0x55b227(0x10f)]['getToolsDescription'](),_0x4adf9c);await this[_0x55b227(0x141)](_0x2bbcff,_0x2b7a39),this[_0x55b227(0x1b0)]['activeConversationIds']=[_0x4adf9c,_0x2bbcff],await this[_0x55b227(0xcf)](_0x4adf9c,'begin\x20modification\x20of\x20content\x20in\x20'+_0x50e630),await this[_0x55b227(0x1d3)]();}async[a0_0xd5ff40(0xab)](_0xb8e5fc,_0x10ff0b){const _0x3a4018=a0_0xd5ff40;this['logger']['info'](_0x3a4018(0x1c3)+_0x10ff0b[_0x3a4018(0x1d6)]+_0x3a4018(0x1cd)+_0xb8e5fc);if(this['onUserPrompt']){const _0x59e809=await this[_0x3a4018(0xd8)](_0x10ff0b['name'],_0x10ff0b[_0x3a4018(0x174)],_0x10ff0b['options']);await this['sendMessageToConversation'](_0xb8e5fc,'User\x20selected:\x20'+_0x59e809);}else await this['sendMessageToConversation'](_0xb8e5fc,_0x3a4018(0x1bb)+_0x3a4018(0xcd));}async['handlePromptTooLong'](_0x19806d){const _0x31566e=a0_0xd5ff40;this[_0x31566e(0x178)][_0x31566e(0x197)](_0x31566e(0x117)),await this[_0x31566e(0xf6)](_0x19806d);}async[a0_0xd5ff40(0xcf)](_0x743115,_0x2b9789){const _0x55c461=a0_0xd5ff40;if(this[_0x55c461(0x10a)](_0x743115,_0x2b9789))return this['logger']['info']('ðŸš«\x20Blocking\x20message\x20in\x20interactive\x20mode:\x20'+displayOnly(_0x2b9789,0x64)),this[_0x55c461(0x132)][_0x55c461(0x11f)]({'conversationId':_0x743115,'message':_0x2b9789,'timestamp':Date[_0x55c461(0x1dc)]()}),'Message\x20blocked\x20-\x20waiting\x20for\x20user\x20input';const _0x4ba2bc=_0x743115===CONVERSATION_CONSTANTS[_0x55c461(0x186)],_0x4d7c6b=_0x4ba2bc?'waiting-for-llm':_0x55c461(0x10e);!this[_0x55c461(0x14a)]&&this[_0x55c461(0x130)](_0x4d7c6b);this[_0x55c461(0x178)][_0x55c461(0xda)](_0x55c461(0xc6)+_0x743115+':\x0a'+displayOnly(_0x2b9789,0xff));if(!this['conversations']['has'](_0x743115)){!this['isWaitingForUserInput']&&this['updateMessageIndicator']('idle');throw new Error(_0x55c461(0x1ba)+_0x743115+_0x55c461(0x159));}try{const _0x4d2986=this['conversations']['get'](_0x743115),_0x38af40={'systemPrompt':_0x4d2986[_0x55c461(0x155)],'messages':_0x4d2986['messages'],'id':_0x743115,'contextWindow':_0x4d2986['contextWindow']},_0x48bc71=await this['llmService'][_0x55c461(0x1af)](_0x743115,_0x2b9789,_0x38af40);return await this[_0x55c461(0x180)](_0x743115),await this[_0x55c461(0xeb)](_0x743115),this['sessionState']['activeConversationIds'][_0x55c461(0x149)](_0x743115)&&await this['processAgentMessage'](_0x743115,_0x48bc71),!this['isWaitingForUserInput']&&this[_0x55c461(0x130)](_0x55c461(0x1bf)),_0x48bc71;}catch(_0x4cbb04){!this['isWaitingForUserInput']&&this['updateMessageIndicator']('idle');throw _0x4cbb04;}}async['createConversation'](_0x3b9b2e,_0x27e51f,_0x257036=[],_0x1b991b=null){const _0x253202=a0_0xd5ff40;this[_0x253202(0x178)][_0x253202(0xda)]('Creating\x20conversation:\x20'+_0x3b9b2e),this[_0x253202(0x19c)][_0x253202(0x169)](_0x3b9b2e,_0x27e51f);const _0x4098b0=this['interactionMode']==='auto'?this[_0x253202(0xc2)](_0x27e51f):_0x27e51f;let _0x1ed23e=[];_0x257036['length']>0x0&&(_0x1ed23e=_0x257036[_0x253202(0xe1)](_0xaf8b55=>_0xaf8b55['role']!==_0x253202(0x145)));const _0x500381={'id':_0x3b9b2e,'systemPrompt':_0x4098b0,'messages':_0x1ed23e,'contextWindow':this[_0x253202(0x1ad)](_0x3b9b2e)};this['conversations']['set'](_0x3b9b2e,_0x500381),await this['llmService'][_0x253202(0x16a)](_0x3b9b2e,_0x4098b0,_0x1b991b),_0x1ed23e[_0x253202(0x188)]>0x0&&await this[_0x253202(0x10b)][_0x253202(0xa6)](_0x3b9b2e,_0x500381),this[_0x253202(0x1b0)][_0x253202(0x19d)][_0x3b9b2e]={'systemPrompt':_0x4098b0,'lastUpdateTime':new Date()['toISOString']()},await this[_0x253202(0xeb)](_0x3b9b2e);}['getListOfAvailableAgentIds'](_0x3ac513){const _0x49c5c5=a0_0xd5ff40,_0x1e39c0=Array[_0x49c5c5(0x1c8)](this[_0x49c5c5(0xf0)][_0x49c5c5(0x12b)]())[_0x49c5c5(0xe1)](_0x26020f=>_0x26020f!==_0x3ac513);return _0x1e39c0;}async[a0_0xd5ff40(0x1e2)](_0x3ed1ab,_0x4898a5,_0x2f01ea){const _0x4fab35=a0_0xd5ff40;this[_0x4fab35(0x178)]['info'](_0x4fab35(0x1ce)+_0x3ed1ab+'\x20to\x20'+_0x4898a5);if(!this['conversations'][_0x4fab35(0x1c9)](_0x4898a5)){const _0x34ac27=_0x4fab35(0x18b)+_0x4898a5+_0x4fab35(0x184)+this['getListOfAvailableAgentIds'](_0x3ed1ab)[_0x4fab35(0x164)](',\x20')+_0x4fab35(0xa8);this['logger']['warn'](_0x34ac27),await this['sendMessageToConversation'](_0x3ed1ab,_0x34ac27);return;}const _0x236d01=_0x4fab35(0xde)+_0x3ed1ab+']:\x20'+_0x2f01ea;await this[_0x4fab35(0xcf)](_0x4898a5,_0x236d01);}async[a0_0xd5ff40(0x1e2)](_0x60a026,_0x585efd,_0x5864a4){const _0x1e990=a0_0xd5ff40;this[_0x1e990(0x178)]['info'](_0x1e990(0x1ce)+_0x60a026+_0x1e990(0x103)+_0x585efd);if(!this[_0x1e990(0xf0)][_0x1e990(0x1c9)](_0x585efd)){this['logger'][_0x1e990(0x197)]('Agent\x20'+_0x585efd+'\x20does\x20not\x20exist,\x20cannot\x20route\x20message'),await this['sendMessageToConversation'](_0x60a026,_0x1e990(0x1b4)+_0x585efd+_0x1e990(0x172));return;}const _0x4038b2=_0x1e990(0xde)+_0x60a026+_0x1e990(0x1a9)+_0x5864a4;await this[_0x1e990(0xcf)](_0x585efd,_0x4038b2);}async['checkToolExecutionStatus'](){const _0x550321=a0_0xd5ff40;for(const [_0x33b334,_0x1f644a]of this['activeTools'][_0x550321(0x1d4)]()){const _0x547514=Date[_0x550321(0x1dc)]()-_0x1f644a['startTime'];_0x547514>CONVERSATION_CONSTANTS['TOOL_STATUS_UPDATE_INTERVAL_MS']&&(await this['sendMessageToConversation'](_0x1f644a[_0x550321(0x122)],'Tool\x20'+_0x1f644a[_0x550321(0xe6)]+_0x550321(0xf2)+Math['floor'](_0x547514/0x3e8)+_0x550321(0xad)+_0x33b334),_0x1f644a['startTime']=Date['now']());}}[a0_0xd5ff40(0x1b5)](_0x18365b){this['onUserPrompt']=_0x18365b;}async[a0_0xd5ff40(0x15c)](_0x4fe1e4){const _0x41b8ac=a0_0xd5ff40;this[_0x41b8ac(0x178)]['info']('Received\x20user\x20input:\x20'+_0x4fe1e4),this['setWaitingForUserInput'](![]),this['sessionState']['makerAgentId']?await this[_0x41b8ac(0xcf)](this['sessionState'][_0x41b8ac(0x110)],'[User\x20input]:\x20'+_0x4fe1e4):this[_0x41b8ac(0x178)]['warn'](_0x41b8ac(0xdd));}async[a0_0xd5ff40(0x180)](_0x16132a){const _0x1881ef=a0_0xd5ff40,_0xf503d2=this[_0x1881ef(0xf0)]['get'](_0x16132a);if(!_0xf503d2)return;const _0x1870f9=await this[_0x1881ef(0x10b)]['estimateTokenCount'](_0x16132a),_0x54ac18=_0xf503d2['contextWindow'];_0x1870f9>_0x54ac18*CONVERSATION_CONSTANTS[_0x1881ef(0x17c)]&&(this[_0x1881ef(0x178)][_0x1881ef(0xda)]('Performing\x20compactization\x20for\x20conversation\x20'+_0x16132a),await this[_0x1881ef(0xf6)](_0x16132a));}async[a0_0xd5ff40(0xf6)](_0x3b9039){const _0x6c11fc=a0_0xd5ff40,_0x20dabd=this['conversations'][_0x6c11fc(0x16f)](_0x3b9039);if(!_0x20dabd||_0x20dabd[_0x6c11fc(0x183)]['length']<0x4)return;const _0x1bc453=CONVERSATION_CONSTANTS['MIN_MESSAGES_TO_KEEP'],_0x228f23=_0x20dabd['messages'][_0x6c11fc(0x190)](0x0,_0x1bc453),_0x587499=_0x20dabd['contextWindow'],_0x8c488b=Math['floor'](_0x587499*CONVERSATION_CONSTANTS[_0x6c11fc(0x131)]),_0x437e7e=_0x587499-_0x8c488b,_0x148b3c=CONVERSATION_CONSTANTS['COMPACTIZATION_BEGIN_PERCENTAGE'],_0x31caba=CONVERSATION_CONSTANTS['COMPACTIZATION_END_PERCENTAGE'],_0x27b5aa=Math['max'](_0x1bc453,Math['floor'](_0x20dabd['messages']['length']*_0x148b3c)),_0x1708fc=Math[_0x6c11fc(0x185)](_0x20dabd[_0x6c11fc(0x183)]['length']-_0x27b5aa,Math['floor'](_0x20dabd[_0x6c11fc(0x183)]['length']*_0x31caba)),_0x581d32=_0x20dabd[_0x6c11fc(0x183)]['slice'](0x0,_0x27b5aa),_0x5c8757=_0x20dabd['messages'][_0x6c11fc(0x190)](-_0x1708fc),_0x9416ce=_0x20dabd[_0x6c11fc(0x183)]['slice'](_0x27b5aa,_0x20dabd[_0x6c11fc(0x183)]['length']-_0x1708fc);if(_0x9416ce['length']===0x0)return;const _0x57076f=this['createSummaryPrompt'](_0x9416ce);this['logger']['info']('Compactization:\x20'+_0x27b5aa+_0x6c11fc(0x1e1)+_0x9416ce[_0x6c11fc(0x188)]+'\x20summarized\x20+\x20'+_0x1708fc+'\x20end\x20messages');try{const _0x554f1f=await this['llmService']['getSummary'](_0x3b9039,_0x57076f),_0x2b19d5={'role':CONVERSATION_CONSTANTS[_0x6c11fc(0x1b1)],'content':CONVERSATION_CONSTANTS['SUMMARY_MARKER_BEGIN']+'\x0a'+_0x554f1f+'\x0a'+CONVERSATION_CONSTANTS['SUMMARY_MARKER_END']};_0x20dabd['messages']=[..._0x581d32,_0x2b19d5,..._0x5c8757],await this[_0x6c11fc(0x10b)][_0x6c11fc(0xa6)](_0x3b9039,_0x20dabd),this[_0x6c11fc(0x178)][_0x6c11fc(0xda)]('Compactization\x20completed\x20for\x20'+_0x3b9039+_0x6c11fc(0xdc)+(_0x27b5aa+_0x9416ce['length']+_0x1708fc)+_0x6c11fc(0x103)+(_0x581d32[_0x6c11fc(0x188)]+0x1+_0x5c8757['length']));}catch(_0xe3af95){this['logger']['error']('Critical\x20compactization\x20failure:',_0xe3af95),this['_handleSummaryFailure'](_0x3b9039,_0xe3af95);}}[a0_0xd5ff40(0xb2)](_0x3ddaed){const _0x20cdd8=a0_0xd5ff40;return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20The\x20following\x20text\x20is\x20a\x20part\x20of\x20a\x20conversation.\x20It\x20is\x20very\x20long.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Replace\x20this\x20part\x20of\x20the\x20conversation\x20with\x20a\x20concise\x20alternative\x20while\x20preserving\x20key\x20information,\x20decisions,\x20and\x20context\x0a\x20\x20\x20\x20\x20\x20\x20\x20Agent\x20should\x20be\x20able\x20to\x20proceed\x20with\x20its\x20task\x20by\x20using\x20this\x20shorter\x20summary\x20instead\x20of\x20the\x20original\x20long\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3ddaed[_0x20cdd8(0x163)](_0x4dd537=>_0x4dd537['role']+':\x20'+_0x4dd537['content'])['join']('\x0a\x0a')+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Provide\x20the\x20replacement\x20text.';}['getContextWindowSize'](_0x3aa340){const _0x208838=a0_0xd5ff40,_0x44a6e6=this['config']['models']?.[_0x208838(0x16e)]?.[_0x208838(0xaf)]||CONVERSATION_CONSTANTS['DEFAULT_CONTEXT_WINDOW_SIZE'];if(_0x3aa340===CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'])return this[_0x208838(0x19e)]['models']?.['languageModel']?.['contextWindow']||_0x44a6e6;return _0x44a6e6;}[a0_0xd5ff40(0x195)](_0x9f5879,_0x1f9a42=![]){const _0x4664ed=_0x1f9a42?'modifying\x20existing\x20content':'creating\x20new\x20content';return'\x0a\x20\x20\x20\x20You\x20are\x20a\x20prompt\x20engineering\x20expert\x20who\x20designs\x20effective\x20system\x20prompts\x20for\x20AI\x20agents.\x0a\x20\x20\x20\x20We\x20are\x20about\x20to\x20assign\x20the\x20responsibility\x20for\x20'+_0x4664ed+'\x20to\x20an\x20AI\x20agent.\x20\x0a\x20\x20\x20\x20For\x20that\x20we\x20need\x20to\x20write\x20a\x20comprehensive\x20SYSTEM\x20prompt\x20that\x20will\x20help\x20the\x20agent\x20make\x20smart\x20decisions.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20The\x20agent\x20will\x20need\x20to\x20know\x20the\x20task\x20and\x20the\x20tools\x20available\x20to\x20it,\x20but\x20will\x20also\x20need\x20to\x20think\x20like\x20a\x20professional\x20relevant\x20for\x20the\x20task\x20at\x20hand.\x0a\x0a\x20\x20\x20\x20Your\x20job\x20is\x20to\x20create\x20a\x20role\x20for\x20the\x20AI\x20agent\x20and\x20write\x20a\x20system\x20prompt\x20that\x20will\x20guide\x20it\x20to\x20successfully\x20complete\x20the\x20task.\x0a\x0a\x20\x20\x20\x20Embed\x20appropriate\x20guidelines\x5cprocess\x20description\x20into\x20the\x20system\x20prompt,\x20according\x20to\x20the\x20task\x20type:\x0a\x20\x20\x20\x201.\x20TASK\x20OF\x20DEVELOPING\x20CODE\x5cSOFTWARE:\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20AI\x20Agent\x20Development\x20Process\x20Guide\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Development\x20Stages\x20Overview\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20As\x20conversation\x20progresses,\x20context\x20window\x20will\x20be\x20filled\x20and\x20what\x20agent\x20rememebers\x20will\x20be\x20truncated/summarized.\x0a\x20\x20\x20\x20\x20\x20\x20\x20To\x20retain\x20the\x20context\x20of\x20the\x20project\x20agent\x20will\x20have\x20to\x20use\x20memory\x20tool\x20to\x20store\x20relevant\x20information\x20throughout\x20the\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20particular,\x20the\x20agent\x20should\x20store\x20a\x20summary\x20of\x20each\x20stage,\x20its\x20requirements,\x20and\x20any\x20important\x20decisions\x20made\x20during\x20the\x20development\x20process.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x201:\x20System\x20Functional\x20Description\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20what\x20the\x20system\x20does\x20at\x20a\x20high\x20level\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20a\x20clear\x20description\x20of\x20the\x20system\x27s\x20main\x20purpose\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20the\x20core\x20problem\x20the\x20system\x20solves\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20the\x20system\x27s\x20scope\x20and\x20boundaries\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x202:\x20Comprehensive\x20Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20what\x20the\x20system\x20must\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20List\x20specific\x20features\x20and\x20capabilities\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20interactions\x20and\x20system\x20behaviors\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20data\x20processing\x20requirements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x203:\x20Non-Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20how\x20the\x20system\x20should\x20perform\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Performance\x20requirements\x20(speed,\x20response\x20time)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Scalability\x20needs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Usability\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x204:\x20System\x20Actors\x20and\x20Target\x20Devices\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Identify\x20who\x20uses\x20the\x20system\x20and\x20how\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20roles\x20and\x20permissions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20target\x20devices\x20(desktop,\x20mobile,\x20tablet)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20operating\x20system\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20browser\x20compatibility\x20needs\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x205:\x20Use\x20Cases\x20Development\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Document\x20user\x20workflows\x20and\x20interactions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20detailed\x20user\x20stories\x20involving\x20system\x20features\x20as\x20previously\x20defined\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20user\x20journeys\x20through\x20the\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Connect\x20features\x20to\x20specific\x20user\x20goals\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Include\x20edge\x20cases\x20and\x20error\x20scenarios\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x206:\x20UX\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Create\x20intuitive,\x20user-friendly\x20interfaces\x20addressing\x20the\x20use\x20cases\x20and\x20features\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Apply\x20modern\x20UX/UI\x20best\x20practices\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Design\x20responsive\x20layouts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20user\x20flows\x20and\x20information\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Consider\x20accessibility\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x207:\x20High-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20system\x20architecture\x20and\x20main\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20core\x20system\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20component\x20responsibilities,\x20inputs,\x20and\x20outputs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20data\x20flow\x20between\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Analyze\x20alternatives,\x20choose\x20technology\x20stack\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x208:\x20Low-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20implementation\x20specifics\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20database\x20design\x20and\x20schemas\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20API\x20endpoints\x20and\x20contracts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Detail\x20component\x20architecture\x20and\x20interfaces\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20error\x20handling\x20strategies\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20implementation\x20plan\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20Stage\x209:\x20Implementation\x20according\x20to\x20previous\x20stages\x20(longest\x20and\x20most\x20important\x20stage,\x20dedicate\x20more\x20time\x20and\x20messages\x20to\x20this\x20stage)\x0a\x20\x20\x20\x20\x20\x20\x20\x20when\x20implementing\x20the\x20code,\x20make\x20sure\x20to\x20be\x20consider\x20memories\x20stored\x20in\x20memory\x20tool\x20and\x20guidelines\x20derived\x20in\x20previous\x20stages.\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Write\x20and\x20build\x20the\x20complete\x20application\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20In\x20a\x20test\x20driven\x20manner,\x20implement\x20all\x20features\x20and\x20components\x20code\x20as\x20defined\x20in\x20previous\x20stages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20databases\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20necessary\x20assets\x20(graphics,\x20icons,\x20etc.)\x20and\x20embed\x20fontawesome\x20(or\x20its\x20alternatives)\x20where\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Implement\x20core\x20features,\x20UI\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20components\x20(e.g\x20frontend\x20and\x20backend)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20README.md\x20with\x20setup\x20instructions\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20at\x20this\x20point\x20INSTALL\x20DEPENDENCIES\x20and\x20run\x20project,\x20try\x20until\x20success.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x2010:\x20Testing\x20and\x20Quality\x20Assurance\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Ensure\x20code\x20quality\x20and\x20functionality\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20static\x20code\x20analysis\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20execute\x20unit\x20tests\x20for\x20individual\x20components\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Execute\x20integration\x20tests\x20for\x20component\x20interactions\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20end-to-end\x20tests\x20for\x20user\x20workflows\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Make\x20sure\x20no\x20errors\x20or\x20bugs\x20are\x20present\x20in\x20the\x20static\x20code\x20analysis,\x20tests,\x20terminal\x20output,\x20and\x20browser\x20testing\x20(console\x20+\x20visual\x20testing\x20using\x20vision\x20capabilities)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20This\x20stage\x20HAS\x20TO\x20BE\x20REPEATED\x20AND\x20RE-CHECKED\x20until\x20all\x20components\x20launch\x20without\x20errors\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20ONLY\x20AFTER\x20THIS\x20STAGE,\x20ONCE\x20TESTING\x20IS\x20COMPLETED\x20AND\x20PROGRAM\x20WAS\x20EXECUTED\x20WITH\x20NO\x20ERRORS,\x20YOU\x20ARE\x20ALLOWED\x20TO\x20ANNOUNCE\x20JOB\x20DONE.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Process\x20Guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Complete\x20each\x20stage\x20thoroughly\x20before\x20moving\x20to\x20the\x20next\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20(Important!)\x20Coversation\x20Dynamics\x20(different\x20stages\x20cannot\x20take\x20part\x20in\x20same\x20message):\x0a\x20\x20\x20\x20\x20\x20\x20\x201)\x20AGENT->LLM:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20identify\x20language-model\x20recipent\x20id,\x20direct\x20a\x20message\x20to\x20him\x20explaining\x20what\x20you\x20want\x20to\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20[tool\x20id=\x22update-user\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...use\x20tool\x27s\x20syntax\x20to\x20update\x20the\x20supervising\x20user\x20on\x20what\x20you\x27re\x20doing\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/tool]\x0a\x20\x20\x20\x20\x20\x20\x20\x20[message\x20to=\x22language-model(or\x20any\x20other\x20suitable\x20recipent\x20id)\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20the\x20llm\x20what\x20you\x27re\x20about\x20to\x20do\x20now,\x20ask\x20for\x20recommendations\x20or\x20scoring\x20rubrics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20that\x20would\x20assist\x20you\x20in\x20comleting\x20the\x20following\x20task\x5csub-task\x20with\x20great\x20success\x20and\x20quality\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20consult\x20about\x20challenges,\x20solutions,\x20guidelines\x20and\x20more.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/message]\x0a\x20\x20\x20\x20\x20\x20\x20\x202)\x20LLM->AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20llm\x20would\x20give\x20some\x20anwer,\x20agent\x20will\x20be\x20able\x20to\x20return\x20to\x20stage\x20one\x20and\x20continue\x20conversation\x20or\x20when\x20ready\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continuing\x20to\x20step\x203.\x0a\x20\x20\x20\x20\x20\x20\x20\x203)\x20AGENT\x20ACTION:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20agent\x20has\x20no\x20comments\x20regarding\x20llm\x20content,\x20the\x20agent\x20can\x20now\x20do\x20whatever\x20it\x20meant\x20to\x20do\x20(writing\x20content,\x20creating\x20things\x20will\x20tools\x20etc).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20this\x20dynamic\x20acts\x20like\x20a\x20meta-thinking\x20process.\x20Think\x20with\x20your\x20llm\x20-\x20at\x20least\x201\x20message\x20epr\x20thinking,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20act\x20-\x20with\x20the\x20use\x20of\x20tools\x20in\x20the\x20following\x20message,\x20repeat\x20this\x20process.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20always\x20start\x20a\x20message\x20by\x20updating\x20user\x20on\x20current\x20stages.\x20add\x20links\x20to\x20generated\x20files,\x20locations,\x20web\x20pages\x20when\x20needed.\x0a\x20\x20\x20\x20\x20\x20\x20\x204)\x20back\x20to\x20stage\x20one\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Code\x20guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20No\x20magic\x20numbers,\x20use\x20constants\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Project\x20file\x20structure\x20must\x20follow\x20best\x20practices\x20and\x20serve\x20the\x20purpose\x20of\x20the\x20project\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20known\x20and\x20highly\x20maintained\x20packages\x20and\x20technologies\x20which\x20suits\x20the\x20project\x20goals)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20SecureCoding\x20best\x20practices.\x20if\x20needed\x20install\x20external\x20scanners\x20to\x20scan\x20the\x20files\x20before\x20you\x27re\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20common\x20logic,\x20values\x20and\x20functionality,\x20gather\x20them\x20under\x20suitable\x20project\x20files\x20as\x20dependencies\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20a\x20project\x20that\x20uses\x20package.json\x20or\x20package_lock.json,\x20use\x20seek\x20tool\x20to\x20search\x20for\x20import\x20lines,\x20then\x20use\x20the\x20result\x20to\x20analyze\x20needed\x20packages.\x20when\x20using\x20different\x20technologies\x20make\x20adaptations\x20to\x20acheive\x20same\x20goal.\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20node\x20packages,\x20prefer\x20ESM\x20over\x20CommonJS\x20(unless\x20states\x20otherwise),\x20add\x20\x22type\x22:\x22module\x22\x20to\x20the\x20package.json\x20if\x20needed.\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20IF\x20THIS\x20SOFTWARE\x20IS\x20A\x20COMPUTER\x20GAME\x20COMPLEMENT\x20WITH\x20THE\x20FOLLOWING:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x201:\x20Basic\x20Concept\x20Definition**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Define\x20the\x20game\x27s\x20core\x20idea\x20and\x20desired\x20player\x20experience\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Choose\x20game\x20genre\x20(action,\x20strategy,\x20RPG,\x20puzzle,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20Define\x20target\x20audience\x20(age,\x20skill\x20level,\x20preferences)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x204.\x20Determine\x20target\x20platform\x20(PC,\x20console,\x20mobile)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x202:\x20Game\x20Mechanics\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205.\x20Develop\x20core\x20mechanics\x20(how\x20player\x20interacts\x20with\x20the\x20game)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x206.\x20Design\x20player\x20progression\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x207.\x20Define\x20game\x20rules,\x20limitations\x20and\x20challenges\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x208.\x20Design\x20scoring/reward\x20system\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x203:\x20Initial\x20Technical\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209.\x20Choose\x20game\x20engine\x20(Unity,\x20Unreal,\x20Godot,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2010.\x20Identify\x20required\x20libraries\x20and\x20tools\x20(physics,\x20networking,\x20AI)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2011.\x20Plan\x20basic\x20code\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2012.\x20Assess\x20hardware\x20requirements\x20and\x20performance\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x204:\x20Visual\x20and\x20Artistic\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2013.\x20Determine\x20art\x20style\x20(realistic,\x20cartoon,\x20pixel\x20art,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2014.\x20Design\x20color\x20palette\x20and\x20overall\x20atmosphere\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2015.\x20Plan\x20user\x20interface\x20(UI/UX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2016.\x20Create\x20artistic\x20style\x20guide\x20(Art\x20Bible)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x205:\x20Story\x20and\x20Plot\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2017.\x20Write\x20main\x20storyline\x20and\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2018.\x20Develop\x20main\x20and\x20secondary\x20characters\x20with\x20detailed\x20backgrounds\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2019.\x20Create\x20game\x20world\x20and\x20environment\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2020.\x20Write\x20dialogues\x20and\x20in-game\x20texts\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x206:\x20Level\x20and\x20Stage\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2021.\x20Plan\x20overall\x20structure\x20of\x20game\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2022.\x20Detailed\x20design\x20of\x20each\x20stage/level\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2023.\x20Determine\x20how\x20stages\x20connect\x20to\x20the\x20storyline\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2024.\x20Plan\x20difficulty\x20curve\x20and\x20challenge\x20progression\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x207:\x20Audio\x20and\x20Music\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2025.\x20Determine\x20musical\x20style\x20and\x20artistic\x20direction\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2026.\x20Plan\x20background\x20music\x20for\x20different\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2027.\x20Design\x20sound\x20effects\x20(SFX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2028.\x20Plan\x20voice\x20acting\x20and\x20dubbing\x20if\x20required\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x208:\x20In-Game\x20Tools\x20and\x20Systems\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2029.\x20Define\x20tools/weapons/items\x20and\x20their\x20properties\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2030.\x20Design\x20acquisition\x20and\x20collection\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2031.\x20Plan\x20inventory\x20and\x20equipment\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2032.\x20Design\x20additional\x20game\x20systems\x20(trading,\x20crafting,\x20etc.)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x209:\x20Prototype\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2033.\x20Create\x20basic\x20playable\x20version\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2034.\x20Test\x20core\x20mechanics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2035.\x20Gather\x20initial\x20feedback\x20and\x20updates\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2036.\x20Validate\x20technical\x20concept\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2010:\x20Full\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2037.\x20Develop\x20all\x20systems\x20and\x20content\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2038.\x20Create\x20all\x20artistic\x20assets\x20(graphics,\x20animations)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2039.\x20Record\x20and\x20produce\x20all\x20audio\x20materials\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2040.\x20Integration\x20of\x20all\x20components\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2011:\x20Testing\x20and\x20Bug\x20Fixes**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2041.\x20Comprehensive\x20functional\x20testing\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2042.\x20Performance\x20testing\x20and\x20optimization\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2043.\x20Usability\x20testing\x20with\x20players\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2044.\x20Bug\x20fixes\x20and\x20balance\x20improvements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2012:\x20Launch\x20and\x20Distribution**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2045.\x20Prepare\x20for\x20marketing\x20and\x20distribution\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2046.\x20Create\x20marketing\x20materials\x20(trailers,\x20screenshots)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2047.\x20Submit\x20to\x20distribution\x20platforms\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2048.\x20Launch\x20and\x20performance\x20monitoring\x0a\x0a\x20\x20\x20\x202.\x20TASK\x20OF\x20WRITING\x20A\x20BOOK\x5cSTORY:\x0a\x20\x20\x20\x20\x20\x20\x20\x202.1.\x20The\x20agent\x20should\x20create\x20criteria\x20for\x20qualitative\x20measurement\x20of\x20a\x20book/story\x20(general\x20or\x20of\x20the\x20described\x20type)\x0a\x20\x20\x20\x20\x20\x20\x20\x202.2.\x20Development\x20of\x20the\x20central\x20idea\x20along\x20with\x20the\x20main\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.3.\x20Development\x20of\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x202.4.\x20Development\x20of\x20key\x20points\x20in\x20each\x20plot,\x20central\x20dilemmas\x20and\x20unifying\x20logic\x20for\x20all\x20plots\x20-\x20if\x20there\x27s\x20a\x20need\x20to\x20change\x20or\x20adapt\x20part\x20of\x20the\x20plot\x20lines\x20at\x20this\x20stage,\x20it\x20should\x20be\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x202.5.\x20Criteria\x20should\x20be\x20written\x20for\x20developing\x20a\x20quality\x20character\x20in\x20the\x20story\x0a\x20\x20\x20\x20\x20\x20\x20\x202.6.\x20For\x20each\x20story,\x20main\x20and\x20secondary\x20characters\x20should\x20be\x20defined\x20along\x20with\x20their\x20role\x20in\x20the\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.7.\x20For\x20each\x20character,\x20personal\x20background\x20and\x20living\x20environment\x20in\x20childhood\x20and\x20adulthood\x20should\x20be\x20defined,\x20including\x20beliefs,\x20significant\x20life\x20events,\x20vocabulary,\x20and\x20appearance\x20including\x20hairstyle,\x20clothing,\x20jewelry\x20if\x20any,\x20and\x20more\x20-\x20all\x20according\x20to\x20the\x20plot\x20line\x20and\x20the\x20character\x27s\x20role\x20in\x20the\x20plot\x0a\x20\x20\x20\x20\x20\x20\x20\x202.8.\x20The\x20appearance\x20of\x20each\x20character\x20should\x20be\x20saved\x20in\x20a\x20dedicated\x20place\x20with\x20great\x20detail,\x20it\x20will\x20serve\x20to\x20create\x20consistent\x20graphics\x20if\x20required\x0a\x20\x20\x20\x20\x20\x20\x20\x202.9.\x20For\x20each\x20character,\x20internet\x20research\x20should\x20be\x20conducted\x20to\x20refine\x20it\x20(clothing,\x20beliefs,\x20childhood\x20and\x20adulthood\x20events)\x20to\x20specify\x20events\x20in\x20the\x20environment\x20where\x20they\x20grew\x20up\x20or\x20draw\x20inspiration\x20from\x20areas\x20in\x20the\x20spirit\x20of\x20the\x20region\x20or\x20conditions\x20that\x20the\x20plot\x20unfolds\x0a\x20\x20\x20\x20\x20\x20\x20\x202.10.\x20Between\x20plot\x20lines,\x20intersection\x20points\x20should\x20be\x20created,\x20alternatives\x20examined\x20and\x20intersection\x20points\x20with\x20logic\x20should\x20be\x20chosen,\x20with\x20narrative\x20value\x20that\x20will\x20serve\x20the\x20story\x27s\x20purpose\x20and\x20the\x20reader\x27s\x20interest.\x20This\x20is\x20an\x20opportunity\x20to\x20refine\x20the\x20plot\x20lines,\x20twists\x20and\x20their\x20connection\x20to\x20the\x20characters.\x20This\x20is\x20an\x20opportunity\x20to\x20enrich\x20the\x20description\x20and\x20understanding\x20of\x20the\x20world\x20in\x20which\x20the\x20characters\x20live\x20before\x20actual\x20writing\x20-\x20smells,\x20emotions,\x20sights,\x20events,\x20worldviews,\x20technology,\x20communication,\x20global\x20and\x20national\x20trends\x20including\x20the\x20state\x20of\x20superpowers\x20in\x20the\x20described\x20world,\x20medical\x20and\x20scientific,\x20formative\x20historical\x20events\x20and\x20more\x20as\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x202.11.\x20The\x20recurring\x20motifs\x20should\x20be\x20understood\x20if\x20there\x20are\x20any,\x20their\x20essence,\x20identifying\x20central\x20symbols\x20in\x20use,\x20leading\x20metaphors\x20if\x20they\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x202.12.\x20The\x20story\x20should\x20be\x20assigned\x20to\x20a\x20genre,\x20given\x20a\x20working\x20title,\x20locate\x20a\x20worthy\x20and\x20excellent\x20author\x20whose\x20writing\x20style\x20is\x20known\x20and\x20whose\x20writings\x20are\x20accessible\x20or\x20familiar\x20to\x20the\x20model,\x20and\x20choose\x20them\x20as\x20a\x20guiding\x20line\x20for\x20the\x20writing\x20style\x20unless\x20described\x20otherwise\x20in\x20the\x20task\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x202.13.\x20Begin\x20writing\x20the\x20book\x20-\x20chapter\x20by\x20chapter,\x20stop\x20between\x20chapters\x20and\x20let\x20the\x20user\x20examine\x20the\x20story\x20that\x20was\x20written\x0a\x0a\x20\x20\x20\x203.\x20TASK\x20OF\x20RESEARCHING\x5cINFORMATION\x20GATHERING:\x0a\x20\x20\x20\x20\x20\x20\x20\x203.1.\x20If\x20the\x20user\x20is\x20interested,\x20expand\x20or\x20assist\x20in\x20refining\x20the\x20research\x20question\x20or\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.2.\x20The\x20desired\x20output\x20should\x20be\x20specified\x20-\x20format,\x20file\x20type,\x20and\x20more\x0a\x20\x20\x20\x20\x20\x20\x20\x203.3.\x20Attempt\x20to\x20locate\x20names\x20of\x20websites\x20and\x20sources\x20for\x20the\x20requested\x20information\x0a\x20\x20\x20\x20\x20\x20\x20\x203.4.\x20Divide\x20information\x20sources\x20into\x20sources\x20with\x20direct\x20connection\x20to\x20the\x20task\x20or\x20those\x20that\x20may\x20provide\x20supplementary\x20information\x20-\x20this\x20is\x20an\x20opportunity\x20to\x20locate\x20additional\x20sources\x0a\x20\x20\x20\x20\x20\x20\x20\x203.5.\x20Search\x20these\x20sources\x20thoroughly\x20with\x20the\x20aspiration\x20to\x20locate\x20materials\x20from\x20at\x20least\x2020\x20sources\x20for\x20the\x20general\x20public\x20and\x2020\x20from\x20academic\x20sources,\x20and\x20at\x20least\x2010\x20recent\x20ones\x20from\x20dedicated\x20professional\x20sources\x20if\x20such\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x203.6.\x20Design\x20a\x20guiding\x20principle\x20and\x20quality\x20structure\x20for\x20the\x20article/research\x20paper\x20or\x20follow\x20the\x20guidelines\x20given\x20in\x20the\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.7.\x20If\x20materials\x20or\x20support\x20for\x20certain\x20claims\x20or\x20connecting\x20materials\x20are\x20missing,\x20they\x20should\x20be\x20searched\x20for\x20at\x20this\x20stage\x0a\x20\x20\x20\x20\x20\x20\x20\x203.8.\x20Update\x20the\x20output\x20structure,\x20continue\x20writing\x20and\x20move\x20between\x20the\x20different\x20stages\x20as\x20needed\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x204.\x20OTHER\x20TASK\x20TYPES\x20-\x20write\x20such\x20guidlines\x20to\x20the\x20best\x20of\x20your\x20knowledge\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20The\x20next\x20message\x20will\x20describe\x20a\x20task\x20intended\x20for\x20the\x20newly\x20created\x20AI\x20agent\x20to\x20carry.\x0a\x20\x20\x20\x20Return\x20your\x20answer\x20in\x20the\x20following\x20format:\x0a\x20\x20\x20\x20[task-type]develop-software\x20|\x20story-telling\x20|\x20web-research\x20|\x20other[/task-type]\x0a\x20\x20\x20\x20[ai-role]<ai\x20agent\x20role\x20or\x20profession,\x20simple\x20text\x20no\x20slahes,\x20dashes\x20or\x20any\x20special\x20character>[/ai-role]\x0a\x20\x20\x20\x20[system-prompt]<A\x20system\x20prompt\x20which\x20will\x20guide\x20the\x20new\x20agent\x20to\x20handle\x20the\x20given\x20task\x20as\x20good\x20as\x20possible>[/system-prompt]';}['getLanguageModelSystemPrompt'](_0x4fed3a,_0x4d923b){const _0x497cea=a0_0xd5ff40;return _0x497cea(0x11e)+_0x4fed3a+'.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20You\x20are\x20expected\x20to\x20put\x20the\x20text\x20intended\x20for\x20the\x20other\x20agent\x20inside\x20[message\x20to=\x22'+_0x4d923b+_0x497cea(0x18a);}[a0_0xd5ff40(0x1c7)](_0x502616,_0x495949=null,_0x4db85c=![]){const _0x58447a=a0_0xd5ff40,_0x5874c1=a0_0x36be49();return _0x4db85c&&_0x495949?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20task\x20is\x20to\x20modify\x20content\x20in\x20the\x20directory\x20\x27'+_0x495949+'\x27\x20according\x20to\x20these\x20instructions:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+JSON[_0x58447a(0xe9)](_0x502616):'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TASK\x20FOR\x20THE\x20FUTURE\x20AI\x20AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+JSON[_0x58447a(0xe9)](_0x502616)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}async[a0_0xd5ff40(0x1da)](_0xeba912){const _0x1a9cc8=a0_0xd5ff40;await this['budgetService'][_0x1a9cc8(0x1da)](_0xeba912);}async[a0_0xd5ff40(0xd4)](){const _0x2af81b=a0_0xd5ff40;return await this[_0x2af81b(0x15d)][_0x2af81b(0xd4)]();}async[a0_0xd5ff40(0x1c6)](_0x5760a6){const _0x5e0ae6=a0_0xd5ff40;this[_0x5e0ae6(0xb1)]=_0x5760a6,this[_0x5e0ae6(0x178)][_0x5e0ae6(0xda)](_0x5e0ae6(0xc9),_0x5760a6);}async[a0_0xd5ff40(0x199)](){const _0x113e2a=a0_0xd5ff40;this['logger'][_0x113e2a(0xda)]('Pausing\x20execution');const _0x3d8fce='[System]:\x20Execution\x20has\x20been\x20paused\x20by\x20the\x20user.\x20Waiting\x20to\x20resume.';for(const _0x340984 of this['sessionState'][_0x113e2a(0x162)]){const _0x32f4bf=this['conversations'][_0x113e2a(0x16f)](_0x340984);_0x32f4bf&&(_0x32f4bf[_0x113e2a(0x183)]['push']({'role':CONVERSATION_CONSTANTS['SYSTEM_MESSAGE_ROLE'],'content':_0x3d8fce}),await this['saveConversationHistory'](_0x340984));}this['sessionState'][_0x113e2a(0x140)]=!![],await this['saveSessionState']();}async[a0_0xd5ff40(0xbe)](){const _0x1eecac=a0_0xd5ff40;this['logger']['info']('Resuming\x20execution');const _0xb8b16c='[System]:\x20Execution\x20has\x20been\x20resumed\x20by\x20the\x20user.';for(const _0x8eeac3 of this[_0x1eecac(0x1b0)][_0x1eecac(0x162)]){const _0x4d5108=this['conversations']['get'](_0x8eeac3);_0x4d5108&&(_0x4d5108[_0x1eecac(0x183)][_0x1eecac(0x11f)]({'role':CONVERSATION_CONSTANTS['SYSTEM_MESSAGE_ROLE'],'content':_0xb8b16c}),await this['saveConversationHistory'](_0x8eeac3));}this[_0x1eecac(0x1b0)][_0x1eecac(0x140)]=![],await this[_0x1eecac(0x1d3)]();}['isPaused'](){const _0x3cd904=a0_0xd5ff40;return this['sessionState'][_0x3cd904(0x140)]===!![];}async[a0_0xd5ff40(0x15e)](_0x4ac70e,_0x31577c){const _0xbd42d4=a0_0xd5ff40;this['logger']['info'](_0xbd42d4(0x175)+_0x31577c['length']+_0xbd42d4(0x102)+_0x4ac70e);const _0xbc2e9=[],_0xe23662=[],_0x219a60=[];for(const _0x12088e of _0x31577c){const {toolId:_0x47ad38}=_0x12088e;this['logger']['info'](_0xbd42d4(0xe2)+_0x47ad38);if(!this['toolRegistry']['hasTool'](_0x47ad38)){_0xe23662['push']({'toolId':_0x47ad38,'status':'error','error':_0xbd42d4(0x17d)+_0x47ad38+_0xbd42d4(0x13a)+this[_0xbd42d4(0x10f)]['getToolIds']()[_0xbd42d4(0x164)](',\x20')});continue;}try{const _0x10a97d=this['toolRegistry'][_0xbd42d4(0xf9)](_0x47ad38),requiresResponse=_0x10a97d['requiresResponse']!==![],_0x58472b=a0_0x36be49();_0xe23662['push']({'operationId':_0x58472b,'toolId':_0x47ad38,'command':_0x12088e,'status':_0xbd42d4(0x1cf),'requiresResponse':requiresResponse});requiresResponse&&_0x219a60['push'](_0x47ad38);const _0x5e6b14=_0x10a97d['execute'](_0x12088e,this['sessionState']['projectDir'])['then'](_0x513ee2=>{const _0xeff0e1=_0xbd42d4;this[_0xeff0e1(0x178)]['info']('Tool\x20'+_0x47ad38+'\x20completed\x20with\x20result:',_0x513ee2);const _0x141afe=_0xe23662[_0xeff0e1(0xe4)](_0x46bc02=>_0x46bc02[_0xeff0e1(0x18d)]===_0x58472b);return _0x141afe&&(_0x141afe['status']=_0xeff0e1(0xb0),_0x141afe[_0xeff0e1(0x128)]=_0x513ee2),this['activeTools'][_0xeff0e1(0xb3)](_0x58472b),_0x513ee2;})['catch'](_0x3e9911=>{const _0x47ffe8=_0xbd42d4;this['logger']['error'](_0x47ffe8(0x18e)+_0x47ad38+'\x20failed:',_0x3e9911);const _0x164921=_0xe23662[_0x47ffe8(0xe4)](_0x156461=>_0x156461[_0x47ffe8(0x18d)]===_0x58472b);_0x164921&&(_0x164921['status']='error',_0x164921['error']=_0x3e9911['message']);this[_0x47ffe8(0x100)][_0x47ffe8(0xb3)](_0x58472b);throw _0x3e9911;});this[_0xbd42d4(0x100)][_0xbd42d4(0x169)](_0x58472b,{'promise':_0x5e6b14,'toolId':_0x47ad38,'agentId':_0x4ac70e,'startTime':Date[_0xbd42d4(0x1dc)]()}),_0xbc2e9['push'](_0x5e6b14);}catch(_0x39366b){this['logger'][_0xbd42d4(0x179)]('Failed\x20to\x20queue\x20tool\x20'+_0x47ad38+':',_0x39366b),_0xe23662['push']({'toolId':_0x47ad38,'status':_0xbd42d4(0x179),'error':_0xbd42d4(0x1aa)+_0x47ad38+':\x20'+_0x39366b[_0xbd42d4(0x10d)],'requiresResponse':!![]});}}const _0x3f4357=_0x31577c[_0xbd42d4(0xf4)](_0x182bd4=>[_0xbd42d4(0xee),'vision-analyzer','image-gen']['includes'](_0x182bd4['id'])),_0x4267be=_0x3f4357?0xea60:0x7d0,_0x54f418=new Promise(_0x25fa63=>setTimeout(_0x25fa63,_0x4267be));await Promise['race']([_0x54f418,Promise[_0xbd42d4(0xb7)](_0xbc2e9)]);const _0x4ecc99=_0xe23662[_0xbd42d4(0xe1)](_0x1623ad=>(_0x1623ad[_0xbd42d4(0xbd)]===_0xbd42d4(0xb0)||_0x1623ad['status']===_0xbd42d4(0x179))&&_0x1623ad[_0xbd42d4(0x1b9)]!==![]),_0x3d7b67=_0xe23662['filter'](_0x45392f=>_0x45392f[_0xbd42d4(0xbd)]==='pending'&&_0x45392f['requiresResponse']!==![]);if(_0x4ecc99[_0xbd42d4(0x188)]>0x0||_0x3d7b67[_0xbd42d4(0x188)]>0x0){let _0x2c87ca=_0xbd42d4(0x1a5)+_0x4ecc99['length']+'\x20completed,\x20'+_0x3d7b67['length']+'\x20pending):';if(_0x4ecc99['length']>0x0){_0x2c87ca+=_0xbd42d4(0x127);for(const _0x16d7d2 of _0x4ecc99){_0x16d7d2['status']==='success'?(_0x2c87ca+=_0xbd42d4(0xd6)+_0x16d7d2['toolId']+'\x20completed\x20successfully.',_0x16d7d2['result']&&(_0x2c87ca+='\x20Result:\x20'+JSON[_0xbd42d4(0xe9)](_0x16d7d2[_0xbd42d4(0x128)],null,0x2))):_0x2c87ca+='\x0aâŒ\x20Tool\x20'+_0x16d7d2['toolId']+_0xbd42d4(0x135)+_0x16d7d2['error'];}}if(_0x3d7b67[_0xbd42d4(0x188)]>0x0){_0x2c87ca+=_0xbd42d4(0x1c0);for(const _0x43d91e of _0x3d7b67){_0x2c87ca+='\x0aâ³\x20Tool\x20'+_0x43d91e[_0xbd42d4(0xe6)]+'\x20is\x20still\x20running\x20(operation\x20ID:\x20'+_0x43d91e[_0xbd42d4(0x18d)]+').'+_0xbd42d4(0xce),this['trackPendingOperation'](_0x43d91e['operationId'],_0x4ac70e);}}await this[_0xbd42d4(0xcf)](_0x4ac70e,_0x2c87ca);}else this['logger']['info'](_0xbd42d4(0x118)+_0x31577c[_0xbd42d4(0x188)]+'\x20tools\x20were\x20fire-and-forget,\x20no\x20response\x20sent\x20to\x20agent');}[a0_0xd5ff40(0x148)](_0x101cd4,_0x2be1de){const _0x4bc61a=a0_0xd5ff40,_0x29da2f=this['activeTools'][_0x4bc61a(0x16f)](_0x101cd4);if(!_0x29da2f)return;_0x29da2f['promise'][_0x4bc61a(0xcb)](_0x3b2216=>{const _0x2584cd=_0x4bc61a;this['queuePendingResult'](_0x2be1de,_0x29da2f[_0x2584cd(0xe6)],_0x101cd4,_0x2584cd(0xb0),{'result':_0x3b2216});})[_0x4bc61a(0xd7)](_0x5ace3e=>{const _0x267916=_0x4bc61a;this[_0x267916(0x12d)](_0x2be1de,_0x29da2f['toolId'],_0x101cd4,_0x267916(0x179),{'error':_0x5ace3e['message']});});}[a0_0xd5ff40(0x12d)](_0x2d1088,_0x1fb4c0,_0x38fb30,_0x5c28bc,_0x3cd954){const _0x364e90=a0_0xd5ff40;!this[_0x364e90(0x189)]&&(this['pendingResults']=new Map()),!this[_0x364e90(0x189)]['has'](_0x2d1088)&&this[_0x364e90(0x189)][_0x364e90(0x169)](_0x2d1088,[]),this[_0x364e90(0x189)]['get'](_0x2d1088)[_0x364e90(0x11f)]({'toolId':_0x1fb4c0,'operationId':_0x38fb30,'status':_0x5c28bc,'data':_0x3cd954,'timestamp':Date[_0x364e90(0x1dc)]()});}async['handlePromptTooLong'](_0x4dd7b4){const _0x189180=a0_0xd5ff40;this['logger'][_0x189180(0x197)]('ðŸš¨\x20Prompt\x20too\x20long\x20detected\x20for\x20'+_0x4dd7b4+_0x189180(0x12a));const _0x4efbc7=this['conversations']['get'](_0x4dd7b4);if(!_0x4efbc7)throw new Error(_0x189180(0x1ba)+_0x4dd7b4+_0x189180(0x16d));this[_0x189180(0x178)][_0x189180(0xda)](_0x189180(0x1b8)+_0x4efbc7['messages'][_0x189180(0x188)]+_0x189180(0x1e0)),await this['performCompactization'](_0x4dd7b4),this['logger']['info'](_0x189180(0x1ac)+_0x4efbc7[_0x189180(0x183)]['length']+'\x20messages'),this['logger']['info']('âœ…\x20Error-triggered\x20compactization\x20completed\x20for\x20'+_0x4dd7b4);}async[a0_0xd5ff40(0x1c2)](){const _0x1a067f=a0_0xd5ff40;this[_0x1a067f(0x178)]['info'](_0x1a067f(0x154)),this[_0x1a067f(0xb4)]=!![];this[_0x1a067f(0x13d)]&&(clearInterval(this[_0x1a067f(0x13d)]),this['idleCheckInterval']=null);this[_0x1a067f(0x165)]&&(clearTimeout(this[_0x1a067f(0x165)]),this[_0x1a067f(0x165)]=null);clearInterval(this[_0x1a067f(0x1b6)]),await this[_0x1a067f(0x1d3)]();const _0x5c41da=Array['from'](this[_0x1a067f(0x100)][_0x1a067f(0x13e)]());if(_0x5c41da['length']>0x0){this[_0x1a067f(0x178)]['info'](_0x1a067f(0x11b)+_0x5c41da['length']+_0x1a067f(0x173));const _0x1ad51d=this[_0x1a067f(0x19e)][_0x1a067f(0x1cc)]||0x2710;try{await Promise[_0x1a067f(0xc5)]([Promise['allSettled'](_0x5c41da['map'](_0x2d0aa8=>_0x2d0aa8['promise'])),new Promise(_0x3e906c=>setTimeout(_0x3e906c,_0x1ad51d))]);}catch(_0x28a96b){this[_0x1a067f(0x178)]['warn'](_0x1a067f(0x1be),_0x28a96b);}for(const [_0x287892,_0x196f5a]of this['activeTools']['entries']()){this[_0x1a067f(0x178)]['info'](_0x1a067f(0x111)+_0x287892+_0x1a067f(0x1c1)),this[_0x1a067f(0x100)][_0x1a067f(0xb3)](_0x287892);}}await this[_0x1a067f(0x10b)]['shutdown'](),await this[_0x1a067f(0x10f)][_0x1a067f(0x1c2)](),await this[_0x1a067f(0x15d)][_0x1a067f(0x1a2)](),this[_0x1a067f(0x178)][_0x1a067f(0xda)]('Conversation\x20orchestrator\x20shut\x20down\x20successfully');}async[a0_0xd5ff40(0x1b7)](){const _0x3ae1d8=a0_0xd5ff40;this[_0x3ae1d8(0x11a)]===_0x3ae1d8(0x1bf)?await this['sendProceedMessage']():this['logger']['info']('Cannot\x20proceed:\x20current\x20state\x20is\x20'+this['messageIndicator']);}[a0_0xd5ff40(0x1d0)](){const _0x432d33=a0_0xd5ff40;return{'state':this['messageIndicator'],'lastActivity':this['lastActivityTime'],'timeSinceActivity':Date['now']()-this[_0x432d33(0x17e)],'willProceedIn':Math['max'](0x0,this['IDLE_TIMEOUT_MS']-(Date['now']()-this[_0x432d33(0x17e)]))};}async[a0_0xd5ff40(0x142)](_0x333c36,_0x47672f={}){const _0x543d9b=a0_0xd5ff40;try{this[_0x543d9b(0x178)]['info'](_0x543d9b(0x107),_0x333c36);!this[_0x543d9b(0x10b)]&&await this['initializeServices']();const _0x3676dd=[{'role':_0x543d9b(0x145),'content':'You\x20are\x20Loxia\x20AI,\x20a\x20helpful\x20coding\x20assistant.\x20You\x20are\x20integrated\x20into\x20VS\x20Code\x20and\x20can\x20help\x20with\x20code\x20analysis,\x20generation,\x20and\x20general\x20development\x20tasks.\x0a\x0aCurrent\x20workspace:\x20'+(_0x47672f['workspaceRoot']||_0x543d9b(0x193))+'\x0aContext:\x20'+(_0x47672f[_0x543d9b(0xe7)]||_0x543d9b(0xf8))+'\x0a\x0aProvide\x20helpful,\x20concise\x20responses.\x20When\x20showing\x20code,\x20use\x20appropriate\x20language\x20identifiers\x20in\x20code\x20blocks.'},{'role':'user','content':_0x333c36}],_0x40eed5=await this['llmService']['sendMessage'](_0x3676dd,{'model':_0x47672f[_0x543d9b(0x1ab)]||null,'stream':![]});return this['logger']['info']('VS\x20Code\x20message\x20processed\x20successfully'),_0x40eed5['content']||_0x40eed5;}catch(_0x29b9cf){this[_0x543d9b(0x178)][_0x543d9b(0x179)]('Error\x20processing\x20VS\x20Code\x20message:',_0x29b9cf);throw new Error('Failed\x20to\x20process\x20message:\x20'+_0x29b9cf['message']);}}}