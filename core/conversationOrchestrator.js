const a0_0x455a35=a0_0xb999;(function(_0x35bae,_0x152341){const _0x56d2fc=a0_0xb999,_0xe23bc1=_0x35bae();while(!![]){try{const _0x1e9706=-parseInt(_0x56d2fc(0x1c9))/0x1*(-parseInt(_0x56d2fc(0x143))/0x2)+-parseInt(_0x56d2fc(0x1ae))/0x3*(parseInt(_0x56d2fc(0x186))/0x4)+-parseInt(_0x56d2fc(0x1a0))/0x5+parseInt(_0x56d2fc(0x155))/0x6+parseInt(_0x56d2fc(0x1cd))/0x7*(parseInt(_0x56d2fc(0x15b))/0x8)+parseInt(_0x56d2fc(0x177))/0x9*(-parseInt(_0x56d2fc(0x183))/0xa)+-parseInt(_0x56d2fc(0x12f))/0xb;if(_0x1e9706===_0x152341)break;else _0xe23bc1['push'](_0xe23bc1['shift']());}catch(_0xb8dbad){_0xe23bc1['push'](_0xe23bc1['shift']());}}}(a0_0x3d24,0xc672f));function a0_0x3d24(){const _0x5814f7=['yxv0BW','z2v0vg9VBa','D2fPDgLUzY1MB3iTBgXT','ndbzy1rsrha','cIaGica','ic0GCgvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBG','w1vZzxiGAw5WDxrDoIa','8j+AQcbqCM9TChqGDg9VigXVBMCGzgv0zwn0zwqGzM9Yia','BwvZC2fNzxm','cGO9psbdB21WBgv0zwqGt3bLCMf0Aw9UCYa9pq','ignVBxbSzxrLzcbZDwnJzxnZzNvSBhKU','icbHBMqGDgHLihn1Bw1HCNKGC2vYDMLJzsbPCYb1BMf2ywLSywjSzs4','C3rYAw5NAwz5','y29UDgv4DfDPBMrVDW','C2XPy2u','DhjHy2Tqzw5KAw5Nt3bLCMf0Aw9U','y3jLyxrLq29UDMvYC2f0Aw9U','CM9Szq','DxrMltG','u1rbvevFreLsx05btuu','u1Ltvevnx01fu1nbr0vFuK9mrq','C2vUzfbYB2nLzwrnzxnZywDL','w0zYB20G','CMvHzgrPCG','CMvHzezPBgu','8j+tPcbtzw5KAw5Nigf1Dg8TChjVy2vLzcbTzxnZywDLlI4U','qMvMB3jLignVBxbHy3rPEMf0Aw9UoIa','Bwf4','icHTB2rLoIa','ve9ptf9tvefuvvnFvvbeqvrfx0LovevsvKfmx01t','Dg9mB2nHBgvmB3DLCKnHC2u','ovHcywneAq','y3jLyxrLu3vTBwfYEvbYB21WDa','C2vZC2LVBLn0yxrL','ignVBxbSzxrLzcb3AxrOihjLC3vSDdO','yNvKz2v0u2vYDMLJzq','BgvUz3rO','ChjVBxb0','8j+uKYbjBNrLCMfJDgL2zsbTB2rLoIbszxn1BwLUzYbTzxnZywDLigzSB3C','zMLUza','C2vUzfvZzxjjBNb1Da','y2HLy2TbBMrqzxjMB3jTq29TCgfJDgL6yxrPB24','C2v0sw50zxjHy3rPB25nB2rL','otK4mJCWuwvesuTn','BMfTzq','rxjYB3iGC2vUzgLUzYbHDxrVlxbYB2nLzwqGBwvZC2fNztO','mJr1CNjTzfm','DxbKyxrLuhjVAMvJDerPCMvJDg9YEq','C2vUze1LC3nHz2u','ifjLC3vSDdOG','ChjVBwLZzq','ms4WlJa','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbPBML0AwfSAxPLzcb3AxrOihbYB2PLy3q6ia','DxnLCG','y29UDMvYC2f0Aw9UCW','yM9Sza','zxjYB3i','q291BgqGBM90igzPBMqGAgLZDg9YEsbMB3iG','B3jPz2LUywXtExn0zw1qCM9TChrZ','AwrSzvrPBwvY','cUkCHsbuB29Sia','y3LHBG','v2fPDgLUzYbMB3iG','rxjYB3iGC3rHCNrPBMCGBMv3ignVBNzLCNnHDgLVBJO','BwTKAxi','y3jLyxrLsw5PDgLHBfbYB21WDezVCKvUz2LUzwvY','C2v0u2vZC2LVBK92zxjYAwrLCW','ywXSu2v0DgXLza','y29UDMvYC2f0Aw9UswrnyxbWAw5N','y29UDMvYC2f0Aw9UsgLZDg9YEq','Dg9VBeLK','vg9VBca','nta3mta2meHKy1zzyG','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbZAhv0igrVD24GC3vJy2vZC2z1BgX5','y29UDgvUDc1TB2rPzMLLCG','q2fUBM90igrPC3bSyxKGChjVBxb0ihrVihvZzxi6ie5VihbYB21WDcbOyw5KBgvYigLZihjLz2LZDgvYzwqUia','ywn0AxzLvg9VBhm','teXnihnLCNzPy2uGy29UBMvJDgvKihrVihrVB2WGCMvNAxn0CNKGzM9YihzPC2LVBIbJyxbHyMLSAxrPzxm','ywn0AxzLq29UDMvYC2f0Aw9UswrZ','CMvWzwf0','Cgf1C2vK','ywnJzxnZ','igLZihn0AwXSihj1BM5PBMCGkg9WzxjHDgLVBIbjrdOG','B3jPz2LUywXfCNjVCG','u1vntufswv9nqvjlrvjFqKvhsu4','ugvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBIbMB3iGy29UDMvYC2f0Aw9Uia','nZe3ntrPAhDNrKW','xtOG','Dg9VBenVBw1HBMrZ','C2vZC2LVBK92zxjYAwrLCW','z2v0tgfUz3vHz2vnB2rLBfn5C3rLBvbYB21WDa','uMvJzwL2zwqGDxnLCIbPBNb1DdOG','ugXLyxnLihvZzsbBBwvZC2fNzsb0BZ0IlI4UiL0GDgfNCYb0BYbZzw5KigeGBwvZC2fNzsb0BYbHBM90AgvYigfNzw50lca','Bg9Nz2vY','q291BgqGBM90igXVywqGy29UDMvYC2f0Aw9UigHPC3rVCNKGzM9Yia','q29TCgfJDgL6yxrPB246ia','seLtve9swv9tvuzgsvG','w3rVB2XZlwnVBw1HBMrZxsb0ywDZihrVihvZzsb0B29SCYWGB3iGDgHLigzVBgXVD2LUzYbZEw50yxGGDg8GAw50zxjHy3qGD2L0Acb0AguGC3vWzxj2AxnPBMCGAhvTyw4GDxnLCJOGw3bYB21WDcbUyw1LpsjZB21LihbYB21WDcbKAxnWBgf5ihrPDgXLiL08ChjVBxb0ig1LC3nHz2u+w29WDgLVBL08B3b0Aw9UideGDgv4Dd5Bl29WDgLVBL0Gw29WDgLVBL08B3b0Aw9UidiGDgv4Dd5Bl29WDgLVBL0UlI5Bl3bYB21WDf0k','Dg9VBhmGyxzHAwXHyMXLigfYzq','AwrSzunOzwnRsw50zxj2ywW','uM91DgLUzYbTzxnZywDLigzYB20G','vxnLCIbZzwXLy3rLzdOG','w09Yy2HLC3rYyxrVCL0GtwvZC2fNAw5Nia','ig1LC3nHz2vZ','BwLU','lcbJCMvHDgLUzYbLBxb0EsbJB252zxjZyxrPB24','x2DLDezPBgvtywzLq29UDMvYC2f0Aw9Uswq','Dg9mB3DLCKnHC2u','icaYlIbpCIbZDgfYDcbHig5LDYbZzxnZAw9UigfZA2LUzYb0AguGywDLBNqGDg8Gy29UDgLUDwu6','ic0+ia','AwrSzq','B25kB2jeB25L','C2vTAs1HDxrV','mtn5AMrMBNi','zNjVBuvUDhjPzxm','qwDLBNqG','Aw5JBhvKzxm','odqZndaYuvbxu2Xs','8j+AQcbqCM9TChqGDg9VigXVBMCGzgv0zwn0zwqGzM9Yicr7y29UDMvYC2f0Aw9Uswr9ic0GCgvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBG','Dg9VBenOzwnRsw50zxj2ywW','zMLSDgvY','q2fUBM90ihnLBMqGBwvZC2fNzsb0BYa','icHMAwXLoIa','C2H1DgrVD24','z3jLzw4','sgfUzgXPBMCGDxnLCIbWCM9TChq6ia','tw9KAwz5Aw5NignVBNrLBNqGAw46ia','z2v0sw5KAwnHDg9YrgLZCgXHEq','CMvTB3zLuhjVBxb0u3LUDgf4rNjVBvn5C3rLBvbYB21WDa','Dw5RBM93BG','C2f2zunVBNzLCNnHDgLVBKHPC3rVCNK','tefor1vbr0vFtu9eruXFsuq','BwvZC2fNzuLUzgLJyxrVCG','EwvSBg93','ihrVB2XZihDLCMuGzMLYzs1HBMqTzM9Yz2v0lcbUBYbYzxnWB25ZzsbZzw50ihrVigfNzw50','C3LZDgvTuhjVBxb0','revgqvvmvf9dt05urvHux1DjtKrpv19tsvPf','CgvUzgLUzW','y29UDMvYC2f0Aw9UlwLUzgv4lMPZB24','C3rHDhvZ','B3bLCMf0Aw9Uswq','zMXVB3i','q09nuefdveLAqvrjt05Fru5ex1bfuKnftLrbr0u','igrVzxmGBM90igv4Axn0lcbJyw5UB3qGCM91DguGBwvZC2fNzq','BM93','tuLox01fu1nbr0vtx1rpx0Tfrva','Aw5PDgLHBgL6zvnLCNzPy2vZ','igzYB20GzMLSzsa','AgfUzgXLvxnLCLbYB21WDa','igzHAwXLzdOG','icaGicbSB3HPysbTB2rPzNKGlI95B3vYlxbYB2PLy3qGiMnVBNrPBNvLigrLDMvSB3bTzw50iG','A2v5CW','BwvZC2fNzq','CMvNAxn0zxjqCM9TChruB29mB25NsgfUzgXLCG','CgvYzM9YBunVBxbHy3rPEMf0Aw9U','ugXLyxnLigLTCgXLBwvUDcb0AguGB25vC2vYuhjVBxb0igHHBMrSzxiGAw4GDgHLienmss4','C3LZDgvT','D2HPDgu','z2v0q29UDgv4DfDPBMrVD1nPEMu','ihn1Bw1HCML6zwqGkYa','cUkpSYbuB29Sia','uMvZDg9YzwqG','ChjVy2vZC0fNzw50twvZC2fNzq','vg9VBcbLEgvJDxrPB24GCMvWB3j0icG','CYbLBgfWC2vKks4Gt3bLCMf0Aw9UieLeoIa','C2f2zvnLC3nPB25tDgf0zq','BgfUz3vHz2vnB2rLBefNzw50swq','DgHLBG','CgvUzgLUz1jLC3vSDhm','qvvutYbTB2rLoIbbDxrVlxnLBgvJDgvKici','q29TCgfJDgL6yxrPB24Gy29TCgXLDgvKigzVCIa','C2HVDwXKqMXVy2TnzxnZywDL','BgXTu2vYDMLJzq','vg9VBcaN','y2f0y2G','C3rYAw5N','zxHLy3v0zq','C2v0v2fPDgLUz0zVCLvZzxjjBNb1Da','vg8GCMuTzw5HyMXLlcbZD2L0y2GGDg8GAw50zxjHy3rPDMuGBw9KzsbVCIbTB2rPzNKGzw5Oyw5Jzvn5C3rLBvbYB21WDcGPicOV','iIbMB3iGChjVBxb0oIa','B3b0Aw9UCW','q2fUy2vSBgLUzYbVCgvYyxrPB24G','ihrVB2WGy29TBwfUzhmGzNjVBsa','uMvZDw1PBMCGy29UDMvYC2f0Aw9UigzYB206ia','u3rHCNrPBMCGBMv3ignVBNzLCNnHDgLVBIbMB3iGDgfZAZOG','zNjVBq','8j+uKIbjBNrLCMfJDgL2zsbTB2rLoIbcBg9JA2LUzYbHDxrVBwf0AwmGBwvZC2fNzxm','vw5YzwnVDMvYywjSzsbLCNjVCIbKDxjPBMCGy29UDMvYC2f0Aw9Uihn1Bw1HCNKUia','Aw50zxjHy3rPB25nB2rL','C2vUze1LC3nHz2vuB0nVBNzLCNnHDgLVBG','ufjptvbux0vor0Loruvsx0Le','ChjVy2vZC1rVB2XdB21Tyw5KCW','Dg9ju09tDhjPBMC','AgfUzgXLuhjVBxb0vg9Vtg9UzW','CgfYC2vnzxnZywDL','DxbKyxrLu3LZDgvTuhjVBxb0C0zVCK1Vzgu','AM9PBG','zgvSzxrL','jYbHy2nVCMrPBMCGDg8GDgHLC2uGAw5ZDhj1y3rPB25ZoGOGicaGicaGicaGica','CMvJAxbPzw50','z2v0vg9VBhnezxnJCMLWDgLVBG','CxvLDwvqzw5KAw5NuMvZDwX0','z2v0','AgfZ','z2v0u3vTBwfYEq','x3nHBML0AxPLq29UDMvYC2f0Aw9UswrgB3jgAwXL','z3jHEq','C2v0uhjVAMvJDerPCMvJDg9YEq','CgfYC2vqCM9TChrfBMDPBMvLCLjLC3bVBNnL','igrVzxmGBM90igv4Axn0','Dg9uAw1Lu3rYAw5N','DxbKyxrLq29UDMvYC2f0Aw9Uu3LZDgvTuhjVBxb0','sM9IigrVBMuGCMvJzwL2zwq6ia','BgfZDefJDgL2Axr5vgLTzq','AxntAhv0DgLUz0rVD24','q29UDgLUDwuGyxv0B21HDgLJywXSEq','u0vtu0LptL9tvefurv9gsuXftKfnrq','CMvZDwX0','CMvZDw1LrxHLy3v0Aw9U','twfWCgvKignVBNzLCNnHDgLVBIbjrcbMB3iGzMLSzsbVCgvYyxrPB25ZoIaI','Dhj5tg9HzenVBNzLCNnHDgLVBKHPC3rVCNLcEvbHDhrLCM4','D3jPDgvgAwXL','Cgf1C2vfEgvJDxrPB24','y29UzMLN','Dgv4Da','rMfPBgvKihrVihjLC3vTzsbJB252zxjZyxrPB246','B25vC2vYuhjVBxb0','Dg9VBfjLz2LZDhj5','C3rHCNruAw1L','qwXSia','C2v0','x2HHBMrSzvn1Bw1HCNLgywLSDxjL','qwz0zxiGy29TCgfJDgL6yxrPB246ia','DxnPBMCGDgHLifTTzxnZywDLxsb0ywCGD2L0Acb0AguGzM9SBg93Aw5NigLKCW','u1vntufswv9nqvjlrvjFru5e','cIaGicaGicaGicaGifrOzsb0yxnRigLZihrVig1VzgLMEsbJB250zw50igLUihrOzsbKAxjLy3rVCNKGjW','zxn0Aw1HDgvuB2TLBKnVDw50','lGOGicaGcIaGicaGicaGww91igfYzsbLEhbLy3rLzcb0BYbWDxqGDgHLihrLEhqGAw50zw5KzwqGzM9YihrOzsbVDgHLCIbHz2vUDcbPBNnPzguGw21LC3nHz2uGDg89iG','Aw5MBW','y2HLy2TuB29SrxHLy3v0Aw9Uu3rHDhvZ','rMfPBgvKihrVihf1zxvLihrVB2WG','cIbuAgLZihnLy3rPB24GD2LSBcbIzsbZzw50igfWyxj0igzYB20GDgHLihrVB2WGAw5ZDhj1y3rPB25ZlG','DgfNugfYC2vYu2vYDMLJzq','ChvZAa','AxnxywL0Aw5NrM9YvxnLCKLUChv0','u3vTBwfYEsbMywLSDxjLigrLDgfPBhm6','rMfPBgvKihrVihnHDMuGC2vZC2LVBIbZDgf0ztO','mtqYndq3mZz4sfb4zMq','ihbLBMrPBMCGB3bLCMf0Aw9UCYb0BYbJB21WBgv0zsbVCIb0Aw1LB3v0','Aw50zxjHy3rPDMu','w1n5C3rLBsbbDxrVlvjLC3bVBNnLxtOG','u2H1DhrPBMCGzg93BIbJB252zxjZyxrPB24GB3jJAgvZDhjHDg9Y','Bg9N','igvUzcbTzxnZywDLCW','C2v0qNvKz2v0tgLTAxq','z2v0sw1Hz2vezxnJCMLWDgLVBG','icbuAgLZignHBIbOyxbWzw4GD2HLBIb0AguGy29UDMvYC2f0Aw9UigjLy29TzxmGDg9VigXHCMDL','cGPzB3uGyxjLigv4CgvJDgvKihrVignVBNn1BhqGEw91CIbmte0GywDLBNqGDxnPBMCGDgHLifTTzxnZywDLxsb0ywCGD2L0Acb0AguGzM9SBg93Aw5NigLKCZOG','q291BgqGBM90ihjLywqVCgfYC2uG','Aw5PDgLHBgL6zq','ChjVAMvJDerPCG','D2fYBG','BwfRzxjbz2vUDeLK','ig5VDcbMB3vUzcbMB3iGy29TCgfJDgL6yxrPB24','rxjYB3iGD2fPDgLUzYbMB3iGCgvUzgLUzYbVCgvYyxrPB25Zigr1CMLUzYbZAhv0zg93BJO','8j+uHcbbDxrVlxbYB2nLzwrPBMCGywz0zxiGmYbZzwnVBMrZig9MigLKBguGDgLTzq','CMvK','mtKWmdm0u2vACujR','CMvWBgfJzq','DxbKyxrLtwvZC2fNzuLUzgLJyxrVCG','CM91DgvnzxnZywDLvg9bz2vUDa','C3vJy2vZCW','lIbnzxnZywDLCYbYzwr1y2vKigzYB20G','zw5Oyw5Jzvn5C3rLBvbYB21WDa','AgfUzgXLvxnLCLbYB21WDejHC2vKt25nB2rL','Bg9HzenVBNzLCNnHDgLVBKHPC3rVCNK','zw50CMLLCW','uxvLDwLUzYb0B29SoIa','tMv3ignVBNzLCNnHDgLVBIbZDgfYDgvKigfUzcbZzxnZAw9Uihn0yxrLihnHDMvK','CgfYC2u','lMXVEgLHlxn0yxrL','igzYB20G','ChjVBxb0lwvUz2LUzwvY','jYbUB3qGzM91BMqUief2ywLSywjSzsb0B29SCZOG','rM91BMqGyw5KigXVywrLzcbJB252zxjZyxrPB24GAgLZDg9YEsbMB3iG','ote2nJmXnhHdzwTKwa','zgvIDwC','z2v0uhjVBxb0rw5NAw5LzxjtExn0zw1qCM9TChq'];a0_0x3d24=function(){return _0x5814f7;};return a0_0x3d24();}import{TagParser}from'../utilities/tagParser.js';import{TagParserService}from'../services/tagParserService.js';import a0_0x1dc306 from'path';import{promises as a0_0x1b3aff}from'fs';function a0_0xb999(_0x24efad,_0x751a32){const _0x3d24a1=a0_0x3d24();return a0_0xb999=function(_0xb9999d,_0x392ef3){_0xb9999d=_0xb9999d-0xb1;let _0x308608=_0x3d24a1[_0xb9999d];if(a0_0xb999['dyOouY']===undefined){var _0x258f26=function(_0x1dc306){const _0x1b3aff='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3dc807='',_0x305d0c='';for(let _0x187ca7=0x0,_0x50c0aa,_0x2543b3,_0x28aea0=0x0;_0x2543b3=_0x1dc306['charAt'](_0x28aea0++);~_0x2543b3&&(_0x50c0aa=_0x187ca7%0x4?_0x50c0aa*0x40+_0x2543b3:_0x2543b3,_0x187ca7++%0x4)?_0x3dc807+=String['fromCharCode'](0xff&_0x50c0aa>>(-0x2*_0x187ca7&0x6)):0x0){_0x2543b3=_0x1b3aff['indexOf'](_0x2543b3);}for(let _0x3d1f8e=0x0,_0x3d17d4=_0x3dc807['length'];_0x3d1f8e<_0x3d17d4;_0x3d1f8e++){_0x305d0c+='%'+('00'+_0x3dc807['charCodeAt'](_0x3d1f8e)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x305d0c);};a0_0xb999['gJSOwo']=_0x258f26,_0x24efad=arguments,a0_0xb999['dyOouY']=!![];}const _0x2c9412=_0x3d24a1[0x0],_0x226abe=_0xb9999d+_0x2c9412,_0x202756=_0x24efad[_0x226abe];return!_0x202756?(_0x308608=a0_0xb999['gJSOwo'](_0x308608),_0x24efad[_0x226abe]=_0x308608):_0x308608=_0x202756,_0x308608;},a0_0xb999(_0x24efad,_0x751a32);}import{v4 as a0_0x3dc807}from'uuid';import{LLMService}from'../services/llmService.js';import{ToolRegistry}from'../services/toolRegistry.js';import{BudgetService}from'../services/budgetService.js';import{displayOnly}from'../utilities/stringOps.js';import a0_0x305d0c from'chalk';export const CONVERSATION_CONSTANTS={'STATE_DIR_NAME':a0_0x455a35(0x150),'SESSION_STATE_FILENAME':'session-state.json','INDEX_FILENAME':a0_0x455a35(0xc2),'LAST_SESSION_FILENAME':'last-session.json','HISTORY_SUFFIX':'-history.json','SYSTEM_MESSAGE_ROLE':'system','USER_MESSAGE_ROLE':a0_0x455a35(0x18d),'ASSISTANT_MESSAGE_ROLE':'assistant','COMPACTIZATION_THRESHOLD_PERCENTAGE':0.7,'COMPACTIZATION_OUTPUT_RESERVE_PERCENTAGE':0.4,'COMPACTIZATION_BEGIN_PERCENTAGE':0.15,'COMPACTIZATION_END_PERCENTAGE':0.35,'MIN_MESSAGES_TO_KEEP':0x2,'SUMMARY_MARKER_BEGIN':'--Conversation\x20Became\x20Long,\x20This\x20Part\x20Has\x20Been\x20Summarized--','SUMMARY_MARKER_END':'--End\x20of\x20Summary--','TOOL_CALL_FREQUENCY_CHECK_MS':0x2710,'TOOL_STATUS_UPDATE_INTERVAL_MS':0x2710,'DEFAULT_CONTEXT_WINDOW_SIZE':0x186a0,'MAKER_AGENT_DEFAULT_ID':'maker-agent','LANGUAGE_MODEL_ID':'language-model','PROMPT_ENGINEER_ID':a0_0x455a35(0x152)};export class ConversationOrchestrator{constructor(_0x187ca7,_0x50c0aa){const _0x3dc7af=a0_0x455a35;this[_0x3dc7af(0x117)]=_0x187ca7,this[_0x3dc7af(0x1b5)]=_0x50c0aa,this[_0x3dc7af(0x12a)]=new TagParserService(_0x50c0aa),this['llmService']=new LLMService(_0x187ca7,_0x50c0aa),this[_0x3dc7af(0xe4)][_0x3dc7af(0xd1)](_0x2543b3=>this['handlePromptTooLong'](_0x2543b3)),this['toolRegistry']=new ToolRegistry(_0x187ca7,_0x50c0aa,this['llmService']),this[_0x3dc7af(0x17b)]=new BudgetService(_0x187ca7,_0x50c0aa),this['conversations']=new Map(),this['activeTools']=new Map(),this[_0x3dc7af(0x19c)]=new Map(),this[_0x3dc7af(0xf4)]='interactive',this['originalSystemPrompts']=new Map(),this[_0x3dc7af(0x179)]={'projectDir':null,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{}},this[_0x3dc7af(0x1cf)]=setInterval(()=>this['checkToolExecutionStatus'](),CONVERSATION_CONSTANTS['TOOL_CALL_FREQUENCY_CHECK_MS']),this[_0x3dc7af(0xbc)]=_0x3dc7af(0x1c6),this['lastActivityTime']=Date[_0x3dc7af(0xc8)](),this[_0x3dc7af(0x193)]=null,this['IDLE_TIMEOUT_MS']=0x1388,this['isShuttingDown']=![],this['startIdleMonitoring']();}async['initializeWithProject'](_0x28aea0){const _0x421ba5=a0_0x455a35;this[_0x421ba5(0x179)]['projectDir']=_0x28aea0,this['toolRegistry']['setProjectDirectory'](_0x28aea0),this['logger']['info']('Conversation\x20orchestrator\x20initialized\x20with\x20project:\x20'+_0x28aea0);}async['initializeWithProject'](_0x3d1f8e){const _0x23b320=a0_0x455a35;this[_0x23b320(0x179)]['projectDir']=_0x3d1f8e,this[_0x23b320(0x11b)]['setProjectDirectory'](_0x3d1f8e),this[_0x23b320(0x1b5)]['info'](_0x23b320(0x18c)+_0x3d1f8e);}[a0_0x455a35(0x107)](_0x3d17d4){const _0x4b8f0f=a0_0x455a35;this[_0x4b8f0f(0x179)][_0x4b8f0f(0x13c)]=_0x3d17d4,this[_0x4b8f0f(0x11b)]&&this['toolRegistry']['setProjectDirectory'](_0x3d17d4),this['logger'][_0x4b8f0f(0x126)]('Updated\x20conversation\x20orchestrator\x20project\x20directory:\x20'+_0x3d17d4);}async[a0_0x455a35(0x13b)](){const _0x38c94a=a0_0x455a35;this[_0x38c94a(0x11b)]=new ToolRegistry(this[_0x38c94a(0x117)],this[_0x38c94a(0x1b5)]),await this[_0x38c94a(0x11b)]['registerBuiltInTools']();}[a0_0x455a35(0x187)](_0x45a597){const _0x333fb5=a0_0x455a35;this[_0x333fb5(0x107)](_0x45a597);}['startIdleMonitoring'](){const _0x25dc2b=a0_0x455a35;this[_0x25dc2b(0x1bb)]=setInterval(()=>{const _0x40410e=_0x25dc2b;if(this['isShuttingDown'])return;if(this[_0x40410e(0xf4)]==='interactive')return;const _0x596e32=Date[_0x40410e(0xc8)](),_0x5e1986=_0x596e32-this['lastActivityTime'];this['messageIndicator']===_0x40410e(0x1c6)&&_0x5e1986>=this['IDLE_TIMEOUT_MS']&&this[_0x40410e(0x179)]['makerAgentId']&&(this['logger']['info'](_0x40410e(0x141)),this[_0x40410e(0x16d)]());},0x1f4);}['setWaitingForUserInput'](_0x5ef196){const _0x44c5d3=a0_0x455a35,_0x1e95eb=this['isWaitingForUserInput'];this[_0x44c5d3(0x12c)]=_0x5ef196;if(_0x5ef196&&!_0x1e95eb)console['log'](a0_0x305d0c[_0x44c5d3(0x195)](_0x44c5d3(0xf2)));else!_0x5ef196&&_0x1e95eb&&(console[_0x44c5d3(0x134)](a0_0x305d0c[_0x44c5d3(0xb4)](_0x44c5d3(0x17e))),this['blockedMessages']=[]);}['shouldBlockMessage'](_0x442027,_0x28b53c){const _0x17712e=a0_0x455a35;if(this[_0x17712e(0xf4)]!==_0x17712e(0x131)||!this[_0x17712e(0x12c)])return![];if(_0x28b53c[_0x17712e(0x1cc)]('[User\x20input]:'))return![];if(_0x28b53c[_0x17712e(0x1cc)]('(system\x20message)'))return![];return!![];}[a0_0x455a35(0x145)](_0x3d5916){const _0x4585bf=a0_0x455a35,_0x123f94=this[_0x4585bf(0xbc)];this[_0x4585bf(0xbc)]=_0x3d5916,this[_0x4585bf(0x10d)]=Date[_0x4585bf(0xc8)]();this[_0x4585bf(0x193)]&&(clearTimeout(this['idleTimer']),this['idleTimer']=null);if(_0x123f94!==_0x3d5916){const _0x1cbbb0=this['getIndicatorDisplay'](_0x3d5916);console[_0x4585bf(0x134)](a0_0x305d0c[_0x4585bf(0x106)](_0x1cbbb0+'\x20'+_0x3d5916));}}[a0_0x455a35(0xb7)](_0xf9af60){const _0x47c8fb=a0_0x455a35;switch(_0xf9af60){case'waiting-for-agent':return a0_0x305d0c[_0x47c8fb(0xbd)]('‚è≥');case'waiting-for-llm':return a0_0x305d0c['blue']('ü§ñ');case _0x47c8fb(0x1c6):return a0_0x305d0c[_0x47c8fb(0xb4)]('‚úì');default:return'‚Ä¢';}}async['sendProceedMessage'](){const _0x531554=a0_0x455a35;if(!this[_0x531554(0x179)]['makerAgentId']||this['isShuttingDown'])return;try{this[_0x531554(0x145)]('waiting-for-agent'),console['log'](a0_0x305d0c['gray'](_0x531554(0x171)));const _0x887a3a=new Date()[_0x531554(0x10a)]()['split']('\x20')[0x0];await this['sendMessageToConversation'](this['sessionState']['makerAgentId'],'('+_0x887a3a+'\x20system\x20message:)\x20proceed.\x20If\x20stuck\x20for\x20too\x20long\x20use\x20tools\x20or\x20perform\x20operations\x20to\x20effectively\x20continue\x20the\x20task.');}catch(_0x2d18d2){this['logger']['error'](_0x531554(0x185),_0x2d18d2),this[_0x531554(0x145)]('idle');}}[a0_0x455a35(0x182)](_0x37e117){const _0x2f0c74=a0_0x455a35,_0xeb4b3b=this['interactionMode'];this['interactionMode']=_0x37e117,this[_0x2f0c74(0x1b5)][_0x2f0c74(0x126)]('Interaction\x20mode\x20changed:\x20'+_0xeb4b3b+_0x2f0c74(0x1c5)+_0x37e117);if(_0x37e117===_0x2f0c74(0x131)&&_0xeb4b3b!=='interactive')this['setWaitingForUserInput'](!![]);else _0x37e117!==_0x2f0c74(0x131)&&_0xeb4b3b===_0x2f0c74(0x131)&&this['setWaitingForUserInput'](![]);this['updateSystemPromptsForMode'](_0x37e117);}['getBlockingStatus'](){const _0x25ad4a=a0_0x455a35;return{'interactionMode':this[_0x25ad4a(0xf4)],'isWaitingForUserInput':this['isWaitingForUserInput'],'blockedMessagesCount':this['blockedMessages'][_0x25ad4a(0x17c)],'indicatorState':this['messageIndicator']};}[a0_0x455a35(0xfb)](_0x2d8496){for(const [_0x46b260,_0x1d986f]of this['conversations']){this['updateConversationSystemPrompt'](_0x46b260,_0x2d8496);}}['updateConversationSystemPrompt'](_0x136edd,_0x1c9699){const _0x46caf8=a0_0x455a35,_0x37298e=this['conversations'][_0x46caf8(0x102)](_0x136edd);if(!_0x37298e)return;!this[_0x46caf8(0x192)]['has'](_0x136edd)&&this['originalSystemPrompts'][_0x46caf8(0x11e)](_0x136edd,_0x37298e['systemPrompt']);const _0x14c53e=this['originalSystemPrompts']['get'](_0x136edd);let _0x314630;_0x1c9699==='auto'?_0x314630=this['removePromptSyntaxFromSystemPrompt'](_0x14c53e):_0x314630=_0x14c53e,_0x37298e[_0x46caf8(0xbf)]=_0x314630,this['llmService']&&this['llmService'][_0x46caf8(0x10b)]&&this[_0x46caf8(0xe4)][_0x46caf8(0x10b)](_0x136edd,_0x314630),this[_0x46caf8(0x1b5)][_0x46caf8(0x156)]('Updated\x20system\x20prompt\x20for\x20'+_0x136edd+'\x20(mode:\x20'+_0x1c9699+')');}['removePromptSyntaxFromSystemPrompt'](_0x560f70){const _0x20b4e1=a0_0x455a35;let _0x408d8b=_0x560f70[_0x20b4e1(0x144)](/5\.\s*If you need user input or a decision[^6]*/,'5.\x20[USER\x20PROMPTS\x20DISABLED\x20IN\x20AUTO\x20MODE]\x20');return _0x408d8b=_0x408d8b[_0x20b4e1(0x144)](/\[prompt[^\]]*\][^[]*\[\/prompt\]/g,''),_0x408d8b+='\x0a\x0a/*\x20NOTE:\x20Prompt\x20syntax\x20removed\x20for\x20auto\x20mode.\x20'+_0x20b4e1(0xea),_0x408d8b;}[a0_0x455a35(0x149)](_0x33dea5,_0x31640b,_0x41bb1a,_0x54e285){const _0x873099=a0_0x455a35;let _0x26d01f=_0x33dea5;return!_0x26d01f[_0x873099(0x176)]()['includes'](_0x873099(0x1ba))&&(_0x26d01f+='\x0a\x0aTools\x20available\x20are:\x0a'+_0x31640b),!_0x26d01f[_0x873099(0x176)]()[_0x873099(0x1cc)](_0x873099(0x121))&&(_0x26d01f+=_0x873099(0x139)+_0x54e285['join'](',\x20')+_0x873099(0x129)),!_0x26d01f[_0x873099(0x1cc)]('conversation\x20rules\x20are')&&(_0x26d01f+='\x0a\x0aConversation\x20rules\x20are:\x0a\x20\x20\x20\x201.\x20When\x20sending\x20a\x20message\x20to\x20another\x20participant,\x20use\x20[message\x20to=\x22participant_id\x22]\x20format\x0a\x20\x20\x20\x202.\x20When\x20using\x20tools,\x20wrap\x20commands\x20in\x20[tools-commands]\x20and\x20[/tools-commands]\x20tags\x0a\x20\x20\x20\x203.\x20Each\x20tool\x20command\x20should\x20be\x20wrapped\x20in\x20[tool\x20id=\x22tool_id\x22]\x20and\x20[/tool]\x20tags\x0a\x20\x20\x20\x204.\x20You\x20must\x20follow\x20the\x20specific\x20format\x20for\x20each\x20tool\x20as\x20described\x20in\x20the\x20tools\x20section\x0a\x20\x20\x20\x205.\x20If\x20you\x20need\x20user\x20input\x20or\x20a\x20decision,\x20use\x20the\x20[prompt]\x20format(NOTICE:\x20at\x20least\x202\x20option\x20tags\x20are\x20recommended):\x20[prompt\x20name=\x22prompt\x20display\x20title\x22]the\x20message\x20the\x20user\x20will\x20see[option]option\x201\x20text[/option]\x20[option]option\x202\x20text[/option]...more\x20options\x20if\x20needed...[/prompt]\x0a\x20\x20\x20\x206.\x20when\x20you\x20have\x20finished\x20your\x20task\x20including\x20verification\x20and\x20validation\x20of\x20actual\x20content\x20as\x20written\x20on\x20disk\x20as\x20compareed\x20to\x20derived\x20specs,\x20or\x20you\x27re\x20not\x20getting\x20any\x20progress\x20use\x20the\x20[job-done]<your\x20message>[/job-done]\x20special\x20instruction\x20tag.\x20preferrably\x20in\x20its\x20own\x20message\x20(no\x20other\x20instructions).\x0a\x20\x20\x20\x207.\x20never\x20announce\x20job-done\x20before\x20you\x20have\x20completed\x20all\x20stages\x20of\x20the\x20development\x20process,\x20tested\x20and\x20re-validated\x20your\x20solution\x20by\x20observing\x20the\x20created\x20files\x20and\x20artifacts.\x0a\x20\x20\x20\x20Your\x20Project\x20Root\x20Directory\x20Is:\x20'+_0x41bb1a+_0x873099(0x15c)),_0x26d01f;}['_sanitizeConversationIdForFile'](_0x2e4ff2){const _0x4ce58f=a0_0x455a35;if(!_0x2e4ff2||typeof _0x2e4ff2!==_0x4ce58f(0xe7))return'conversation-'+Date['now']();let _0x2dbaa2=_0x2e4ff2[_0x4ce58f(0x144)](/\s+/g,'-')['replace'](/[^a-zA-Z0-9_-]/g,'')[_0x4ce58f(0x144)](/-+/g,'-')['replace'](/^-+|-+$/g,'')[_0x4ce58f(0x1c3)]();if(!_0x2dbaa2)_0x2dbaa2='conversation-'+Date[_0x4ce58f(0xc8)]();else _0x2dbaa2['length']>0x32&&(_0x2dbaa2=_0x2dbaa2['substring'](0x0,0x28)+'-'+Date['now']()['toString']()[_0x4ce58f(0x166)](-0x8));return _0x2dbaa2;}['_getFileSafeConversationId'](_0x26724b){const _0x50e7aa=a0_0x455a35;if(this['conversationIdMapping'][_0x50e7aa(0x103)](_0x26724b))return this['conversationIdMapping']['get'](_0x26724b);const _0x3908af=this[_0x50e7aa(0x105)](_0x26724b);return this['conversationIdMapping']['set'](_0x26724b,_0x3908af),_0x3908af!==_0x26724b&&this['logger']['info'](_0x50e7aa(0x113)+_0x26724b+'\x22\x20->\x20\x22'+_0x3908af+'\x22'),_0x3908af;}async[a0_0x455a35(0xca)](){const _0x5ebf97=a0_0x455a35;this['llmService']&&this[_0x5ebf97(0x11b)]&&(this[_0x5ebf97(0x11b)]['setLLMService'](this['llmService']),this[_0x5ebf97(0x1b5)]['info'](_0x5ebf97(0x1a5)));}async['getImageDescription'](_0x47dbd9,_0x1e6690,_0x359d55={}){const _0x21f4a5=a0_0x455a35;if(!this['llmService'])throw new Error('LLM\x20service\x20not\x20available\x20for\x20image\x20description');return await this['llmService'][_0x21f4a5(0x137)](_0x47dbd9,_0x1e6690,_0x359d55);}async[a0_0x455a35(0x14a)](_0x150951,_0x3987d7){const _0x228aed=a0_0x455a35;this[_0x228aed(0x1b5)]['info'](_0x228aed(0xb5)+_0x3987d7['name']+_0x228aed(0x151)+_0x150951+_0x228aed(0x174)+this[_0x228aed(0xf4)]+')');switch(this[_0x228aed(0xf4)]){case'auto':const _0x5696ac=_0x3987d7['options']&&_0x3987d7['options'][_0x228aed(0x17c)]>0x0?_0x3987d7[_0x228aed(0xec)][0x0]:_0x228aed(0x10f);this[_0x228aed(0x1b5)][_0x228aed(0x126)](_0x228aed(0xe1)+_0x5696ac+_0x228aed(0xeb)+_0x3987d7[_0x228aed(0x184)]),await this[_0x228aed(0xf5)](_0x150951,_0x228aed(0x132)+_0x5696ac);break;case _0x228aed(0x1c8):if(this['onUserPrompt']){const _0x5772c7=await this['onUserPrompt'](_0x3987d7['name'],_0x3987d7['text'],_0x3987d7[_0x228aed(0xec)]);await this[_0x228aed(0xf5)](_0x150951,'User\x20selected:\x20'+_0x5772c7);}else await this[_0x228aed(0xf5)](_0x150951,'Cannot\x20display\x20prompt\x20to\x20user:\x20No\x20prompt\x20handler\x20is\x20registered.\x20'+_0x228aed(0xd3));break;case'interactive':default:if(this['onUserPrompt']){const _0x2b35ad=await this[_0x228aed(0x11a)](_0x3987d7['name'],_0x3987d7['text'],_0x3987d7[_0x228aed(0xec)]);await this['sendMessageToConversation'](_0x150951,_0x228aed(0x1bd)+_0x2b35ad);}else await this[_0x228aed(0xf5)](_0x150951,'Cannot\x20display\x20prompt\x20to\x20user:\x20No\x20prompt\x20handler\x20is\x20registered.\x20'+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');break;}}async['handleJobDoneBasedOnMode'](_0x29a87f){const _0x174a62=a0_0x455a35;this['logger'][_0x174a62(0x126)](_0x174a62(0x10c)+_0x29a87f+'\x20(mode:\x20'+this[_0x174a62(0xf4)]+')');if(this['onJobDone'])await this['onJobDone'](_0x29a87f);else switch(this['interactionMode']){case _0x174a62(0x158):this[_0x174a62(0x1b5)][_0x174a62(0x126)](_0x29a87f+'\x0aThank\x20you\x20for\x20choosing\x20Loxia.'),process['exit'](0x0);break;case _0x174a62(0x1c8):this['logger']['info']('Job\x20completed:\x20'+_0x29a87f),this['logger'][_0x174a62(0x126)]('SEMI-AUTO\x20mode:\x20Task\x20completed.\x20Press\x20Ctrl+I\x20to\x20enter\x20interactive\x20mode\x20or\x20exit.');break;case _0x174a62(0x131):default:this['logger'][_0x174a62(0x126)]('Job\x20completed:\x20'+_0x29a87f);break;}}['registerJobDoneHandler'](_0x5973d1){const _0x3c9ce0=a0_0x455a35;this[_0x3c9ce0(0x1c7)]=_0x5973d1;}async['processAgentMessage'](_0x7197e0,_0x2429c0){const _0x552d8e=a0_0x455a35;this['logger']['info']('Processing\x20message\x20from\x20'+_0x7197e0);const _0x17601a=this[_0x552d8e(0x12a)][_0x552d8e(0xfa)](_0x2429c0);_0x17601a['toolCommands']&&_0x17601a['toolCommands']['length']>0x0&&await this['processToolCommands'](_0x7197e0,_0x17601a[_0x552d8e(0x1b0)]);_0x17601a['prompt']&&await this['handleUserPromptBasedOnMode'](_0x7197e0,_0x17601a[_0x552d8e(0x17d)]);if(_0x17601a['jobDone']!=null){await this['handleJobDoneBasedOnMode'](_0x17601a['jobDone']);return;}if(_0x17601a['recipient']){const _0x56c380=_0x17601a['recipient'],_0x533ec7=_0x17601a['content'];await this[_0x552d8e(0x146)](_0x7197e0,_0x56c380,_0x533ec7),this[_0x552d8e(0x1b5)]['info']('['+displayOnly(_0x7197e0,0xa)+'\x20->\x20'+displayOnly(_0x56c380,0xa)+_0x552d8e(0x1af)+displayOnly(_0x533ec7,0xff)+'\x0a');}!_0x17601a[_0x552d8e(0xff)]&&(!_0x17601a[_0x552d8e(0x1b0)]||_0x17601a[_0x552d8e(0x1b0)][_0x552d8e(0x17c)]===0x0)&&!_0x17601a['prompt']&&!_0x17601a['jobDone']&&await this['sendMessageToConversation'](_0x7197e0,'Your\x20message\x20didn\x27t\x20contain\x20any\x20tool\x20commands,\x20a\x20message\x20to\x20another\x20agent,\x20or\x20a\x20prompt.\x20'+_0x552d8e(0x1b4)+_0x552d8e(0x1b9));}[a0_0x455a35(0x108)](_0xa8432a){const _0x43f3d8=a0_0x455a35,_0x25d6e7=CONVERSATION_CONSTANTS['MAKER_AGENT_DEFAULT_ID'],_0x29e5ed='You\x20are\x20an\x20AI\x20assistant\x20tasked\x20with\x20completing\x20the\x20following:\x20';try{const _0x29360b=TagParser['extractStructured'](_0xa8432a,{'role':'ai-role','systemPrompt':'system-prompt'});let _0x520c4d=_0x29360b[_0x43f3d8(0x169)];_0x520c4d?_0x520c4d=_0x520c4d[_0x43f3d8(0x144)](/[\\/]/g,''):(_0x520c4d=_0x25d6e7,this['logger']['warn']('Failed to parse role from prompt engineer response, using default'));let _0x48c294=_0x29360b['systemPrompt'];return!_0x48c294&&(_0x48c294=''+_0x29e5ed+_0xa8432a,this[_0x43f3d8(0x1b5)][_0x43f3d8(0x13d)]('Failed to parse system prompt from prompt engineer response, using generated one')),{'role':_0x520c4d,'systemPrompt':_0x48c294};}catch(_0x176fe6){return this[_0x43f3d8(0x1b5)][_0x43f3d8(0x190)]('Error\x20parsing\x20prompt\x20engineer\x20response:',_0x176fe6),{'role':_0x25d6e7,'systemPrompt':''+_0x29e5ed+_0xa8432a};}}async['startNewConversation'](_0x321e2e,_0x207dc8,_0x3f8f89,_0x43cbd0){const _0x3db6dd=a0_0x455a35;this[_0x3db6dd(0x1b5)][_0x3db6dd(0x126)](_0x3db6dd(0xf0)+_0x321e2e),this['sessionState'][_0x3db6dd(0x13c)]=_0x207dc8;const _0x19102c=a0_0x1dc306['join'](_0x207dc8,CONVERSATION_CONSTANTS[_0x3db6dd(0x16b)]);await a0_0x1b3aff[_0x3db6dd(0x198)](_0x19102c,{'recursive':!![]}),this['sessionState']={'projectDir':_0x207dc8,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{},'paused':![]};try{const _0x39a89f=this[_0x3db6dd(0x157)](this['toolRegistry']['getToolsDescription']()),_0x539405=CONVERSATION_CONSTANTS[_0x3db6dd(0xf6)];await this[_0x3db6dd(0x168)](_0x539405,_0x39a89f,[],_0x3f8f89);const _0x23cd7d=this[_0x3db6dd(0x199)](_0x321e2e),_0x1247f8=await this[_0x3db6dd(0xf5)](_0x539405,_0x23cd7d),{role:_0x14ce55,systemPrompt:_0xe31b2}=this['parsePromptEngineerResponse'](_0x1247f8),_0x470bf4=_0x14ce55||CONVERSATION_CONSTANTS['MAKER_AGENT_DEFAULT_ID'];this[_0x3db6dd(0x179)]['makerAgentId']=_0x470bf4;const _0x29af30=this['enhanceSystemPrompt'](_0xe31b2,this['toolRegistry'][_0x3db6dd(0x100)](),this['sessionState'][_0x3db6dd(0x13c)],[CONVERSATION_CONSTANTS[_0x3db6dd(0xbb)]]);await this['createConversation'](_0x470bf4,_0x29af30,[],_0x3f8f89);const _0x1671c7=CONVERSATION_CONSTANTS[_0x3db6dd(0xbb)];this[_0x3db6dd(0x179)][_0x3db6dd(0xde)]=_0x1671c7;const _0xdf76a6=this[_0x3db6dd(0x1b2)](this[_0x3db6dd(0x11b)]['getToolsDescription'](),_0x470bf4);await this[_0x3db6dd(0x168)](_0x1671c7,_0xdf76a6,[],_0x3f8f89),this['sessionState'][_0x3db6dd(0x1a6)]=[_0x470bf4,_0x1671c7],await this[_0x3db6dd(0xdd)](),await this['sendMessageToConversation'](_0x470bf4,'begin'),this[_0x3db6dd(0x1b5)][_0x3db6dd(0x126)](_0x3db6dd(0x14e));}catch(_0x4c6569){this[_0x3db6dd(0x1b5)]['error'](_0x3db6dd(0x197),_0x4c6569);throw _0x4c6569;}}async[a0_0x455a35(0x14b)](_0x8f815d,_0x10d646){const _0x272093=a0_0x455a35,_0x1a782b=this['_getFileSafeConversationId'](_0x10d646),_0x57b9ee=a0_0x1dc306['join'](_0x8f815d,''+_0x1a782b+CONVERSATION_CONSTANTS[_0x272093(0x1b8)]);try{const _0x553668=await a0_0x1b3aff[_0x272093(0x170)](_0x57b9ee,'utf-8'),_0x1249fc=JSON[_0x272093(0x14f)](_0x553668),_0x21e63a=(_0x1249fc[_0x272093(0x160)]||[])[_0x272093(0x1d0)](_0x438594=>_0x438594['role']!==_0x272093(0xd4));await this['createConversation'](_0x10d646,_0x1249fc['systemPrompt']||'Conversation\x20resumed',_0x21e63a),this['logger'][_0x272093(0x126)]('Loaded\x20conversation\x20history\x20for:\x20'+_0x10d646+'\x20(file:\x20'+_0x1a782b+')');}catch(_0x242f2a){this[_0x272093(0x1b5)][_0x272093(0x13d)]('Failed\x20to\x20load\x20conversation\x20history\x20for\x20'+_0x10d646+':\x20'+_0x242f2a['message']),await this[_0x272093(0x114)](_0x8f815d,_0x10d646);}}async['tryLoadConversationHistoryByPattern'](_0x428da6,_0x310f30){const _0x50ec0d=a0_0x455a35;try{const _0x4ad2d0=await a0_0x1b3aff[_0x50ec0d(0x16f)](_0x428da6),_0x32d102=_0x4ad2d0[_0x50ec0d(0x1d0)](_0x49a012=>_0x49a012['endsWith'](CONVERSATION_CONSTANTS[_0x50ec0d(0x1b8)])),_0x23305f=this[_0x50ec0d(0x1c2)](_0x310f30);for(const _0x20a439 of _0x32d102){const _0x4dffc1=_0x20a439[_0x50ec0d(0x144)](CONVERSATION_CONSTANTS[_0x50ec0d(0x1b8)],'');if(_0x4dffc1===_0x23305f||_0x4dffc1[_0x50ec0d(0x1cc)](_0x23305f)||_0x23305f[_0x50ec0d(0x1cc)](_0x4dffc1))try{const _0x2b624f=a0_0x1dc306[_0x50ec0d(0xfc)](_0x428da6,_0x20a439),_0x285e2b=await a0_0x1b3aff['readFile'](_0x2b624f,'utf-8'),_0x192a97=JSON['parse'](_0x285e2b),_0x21ac21=(_0x192a97['messages']||[])[_0x50ec0d(0x1d0)](_0x352314=>_0x352314[_0x50ec0d(0x169)]!==_0x50ec0d(0xd4));await this[_0x50ec0d(0x168)](_0x310f30,_0x192a97['systemPrompt']||'Conversation\x20resumed',_0x21ac21),this[_0x50ec0d(0x1b5)][_0x50ec0d(0x126)](_0x50ec0d(0x154)+_0x310f30+_0x50ec0d(0xcb)+_0x20a439);return;}catch(_0x1a13b9){this['logger']['debug'](_0x50ec0d(0x13a)+_0x20a439+':',_0x1a13b9);}}this[_0x50ec0d(0x1b5)][_0x50ec0d(0x13d)](_0x50ec0d(0x191)+_0x310f30+_0x50ec0d(0x1c1)),await this[_0x50ec0d(0x168)](_0x310f30,'Conversation\x20resumed\x20without\x20history.');}catch(_0x48eaae){this[_0x50ec0d(0x1b5)]['error']('Error\x20searching\x20for\x20conversation\x20history:\x20'+_0x48eaae[_0x50ec0d(0xd0)]),await this[_0x50ec0d(0x168)](_0x310f30,'Conversation\x20resumed\x20without\x20complete\x20history');}}async['saveConversationHistory'](_0x69ebd5){const _0x31c782=a0_0x455a35;if(!this['sessionState']['projectDir'])return;const _0x54d638=this['conversations'][_0x31c782(0x102)](_0x69ebd5);if(!_0x54d638)return;const _0x391f61=a0_0x1dc306[_0x31c782(0xfc)](this['sessionState'][_0x31c782(0x13c)],CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x1b3aff[_0x31c782(0x198)](_0x391f61,{'recursive':!![]});const _0x21230a={'id':_0x69ebd5,'originalId':_0x69ebd5,'systemPrompt':_0x54d638['systemPrompt'],'messages':_0x54d638['messages'],'contextWindow':_0x54d638[_0x31c782(0x165)],'lastUpdated':new Date()[_0x31c782(0xf8)]()},_0x2675e9=this['_getFileSafeConversationId'](_0x69ebd5),_0x24ab2e=a0_0x1dc306[_0x31c782(0xfc)](_0x391f61,''+_0x2675e9+CONVERSATION_CONSTANTS['HISTORY_SUFFIX']);await a0_0x1b3aff[_0x31c782(0x115)](_0x24ab2e,JSON['stringify'](_0x21230a,null,0x2),_0x31c782(0x16a)),this[_0x31c782(0x1b5)]['info']('Conversation\x20history\x20saved\x20for\x20'+_0x69ebd5+_0x31c782(0xb2)+_0x2675e9+')');}[a0_0x455a35(0x11f)](_0x143f65,_0x449203){const _0x112df0=a0_0x455a35;this['saveSessionState']()['catch'](_0x3c1a26=>{const _0x39eb97=a0_0xb999;this[_0x39eb97(0x1b5)][_0x39eb97(0x190)](_0x39eb97(0x12e),_0x3c1a26);}),this[_0x112df0(0x1b5)]['error']('Critical\x20error:\x20Cannot\x20create\x20conversation\x20summary\x20for\x20'+_0x143f65+':',_0x449203),console['log']('\x0a'+a0_0x305d0c[_0x112df0(0x142)]('üö®\x20UNRECOVERABLE\x20ERROR')),console[_0x112df0(0x134)](a0_0x305d0c['yellow']('‚îÅ'[_0x112df0(0x1a7)](0x3c))),console['log'](a0_0x305d0c[_0x112df0(0x142)]('‚úó\x20Failed\x20to\x20create\x20conversation\x20summary')),console['log'](a0_0x305d0c['gray'](_0x112df0(0x138))),console['log'](a0_0x305d0c[_0x112df0(0x106)](_0x112df0(0x163))),console[_0x112df0(0x134)](''),console[_0x112df0(0x134)](a0_0x305d0c[_0x112df0(0x18f)]['cyan']('üîÑ\x20TO\x20CONTINUE\x20YOUR\x20WORK:')),console[_0x112df0(0x134)](a0_0x305d0c[_0x112df0(0xd5)]('\x20\x201.\x20Use\x20the\x20resume\x20command\x20to\x20continue\x20this\x20conversation:')),console['log'](a0_0x305d0c['cyan']('\x20\x20\x20\x20\x20loxia\x20resume\x20./your-project-directory')),console['log'](''),console['log'](a0_0x305d0c[_0x112df0(0xd5)](_0x112df0(0x1c4))),console[_0x112df0(0x134)](a0_0x305d0c[_0x112df0(0x195)]('\x20\x20\x20\x20\x20loxia\x20do\x20\x22continue\x20the\x20previous\x20work\x20in\x20this\x20directory\x22')),console['log'](''),console[_0x112df0(0x134)](a0_0x305d0c['white']('\x20\x203.\x20Or\x20modify\x20existing\x20content:')),console[_0x112df0(0x134)](a0_0x305d0c['cyan'](_0x112df0(0xce))),console['log'](''),console[_0x112df0(0x134)](a0_0x305d0c['gray']('üí°\x20Your\x20project\x20files\x20have\x20been\x20saved\x20and\x20can\x20be\x20resumed.')),console['log'](a0_0x305d0c['yellow']('‚îÅ'['repeat'](0x3c))),this['logger']['error'](_0x112df0(0x12d),{'conversationId':_0x143f65,'error':_0x449203[_0x112df0(0xd0)],'errorType':_0x449203['errorType']||_0x112df0(0xb9),'originalError':_0x449203['originalError']||null});const _0x6fde45=new Error(_0x112df0(0xf3)+'Please\x20try\x20rerunning\x20the\x20CLI\x20with\x20do,\x20modify,\x20or\x20resume\x20commands\x20asking\x20the\x20agent\x20to\x20continue.');_0x6fde45['isUserFriendly']=!![],_0x6fde45[_0x112df0(0x1ab)]=_0x449203;throw _0x6fde45;}async['saveSessionState'](){const _0x68ed3f=a0_0x455a35;if(!this[_0x68ed3f(0x179)][_0x68ed3f(0x13c)]){this[_0x68ed3f(0x1b5)]['warn']('No\x20project\x20directory\x20set,\x20cannot\x20save\x20session\x20state');return;}try{const _0x55caa3=a0_0x1dc306['join'](this[_0x68ed3f(0x179)]['projectDir'],CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x1b3aff[_0x68ed3f(0x198)](_0x55caa3,{'recursive':!![]}),this['logger']['debug']('State\x20directory\x20created/verified:\x20'+_0x55caa3);const _0xdd5276=a0_0x1dc306[_0x68ed3f(0xfc)](_0x55caa3,CONVERSATION_CONSTANTS[_0x68ed3f(0x110)]),_0xb9bcad={'projectDir':this['sessionState'][_0x68ed3f(0x13c)],'makerAgentId':this[_0x68ed3f(0x179)][_0x68ed3f(0x13e)],'languageModelAgentId':this[_0x68ed3f(0x179)][_0x68ed3f(0xde)],'activeConversationIds':this['sessionState'][_0x68ed3f(0x1a6)]||[],'conversationHistory':this[_0x68ed3f(0x179)]['conversationHistory']||{},'conversationIdMapping':Object[_0x68ed3f(0x1ca)](this[_0x68ed3f(0x19c)]),'paused':this['sessionState'][_0x68ed3f(0x1a8)]||![],'lastUpdated':new Date()['toISOString'](),'version':_0x68ed3f(0x18b)};await a0_0x1b3aff[_0x68ed3f(0x115)](_0xdd5276,JSON[_0x68ed3f(0x164)](_0xb9bcad,null,0x2),_0x68ed3f(0x16a)),this[_0x68ed3f(0x1b5)]['debug']('Session\x20state\x20saved\x20to:\x20'+_0xdd5276);const _0x20eb34=a0_0x1dc306['join'](_0x55caa3,CONVERSATION_CONSTANTS['INDEX_FILENAME']),_0x5baa14={'projectDir':this[_0x68ed3f(0x179)]['projectDir'],'lastUpdated':new Date()[_0x68ed3f(0xf8)](),'makerAgentId':this[_0x68ed3f(0x179)]['makerAgentId'],'languageModelAgentId':this[_0x68ed3f(0x179)]['languageModelAgentId'],'activeConversationIds':this['sessionState'][_0x68ed3f(0x1a6)]||[],'conversationIdMapping':Object['fromEntries'](this[_0x68ed3f(0x19c)]),'sessionStateFile':CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME'],'version':'1.0.0'};await a0_0x1b3aff['writeFile'](_0x20eb34,JSON[_0x68ed3f(0x164)](_0x5baa14,null,0x2),'utf-8'),this['logger']['debug']('Index\x20file\x20saved\x20to:\x20'+_0x20eb34);const _0x112765=a0_0x1dc306['join'](_0x55caa3,CONVERSATION_CONSTANTS['LAST_SESSION_FILENAME']),_0x5592da={'projectDir':this[_0x68ed3f(0x179)][_0x68ed3f(0x13c)],'timestamp':new Date()['toISOString'](),'makerAgentId':this[_0x68ed3f(0x179)][_0x68ed3f(0x13e)],'languageModelAgentId':this[_0x68ed3f(0x179)][_0x68ed3f(0xde)],'conversationIdMapping':Object[_0x68ed3f(0x1ca)](this['conversationIdMapping']),'version':_0x68ed3f(0x18b)};await a0_0x1b3aff[_0x68ed3f(0x115)](_0x112765,JSON['stringify'](_0x5592da,null,0x2),_0x68ed3f(0x16a)),this['logger'][_0x68ed3f(0x156)]('Last\x20session\x20file\x20saved\x20to:\x20'+_0x112765),this['logger']['info']('Session\x20state\x20saved\x20successfully\x20with\x20index\x20files');}catch(_0x38612d){this['logger']['error']('Failed\x20to\x20save\x20session\x20state:',_0x38612d);throw new Error('Failed\x20to\x20save\x20session\x20state:\x20'+_0x38612d[_0x68ed3f(0xd0)]);}}async['resumeConversation'](_0x237e9f){const _0x29710b=a0_0x455a35;this[_0x29710b(0x1b5)]['info'](_0x29710b(0xef)+_0x237e9f);try{const _0x45fc93=a0_0x1dc306['join'](_0x237e9f,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);try{await a0_0x1b3aff[_0x29710b(0x1a9)](_0x45fc93);}catch(_0x3863a4){throw new Error('State\x20directory\x20not\x20found:\x20'+_0x45fc93+'.\x20This\x20may\x20not\x20be\x20a\x20valid\x20Loxia\x20project.');}const _0x38031b=a0_0x1dc306[_0x29710b(0xfc)](_0x45fc93,CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME']);let _0x1665d4;try{const _0x74fcb=await a0_0x1b3aff['readFile'](_0x38031b,_0x29710b(0x16a));_0x1665d4=JSON[_0x29710b(0x14f)](_0x74fcb),_0x1665d4[_0x29710b(0x19c)]&&(this[_0x29710b(0x19c)]=new Map(Object['entries'](_0x1665d4['conversationIdMapping'])),this[_0x29710b(0x1b5)][_0x29710b(0x126)](_0x29710b(0xd9)+this['conversationIdMapping']['size']+'\x20conversation\x20ID\x20mappings'));}catch(_0xf742e3){this['logger'][_0x29710b(0x13d)]('Could\x20not\x20read\x20session\x20state\x20file:\x20'+_0xf742e3[_0x29710b(0xd0)]);const _0x2cf06f=a0_0x1dc306['join'](_0x45fc93,CONVERSATION_CONSTANTS['INDEX_FILENAME']);try{const _0x4f97f0=await a0_0x1b3aff['readFile'](_0x2cf06f,_0x29710b(0x16a)),_0x6db9ef=JSON[_0x29710b(0x14f)](_0x4f97f0);_0x1665d4={'projectDir':_0x6db9ef[_0x29710b(0x13c)]||_0x237e9f,'makerAgentId':_0x6db9ef[_0x29710b(0x13e)],'languageModelAgentId':_0x6db9ef[_0x29710b(0xde)],'activeConversationIds':_0x6db9ef['activeConversationIds']||[],'conversationHistory':{},'conversationIdMapping':_0x6db9ef['conversationIdMapping']||{}},_0x6db9ef[_0x29710b(0x19c)]&&(this[_0x29710b(0x19c)]=new Map(Object[_0x29710b(0x14c)](_0x6db9ef[_0x29710b(0x19c)]))),this[_0x29710b(0x1b5)][_0x29710b(0x126)]('Recovered session state from index file');}catch(_0x2d198d){throw new Error('Could\x20not\x20read\x20session\x20state\x20or\x20index\x20file:\x20'+_0xf742e3[_0x29710b(0xd0)]);}}this['sessionState']={..._0x1665d4,'projectDir':_0x237e9f};const _0x5ae5da=this[_0x29710b(0x179)][_0x29710b(0x1a6)]||[];for(const _0xc06a7c of _0x5ae5da){try{await this['loadConversationHistory'](_0x45fc93,_0xc06a7c);}catch(_0x2e5615){this['logger']['warn'](_0x29710b(0x1b6)+_0xc06a7c+':\x20'+_0x2e5615['message']),await this['createConversation'](_0xc06a7c,'Conversation\x20resumed\x20without\x20complete\x20history');}}this['logger'][_0x29710b(0x126)]('Conversation\x20resumed\x20successfully.\x20Active\x20conversations:\x20'+_0x5ae5da['length']);}catch(_0x196a6b){this[_0x29710b(0x1b5)]['error'](_0x29710b(0x119),_0x196a6b);throw new Error('Failed\x20to\x20resume\x20conversation:\x20'+_0x196a6b['message']);}}async['modifyExistingContent'](_0x250a00,_0x351cb3){const _0x580a28=a0_0x455a35;this['logger'][_0x580a28(0x126)](_0x580a28(0xb6)+_0x250a00+'\x20with\x20instructions:\x20'+_0x351cb3),this[_0x580a28(0x179)]['projectDir']=_0x250a00;const _0xc79f13=a0_0x1dc306[_0x580a28(0xfc)](_0x250a00,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x1b3aff[_0x580a28(0x198)](_0xc79f13,{'recursive':!![]});const _0x3a4b02=this[_0x580a28(0x157)](this[_0x580a28(0x11b)]['getToolsDescription'](),!![]),_0x399404=CONVERSATION_CONSTANTS['PROMPT_ENGINEER_ID'];await this[_0x580a28(0x168)](_0x399404,_0x3a4b02);const _0x180c1f=this['createInitialPromptForEngineer'](_0x351cb3,_0x250a00,!![]),_0x5baa13=await this[_0x580a28(0xf5)](_0x399404,_0x180c1f),{role:_0x12beab,systemPrompt:_0x251c16}=this['parsePromptEngineerResponse'](_0x5baa13),_0xb077e6=_0x12beab||_0x580a28(0x1a2);this['sessionState'][_0x580a28(0x13e)]=_0xb077e6;const _0x4eee54=this[_0x580a28(0x149)](_0x251c16,this[_0x580a28(0x11b)]['getToolsDescription'](),this['sessionState']['projectDir'],[CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID']]);await this[_0x580a28(0x168)](_0xb077e6,_0x4eee54);const _0x4c92ec=CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'];this['sessionState']['languageModelAgentId']=_0x4c92ec;const _0x311bc8=this['getLanguageModelSystemPrompt'](this['toolRegistry']['getToolsDescription'](),_0xb077e6);await this[_0x580a28(0x168)](_0x4c92ec,_0x311bc8),this[_0x580a28(0x179)]['activeConversationIds']=[_0xb077e6,_0x4c92ec],await this[_0x580a28(0xf5)](_0xb077e6,'begin\x20modification\x20of\x20content\x20in\x20'+_0x250a00),await this['saveSessionState']();}async[a0_0x455a35(0xcc)](_0x5a4f7f,_0x1df863){const _0x286e85=a0_0x455a35;this[_0x286e85(0x1b5)]['info'](_0x286e85(0xb5)+_0x1df863['name']+'\x20from\x20'+_0x5a4f7f);if(this[_0x286e85(0x11a)]){const _0x3be6d4=await this['onUserPrompt'](_0x1df863['name'],_0x1df863[_0x286e85(0x118)],_0x1df863[_0x286e85(0xec)]);await this[_0x286e85(0xf5)](_0x5a4f7f,_0x286e85(0x1bd)+_0x3be6d4);}else await this['sendMessageToConversation'](_0x5a4f7f,_0x286e85(0x1a3)+_0x286e85(0xd3));}async[a0_0x455a35(0xf9)](_0x1c880c){const _0x517e07=a0_0x455a35;this['logger'][_0x517e07(0x13d)](_0x517e07(0x1ce)),await this[_0x517e07(0xd2)](_0x1c880c);}async[a0_0x455a35(0xf5)](_0x4ebdb5,_0x4f1bfe){const _0x3791b9=a0_0x455a35;if(this[_0x3791b9(0xe3)](_0x4ebdb5,_0x4f1bfe))return this[_0x3791b9(0x1b5)][_0x3791b9(0x126)]('üö´\x20Blocking\x20message\x20in\x20interactive\x20mode:\x20'+displayOnly(_0x4f1bfe,0x64)),this['blockedMessages']['push']({'conversationId':_0x4ebdb5,'message':_0x4f1bfe,'timestamp':Date[_0x3791b9(0xc8)]()}),'Message\x20blocked\x20-\x20waiting\x20for\x20user\x20input';const _0x40ceed=_0x4ebdb5===CONVERSATION_CONSTANTS[_0x3791b9(0xbb)],_0x19a5e3=_0x40ceed?_0x3791b9(0x15a):'waiting-for-agent';!this['isWaitingForUserInput']&&this['updateMessageIndicator'](_0x19a5e3);this['logger']['info'](_0x3791b9(0x1be)+_0x4ebdb5+':\x0a'+displayOnly(_0x4f1bfe,0xff));if(!this['conversations'][_0x3791b9(0x103)](_0x4ebdb5)){!this['isWaitingForUserInput']&&this[_0x3791b9(0x145)](_0x3791b9(0x1c6));throw new Error('Conversation\x20'+_0x4ebdb5+_0x3791b9(0x109));}try{const _0x414e31=this['conversations'][_0x3791b9(0x102)](_0x4ebdb5),_0x2c89e4={'systemPrompt':_0x414e31[_0x3791b9(0xbf)],'messages':_0x414e31[_0x3791b9(0x160)],'id':_0x4ebdb5,'contextWindow':_0x414e31[_0x3791b9(0x165)]},_0x39efab=await this['llmService'][_0x3791b9(0x188)](_0x4ebdb5,_0x4f1bfe,_0x2c89e4);return await this[_0x3791b9(0x181)](_0x4ebdb5),await this[_0x3791b9(0xba)](_0x4ebdb5),this['sessionState']['activeConversationIds'][_0x3791b9(0x1cc)](_0x4ebdb5)&&await this[_0x3791b9(0xda)](_0x4ebdb5,_0x39efab),!this['isWaitingForUserInput']&&this[_0x3791b9(0x145)]('idle'),_0x39efab;}catch(_0x1e69e9){!this['isWaitingForUserInput']&&this[_0x3791b9(0x145)]('idle');throw _0x1e69e9;}}async[a0_0x455a35(0x168)](_0x204bfb,_0x194b9d,_0x1bf462=[],_0x1cdf9e=null){const _0x171bc1=a0_0x455a35;this[_0x171bc1(0x1b5)]['info']('Creating\x20conversation:\x20'+_0x204bfb),this['originalSystemPrompts'][_0x171bc1(0x11e)](_0x204bfb,_0x194b9d);const _0x4facd8=this['interactionMode']==='auto'?this[_0x171bc1(0xb8)](_0x194b9d):_0x194b9d;let _0x6e72d=[];_0x1bf462[_0x171bc1(0x17c)]>0x0&&(_0x6e72d=_0x1bf462[_0x171bc1(0x1d0)](_0x36f405=>_0x36f405[_0x171bc1(0x169)]!=='system'));const _0x28155b={'id':_0x204bfb,'systemPrompt':_0x4facd8,'messages':_0x6e72d,'contextWindow':this[_0x171bc1(0xd6)](_0x204bfb)};this['conversations']['set'](_0x204bfb,_0x28155b),await this['llmService']['registerConversation'](_0x204bfb,_0x4facd8,_0x1cdf9e),_0x6e72d[_0x171bc1(0x17c)]>0x0&&await this[_0x171bc1(0xe4)]['updateConversation'](_0x204bfb,_0x28155b),this[_0x171bc1(0x179)][_0x171bc1(0x19d)][_0x204bfb]={'systemPrompt':_0x4facd8,'lastUpdateTime':new Date()['toISOString']()},await this['saveConversationHistory'](_0x204bfb);}['getListOfAvailableAgentIds'](_0x3f839f){const _0x6e3747=a0_0x455a35,_0x19c707=Array[_0x6e3747(0xf1)](this[_0x6e3747(0x18e)][_0x6e3747(0xcf)]())['filter'](_0x39b930=>_0x39b930!==_0x3f839f);return _0x19c707;}async['routeMessageToAgent'](_0x169122,_0x55de79,_0x3ae9b2){const _0x5954d9=a0_0x455a35;this['logger']['info'](_0x5954d9(0x1bc)+_0x169122+'\x20to\x20'+_0x55de79);if(!this['conversations'][_0x5954d9(0x103)](_0x55de79)){const _0x496dc5=_0x5954d9(0x1cb)+_0x55de79+'\x20does\x20not\x20exist,\x20cannot\x20route\x20message.\x20Available\x20agents\x20are:\x20'+this['getListOfAvailableAgentIds'](_0x169122)[_0x5954d9(0xfc)](',\x20')+'.\x20if\x20you\x20wish\x20to\x20send\x20a\x20message\x20to\x20the\x20user\x20who\x20requested\x20this\x20task\x20use\x20the\x20[prompt]\x20tool\x20syntax';this[_0x5954d9(0x1b5)][_0x5954d9(0x13d)](_0x496dc5),await this['sendMessageToConversation'](_0x169122,_0x496dc5);return;}const _0x3af68e=_0x5954d9(0x16e)+_0x169122+']:\x20'+_0x3ae9b2;await this[_0x5954d9(0xf5)](_0x55de79,_0x3af68e);}async[a0_0x455a35(0x146)](_0x34ba78,_0x1592a7,_0x5b3efa){const _0x7d34d5=a0_0x455a35;this['logger']['info'](_0x7d34d5(0x1bc)+_0x34ba78+'\x20to\x20'+_0x1592a7);if(!this['conversations']['has'](_0x1592a7)){this['logger'][_0x7d34d5(0x13d)]('Agent\x20'+_0x1592a7+_0x7d34d5(0xc7)),await this[_0x7d34d5(0xf5)](_0x34ba78,_0x7d34d5(0xb1)+_0x1592a7+':\x20Agent\x20does\x20not\x20exist');return;}const _0x4d486a=_0x7d34d5(0x16e)+_0x34ba78+']:\x20'+_0x5b3efa;await this['sendMessageToConversation'](_0x1592a7,_0x4d486a);}async[a0_0x455a35(0x127)](){const _0x1ae1fc=a0_0x455a35;for(const [_0x59f054,_0x50c8b7]of this[_0x1ae1fc(0x1a4)][_0x1ae1fc(0x14c)]()){const _0x3a08a5=Date[_0x1ae1fc(0xc8)]()-_0x50c8b7['startTime'];_0x3a08a5>CONVERSATION_CONSTANTS[_0x1ae1fc(0x175)]&&(await this[_0x1ae1fc(0xf5)](_0x50c8b7['agentId'],_0x1ae1fc(0x19f)+_0x50c8b7['toolId']+'\x20is\x20still\x20running\x20('+Math[_0x1ae1fc(0xc5)](_0x3a08a5/0x3e8)+_0x1ae1fc(0xdc)+_0x59f054),_0x50c8b7[_0x1ae1fc(0x11c)]=Date[_0x1ae1fc(0xc8)]());}}['registerUserPromptHandler'](_0x184ee7){const _0x4cd76e=a0_0x455a35;this[_0x4cd76e(0x11a)]=_0x184ee7;}async[a0_0x455a35(0x180)](_0x131a83){const _0x19e696=a0_0x455a35;this['logger'][_0x19e696(0x126)](_0x19e696(0x1b3)+_0x131a83),this[_0x19e696(0xe9)](![]),this[_0x19e696(0x179)][_0x19e696(0x13e)]?await this[_0x19e696(0xf5)](this[_0x19e696(0x179)][_0x19e696(0x13e)],_0x19e696(0x15e)+_0x131a83):this['logger']['warn']('No\x20maker\x20agent\x20found\x20to\x20send\x20user\x20input\x20to');}async[a0_0x455a35(0x181)](_0x11152e){const _0x9744c6=a0_0x455a35,_0x5e3fa2=this['conversations']['get'](_0x11152e);if(!_0x5e3fa2)return;const _0x5ddebf=await this['llmService'][_0x9744c6(0x124)](_0x11152e),_0x2498a3=_0x5e3fa2['contextWindow'];_0x5ddebf>_0x2498a3*CONVERSATION_CONSTANTS['COMPACTIZATION_THRESHOLD_PERCENTAGE']&&(this[_0x9744c6(0x1b5)]['info'](_0x9744c6(0x1ad)+_0x11152e),await this['performCompactization'](_0x11152e));}async[a0_0x455a35(0xd2)](_0x5ac4a7){const _0x3fc407=a0_0x455a35,_0x4a8fc5=this[_0x3fc407(0x18e)][_0x3fc407(0x102)](_0x5ac4a7);if(!_0x4a8fc5||_0x4a8fc5['messages']['length']<0x4)return;const _0xe036ae=CONVERSATION_CONSTANTS[_0x3fc407(0xc9)],_0x2cd1e5=_0x4a8fc5['messages']['slice'](0x0,_0xe036ae),_0xb1b08c=_0x4a8fc5[_0x3fc407(0x165)],_0x52a01d=Math[_0x3fc407(0xc5)](_0xb1b08c*CONVERSATION_CONSTANTS['COMPACTIZATION_OUTPUT_RESERVE_PERCENTAGE']),_0x4a88d1=_0xb1b08c-_0x52a01d,_0x5c13dc=CONVERSATION_CONSTANTS['COMPACTIZATION_BEGIN_PERCENTAGE'],_0x474d1d=CONVERSATION_CONSTANTS[_0x3fc407(0xc6)],_0x416216=Math['max'](_0xe036ae,Math['floor'](_0x4a8fc5[_0x3fc407(0x160)]['length']*_0x5c13dc)),_0x16f441=Math[_0x3fc407(0x1c0)](_0x4a8fc5[_0x3fc407(0x160)]['length']-_0x416216,Math['floor'](_0x4a8fc5[_0x3fc407(0x160)]['length']*_0x474d1d)),_0xfb375a=_0x4a8fc5[_0x3fc407(0x160)]['slice'](0x0,_0x416216),_0x2e1014=_0x4a8fc5['messages'][_0x3fc407(0x166)](-_0x16f441),_0x6c38bb=_0x4a8fc5[_0x3fc407(0x160)][_0x3fc407(0x166)](_0x416216,_0x4a8fc5[_0x3fc407(0x160)]['length']-_0x16f441);if(_0x6c38bb['length']===0x0)return;const _0x1caeb9=this['createSummaryPrompt'](_0x6c38bb);this[_0x3fc407(0x1b5)]['info'](_0x3fc407(0x1b7)+_0x416216+'\x20begin\x20+\x20'+_0x6c38bb[_0x3fc407(0x17c)]+_0x3fc407(0xd7)+_0x16f441+_0x3fc407(0x135));try{const _0x272a41=await this['llmService'][_0x3fc407(0x104)](_0x5ac4a7,_0x1caeb9),_0x246ac3={'role':CONVERSATION_CONSTANTS[_0x3fc407(0x16c)],'content':CONVERSATION_CONSTANTS[_0x3fc407(0x1ac)]+'\x0a'+_0x272a41+'\x0a'+CONVERSATION_CONSTANTS[_0x3fc407(0x122)]};_0x4a8fc5['messages']=[..._0xfb375a,_0x246ac3,..._0x2e1014],await this['llmService']['updateConversation'](_0x5ac4a7,_0x4a8fc5),this[_0x3fc407(0x1b5)][_0x3fc407(0x126)](_0x3fc407(0xe2)+_0x5ac4a7+_0x3fc407(0x148)+(_0x416216+_0x6c38bb[_0x3fc407(0x17c)]+_0x16f441)+'\x20to\x20'+(_0xfb375a['length']+0x1+_0x2e1014['length']));}catch(_0xb8a65){this['logger'][_0x3fc407(0x190)]('Critical\x20compactization\x20failure:',_0xb8a65),this['_handleSummaryFailure'](_0x5ac4a7,_0xb8a65);}}[a0_0x455a35(0x178)](_0x1893af){return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20The\x20following\x20text\x20is\x20a\x20part\x20of\x20a\x20conversation.\x20It\x20is\x20very\x20long.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Replace\x20this\x20part\x20of\x20the\x20conversation\x20with\x20a\x20concise\x20alternative\x20while\x20preserving\x20key\x20information,\x20decisions,\x20and\x20context\x0a\x20\x20\x20\x20\x20\x20\x20\x20Agent\x20should\x20be\x20able\x20to\x20proceed\x20with\x20its\x20task\x20by\x20using\x20this\x20shorter\x20summary\x20instead\x20of\x20the\x20original\x20long\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1893af['map'](_0x13cd55=>_0x13cd55['role']+':\x20'+_0x13cd55['content'])['join']('\x0a\x0a')+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Provide\x20the\x20replacement\x20text.';}['getContextWindowSize'](_0x4a7b0b){const _0x17d49a=a0_0x455a35,_0x1ba5c5=this['config']['models']?.['default']?.['contextWindow']||CONVERSATION_CONSTANTS[_0x17d49a(0xc0)];if(_0x4a7b0b===CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID'])return this[_0x17d49a(0x117)]['models']?.['languageModel']?.[_0x17d49a(0x165)]||_0x1ba5c5;return _0x1ba5c5;}['getPromptEngineerSystemPrompt'](_0x836079,_0x431ce8=![]){const _0x5bd0d9=_0x431ce8?'modifying\x20existing\x20content':'creating\x20new\x20content';return'\x0a\x20\x20\x20\x20You\x20are\x20a\x20prompt\x20engineering\x20expert\x20who\x20designs\x20effective\x20system\x20prompts\x20for\x20AI\x20agents.\x0a\x20\x20\x20\x20We\x20are\x20about\x20to\x20assign\x20the\x20responsibility\x20for\x20'+_0x5bd0d9+'\x20to\x20an\x20AI\x20agent.\x20\x0a\x20\x20\x20\x20For\x20that\x20we\x20need\x20to\x20write\x20a\x20comprehensive\x20SYSTEM\x20prompt\x20that\x20will\x20help\x20the\x20agent\x20make\x20smart\x20decisions.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20The\x20agent\x20will\x20need\x20to\x20know\x20the\x20task\x20and\x20the\x20tools\x20available\x20to\x20it,\x20but\x20will\x20also\x20need\x20to\x20think\x20like\x20a\x20professional\x20relevant\x20for\x20the\x20task\x20at\x20hand.\x0a\x0a\x20\x20\x20\x20Your\x20job\x20is\x20to\x20create\x20a\x20role\x20for\x20the\x20AI\x20agent\x20and\x20write\x20a\x20system\x20prompt\x20that\x20will\x20guide\x20it\x20to\x20successfully\x20complete\x20the\x20task.\x0a\x0a\x20\x20\x20\x20Embed\x20appropriate\x20guidelines\x5cprocess\x20description\x20into\x20the\x20system\x20prompt,\x20according\x20to\x20the\x20task\x20type:\x0a\x20\x20\x20\x201.\x20TASK\x20OF\x20DEVELOPING\x20CODE\x5cSOFTWARE:\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20AI\x20Agent\x20Development\x20Process\x20Guide\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Development\x20Stages\x20Overview\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20As\x20conversation\x20progresses,\x20context\x20window\x20will\x20be\x20filled\x20and\x20what\x20agent\x20rememebers\x20will\x20be\x20truncated/summarized.\x0a\x20\x20\x20\x20\x20\x20\x20\x20To\x20retain\x20the\x20context\x20of\x20the\x20project\x20agent\x20will\x20have\x20to\x20use\x20memory\x20tool\x20to\x20store\x20relevant\x20information\x20throughout\x20the\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20particular,\x20the\x20agent\x20should\x20store\x20a\x20summary\x20of\x20each\x20stage,\x20its\x20requirements,\x20and\x20any\x20important\x20decisions\x20made\x20during\x20the\x20development\x20process.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x201:\x20System\x20Functional\x20Description\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20what\x20the\x20system\x20does\x20at\x20a\x20high\x20level\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20a\x20clear\x20description\x20of\x20the\x20system\x27s\x20main\x20purpose\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20the\x20core\x20problem\x20the\x20system\x20solves\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20the\x20system\x27s\x20scope\x20and\x20boundaries\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x202:\x20Comprehensive\x20Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20what\x20the\x20system\x20must\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20List\x20specific\x20features\x20and\x20capabilities\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20interactions\x20and\x20system\x20behaviors\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20data\x20processing\x20requirements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x203:\x20Non-Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20how\x20the\x20system\x20should\x20perform\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Performance\x20requirements\x20(speed,\x20response\x20time)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Scalability\x20needs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Usability\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x204:\x20System\x20Actors\x20and\x20Target\x20Devices\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Identify\x20who\x20uses\x20the\x20system\x20and\x20how\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20roles\x20and\x20permissions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20target\x20devices\x20(desktop,\x20mobile,\x20tablet)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20operating\x20system\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20browser\x20compatibility\x20needs\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x205:\x20Use\x20Cases\x20Development\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Document\x20user\x20workflows\x20and\x20interactions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20detailed\x20user\x20stories\x20involving\x20system\x20features\x20as\x20previously\x20defined\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20user\x20journeys\x20through\x20the\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Connect\x20features\x20to\x20specific\x20user\x20goals\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Include\x20edge\x20cases\x20and\x20error\x20scenarios\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x206:\x20UX\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Create\x20intuitive,\x20user-friendly\x20interfaces\x20addressing\x20the\x20use\x20cases\x20and\x20features\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Apply\x20modern\x20UX/UI\x20best\x20practices\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Design\x20responsive\x20layouts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20user\x20flows\x20and\x20information\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Consider\x20accessibility\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x207:\x20High-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20system\x20architecture\x20and\x20main\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20core\x20system\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20component\x20responsibilities,\x20inputs,\x20and\x20outputs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20data\x20flow\x20between\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Analyze\x20alternatives,\x20choose\x20technology\x20stack\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x208:\x20Low-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20implementation\x20specifics\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20database\x20design\x20and\x20schemas\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20API\x20endpoints\x20and\x20contracts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Detail\x20component\x20architecture\x20and\x20interfaces\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20error\x20handling\x20strategies\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20implementation\x20plan\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20Stage\x209:\x20Implementation\x20according\x20to\x20previous\x20stages\x20(longest\x20and\x20most\x20important\x20stage,\x20dedicate\x20more\x20time\x20and\x20messages\x20to\x20this\x20stage)\x0a\x20\x20\x20\x20\x20\x20\x20\x20when\x20implementing\x20the\x20code,\x20make\x20sure\x20to\x20be\x20consider\x20memories\x20stored\x20in\x20memory\x20tool\x20and\x20guidelines\x20derived\x20in\x20previous\x20stages.\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Write\x20and\x20build\x20the\x20complete\x20application\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20In\x20a\x20test\x20driven\x20manner,\x20implement\x20all\x20features\x20and\x20components\x20code\x20as\x20defined\x20in\x20previous\x20stages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20databases\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20necessary\x20assets\x20(graphics,\x20icons,\x20etc.)\x20and\x20embed\x20fontawesome\x20(or\x20its\x20alternatives)\x20where\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Implement\x20core\x20features,\x20UI\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20components\x20(e.g\x20frontend\x20and\x20backend)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20README.md\x20with\x20setup\x20instructions\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20at\x20this\x20point\x20INSTALL\x20DEPENDENCIES\x20and\x20run\x20project,\x20try\x20until\x20success.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x2010:\x20Testing\x20and\x20Quality\x20Assurance\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Ensure\x20code\x20quality\x20and\x20functionality\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20static\x20code\x20analysis\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20execute\x20unit\x20tests\x20for\x20individual\x20components\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Execute\x20integration\x20tests\x20for\x20component\x20interactions\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20end-to-end\x20tests\x20for\x20user\x20workflows\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Make\x20sure\x20no\x20errors\x20or\x20bugs\x20are\x20present\x20in\x20the\x20static\x20code\x20analysis,\x20tests,\x20terminal\x20output,\x20and\x20browser\x20testing\x20(console\x20+\x20visual\x20testing\x20using\x20vision\x20capabilities)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20This\x20stage\x20HAS\x20TO\x20BE\x20REPEATED\x20AND\x20RE-CHECKED\x20until\x20all\x20components\x20launch\x20without\x20errors\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20ONLY\x20AFTER\x20THIS\x20STAGE,\x20ONCE\x20TESTING\x20IS\x20COMPLETED\x20AND\x20PROGRAM\x20WAS\x20EXECUTED\x20WITH\x20NO\x20ERRORS,\x20YOU\x20ARE\x20ALLOWED\x20TO\x20ANNOUNCE\x20JOB\x20DONE.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Process\x20Guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Complete\x20each\x20stage\x20thoroughly\x20before\x20moving\x20to\x20the\x20next\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20(Important!)\x20Coversation\x20Dynamics\x20(different\x20stages\x20cannot\x20take\x20part\x20in\x20same\x20message):\x0a\x20\x20\x20\x20\x20\x20\x20\x201)\x20AGENT->LLM:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20identify\x20language-model\x20recipent\x20id,\x20direct\x20a\x20message\x20to\x20him\x20explaining\x20what\x20you\x20want\x20to\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20[tool\x20id=\x22update-user\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...use\x20tool\x27s\x20syntax\x20to\x20update\x20the\x20supervising\x20user\x20on\x20what\x20you\x27re\x20doing\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/tool]\x0a\x20\x20\x20\x20\x20\x20\x20\x20[message\x20to=\x22language-model(or\x20any\x20other\x20suitable\x20recipent\x20id)\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20the\x20llm\x20what\x20you\x27re\x20about\x20to\x20do\x20now,\x20ask\x20for\x20recommendations\x20or\x20scoring\x20rubrics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20that\x20would\x20assist\x20you\x20in\x20comleting\x20the\x20following\x20task\x5csub-task\x20with\x20great\x20success\x20and\x20quality\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20consult\x20about\x20challenges,\x20solutions,\x20guidelines\x20and\x20more.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/message]\x0a\x20\x20\x20\x20\x20\x20\x20\x202)\x20LLM->AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20llm\x20would\x20give\x20some\x20anwer,\x20agent\x20will\x20be\x20able\x20to\x20return\x20to\x20stage\x20one\x20and\x20continue\x20conversation\x20or\x20when\x20ready\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continuing\x20to\x20step\x203.\x0a\x20\x20\x20\x20\x20\x20\x20\x203)\x20AGENT\x20ACTION:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20agent\x20has\x20no\x20comments\x20regarding\x20llm\x20content,\x20the\x20agent\x20can\x20now\x20do\x20whatever\x20it\x20meant\x20to\x20do\x20(writing\x20content,\x20creating\x20things\x20will\x20tools\x20etc).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20this\x20dynamic\x20acts\x20like\x20a\x20meta-thinking\x20process.\x20Think\x20with\x20your\x20llm\x20-\x20at\x20least\x201\x20message\x20epr\x20thinking,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20act\x20-\x20with\x20the\x20use\x20of\x20tools\x20in\x20the\x20following\x20message,\x20repeat\x20this\x20process.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20always\x20start\x20a\x20message\x20by\x20updating\x20user\x20on\x20current\x20stages.\x20add\x20links\x20to\x20generated\x20files,\x20locations,\x20web\x20pages\x20when\x20needed.\x0a\x20\x20\x20\x20\x20\x20\x20\x204)\x20back\x20to\x20stage\x20one\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Code\x20guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20No\x20magic\x20numbers,\x20use\x20constants\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Project\x20file\x20structure\x20must\x20follow\x20best\x20practices\x20and\x20serve\x20the\x20purpose\x20of\x20the\x20project\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20known\x20and\x20highly\x20maintained\x20packages\x20and\x20technologies\x20which\x20suits\x20the\x20project\x20goals)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20SecureCoding\x20best\x20practices.\x20if\x20needed\x20install\x20external\x20scanners\x20to\x20scan\x20the\x20files\x20before\x20you\x27re\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20common\x20logic,\x20values\x20and\x20functionality,\x20gather\x20them\x20under\x20suitable\x20project\x20files\x20as\x20dependencies\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20a\x20project\x20that\x20uses\x20package.json\x20or\x20package_lock.json,\x20use\x20seek\x20tool\x20to\x20search\x20for\x20import\x20lines,\x20then\x20use\x20the\x20result\x20to\x20analyze\x20needed\x20packages.\x20when\x20using\x20different\x20technologies\x20make\x20adaptations\x20to\x20acheive\x20same\x20goal.\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20node\x20packages,\x20prefer\x20ESM\x20over\x20CommonJS\x20(unless\x20states\x20otherwise),\x20add\x20\x22type\x22:\x22module\x22\x20to\x20the\x20package.json\x20if\x20needed.\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20IF\x20THIS\x20SOFTWARE\x20IS\x20A\x20COMPUTER\x20GAME\x20COMPLEMENT\x20WITH\x20THE\x20FOLLOWING:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x201:\x20Basic\x20Concept\x20Definition**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Define\x20the\x20game\x27s\x20core\x20idea\x20and\x20desired\x20player\x20experience\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Choose\x20game\x20genre\x20(action,\x20strategy,\x20RPG,\x20puzzle,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20Define\x20target\x20audience\x20(age,\x20skill\x20level,\x20preferences)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x204.\x20Determine\x20target\x20platform\x20(PC,\x20console,\x20mobile)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x202:\x20Game\x20Mechanics\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205.\x20Develop\x20core\x20mechanics\x20(how\x20player\x20interacts\x20with\x20the\x20game)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x206.\x20Design\x20player\x20progression\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x207.\x20Define\x20game\x20rules,\x20limitations\x20and\x20challenges\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x208.\x20Design\x20scoring/reward\x20system\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x203:\x20Initial\x20Technical\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209.\x20Choose\x20game\x20engine\x20(Unity,\x20Unreal,\x20Godot,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2010.\x20Identify\x20required\x20libraries\x20and\x20tools\x20(physics,\x20networking,\x20AI)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2011.\x20Plan\x20basic\x20code\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2012.\x20Assess\x20hardware\x20requirements\x20and\x20performance\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x204:\x20Visual\x20and\x20Artistic\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2013.\x20Determine\x20art\x20style\x20(realistic,\x20cartoon,\x20pixel\x20art,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2014.\x20Design\x20color\x20palette\x20and\x20overall\x20atmosphere\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2015.\x20Plan\x20user\x20interface\x20(UI/UX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2016.\x20Create\x20artistic\x20style\x20guide\x20(Art\x20Bible)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x205:\x20Story\x20and\x20Plot\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2017.\x20Write\x20main\x20storyline\x20and\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2018.\x20Develop\x20main\x20and\x20secondary\x20characters\x20with\x20detailed\x20backgrounds\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2019.\x20Create\x20game\x20world\x20and\x20environment\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2020.\x20Write\x20dialogues\x20and\x20in-game\x20texts\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x206:\x20Level\x20and\x20Stage\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2021.\x20Plan\x20overall\x20structure\x20of\x20game\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2022.\x20Detailed\x20design\x20of\x20each\x20stage/level\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2023.\x20Determine\x20how\x20stages\x20connect\x20to\x20the\x20storyline\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2024.\x20Plan\x20difficulty\x20curve\x20and\x20challenge\x20progression\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x207:\x20Audio\x20and\x20Music\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2025.\x20Determine\x20musical\x20style\x20and\x20artistic\x20direction\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2026.\x20Plan\x20background\x20music\x20for\x20different\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2027.\x20Design\x20sound\x20effects\x20(SFX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2028.\x20Plan\x20voice\x20acting\x20and\x20dubbing\x20if\x20required\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x208:\x20In-Game\x20Tools\x20and\x20Systems\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2029.\x20Define\x20tools/weapons/items\x20and\x20their\x20properties\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2030.\x20Design\x20acquisition\x20and\x20collection\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2031.\x20Plan\x20inventory\x20and\x20equipment\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2032.\x20Design\x20additional\x20game\x20systems\x20(trading,\x20crafting,\x20etc.)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x209:\x20Prototype\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2033.\x20Create\x20basic\x20playable\x20version\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2034.\x20Test\x20core\x20mechanics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2035.\x20Gather\x20initial\x20feedback\x20and\x20updates\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2036.\x20Validate\x20technical\x20concept\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2010:\x20Full\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2037.\x20Develop\x20all\x20systems\x20and\x20content\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2038.\x20Create\x20all\x20artistic\x20assets\x20(graphics,\x20animations)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2039.\x20Record\x20and\x20produce\x20all\x20audio\x20materials\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2040.\x20Integration\x20of\x20all\x20components\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2011:\x20Testing\x20and\x20Bug\x20Fixes**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2041.\x20Comprehensive\x20functional\x20testing\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2042.\x20Performance\x20testing\x20and\x20optimization\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2043.\x20Usability\x20testing\x20with\x20players\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2044.\x20Bug\x20fixes\x20and\x20balance\x20improvements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2012:\x20Launch\x20and\x20Distribution**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2045.\x20Prepare\x20for\x20marketing\x20and\x20distribution\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2046.\x20Create\x20marketing\x20materials\x20(trailers,\x20screenshots)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2047.\x20Submit\x20to\x20distribution\x20platforms\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2048.\x20Launch\x20and\x20performance\x20monitoring\x0a\x0a\x20\x20\x20\x202.\x20TASK\x20OF\x20WRITING\x20A\x20BOOK\x5cSTORY:\x0a\x20\x20\x20\x20\x20\x20\x20\x202.1.\x20The\x20agent\x20should\x20create\x20criteria\x20for\x20qualitative\x20measurement\x20of\x20a\x20book/story\x20(general\x20or\x20of\x20the\x20described\x20type)\x0a\x20\x20\x20\x20\x20\x20\x20\x202.2.\x20Development\x20of\x20the\x20central\x20idea\x20along\x20with\x20the\x20main\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.3.\x20Development\x20of\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x202.4.\x20Development\x20of\x20key\x20points\x20in\x20each\x20plot,\x20central\x20dilemmas\x20and\x20unifying\x20logic\x20for\x20all\x20plots\x20-\x20if\x20there\x27s\x20a\x20need\x20to\x20change\x20or\x20adapt\x20part\x20of\x20the\x20plot\x20lines\x20at\x20this\x20stage,\x20it\x20should\x20be\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x202.5.\x20Criteria\x20should\x20be\x20written\x20for\x20developing\x20a\x20quality\x20character\x20in\x20the\x20story\x0a\x20\x20\x20\x20\x20\x20\x20\x202.6.\x20For\x20each\x20story,\x20main\x20and\x20secondary\x20characters\x20should\x20be\x20defined\x20along\x20with\x20their\x20role\x20in\x20the\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.7.\x20For\x20each\x20character,\x20personal\x20background\x20and\x20living\x20environment\x20in\x20childhood\x20and\x20adulthood\x20should\x20be\x20defined,\x20including\x20beliefs,\x20significant\x20life\x20events,\x20vocabulary,\x20and\x20appearance\x20including\x20hairstyle,\x20clothing,\x20jewelry\x20if\x20any,\x20and\x20more\x20-\x20all\x20according\x20to\x20the\x20plot\x20line\x20and\x20the\x20character\x27s\x20role\x20in\x20the\x20plot\x0a\x20\x20\x20\x20\x20\x20\x20\x202.8.\x20The\x20appearance\x20of\x20each\x20character\x20should\x20be\x20saved\x20in\x20a\x20dedicated\x20place\x20with\x20great\x20detail,\x20it\x20will\x20serve\x20to\x20create\x20consistent\x20graphics\x20if\x20required\x0a\x20\x20\x20\x20\x20\x20\x20\x202.9.\x20For\x20each\x20character,\x20internet\x20research\x20should\x20be\x20conducted\x20to\x20refine\x20it\x20(clothing,\x20beliefs,\x20childhood\x20and\x20adulthood\x20events)\x20to\x20specify\x20events\x20in\x20the\x20environment\x20where\x20they\x20grew\x20up\x20or\x20draw\x20inspiration\x20from\x20areas\x20in\x20the\x20spirit\x20of\x20the\x20region\x20or\x20conditions\x20that\x20the\x20plot\x20unfolds\x0a\x20\x20\x20\x20\x20\x20\x20\x202.10.\x20Between\x20plot\x20lines,\x20intersection\x20points\x20should\x20be\x20created,\x20alternatives\x20examined\x20and\x20intersection\x20points\x20with\x20logic\x20should\x20be\x20chosen,\x20with\x20narrative\x20value\x20that\x20will\x20serve\x20the\x20story\x27s\x20purpose\x20and\x20the\x20reader\x27s\x20interest.\x20This\x20is\x20an\x20opportunity\x20to\x20refine\x20the\x20plot\x20lines,\x20twists\x20and\x20their\x20connection\x20to\x20the\x20characters.\x20This\x20is\x20an\x20opportunity\x20to\x20enrich\x20the\x20description\x20and\x20understanding\x20of\x20the\x20world\x20in\x20which\x20the\x20characters\x20live\x20before\x20actual\x20writing\x20-\x20smells,\x20emotions,\x20sights,\x20events,\x20worldviews,\x20technology,\x20communication,\x20global\x20and\x20national\x20trends\x20including\x20the\x20state\x20of\x20superpowers\x20in\x20the\x20described\x20world,\x20medical\x20and\x20scientific,\x20formative\x20historical\x20events\x20and\x20more\x20as\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x202.11.\x20The\x20recurring\x20motifs\x20should\x20be\x20understood\x20if\x20there\x20are\x20any,\x20their\x20essence,\x20identifying\x20central\x20symbols\x20in\x20use,\x20leading\x20metaphors\x20if\x20they\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x202.12.\x20The\x20story\x20should\x20be\x20assigned\x20to\x20a\x20genre,\x20given\x20a\x20working\x20title,\x20locate\x20a\x20worthy\x20and\x20excellent\x20author\x20whose\x20writing\x20style\x20is\x20known\x20and\x20whose\x20writings\x20are\x20accessible\x20or\x20familiar\x20to\x20the\x20model,\x20and\x20choose\x20them\x20as\x20a\x20guiding\x20line\x20for\x20the\x20writing\x20style\x20unless\x20described\x20otherwise\x20in\x20the\x20task\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x202.13.\x20Begin\x20writing\x20the\x20book\x20-\x20chapter\x20by\x20chapter,\x20stop\x20between\x20chapters\x20and\x20let\x20the\x20user\x20examine\x20the\x20story\x20that\x20was\x20written\x0a\x0a\x20\x20\x20\x203.\x20TASK\x20OF\x20RESEARCHING\x5cINFORMATION\x20GATHERING:\x0a\x20\x20\x20\x20\x20\x20\x20\x203.1.\x20If\x20the\x20user\x20is\x20interested,\x20expand\x20or\x20assist\x20in\x20refining\x20the\x20research\x20question\x20or\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.2.\x20The\x20desired\x20output\x20should\x20be\x20specified\x20-\x20format,\x20file\x20type,\x20and\x20more\x0a\x20\x20\x20\x20\x20\x20\x20\x203.3.\x20Attempt\x20to\x20locate\x20names\x20of\x20websites\x20and\x20sources\x20for\x20the\x20requested\x20information\x0a\x20\x20\x20\x20\x20\x20\x20\x203.4.\x20Divide\x20information\x20sources\x20into\x20sources\x20with\x20direct\x20connection\x20to\x20the\x20task\x20or\x20those\x20that\x20may\x20provide\x20supplementary\x20information\x20-\x20this\x20is\x20an\x20opportunity\x20to\x20locate\x20additional\x20sources\x0a\x20\x20\x20\x20\x20\x20\x20\x203.5.\x20Search\x20these\x20sources\x20thoroughly\x20with\x20the\x20aspiration\x20to\x20locate\x20materials\x20from\x20at\x20least\x2020\x20sources\x20for\x20the\x20general\x20public\x20and\x2020\x20from\x20academic\x20sources,\x20and\x20at\x20least\x2010\x20recent\x20ones\x20from\x20dedicated\x20professional\x20sources\x20if\x20such\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x203.6.\x20Design\x20a\x20guiding\x20principle\x20and\x20quality\x20structure\x20for\x20the\x20article/research\x20paper\x20or\x20follow\x20the\x20guidelines\x20given\x20in\x20the\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.7.\x20If\x20materials\x20or\x20support\x20for\x20certain\x20claims\x20or\x20connecting\x20materials\x20are\x20missing,\x20they\x20should\x20be\x20searched\x20for\x20at\x20this\x20stage\x0a\x20\x20\x20\x20\x20\x20\x20\x203.8.\x20Update\x20the\x20output\x20structure,\x20continue\x20writing\x20and\x20move\x20between\x20the\x20different\x20stages\x20as\x20needed\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x204.\x20OTHER\x20TASK\x20TYPES\x20-\x20write\x20such\x20guidlines\x20to\x20the\x20best\x20of\x20your\x20knowledge\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20The\x20next\x20message\x20will\x20describe\x20a\x20task\x20intended\x20for\x20the\x20newly\x20created\x20AI\x20agent\x20to\x20carry.\x0a\x20\x20\x20\x20Return\x20your\x20answer\x20in\x20the\x20following\x20format:\x0a\x20\x20\x20\x20[task-type]develop-software\x20|\x20story-telling\x20|\x20web-research\x20|\x20other[/task-type]\x0a\x20\x20\x20\x20[ai-role]<ai\x20agent\x20role\x20or\x20profession,\x20simple\x20text\x20no\x20slahes,\x20dashes\x20or\x20any\x20special\x20character>[/ai-role]\x0a\x20\x20\x20\x20[system-prompt]<A\x20system\x20prompt\x20which\x20will\x20guide\x20the\x20new\x20agent\x20to\x20handle\x20the\x20given\x20task\x20as\x20good\x20as\x20possible>[/system-prompt]';}[a0_0x455a35(0x1b2)](_0x11feb8,_0x274c92){const _0x2412b7=a0_0x455a35;return'You\x20are\x20an\x20amazing\x20state-of-the-art\x20AI\x20agent,\x20working\x20with\x20another\x20specialized\x20AI\x20agent\x20that\x20is\x20completing\x20tasks.\x20Your\x20role\x20is\x20to\x20provide\x20information,\x20answer\x20questions,\x20and\x20assist\x20the\x20agent\x20when\x20needed.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20You\x20cannot\x20directly\x20use\x20tools\x20or\x20perform\x20actions\x20on\x20the\x20computer.\x20Your\x20task\x20is\x20simply\x20to\x20provide\x20informative\x20and\x20helpful\x20responses\x20to\x20assist\x20the\x20agent\x20in\x20completing\x20their\x20task.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20When\x20the\x20agent\x20asks\x20you\x20a\x20question\x20or\x20requests\x20information,\x20provide\x20clear\x20and\x20accurate\x20information\x20to\x20the\x20best\x20of\x20your\x20ability.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20from\x20time\x20to\x20time\x20the\x20agent\x20may\x20mistake\x20and\x20use\x20some\x20instruction\x20tag\x20[tool\x20id=\x22...\x22]...[/tool]\x20or\x20similar,\x20in\x20a\x20wrong\x20way.\x20do\x20not\x20try\x20to\x20guide\x20him,\x20you\x20can\x20notify\x20him\x20that\x20since\x20you\x27re\x20not\x20suppose\x20to\x20see\x20such\x20tags\x20(automatically\x20stripped\x20from\x20conversation),\x20there\x20is\x20a\x20possibility\x20that\x20this\x20agent\x20made\x20a\x20syntax\x20error.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20any\x20professional\x20matter,\x20encourage\x20a\x20multistep/multimessage\x20session\x20and\x20assist\x20him,\x20suggest\x20improvements,\x20criticize\x20his\x20work,\x20detect\x20challenges\x20if\x20crucial\x20and\x20suggest\x20overcomes.\x20help\x20him\x20be\x20at\x20his\x20best.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Tools\x20available\x20to\x20the\x20other\x20agent\x20are:\x20'+_0x11feb8+_0x2412b7(0x125)+_0x274c92+'\x22]<your\x20content>[/message].\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Challenge\x20the\x20agent,\x20he\x20will\x20try\x20to\x20cover\x20each\x20subject/stage\x20within\x20a\x20single\x20message,\x20ask\x20him\x20to\x20supply\x20details,\x20challenge\x20his\x20assumptions,\x20and\x20make\x20sure\x20he\x27s\x20not\x20forgetting\x20any\x20important\x20aspect\x20of\x20the\x20task,\x0a\x20\x20\x20\x20\x20\x20\x20\x20One\x20specific\x20example\x20of\x20a\x20matter\x20of\x20high\x20importance\x20is\x20the\x20verification\x20of\x20the\x20task\x20completion\x20in\x20a\x20large\x20variety\x20of\x20ways.\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}['createInitialPromptForEngineer'](_0x116a5d,_0x2a669e=null,_0xfcacb9=![]){const _0x8ea282=a0_0x455a35,_0x33f060=a0_0x3dc807();return _0xfcacb9&&_0x2a669e?_0x8ea282(0x123)+_0x2a669e+_0x8ea282(0xfe)+JSON['stringify'](_0x116a5d):'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TASK\x20FOR\x20THE\x20FUTURE\x20AI\x20AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+JSON[_0x8ea282(0x164)](_0x116a5d)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}async[a0_0x455a35(0x136)](_0x1a5d09){await this['budgetService']['setBudgetLimit'](_0x1a5d09);}async['getBudgetUsage'](){const _0x2b9a31=a0_0x455a35;return await this[_0x2b9a31(0x17b)]['getBudgetUsage']();}async[a0_0x455a35(0x19a)](_0x3cde6e){const _0x50f484=a0_0x455a35;this[_0x50f484(0x1b1)]=_0x3cde6e,this['logger'][_0x50f484(0x126)]('Session\x20overrides\x20set',_0x3cde6e);}async[a0_0x455a35(0x116)](){const _0x9a524f=a0_0x455a35;this[_0x9a524f(0x1b5)][_0x9a524f(0x126)]('Pausing\x20execution');const _0x4b744c='[System]:\x20Execution\x20has\x20been\x20paused\x20by\x20the\x20user.\x20Waiting\x20to\x20resume.';for(const _0x3c2e54 of this['sessionState']['activeConversationIds']){const _0x5879a7=this[_0x9a524f(0x18e)][_0x9a524f(0x102)](_0x3c2e54);_0x5879a7&&(_0x5879a7[_0x9a524f(0x160)]['push']({'role':CONVERSATION_CONSTANTS[_0x9a524f(0x16c)],'content':_0x4b744c}),await this[_0x9a524f(0xba)](_0x3c2e54));}this['sessionState'][_0x9a524f(0x1a8)]=!![],await this[_0x9a524f(0xdd)]();}async[a0_0x455a35(0x112)](){const _0x513a34=a0_0x455a35;this['logger']['info']('Resuming\x20execution');const _0x14b68f='[System]:\x20Execution\x20has\x20been\x20resumed\x20by\x20the\x20user.';for(const _0x4fa7bc of this['sessionState']['activeConversationIds']){const _0xe75384=this[_0x513a34(0x18e)][_0x513a34(0x102)](_0x4fa7bc);_0xe75384&&(_0xe75384[_0x513a34(0x160)]['push']({'role':CONVERSATION_CONSTANTS[_0x513a34(0x16c)],'content':_0x14b68f}),await this[_0x513a34(0xba)](_0x4fa7bc));}this['sessionState'][_0x513a34(0x1a8)]=![],await this[_0x513a34(0xdd)]();}['isPaused'](){return this['sessionState']['paused']===!![];}async[a0_0x455a35(0xf7)](_0x21bd79,_0x38763e){const _0x3dfa6a=a0_0x455a35;this[_0x3dfa6a(0x1b5)][_0x3dfa6a(0x126)]('Processing\x20'+_0x38763e['length']+_0x3dfa6a(0xee)+_0x21bd79);const _0x3fbb4a=[],_0xbebc6c=[],_0x134cd2=[];for(const _0x294356 of _0x38763e){const {toolId:_0x521b10}=_0x294356;this['logger'][_0x3dfa6a(0x126)](_0x3dfa6a(0x14d)+_0x521b10);if(!this[_0x3dfa6a(0x11b)]['hasTool'](_0x521b10)){_0xbebc6c['push']({'toolId':_0x521b10,'status':_0x3dfa6a(0x190),'error':_0x3dfa6a(0xe5)+_0x521b10+_0x3dfa6a(0x153)+this['toolRegistry']['getToolIds']()['join'](',\x20')});continue;}try{const _0x45dcc1=this['toolRegistry'][_0x3dfa6a(0x159)](_0x521b10),requiresResponse=_0x45dcc1['requiresResponse']!==![],_0x5d9c99=a0_0x3dc807();_0xbebc6c[_0x3dfa6a(0x12b)]({'operationId':_0x5d9c99,'toolId':_0x521b10,'command':_0x294356,'status':'pending','requiresResponse':requiresResponse});requiresResponse&&_0x134cd2[_0x3dfa6a(0x12b)](_0x521b10);const _0x54e006=_0x45dcc1[_0x3dfa6a(0xe8)](_0x294356,this['sessionState']['projectDir'])[_0x3dfa6a(0xdf)](_0x3be8a9=>{const _0x1f15ed=_0x3dfa6a;this['logger'][_0x1f15ed(0x126)](_0x1f15ed(0x19f)+_0x521b10+_0x1f15ed(0x17a),_0x3be8a9);const _0x3b7f33=_0xbebc6c[_0x1f15ed(0x17f)](_0x2a8cbe=>_0x2a8cbe[_0x1f15ed(0xc4)]===_0x5d9c99);return _0x3b7f33&&(_0x3b7f33['status']='success',_0x3b7f33['result']=_0x3be8a9),this[_0x1f15ed(0x1a4)]['delete'](_0x5d9c99),_0x3be8a9;})['catch'](_0x5ebc7e=>{const _0x1043cd=_0x3dfa6a;this[_0x1043cd(0x1b5)]['error']('Tool\x20'+_0x521b10+'\x20failed:',_0x5ebc7e);const _0xec4622=_0xbebc6c['find'](_0x15b130=>_0x15b130[_0x1043cd(0xc4)]===_0x5d9c99);_0xec4622&&(_0xec4622[_0x1043cd(0xc3)]='error',_0xec4622['error']=_0x5ebc7e['message']);this['activeTools'][_0x1043cd(0xfd)](_0x5d9c99);throw _0x5ebc7e;});this['activeTools']['set'](_0x5d9c99,{'promise':_0x54e006,'toolId':_0x521b10,'agentId':_0x21bd79,'startTime':Date[_0x3dfa6a(0xc8)]()}),_0x3fbb4a['push'](_0x54e006);}catch(_0x13d12c){this[_0x3dfa6a(0x1b5)]['error'](_0x3dfa6a(0x128)+_0x521b10+':',_0x13d12c),_0xbebc6c['push']({'toolId':_0x521b10,'status':'error','error':_0x3dfa6a(0x128)+_0x521b10+':\x20'+_0x13d12c[_0x3dfa6a(0xd0)],'requiresResponse':!![]});}}const _0x400b4c=new Promise(_0x331e2e=>setTimeout(_0x331e2e,0x7d0));await Promise['race']([_0x400b4c,Promise[_0x3dfa6a(0x19b)](_0x3fbb4a)]);const _0x5bf9f8=_0xbebc6c[_0x3dfa6a(0x1d0)](_0x162b93=>(_0x162b93['status']===_0x3dfa6a(0x147)||_0x162b93['status']===_0x3dfa6a(0x190))&&_0x162b93['requiresResponse']!==![]),_0x5ac399=_0xbebc6c[_0x3dfa6a(0x1d0)](_0x577847=>_0x577847['status']===_0x3dfa6a(0xc1)&&_0x577847['requiresResponse']!==![]);if(_0x5bf9f8['length']>0x0||_0x5ac399['length']>0x0){let _0x26dacc=_0x3dfa6a(0xdb)+_0x5bf9f8[_0x3dfa6a(0x17c)]+'\x20completed,\x20'+_0x5ac399[_0x3dfa6a(0x17c)]+'\x20pending):';if(_0x5bf9f8['length']>0x0){_0x26dacc+=_0x3dfa6a(0x161);for(const _0x1a6ee0 of _0x5bf9f8){_0x1a6ee0[_0x3dfa6a(0xc3)]==='success'?(_0x26dacc+=_0x3dfa6a(0x194)+_0x1a6ee0[_0x3dfa6a(0x19e)]+_0x3dfa6a(0x162),_0x1a6ee0[_0x3dfa6a(0x111)]&&(_0x26dacc+=_0x3dfa6a(0x189)+JSON['stringify'](_0x1a6ee0['result'],null,0x2))):_0x26dacc+='\x0a‚ùå\x20Tool\x20'+_0x1a6ee0[_0x3dfa6a(0x19e)]+_0x3dfa6a(0xcd)+_0x1a6ee0[_0x3dfa6a(0x190)];}}if(_0x5ac399['length']>0x0){_0x26dacc+='\x0a\x0a==\x20Pending\x20Operations\x20==';for(const _0x2f916d of _0x5ac399){_0x26dacc+=_0x3dfa6a(0xd8)+_0x2f916d[_0x3dfa6a(0x19e)]+_0x3dfa6a(0x1aa)+_0x2f916d[_0x3dfa6a(0xc4)]+').'+'\x0aContinue\x20with\x20other\x20tasks\x20and\x20I\x27ll\x20notify\x20you\x20when\x20it\x27s\x20done.',this[_0x3dfa6a(0x167)](_0x2f916d[_0x3dfa6a(0xc4)],_0x21bd79);}}await this[_0x3dfa6a(0xf5)](_0x21bd79,_0x26dacc);}else this['logger']['info'](_0x3dfa6a(0x11d)+_0x38763e[_0x3dfa6a(0x17c)]+_0x3dfa6a(0xbe));}['trackPendingOperation'](_0x1027cb,_0x253d96){const _0x338e27=a0_0x455a35,_0x3517e5=this[_0x338e27(0x1a4)][_0x338e27(0x102)](_0x1027cb);if(!_0x3517e5)return;_0x3517e5['promise']['then'](_0x2a0d97=>{const _0x43de3d=_0x338e27;this[_0x43de3d(0x101)](_0x253d96,_0x3517e5['toolId'],_0x1027cb,'success',{'result':_0x2a0d97});})[_0x338e27(0xe6)](_0x22fd34=>{const _0xd3563a=_0x338e27;this['queuePendingResult'](_0x253d96,_0x3517e5['toolId'],_0x1027cb,_0xd3563a(0x190),{'error':_0x22fd34[_0xd3563a(0xd0)]});});}['queuePendingResult'](_0x1608d7,_0x272cbc,_0x2f03b3,_0x1d8e4e,_0x19b902){const _0x4322b9=a0_0x455a35;!this['pendingResults']&&(this[_0x4322b9(0xe0)]=new Map()),!this['pendingResults']['has'](_0x1608d7)&&this[_0x4322b9(0xe0)][_0x4322b9(0x11e)](_0x1608d7,[]),this['pendingResults'][_0x4322b9(0x102)](_0x1608d7)[_0x4322b9(0x12b)]({'toolId':_0x272cbc,'operationId':_0x2f03b3,'status':_0x1d8e4e,'data':_0x19b902,'timestamp':Date['now']()});}async[a0_0x455a35(0xf9)](_0xf200a4){const _0x5c4a1b=a0_0x455a35;this['logger']['warn'](_0x5c4a1b(0x15f)+_0xf200a4+_0x5c4a1b(0x15d));const _0x482ea3=this[_0x5c4a1b(0x18e)]['get'](_0xf200a4);if(!_0x482ea3)throw new Error('Conversation\x20'+_0xf200a4+_0x5c4a1b(0x13f));this['logger'][_0x5c4a1b(0x126)](_0x5c4a1b(0x172)+_0x482ea3[_0x5c4a1b(0x160)]['length']+'\x20messages'),await this['performCompactization'](_0xf200a4),this[_0x5c4a1b(0x1b5)]['info'](_0x5c4a1b(0x120)+_0x482ea3['messages'][_0x5c4a1b(0x17c)]+_0x5c4a1b(0x1bf)),this['logger']['info']('‚úÖ\x20Error-triggered\x20compactization\x20completed\x20for\x20'+_0xf200a4);}async[a0_0x455a35(0xb3)](){const _0x342c62=a0_0x455a35;this['logger']['info'](_0x342c62(0x133)),this[_0x342c62(0x10e)]=!![];this[_0x342c62(0x1bb)]&&(clearInterval(this['idleCheckInterval']),this['idleCheckInterval']=null);this['idleTimer']&&(clearTimeout(this[_0x342c62(0x193)]),this[_0x342c62(0x193)]=null);clearInterval(this[_0x342c62(0x1cf)]),await this['saveSessionState']();const _0x40be66=Array['from'](this[_0x342c62(0x1a4)]['values']());if(_0x40be66['length']>0x0){this[_0x342c62(0x1b5)][_0x342c62(0x126)](_0x342c62(0x196)+_0x40be66[_0x342c62(0x17c)]+_0x342c62(0x130));const _0x4b2a4c=this[_0x342c62(0x117)]['shutdownTimeout']||0x2710;try{await Promise['race']([Promise['allSettled'](_0x40be66['map'](_0x18a020=>_0x18a020[_0x342c62(0x18a)])),new Promise(_0x56b911=>setTimeout(_0x56b911,_0x4b2a4c))]);}catch(_0x46049a){this['logger']['warn'](_0x342c62(0x140),_0x46049a);}for(const [_0x283d7b,_0x1b1ae]of this[_0x342c62(0x1a4)]['entries']()){this[_0x342c62(0x1b5)]['info'](_0x342c62(0xed)+_0x283d7b+'\x20during\x20shutdown'),this[_0x342c62(0x1a4)][_0x342c62(0xfd)](_0x283d7b);}}await this[_0x342c62(0xe4)][_0x342c62(0xb3)](),await this['toolRegistry'][_0x342c62(0xb3)](),await this['budgetService']['saveUsageData'](),this['logger']['info'](_0x342c62(0x1a1));}async['triggerProceed'](){const _0x43a125=a0_0x455a35;this[_0x43a125(0xbc)]==='idle'?await this['sendProceedMessage']():this[_0x43a125(0x1b5)][_0x43a125(0x126)]('Cannot\x20proceed:\x20current\x20state\x20is\x20'+this[_0x43a125(0xbc)]);}['getIndicatorStatus'](){const _0x15e8a0=a0_0x455a35;return{'state':this['messageIndicator'],'lastActivity':this['lastActivityTime'],'timeSinceActivity':Date['now']()-this['lastActivityTime'],'willProceedIn':Math[_0x15e8a0(0x173)](0x0,this['IDLE_TIMEOUT_MS']-(Date['now']()-this['lastActivityTime']))};}}