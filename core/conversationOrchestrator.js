const a0_0x58da6f=a0_0x511e;(function(_0x59c063,_0x1e1130){const _0x25c488=a0_0x511e,_0x44d104=_0x59c063();while(!![]){try{const _0x4deb95=parseInt(_0x25c488(0x227))/0x1+parseInt(_0x25c488(0x1f5))/0x2+-parseInt(_0x25c488(0x19e))/0x3+parseInt(_0x25c488(0x217))/0x4+parseInt(_0x25c488(0x15c))/0x5+parseInt(_0x25c488(0x1a0))/0x6*(-parseInt(_0x25c488(0x197))/0x7)+parseInt(_0x25c488(0x165))/0x8*(-parseInt(_0x25c488(0x17e))/0x9);if(_0x4deb95===_0x1e1130)break;else _0x44d104['push'](_0x44d104['shift']());}catch(_0x409b50){_0x44d104['push'](_0x44d104['shift']());}}}(a0_0x5b40,0x7882c));import{TagParser}from'../utilities/tagParser.js';import{TagParserService}from'../services/tagParserService.js';import a0_0x2d3ef3 from'path';import{promises as a0_0x3520d9}from'fs';import{v4 as a0_0x4a09cf}from'uuid';import{LLMService}from'../services/llmService.js';import{ToolRegistry}from'../services/toolRegistry.js';import{BudgetService}from'../services/budgetService.js';function a0_0x511e(_0x34a1f1,_0x14f221){const _0x5b40e2=a0_0x5b40();return a0_0x511e=function(_0x511e35,_0x44ea9f){_0x511e35=_0x511e35-0x120;let _0x2d91ce=_0x5b40e2[_0x511e35];if(a0_0x511e['IoWuSH']===undefined){var _0x5cbcb7=function(_0x2d3ef3){const _0x3520d9='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4a09cf='',_0x507ef5='';for(let _0x3c1215=0x0,_0x5672f6,_0x2fedd5,_0x319c43=0x0;_0x2fedd5=_0x2d3ef3['charAt'](_0x319c43++);~_0x2fedd5&&(_0x5672f6=_0x3c1215%0x4?_0x5672f6*0x40+_0x2fedd5:_0x2fedd5,_0x3c1215++%0x4)?_0x4a09cf+=String['fromCharCode'](0xff&_0x5672f6>>(-0x2*_0x3c1215&0x6)):0x0){_0x2fedd5=_0x3520d9['indexOf'](_0x2fedd5);}for(let _0x4efdcf=0x0,_0x14d6b7=_0x4a09cf['length'];_0x4efdcf<_0x14d6b7;_0x4efdcf++){_0x507ef5+='%'+('00'+_0x4a09cf['charCodeAt'](_0x4efdcf)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x507ef5);};a0_0x511e['AsucGm']=_0x5cbcb7,_0x34a1f1=arguments,a0_0x511e['IoWuSH']=!![];}const _0x151b42=_0x5b40e2[0x0],_0x1eea33=_0x511e35+_0x151b42,_0x1e6602=_0x34a1f1[_0x1eea33];return!_0x1e6602?(_0x2d91ce=a0_0x511e['AsucGm'](_0x2d91ce),_0x34a1f1[_0x1eea33]=_0x2d91ce):_0x2d91ce=_0x1e6602,_0x2d91ce;},a0_0x511e(_0x34a1f1,_0x14f221);}import{displayOnly}from'../utilities/stringOps.js';import a0_0x507ef5 from'chalk';function a0_0x5b40(){const _0x4929d6=['CgvUzgLUz1jLC3vSDhm','xtOG','DgfNugfYC2vYu2vYDMLJzq','CgvYzM9YBunVBxbHy3rPEMf0Aw9U','ntK4mduWr0DWy2nr','C2H1DgrVD24','nLDmA3f3BW','C3LZDgvTuhjVBxb0','AgfUzgXLvxnLCLbYB21WDejHC2vKt25nB2rL','sM9IigrVBMuGCMvJzwL2zwq6ia','q2fUBM90ihnLBMqGBwvZC2fNzsb0BYa','CMvNAxn0zxjkB2jeB25LsgfUzgXLCG','vw5RBM93BG','zgvSzxrL','q29UDMvYC2f0Aw9UigHPC3rVCNKGC2f2zwqGzM9Yia','sw50zxjHy3rPB24GBw9KzsbJAgfUz2vKoIa','Bw9KzwW','8j+AQYbcBg9JA2LUzYbTzxnZywDLigLUigLUDgvYywn0AxzLig1Vzgu6ia','rMfPBgvKihrVihnHDMuGC2vZC2LVBIbZDgf0ztOG','8j+uKYbjBNrLCMfJDgL2zsbTB2rLoIbszxn1BwLUzYbTzxnZywDLigzSB3C','BgXTu2vYDMLJzq','z2v0vg9VBhnezxnJCMLWDgLVBG','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbZAhv0igrVD24GC3vJy2vZC2z1BgX5','yxnZAxn0yw50','C2HVDwXKqMXVy2TnzxnZywDL','zMLUza','uMvJzwL2zwqGDxnLCIbPBNb1DdOG','C2vZC2LVBLn0yxrL','ugvYzM9YBwLUzYbJB21Wywn0AxPHDgLVBIbMB3iGy29UDMvYC2f0Aw9Uia','ugf1C2LUzYbLEgvJDxrPB24','C3vIC3rYAw5N','CMvNAxn0zxjqCM9TChruB29mB25NsgfUzgXLCG','zNjVBuvUDhjPzxm','iIaTpIaI','tuflrvjFquDftLrFrevgqvvmvf9jra','ihn5C3rLBsbTzxnZywDLoIKGChjVy2vLzc4GswyGC3r1y2SGzM9YihrVBYbSB25NihvZzsb0B29SCYbVCIbWzxjMB3jTig9WzxjHDgLVBNmGDg8GzwzMzwn0AxzLBhKGy29UDgLUDwuGDgHLihrHC2SU','zxHLy3v0zq','z2v0sw5KAwnHDg9YrgLZCgXHEq','Bw9KzwXZ','CMvHzezPBgu','rxjYB3iGC2vHCMnOAw5NigzVCIbJB252zxjZyxrPB24GAgLZDg9YEtOG','CYbLBgfWC2vKks4Gt3bLCMf0Aw9UieLeoIa','CMvZDwX0','igzYB20G','CMvHzgrPCG','ywn0AxzLvg9VBhm','z2v0tgfUz3vHz2vnB2rLBfn5C3rLBvbYB21WDa','vxnLCIbZzwXLy3rLzdOG','CMvWBgfJzq','zw50CMLLCW','8j+AQcbvtLjfq09wrvjbqKXfievsuK9s','iL08Ew91CIbJB250zw50pLSVBwvZC2fNzv0UcGOGicaGicaGienOywXSzw5Nzsb0AguGywDLBNqSigHLihDPBgWGDhj5ihrVignVDMvYigvHy2GGC3vIAMvJDc9ZDgfNzsb3AxrOAw4GysbZAw5NBguGBwvZC2fNzsWGyxnRigHPBsb0BYbZDxbWBhKGzgv0ywLSCYWGy2HHBgXLBMDLigHPCYbHC3n1Bxb0Aw9UCYWGyw5Kig1HA2uGC3vYzsbOzsDZig5VDcbMB3jNzxr0Aw5NigfUEsbPBxbVCNrHBNqGyxnWzwn0ig9MihrOzsb0yxnRlaOGicaGicaGie9UzsbZCgvJAwzPyYbLEgfTCgXLig9MigeGBwf0DgvYig9MigHPz2GGAw1WB3j0yw5JzsbPCYb0AguGDMvYAwzPy2f0Aw9Uig9MihrOzsb0yxnRignVBxbSzxrPB24GAw4GysbSyxjNzsb2yxjPzxr5ig9MihDHExmUcIaGicaGicaG','twvZC2fNzsbIBg9JA2vKic0GD2fPDgLUzYbMB3iGDxnLCIbPBNb1Da','C2v0qNvKz2v0tgLTAxq','rxjYB3iGC2vUzgLUzYbHDxrVlxbYB2nLzwqGBwvZC2fNztO','C3rHDhvZ','CgfYC2vnzxnZywDL','AwrSzq','uhjVy2vZC2LUzYbwuYbdB2rLig1LC3nHz2u6','C2vUzfbYB2nLzwrnzxnZywDL','C3rHCNrozxDdB252zxjZyxrPB24','CM9Szq','CMfJzq','ifjLC3vSDdOG','z2v0qNvKz2v0vxnHz2u','AgfUzgXLuhjVBxb0vg9Vtg9UzW','CgfYC2vqCM9TChrfBMDPBMvLCLjLC3bVBNnL','rMfPBgvKihrVihf1zxvLihrVB2WG','Dg9mB2nHBgvmB3DLCKnHC2u','y29UDgv4DfDPBMrVDW','icHTB2rLoIa','Aw50zxjHy3rPDMu','vg8GCMuTzw5HyMXLlcbZD2L0y2GGDg8GAw50zxjHy3rPDMuGBw9KzsbVCIbTB2rPzNKGzw5Oyw5Jzvn5C3rLBvbYB21WDcGPicOV','igzYB20GzMLSzsa','icaGicbSB3HPysbTB2rPzNKGlI95B3vYlxbYB2PLy3qGiMnVBNrPBNvLigrLDMvSB3bTzw50iG','q29UDMvYC2f0Aw9Uig9Yy2HLC3rYyxrVCIbPBML0AwfSAxPLzcb3AxrOihbYB2PLy3q6ia','cIaGica','w1n5C3rLBv06iev4zwn1DgLVBIbOyxmGyMvLBIbYzxn1BwvKigj5ihrOzsb1C2vYlG','BwfW','rMfPBgvKihrVihbYB2nLC3mGBwvZC2fNztOG','vg9VBcaN','u3vTBwfYEsbMywLSDxjLigrLDgfPBhm6','CgvUzgLUzW','lIbnzxnZywDLCYbYzwr1y2vKigzYB20G','C3vJy2vZCW','C2f2zvnLC3nPB25tDgf0zq','yNvKz2v0u2vYDMLJzq','ve9ptf9dquXmx0zsrvfvru5dwv9dsevds19nuW','q29UDgLUDwuGyxv0B21HDgLJywXSEq','C3rHCNruAw1L','B3jPz2LUywXtExn0zw1qCM9TChrZ','otqYndGWq3jkEM5s','CMvNAxn0zxjdB252zxjZyxrPB24','BwvZC2fNzxm','D29YA3nWywnLuM9VDa','B25kB2jeB25L','ig5VDcbMB3vUzcbMB3iGy29TCgfJDgL6yxrPB24','yMXVy2TLze1LC3nHz2vZ','seLtve9swv9tvuzgsvG','D2fYBG','tM8GChjVAMvJDcbKAxjLy3rVCNKGC2v0lcbJyw5UB3qGC2f2zsbZzxnZAw9Uihn0yxrL','u3rHCNrPBMCGBMv3ignVBNzLCNnHDgLVBIbMB3iGDgfZAZOG','cGPuB29SCYbHDMfPBgfIBguGyxjLoGO','AM9Irg9Uzq','rMfPBgvKihrVihjLC3vTzsbJB252zxjZyxrPB246ia','Bw9Kzq','rxjYB3iGCgfYC2LUzYbWCM9TChqGzw5NAw5LzxiGCMvZCg9UC2u6','ChjVBwLZzq','igr1CMLUzYbZAhv0zg93BG','C2vUze1LC3nHz2u','igLZihn0AwXSihj1BM5PBMCGkg9WzxjHDgLVBIbjrdOG','Dg9ju09tDhjPBMC','ms4WlJa','q29UDMvYC2f0Aw9UihjLC3vTzwqGC3vJy2vZC2z1BgX5lIbby3rPDMuGy29UDMvYC2f0Aw9UCZOG','C2f2zunVBNzLCNnHDgLVBKHPC3rVCNK','BwTKAxi','4PYfievYCM9YlxrYAwDNzxjLzcbJB21Wywn0AxPHDgLVBIbJB21WBgv0zwqGzM9Yia','zxjYB3i','Aw5PDgLHBgL6zvnLCNzPy2vZ','y3LHBG','C3rYAw5NAwz5','D2fPDgLUzY1MB3iTywDLBNq','ugXLyxnLihrYEsbYzxj1BM5PBMCGDgHLienmssb3AxrOigrVlcbTB2rPzNKSig9YihjLC3vTzsbJB21Tyw5KCYbHC2TPBMCGDgHLigfNzw50ihrVignVBNrPBNvLlG','BwfRzxiTywDLBNq','zMXVB3i','mJG2ntG1nNvtywD4rW','uMvZDw1PBMCGzxHLy3v0Aw9U','cKnVBNrLEhq6ia','y3jLyxrLsw5PDgLHBfbYB21WDezVCKvUz2LUzwvY','BgvUz3rO','Dg9VBenVBw1HBMrZ','CM91DgvnzxnZywDLvg9bz2vUDa','q29UDMvYC2f0Aw9UihjLC3vTzwq','Bg9N','y29UzMLN','ic0+ia','yxv0BW','Cgf1C2vK','BwvZC2fNzq','Dg9VBenOzwnRsw50zxj2ywW','cGPdB252zxjZyxrPB24GCNvSzxmGyxjLoGOGicaGms4Gv2HLBIbZzw5KAw5NigeGBwvZC2fNzsb0BYbHBM90AgvYihbHCNrPy2LWyw50lcb1C2uGw21LC3nHz2uGDg89iNbHCNrPy2LWyw50x2LKiL0GzM9YBwf0cIaGicaYlIbxAgvUihvZAw5NihrVB2XZlcb3CMfWignVBw1HBMrZigLUifT0B29SCY1JB21Tyw5KC10Gyw5KifSVDg9VBhmTy29TBwfUzhnDihrHz3mkicaGidmUievHy2GGDg9VBcbJB21Tyw5KihnOB3vSzcbIzsb3CMfWCgvKigLUifT0B29SigLKpsj0B29Sx2LKiL0Gyw5KifSVDg9VBf0GDgfNCWOGicaGnc4Gww91ig11C3qGzM9SBg93ihrOzsbZCgvJAwzPyYbMB3jTyxqGzM9YigvHy2GGDg9VBcbHCYbKzxnJCMLIzwqGAw4GDgHLihrVB2XZihnLy3rPB24kicaGiduUieLMihLVDsbUzwvKihvZzxiGAw5WDxqGB3iGysbKzwnPC2LVBIWGDxnLihrOzsbBChjVBxb0xsbMB3jTyxqOtK9usunfoIbHDcbSzwfZDcaYig9WDgLVBIb0ywDZigfYzsbYzwnVBw1LBMrLzcK6ifTWCM9TChqGBMfTzt0IChjVBxb0igrPC3bSyxKGDgL0BguIxxrOzsbTzxnZywDLihrOzsb1C2vYihDPBgWGC2vLw29WDgLVBL1VChrPB24Gmsb0zxH0wY9VChrPB25DifTVChrPB25DB3b0Aw9UidiGDgv4DfSVB3b0Aw9Uxs4UlM1VCMuGB3b0Aw9UCYbPzIbUzwvKzwqUlI5Bl3bYB21WDf0kicaGidyUihDOzw4GEw91igHHDMuGzMLUAxnOzwqGEw91CIb0yxnRigLUy2X1zgLUzYb2zxjPzMLJyxrPB24Gyw5KihzHBgLKyxrPB24GB2yGywn0DwfSignVBNrLBNqGyxmGD3jPDhrLBIbVBIbKAxnRigfZignVBxbHCMvLzcb0BYbKzxjPDMvKihnWzwnZlcbVCIb5B3uNCMuGBM90igDLDhrPBMCGyw55ihbYB2DYzxnZihvZzsb0AguGw2PVyI1KB25LxtX5B3vYig1LC3nHz2u+wY9QB2iTzg9Uzv0GC3bLy2LHBcbPBNn0CNvJDgLVBIb0ywCUihbYzwzLCNjHyMX5igLUigL0CYbVD24GBwvZC2fNzsaOBM8GB3rOzxiGAw5ZDhj1y3rPB25Zks4kicaGidCUig5LDMvYigfUBM91BMnLigPVyI1KB25LigjLzM9Yzsb5B3uGAgf2zsbJB21WBgv0zwqGywXSihn0ywDLCYbVzIb0AguGzgv2zwXVCg1LBNqGChjVy2vZCYWGDgvZDgvKigfUzcbYzs12ywXPzgf0zwqGEw91CIbZB2X1DgLVBIbIEsbVyNnLCNzPBMCGDgHLignYzwf0zwqGzMLSzxmGyw5KigfYDgLMywn0CY4kicaGifLVDxiGuhjVAMvJDcbsB290ierPCMvJDg9YEsbjCZOG','nty5mJm3wfrbsNDw','CMvTB3zLuhjVBxb0u3LUDgf4rNjVBvn5C3rLBvbYB21WDa','igrVzxmGBM90igv4Axn0lcbJyw5UB3qGCM91DguGBwvZC2fNzq','Dg9tDhjPBMC','DxbKyxrLq29UDMvYC2f0Aw9Uu3LZDgvTuhjVBxb0','BgfUz3vHz2vnB2rLBefNzw50swq','D2fPDgLUzY1MB3iTBgXT','ww91igfYzsbHBIbHBwf6Aw5Nihn0yxrLlw9MlxrOzs1HCNqGquKGywDLBNqSihDVCMTPBMCGD2L0AcbHBM90AgvYihnWzwnPywXPEMvKiefjigfNzw50ihrOyxqGAxmGy29TCgXLDgLUzYb0yxnRCY4Gww91CIbYB2XLigLZihrVihbYB3zPzguGAw5MB3jTyxrPB24SigfUC3DLCIbXDwvZDgLVBNmSigfUzcbHC3nPC3qGDgHLigfNzw50ihDOzw4GBMvLzgvKlGOGicaGcIaGicaGicaGww91ignHBM5VDcbKAxjLy3rSEsb1C2uGDg9VBhmGB3iGCgvYzM9YBsbHy3rPB25Zig9UihrOzsbJB21WDxrLCI4Gww91CIb0yxnRigLZihnPBxbSEsb0BYbWCM92AwrLigLUzM9YBwf0AxzLigfUzcbOzwXWzNvSihjLC3bVBNnLCYb0BYbHC3nPC3qGDgHLigfNzw50igLUignVBxbSzxrPBMCGDgHLAxiGDgfZAY4kicaGiaOGicaGicaGifDOzw4GDgHLigfNzw50igfZA3mGEw91igeGCxvLC3rPB24GB3iGCMvXDwvZDhmGAw5MB3jTyxrPB24SihbYB3zPzguGy2XLyxiGyw5KigfJy3vYyxrLigLUzM9YBwf0Aw9UihrVihrOzsbIzxn0ig9MihLVDxiGywjPBgL0Es4kicaGicaGicakicaGicaGicbMCM9TihrPBwuGDg8GDgLTzsb0AguGywDLBNqGBwf5ig1PC3rHA2uGyw5KihvZzsbZB21LigLUC3rYDwn0Aw9UihrHzYbBDg9VBcbPzd0IlI4UiL0UlI5Bl3rVB2XDig9YihnPBwLSyxiSigLUigeGD3jVBMCGD2f5lIbKBYbUB3qGDhj5ihrVigD1AwrLigHPBsWGEw91ignHBIbUB3rPzNKGAgLTihrOyxqGC2LUy2uGEw91j3jLig5VDcbZDxbWB3nLihrVihnLzsbZDwnOihrHz3mGkgf1Dg9TyxrPy2fSBhKGC3rYAxbWzwqGzNjVBsbJB252zxjZyxrPB24Plcb0AgvYzsbPCYbHihbVC3nPyMLSAxr5ihrOyxqGDgHPCYbHz2vUDcbTywrLigeGC3LUDgf4igvYCM9YlGOkicaGicaGicbjBIbHBNKGChjVzMvZC2LVBMfSig1HDhrLCIWGzw5JB3vYywDLigeGBxvSDgLZDgvWl211BhrPBwvZC2fNzsbZzxnZAw9UigfUzcbHC3nPC3qGAgLTlcbZDwDNzxn0igLTChjVDMvTzw50CYWGy3jPDgLJAxPLigHPCYb3B3jRlcbKzxrLy3qGy2HHBgXLBMDLCYbPzIbJCNvJAwfSigfUzcbZDwDNzxn0ig92zxjJB21LCY4GAgvSCcbOAw0GyMuGyxqGAgLZigjLC3qUcGOGicaGicaGifrVB2XZigf2ywLSywjSzsb0BYb0AguGB3rOzxiGywDLBNqGyxjLoIa','ugXLyxnLigLTCgXLBwvUDcb0AguGB25vC2vYuhjVBxb0igHHBMrSzxiGAw4GDgHLienmss4','su5ervHFrKLmru5btuu','x2DLDezPBgvtywzLq29UDMvYC2f0Aw9Uswq','ChjVBxb0lwvUz2LUzwvY','q3jLyxrPBMCGy29UDMvYC2f0Aw9UoIa','ihbLBMrPBMCPoG','A2v5CW','icbuAgLZignHBIbOyxbWzw4GD2HLBIb0AguGy29UDMvYC2f0Aw9UigjLy29TzxmGDg9VigXHCMDL','ls1dB252zxjZyxrPB24GqMvJyw1LieXVBMCSifrOAxmGugfYDcbiyxmGqMvLBIbtDw1TyxjPEMvKls0','zxn0Aw1HDgvuB2TLBKnVDw50','AM9PBG','Dg9mB3DLCKnHC2u','u1rbvevFreLsx05btuu','y2HLy2TuB29SrxHLy3v0Aw9Uu3rHDhvZ','C2vZC2LVBK92zxjYAwrLCW','DNnJB2rL','BM93','z3jHEq','AwrSzvrPBwvY','y3jLyxrLu3vTBwfYEvbYB21WDa','u1Ltvevnx01fu1nbr0vFuK9mrq','cIaGicaGicaGicaGia','BgfZDefJDgL2Axr5vgLTzq','ChvZAa','q29UDMvYC2f0Aw9UihjLC3vTzwqGD2L0Ag91DcbJB21WBgv0zsbOAxn0B3j5','y3jLyxrLq29UDMvYC2f0Aw9U','C2v0v2fPDgLUz0zVCLvZzxjjBNb1Da','BwfRzxjbz2vUDeLK','zMLSDgvY','D3jPDgvgAwXL','tMv3ignVBNzLCNnHDgLVBIbZDgfYDgvKigfUzcbZzxnZAw9Uihn0yxrLihnHDMvK','ig1LC3nHz2vZ','ihbLBMrPBMCGB3bLCMf0Aw9UCYb0BYbJB21WBgv0zsbVCIb0Aw1LB3v0','vLmGq29KzsbTzxnZywDLihbYB2nLC3nLzcbZDwnJzxnZzNvSBhK','C2XPy2u','cGPzB3uGyxjLigv4CgvJDgvKihrVignVBNn1BhqGEw91CIbmte0GywDLBNqGDxnPBMCGDgHLifTTzxnZywDLxsb0ywCGD2L0Acb0AguGzM9SBg93Aw5NigLKCZOG','y2f0y2G','icaGicbSB3HPysbYzxn1BwuGlI95B3vYlxbYB2PLy3qTzgLYzwn0B3j5','tw9KAwz5Aw5NignVBNrLBNqGAw46ia','B3b0Aw9UCW','vg9VBca','z2v0sw5KAwnHDg9Yu3rHDhvZ','C2vTAs1HDxrV','C2f2zvvZywDLrgf0yq','C2vZC2LVBI1ZDgf0zs5QC29U','Bg9HzenVBNzLCNnHDgLVBKHPC3rVCNK','AwrSzunOzwnRsw50zxj2ywW','ywn0AxzLq29UDMvYC2f0Aw9UswrZ','D2HPDgu','DxbKyxrLq29UDMvYC2f0Aw9U','ls1fBMqGB2yGu3vTBwfYEs0T','ChjVAMvJDerPCG','yMvNAw4GBw9KAwzPy2f0Aw9Uig9MignVBNrLBNqGAw4G','y29UDgvUDa','tefor1vbr0vFtu9eruXFsuq','zw5Oyw5Jzvn5C3rLBvbYB21WDa','ywnJzxnZ','DxrMltG','Aw50zxjHy3rPB25nB2rL','8j+uHcbbDxrVlxbYB2nLzwrPBMCGywz0zxiGmYbZzwnVBMrZig9MigLKBguGDgLTzq','z2v0vg9VBeLKCW','Aw5JBhvKzxm','BMfTzq','lMXVEgLHlxn0yxrL','jYbUB3qGzM91BMqUief2ywLSywjSzsb0B29SCZOG','AxnvC2vYrNjPzw5KBhK','q291BgqGBM90igzPBMqGAgLZDg9YEsbMB3iG','B25vC2vYuhjVBxb0','Dhj5tg9HzenVBNzLCNnHDgLVBKHPC3rVCNLcEvbHDhrLCM4','ChjVy2vZC1rVB2XdB21Tyw5KCW','q2fUBM90igrPC3bSyxKGChjVBxb0ihrVihvZzxi6ie5VihbYB21WDcbOyw5KBgvYigLZihjLz2LZDgvYzwqUia','rM91BMqGyw5KigXVywrLzcbJB252zxjZyxrPB24GAgLZDg9YEsbMB3iG','AgfUzgXLsM9Irg9UzujHC2vKt25nB2rL','y29UDMvYC2f0Aw9UsgLZDg9YEq','DxbKyxrLuhjVAMvJDerPCMvJDg9YEq','BgfUz3vHz2uTBw9KzwW','CMvK','Dg9VBeLK','qwDLBNqG','Dg9VBfjLz2LZDhj5','x3nHBML0AxPLq29UDMvYC2f0Aw9UswrgB3jgAwXL','tgfZDcbZzxnZAw9UigzPBguGC2f2zwqGDg86ia','z2v0q29UDgv4DfDPBMrVD1nPEMu','q09nuefdveLAqvrjt05Ft1vuufvux1jfu0vsvKvFuevsq0vovefhrq','y29UDMvYC2f0Aw9UswrnyxbWAw5N','ywXSu2v0DgXLza','DxbKyxrLtwvZC2fNzuLUzgLJyxrVCG','u0vtu0LptL9tvefurv9gsuXftKfnrq','CgfYC2u','jYbHy2nVCMrPBMCGDg8GDgHLC2uGAw5ZDhj1y3rPB25ZoGOGicaGicaGicaGica','ota4nta1rKX3twzk','DxbKyxrLu3LZDgvTuhjVBxb0C0zVCK1Vzgu','Dg9VBhmGyxzHAwXHyMXLigfYzq','icbHBMqGDgHLihn1Bw1HCNKGC2vYDMLJzsbPCYb1BMf2ywLSywjSzs4','C2L6zq','ns4Gw1vtrviGufjptvbuuYbesvnbqKXfrcbjtIbbvvrpie1prevDia','C3LZDgvT','rMfPBgvKihrVihjLC3vTzsbJB252zxjZyxrPB246','zxHPDa','ofrzC21AAG','q291BgqGBM90igXVywqGy29UDMvYC2f0Aw9UigHPC3rVCNKGzM9Yia','zgvIDwC','8j+uKIbjBNrLCMfJDgL2zsbTB2rLoIbcBg9JA2LUzYbHDxrVBwf0AwmGBwvZC2fNzxm','w1vZzxiGAw5WDxrDoIa','vxbKyxrLzcbJB252zxjZyxrPB24GB3jJAgvZDhjHDg9YihbYB2PLy3qGzgLYzwn0B3j5oIa','icaYlIbpCIbZDgfYDcbHig5LDYbZzxnZAw9UigfZA2LUzYb0AguGywDLBNqGDg8Gy29UDgLUDwu6','rMfPBgvKihrVihnHDMuGC2vZC2LVBIbZDgf0ztO','yMvNAw4','z2v0uhjVBxb0rw5NAw5LzxjtExn0zw1qCM9TChq','cIaGicbzB3uGyxjLigeGChjVBxb0igvUz2LUzwvYAw5Nigv4CgvYDcb3Ag8GzgvZAwDUCYbLzMzLy3rPDMuGC3LZDgvTihbYB21WDhmGzM9YiefjigfNzw50CY4kicaGifDLigfYzsbHyM91Dcb0BYbHC3nPz24GDgHLihjLC3bVBNnPyMLSAxr5igzVCIa','y29UDMvYC2f0Aw9UCW','x2HHBMrSzvn1Bw1HCNLgywLSDxjL','CMvJAxbPzw50','z2v0','Aw5MBW','CMvNAxn0zxjvC2vYuhjVBxb0sgfUzgXLCG','teftvf9trvntsu9ox0zjtevoqu1f','igrVzxmGBM90igv4Axn0lcbJyw5UB3qGCM91DguGBwvZC2fNzs4GqxzHAwXHyMXLigfNzw50CYbHCMu6ia','Aw5PDgLHBgL6zvDPDgHqCM9Qzwn0','u2vZC2LVBIbZDgf0zsbZyxzLzcbZDwnJzxnZzNvSBhKGD2L0AcbPBMrLEcbMAwXLCW','rxjYB3iGChjVy2vZC2LUzYbwuYbdB2rLig1LC3nHz2u6','y2HLy2TbBMrqzxjMB3jTq29TCgfJDgL6yxrPB24','C2v0uhjVAMvJDerPCMvJDg9YEq','teXnihnLCNzPy2uGBM90igf2ywLSywjSzsbMB3iGAw1Hz2uGzgvZy3jPChrPB24','mta5ndq4mZDeCMveuey','8j+AQcbqCM9TChqGDg9VigXVBMCGzgv0zwn0zwqGzM9Yia','AgfZ','ihDPDgGGAw5ZDhj1y3rPB25ZoIa','B3bLCMf0Aw9Uswq','uhjVy2vZC2LUzYa','AxnxywL0Aw5NrM9YvxnLCKLUChv0','CMvNAxn0zxjcDwLSDeLUvg9VBhm','q09nuefdveLAqvrjt05Fru5ex1bfuKnftLrbr0u','surmrv9usu1ft1vux01t','cGO9psbdB21WBgv0zwqGt3bLCMf0Aw9UCYa9pq','BwLU','igzHAwXLzdO','tM8GBwfRzxiGywDLBNqGzM91BMqGDg8GC2vUzcb1C2vYigLUChv0ihrV','Bg9Nz2vY','ChjVy2vZC0fNzw50twvZC2fNzq','Dgv4Da','C2v0','w09Yy2HLC3rYyxrVCL0GtwvZC2fNAw5Nia','AgfZvg9VBa','BwvZC2fNzuLUzgLJyxrVCG','BgfUz3vHz2vnB2rLBa','cUkDJcbuB29Sia','C3LZDgvTlxbYB21WDa','ihrVia','mJa3mta5ELbXCNDJ','AxntAhv0DgLUz0rVD24','C2vUze1LC3nHz2vuB0nVBNzLCNnHDgLVBG'];a0_0x5b40=function(){return _0x4929d6;};return a0_0x5b40();}export const CONVERSATION_CONSTANTS={'STATE_DIR_NAME':a0_0x58da6f(0x141),'SESSION_STATE_FILENAME':a0_0x58da6f(0x12e),'INDEX_FILENAME':'conversation-index.json','LAST_SESSION_FILENAME':'last-session.json','HISTORY_SUFFIX':'-history.json','SYSTEM_MESSAGE_ROLE':a0_0x58da6f(0x162),'USER_MESSAGE_ROLE':'user','ASSISTANT_MESSAGE_ROLE':a0_0x58da6f(0x1b1),'COMPACTIZATION_THRESHOLD_PERCENTAGE':0.7,'COMPACTIZATION_OUTPUT_RESERVE_PERCENTAGE':0.4,'COMPACTIZATION_BEGIN_PERCENTAGE':0.15,'COMPACTIZATION_END_PERCENTAGE':0.35,'MIN_MESSAGES_TO_KEEP':0x2,'SUMMARY_MARKER_BEGIN':a0_0x58da6f(0x237),'SUMMARY_MARKER_END':a0_0x58da6f(0x134),'TOOL_CALL_FREQUENCY_CHECK_MS':0x2710,'TOOL_STATUS_UPDATE_INTERVAL_MS':0x2710,'DEFAULT_CONTEXT_WINDOW_SIZE':0x186a0,'MAKER_AGENT_DEFAULT_ID':a0_0x58da6f(0x215),'LANGUAGE_MODEL_ID':a0_0x58da6f(0x14d),'PROMPT_ENGINEER_ID':a0_0x58da6f(0x232)};export class ConversationOrchestrator{constructor(_0x3c1215,_0x5672f6){const _0x302bf9=a0_0x58da6f;this[_0x302bf9(0x220)]=_0x3c1215,this[_0x302bf9(0x18c)]=_0x5672f6,this['blockedMessages']=[],this[_0x302bf9(0x19c)]=new TagParserService(_0x5672f6),this[_0x302bf9(0x1ae)]=new LLMService(_0x3c1215,_0x5672f6),this['llmService'][_0x302bf9(0x1b9)](_0x2fedd5=>this[_0x302bf9(0x1db)](_0x2fedd5)),this[_0x302bf9(0x151)]=new ToolRegistry(_0x3c1215,_0x5672f6,this['llmService']),this['budgetService']=new BudgetService(_0x3c1215,_0x5672f6),this[_0x302bf9(0x170)]=new Map(),this[_0x302bf9(0x1c7)]=new Map(),this['conversationIdMapping']=new Map(),this[_0x302bf9(0x13c)]=_0x302bf9(0x1e1),this[_0x302bf9(0x1f4)]=new Map(),this['sessionState']={'projectDir':null,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{}},this['toolCheckInterval']=setInterval(()=>this[_0x302bf9(0x23c)](),CONVERSATION_CONSTANTS[_0x302bf9(0x1f1)]),this[_0x302bf9(0x192)]=_0x302bf9(0x1d3),this[_0x302bf9(0x245)]=Date['now'](),this['idleTimer']=null,this['IDLE_TIMEOUT_MS']=0x1388,this[_0x302bf9(0x198)]=![],this['startIdleMonitoring']();}async[a0_0x58da6f(0x178)](_0x319c43){const _0x27a36e=a0_0x58da6f;this['sessionState']['projectDir']=_0x319c43,this[_0x27a36e(0x151)]['setProjectDirectory'](_0x319c43),this[_0x27a36e(0x18c)]['info'](_0x27a36e(0x1e5)+_0x319c43);}async[a0_0x58da6f(0x178)](_0x4efdcf){const _0x357cae=a0_0x58da6f;this[_0x357cae(0x1b5)][_0x357cae(0x135)]=_0x4efdcf,this['toolRegistry']['setProjectDirectory'](_0x4efdcf),this[_0x357cae(0x18c)][_0x357cae(0x174)](_0x357cae(0x1e5)+_0x4efdcf);}[a0_0x58da6f(0x17c)](_0x14d6b7){const _0x1f7335=a0_0x58da6f;this[_0x1f7335(0x1b5)][_0x1f7335(0x135)]=_0x14d6b7,this['toolRegistry']&&this[_0x1f7335(0x151)]['setProjectDirectory'](_0x14d6b7),this[_0x1f7335(0x18c)]['info'](_0x1f7335(0x16a)+_0x14d6b7);}async['initialize'](){const _0x583232=a0_0x58da6f;this[_0x583232(0x151)]=new ToolRegistry(this[_0x583232(0x220)],this['logger']),await this['toolRegistry'][_0x583232(0x185)]();}[a0_0x58da6f(0x14c)](_0x7c1d4a){this['setProjectDirectory'](_0x7c1d4a);}['startIdleMonitoring'](){const _0x40d83a=a0_0x58da6f;this[_0x40d83a(0x130)]=setInterval(()=>{const _0x10d2d8=_0x40d83a;if(this[_0x10d2d8(0x198)])return;if(this['interactionMode']===_0x10d2d8(0x1e1))return;const _0x10927a=Date[_0x10d2d8(0x23f)](),_0x4670d1=_0x10927a-this['lastActivityTime'];this[_0x10d2d8(0x192)]===_0x10d2d8(0x1d3)&&_0x4670d1>=this[_0x10d2d8(0x187)]&&this['sessionState'][_0x10d2d8(0x24a)]&&(this[_0x10d2d8(0x18c)][_0x10d2d8(0x174)](_0x10d2d8(0x13d)),this[_0x10d2d8(0x1d5)]());},0x1f4);}[a0_0x58da6f(0x249)](_0x1bee1f){const _0x2649bb=a0_0x58da6f,_0x3ad284=this['isWaitingForUserInput'];this['isWaitingForUserInput']=_0x1bee1f;if(_0x1bee1f&&!_0x3ad284)console['log'](a0_0x507ef5[_0x2649bb(0x211)](_0x2649bb(0x168)));else!_0x1bee1f&&_0x3ad284&&(console[_0x2649bb(0x21f)](a0_0x507ef5['green'](_0x2649bb(0x1ad))),this['blockedMessages']=[]);}['shouldBlockMessage'](_0x274e03,_0x16aed0){const _0x2dbb3e=a0_0x58da6f;if(this[_0x2dbb3e(0x13c)]!==_0x2dbb3e(0x1e1)||!this[_0x2dbb3e(0x184)])return![];if(_0x16aed0['includes']('[User\x20input]:'))return![];if(_0x16aed0[_0x2dbb3e(0x13f)]('(system\x20message)'))return![];return!![];}[a0_0x58da6f(0x158)](_0x39b986){const _0x4ece28=a0_0x58da6f,_0x559110=this['messageIndicator'];this['messageIndicator']=_0x39b986,this[_0x4ece28(0x245)]=Date['now']();this['idleTimer']&&(clearTimeout(this['idleTimer']),this['idleTimer']=null);if(_0x559110!==_0x39b986){const _0x569c2d=this[_0x4ece28(0x1bf)](_0x39b986);console['log'](a0_0x507ef5[_0x4ece28(0x240)](_0x569c2d+'\x20'+_0x39b986));}}[a0_0x58da6f(0x1bf)](_0x3746b){const _0x521182=a0_0x58da6f;switch(_0x3746b){case _0x521182(0x213):return a0_0x507ef5['yellow']('⏳');case _0x521182(0x22d):return a0_0x507ef5['blue']('🤖');case _0x521182(0x1d3):return a0_0x507ef5['green']('✓');default:return'•';}}async['sendProceedMessage'](){const _0xd78368=a0_0x58da6f;if(!this[_0xd78368(0x1b5)][_0xd78368(0x24a)]||this['isShuttingDown'])return;try{this[_0xd78368(0x158)]('waiting-for-agent'),console[_0xd78368(0x21f)](a0_0x507ef5['gray']('📤\x20Sending\x20auto-proceed\x20message...'));const _0xdc2f1a=new Date()['toTimeString']()['split']('\x20')[0x0];await this['sendMessageToConversation'](this[_0xd78368(0x1b5)]['makerAgentId'],'('+_0xdc2f1a+_0xd78368(0x1bd));}catch(_0x25ec5d){this[_0xd78368(0x18c)]['error'](_0xd78368(0x1d0),_0x25ec5d),this['updateMessageIndicator']('idle');}}['setInteractionMode'](_0x2b783a){const _0xec194d=a0_0x58da6f,_0x35b887=this['interactionMode'];this[_0xec194d(0x13c)]=_0x2b783a,this[_0xec194d(0x18c)][_0xec194d(0x174)](_0xec194d(0x1a9)+_0x35b887+'\x20->\x20'+_0x2b783a);if(_0x2b783a==='interactive'&&_0x35b887!=='interactive')this['setWaitingForUserInput'](!![]);else _0x2b783a!=='interactive'&&_0x35b887==='interactive'&&this[_0xec194d(0x249)](![]);this['updateSystemPromptsForMode'](_0x2b783a);}['getBlockingStatus'](){const _0x498f3b=a0_0x58da6f;return{'interactionMode':this['interactionMode'],'isWaitingForUserInput':this[_0x498f3b(0x184)],'blockedMessagesCount':this[_0x498f3b(0x1fb)][_0x498f3b(0x21b)],'indicatorState':this[_0x498f3b(0x192)]};}[a0_0x58da6f(0x15d)](_0x24f685){const _0x20eada=a0_0x58da6f;for(const [_0x65ab9,_0x499d4e]of this['conversations']){this[_0x20eada(0x22b)](_0x65ab9,_0x24f685);}}[a0_0x58da6f(0x22b)](_0x443c40,_0x589900){const _0x299377=a0_0x58da6f,_0x475339=this[_0x299377(0x170)]['get'](_0x443c40);if(!_0x475339)return;!this['originalSystemPrompts'][_0x299377(0x180)](_0x443c40)&&this[_0x299377(0x1f4)]['set'](_0x443c40,_0x475339['systemPrompt']);const _0x2fb29b=this['originalSystemPrompts']['get'](_0x443c40);let _0x128c09;_0x589900===_0x299377(0x222)?_0x128c09=this[_0x299377(0x228)](_0x2fb29b):_0x128c09=_0x2fb29b,_0x475339[_0x299377(0x1a1)]=_0x128c09,this[_0x299377(0x1ae)]&&this[_0x299377(0x1ae)]['updateConversationSystemPrompt']&&this[_0x299377(0x1ae)][_0x299377(0x22b)](_0x443c40,_0x128c09),this[_0x299377(0x18c)]['debug']('Updated\x20system\x20prompt\x20for\x20'+_0x443c40+_0x299377(0x1e0)+_0x589900+')');}['removePromptSyntaxFromSystemPrompt'](_0x52b653){const _0x406647=a0_0x58da6f;let _0x2d6b12=_0x52b653['replace'](/5\.\s*If you need user input or a decision[^6]*/,_0x406647(0x161));return _0x2d6b12=_0x2d6b12['replace'](/\[prompt[^\]]*\][^[]*\[\/prompt\]/g,''),_0x2d6b12+='\x0a\x0a/*\x20NOTE:\x20Prompt\x20syntax\x20removed\x20for\x20auto\x20mode.\x20'+_0x406647(0x1e2),_0x2d6b12;}[a0_0x58da6f(0x139)](_0x517072,_0x404a22,_0x3be1fd,_0x4c2d77){const _0x168269=a0_0x58da6f;let _0x45d7dd=_0x517072;return!_0x45d7dd['toLocaleLowerCase']()[_0x168269(0x13f)](_0x168269(0x15e))&&(_0x45d7dd+=_0x168269(0x200)+_0x404a22),!_0x45d7dd[_0x168269(0x1de)]()['includes']('using\x20the\x20[message]\x20tag\x20with\x20the\x20following\x20ids')&&(_0x45d7dd+=_0x168269(0x125)+_0x4c2d77[_0x168269(0x239)](',\x20')+'\x0a\x20This\x20section\x20will\x20be\x20sent\x20apart\x20from\x20the\x20tool\x20instructions.'),!_0x45d7dd[_0x168269(0x13f)]('conversation\x20rules\x20are')&&(_0x45d7dd+=_0x168269(0x226)+_0x3be1fd+_0x168269(0x1e6)),_0x45d7dd;}['_sanitizeConversationIdForFile'](_0x5034da){const _0x45912a=a0_0x58da6f;if(!_0x5034da||typeof _0x5034da!=='string')return'conversation-'+Date[_0x45912a(0x23f)]();let _0x4332a6=_0x5034da[_0x45912a(0x1ca)](/\s+/g,'-')['replace'](/[^a-zA-Z0-9_-]/g,'')['replace'](/-+/g,'-')[_0x45912a(0x1ca)](/^-+|-+$/g,'')[_0x45912a(0x23a)]();if(!_0x4332a6)_0x4332a6='conversation-'+Date['now']();else _0x4332a6['length']>0x32&&(_0x4332a6=_0x4332a6[_0x45912a(0x1b8)](0x0,0x28)+'-'+Date['now']()[_0x45912a(0x22a)]()[_0x45912a(0x124)](-0x8));return _0x4332a6;}['_getFileSafeConversationId'](_0x23c3ca){const _0x3d2190=a0_0x58da6f;if(this[_0x3d2190(0x156)]['has'](_0x23c3ca))return this['conversationIdMapping'][_0x3d2190(0x173)](_0x23c3ca);const _0x87a155=this[_0x3d2190(0x152)](_0x23c3ca);return this['conversationIdMapping']['set'](_0x23c3ca,_0x87a155),_0x87a155!==_0x23c3ca&&this[_0x3d2190(0x18c)]['info']('Mapped\x20conversation\x20ID\x20for\x20file\x20operations:\x20\x22'+_0x23c3ca+_0x3d2190(0x1bb)+_0x87a155+'\x22'),_0x87a155;}async['initializeServices'](){const _0x83c7f4=a0_0x58da6f;this[_0x83c7f4(0x1ae)]&&this[_0x83c7f4(0x151)]&&(this[_0x83c7f4(0x151)]['setLLMService'](this['llmService']),this[_0x83c7f4(0x18c)][_0x83c7f4(0x174)]('LLM\x20service\x20connected\x20to\x20tool\x20registry\x20for\x20vision\x20capabilities'));}async['getImageDescription'](_0x42afc2,_0x261615,_0x528552={}){const _0xb127a7=a0_0x58da6f;if(!this[_0xb127a7(0x1ae)])throw new Error(_0xb127a7(0x17d));return await this[_0xb127a7(0x1ae)]['getImageDescription'](_0x42afc2,_0x261615,_0x528552);}async[a0_0x58da6f(0x1a2)](_0x398918,_0x36763e){const _0x43c390=a0_0x58da6f;this['logger']['info']('Handling\x20user\x20prompt:\x20'+_0x36763e['name']+_0x43c390(0x1c5)+_0x398918+'\x20(mode:\x20'+this[_0x43c390(0x13c)]+')');switch(this[_0x43c390(0x13c)]){case _0x43c390(0x222):const _0x515a3a=_0x36763e[_0x43c390(0x129)]&&_0x36763e[_0x43c390(0x129)][_0x43c390(0x21b)]>0x0?_0x36763e['options'][0x0]:_0x43c390(0x1f2);this[_0x43c390(0x18c)][_0x43c390(0x174)]('AUTO\x20mode:\x20Auto-selected\x20\x22'+_0x515a3a+'\x22\x20for\x20prompt:\x20'+_0x36763e['name']),await this['sendMessageToConversation'](_0x398918,'[System\x20Auto-Response]:\x20'+_0x515a3a);break;case _0x43c390(0x12c):if(this['onUserPrompt']){const _0x4a93dc=await this['onUserPrompt'](_0x36763e[_0x43c390(0x140)],_0x36763e[_0x43c390(0x18e)],_0x36763e[_0x43c390(0x129)]);await this[_0x43c390(0x199)](_0x398918,_0x43c390(0x1c9)+_0x4a93dc);}else await this[_0x43c390(0x199)](_0x398918,_0x43c390(0x148)+_0x43c390(0x22f));break;case _0x43c390(0x1e1):default:if(this[_0x43c390(0x145)]){const _0x5a6dc6=await this[_0x43c390(0x145)](_0x36763e['name'],_0x36763e['text'],_0x36763e['options']);await this[_0x43c390(0x199)](_0x398918,_0x43c390(0x1c9)+_0x5a6dc6);}else await this[_0x43c390(0x199)](_0x398918,_0x43c390(0x148)+_0x43c390(0x22f));break;}}async['handleJobDoneBasedOnMode'](_0x3f0fb2){const _0xd7cf6f=a0_0x58da6f;this[_0xd7cf6f(0x18c)]['info'](_0xd7cf6f(0x1a3)+_0x3f0fb2+'\x20(mode:\x20'+this[_0xd7cf6f(0x13c)]+')');if(this[_0xd7cf6f(0x1f9)])await this['onJobDone'](_0x3f0fb2);else switch(this['interactionMode']){case'auto':this['logger'][_0xd7cf6f(0x174)](_0x3f0fb2+'\x0aThank\x20you\x20for\x20choosing\x20Loxia.'),process[_0xd7cf6f(0x164)](0x0);break;case _0xd7cf6f(0x12c):this['logger']['info']('Job\x20completed:\x20'+_0x3f0fb2),this['logger'][_0xd7cf6f(0x174)]('SEMI-AUTO\x20mode:\x20Task\x20completed.\x20Press\x20Ctrl+I\x20to\x20enter\x20interactive\x20mode\x20or\x20exit.');break;case'interactive':default:this['logger'][_0xd7cf6f(0x174)]('Job\x20completed:\x20'+_0x3f0fb2);break;}}[a0_0x58da6f(0x1a5)](_0x2e7554){const _0x27118c=a0_0x58da6f;this[_0x27118c(0x1f9)]=_0x2e7554;}async[a0_0x58da6f(0x18d)](_0x23cf57,_0x586271){const _0x12e379=a0_0x58da6f;this[_0x12e379(0x18c)][_0x12e379(0x174)]('Processing\x20message\x20from\x20'+_0x23cf57);const _0x2ca372=this['tagParserService'][_0x12e379(0x1d2)](_0x586271);_0x2ca372['toolCommands']&&_0x2ca372[_0x12e379(0x21c)][_0x12e379(0x21b)]>0x0&&await this[_0x12e379(0x147)](_0x23cf57,_0x2ca372[_0x12e379(0x21c)]);_0x2ca372['prompt']&&await this['handleUserPromptBasedOnMode'](_0x23cf57,_0x2ca372['prompt']);if(_0x2ca372['jobDone']!=null){await this[_0x12e379(0x14a)](_0x2ca372[_0x12e379(0x201)]);return;}if(_0x2ca372[_0x12e379(0x172)]){const _0x4264f5=_0x2ca372[_0x12e379(0x172)],_0x18a78e=_0x2ca372['content'];await this[_0x12e379(0x21d)](_0x23cf57,_0x4264f5,_0x18a78e),this[_0x12e379(0x18c)]['info']('['+displayOnly(_0x23cf57,0xa)+_0x12e379(0x221)+displayOnly(_0x4264f5,0xa)+_0x12e379(0x19b)+displayOnly(_0x18a78e,0xff)+'\x0a');}!_0x2ca372[_0x12e379(0x172)]&&(!_0x2ca372[_0x12e379(0x21c)]||_0x2ca372['toolCommands']['length']===0x0)&&!_0x2ca372['prompt']&&!_0x2ca372[_0x12e379(0x201)]&&await this[_0x12e379(0x199)](_0x23cf57,'Your\x20message\x20didn\x27t\x20contain\x20any\x20tool\x20commands,\x20a\x20message\x20to\x20another\x20agent,\x20or\x20a\x20prompt.\x20'+'Please\x20use\x20[message\x20to=\x22...\x22]\x20tags\x20to\x20send\x20a\x20message\x20to\x20another\x20agent,\x20'+'[tools-commands]\x20tags\x20to\x20use\x20tools,\x20or\x20the\x20following\x20syntax\x20to\x20interact\x20with\x20the\x20supervising\x20human\x20user:\x20[prompt\x20name=\x22some\x20prompt\x20display\x20title\x22]<prompt\x20message>[option]<option\x201\x20text>[/option]\x20[option]<option\x202\x20text>[/option]...[/prompt]\x0a');}[a0_0x58da6f(0x1dc)](_0x1c83a9){const _0x29de23=a0_0x58da6f,_0x5f44dc=CONVERSATION_CONSTANTS[_0x29de23(0x1bc)],_0xd8109c='You\x20are\x20an\x20AI\x20assistant\x20tasked\x20with\x20completing\x20the\x20following:\x20';try{const _0x4fd3a7=TagParser['extractStructured'](_0x1c83a9,{'role':'ai-role','systemPrompt':_0x29de23(0x195)});let _0x3eecb5=_0x4fd3a7['role'];_0x3eecb5?_0x3eecb5=_0x3eecb5[_0x29de23(0x1ca)](/[\\/]/g,''):(_0x3eecb5=_0x5f44dc,this[_0x29de23(0x18c)][_0x29de23(0x1fd)]('Failed to parse role from prompt engineer response, using default'));let _0x4ac1f7=_0x4fd3a7['systemPrompt'];return!_0x4ac1f7&&(_0x4ac1f7=''+_0xd8109c+_0x1c83a9,this['logger']['warn']('Failed to parse system prompt from prompt engineer response, using generated one')),{'role':_0x3eecb5,'systemPrompt':_0x4ac1f7};}catch(_0xc2c9e){return this['logger']['error'](_0x29de23(0x204),_0xc2c9e),{'role':_0x5f44dc,'systemPrompt':''+_0xd8109c+_0x1c83a9};}}async[a0_0x58da6f(0x1d6)](_0x25314a,_0x3b2429,_0x200cb4,_0x34c305){const _0x47877c=a0_0x58da6f;this['logger'][_0x47877c(0x174)](_0x47877c(0x1ff)+_0x25314a),this['sessionState'][_0x47877c(0x135)]=_0x3b2429;const _0x1ebab5=a0_0x2d3ef3['join'](_0x3b2429,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x3520d9['mkdir'](_0x1ebab5,{'recursive':!![]}),this[_0x47877c(0x1b5)]={'projectDir':_0x3b2429,'makerAgentId':null,'languageModelAgentId':null,'activeConversationIds':[],'conversationHistory':{},'paused':![]};try{const _0x16477d=this['getPromptEngineerSystemPrompt'](this[_0x47877c(0x151)]['getToolsDescription']()),_0xb657b3=CONVERSATION_CONSTANTS['PROMPT_ENGINEER_ID'];await this[_0x47877c(0x248)](_0xb657b3,_0x16477d,[],_0x200cb4);const _0x14a21a=this[_0x47877c(0x21a)](_0x25314a),_0x2a75c7=await this[_0x47877c(0x199)](_0xb657b3,_0x14a21a),{role:_0x40e617,systemPrompt:_0x21396c}=this['parsePromptEngineerResponse'](_0x2a75c7),_0x31134e=_0x40e617||CONVERSATION_CONSTANTS[_0x47877c(0x1bc)];this['sessionState']['makerAgentId']=_0x31134e;const _0x692ff7=this[_0x47877c(0x139)](_0x21396c,this['toolRegistry']['getToolsDescription'](),this['sessionState'][_0x47877c(0x135)],[CONVERSATION_CONSTANTS['LANGUAGE_MODEL_ID']]);await this[_0x47877c(0x248)](_0x31134e,_0x692ff7,[],_0x200cb4);const _0x5b3fd4=CONVERSATION_CONSTANTS[_0x47877c(0x138)];this['sessionState']['languageModelAgentId']=_0x5b3fd4;const _0x25d603=this[_0x47877c(0x1c8)](this['toolRegistry']['getToolsDescription'](),_0x31134e);await this[_0x47877c(0x248)](_0x5b3fd4,_0x25d603,[],_0x200cb4),this['sessionState'][_0x47877c(0x131)]=[_0x31134e,_0x5b3fd4],await this['saveSessionState'](),await this[_0x47877c(0x199)](_0x31134e,_0x47877c(0x16d)),this['logger']['info'](_0x47877c(0x120));}catch(_0x41cf9d){this[_0x47877c(0x18c)][_0x47877c(0x20f)]('Error\x20starting\x20new\x20conversation:',_0x41cf9d);throw _0x41cf9d;}}async['loadConversationHistory'](_0x59d0fc,_0x4e7951){const _0x5ad715=a0_0x58da6f,_0x346a70=this['_getFileSafeConversationId'](_0x4e7951),_0x33fe9b=a0_0x2d3ef3['join'](_0x59d0fc,''+_0x346a70+CONVERSATION_CONSTANTS[_0x5ad715(0x1fc)]);try{const _0x1e1155=await a0_0x3520d9[_0x5ad715(0x1c1)](_0x33fe9b,_0x5ad715(0x13b)),_0x5ec6fd=JSON[_0x5ad715(0x15a)](_0x1e1155),_0xb35345=(_0x5ec6fd['messages']||[])['filter'](_0x1cbd43=>_0x1cbd43[_0x5ad715(0x1d7)]!=='system');await this[_0x5ad715(0x248)](_0x4e7951,_0x5ec6fd['systemPrompt']||'Conversation\x20resumed',_0xb35345),this[_0x5ad715(0x18c)][_0x5ad715(0x174)]('Loaded\x20conversation\x20history\x20for:\x20'+_0x4e7951+'\x20(file:\x20'+_0x346a70+')');}catch(_0x2cab0c){this[_0x5ad715(0x18c)][_0x5ad715(0x1fd)]('Failed\x20to\x20load\x20conversation\x20history\x20for\x20'+_0x4e7951+':\x20'+_0x2cab0c[_0x5ad715(0x224)]),await this['tryLoadConversationHistoryByPattern'](_0x59d0fc,_0x4e7951);}}async[a0_0x58da6f(0x146)](_0x32ea04,_0x44423d){const _0x27cdfb=a0_0x58da6f;try{const _0x237f59=await a0_0x3520d9[_0x27cdfb(0x1c6)](_0x32ea04),_0x288a54=_0x237f59[_0x27cdfb(0x24b)](_0x18e054=>_0x18e054['endsWith'](CONVERSATION_CONSTANTS[_0x27cdfb(0x1fc)])),_0x2cd887=this[_0x27cdfb(0x231)](_0x44423d);for(const _0x2a703e of _0x288a54){const _0x1d4933=_0x2a703e['replace'](CONVERSATION_CONSTANTS[_0x27cdfb(0x1fc)],'');if(_0x1d4933===_0x2cd887||_0x1d4933['includes'](_0x2cd887)||_0x2cd887['includes'](_0x1d4933))try{const _0x4e5864=a0_0x2d3ef3[_0x27cdfb(0x239)](_0x32ea04,_0x2a703e),_0x9caa33=await a0_0x3520d9['readFile'](_0x4e5864,'utf-8'),_0x3084bc=JSON['parse'](_0x9caa33),_0x4cf58a=(_0x3084bc['messages']||[])[_0x27cdfb(0x24b)](_0x325951=>_0x325951[_0x27cdfb(0x1d7)]!==_0x27cdfb(0x162));await this['createConversation'](_0x44423d,_0x3084bc[_0x27cdfb(0x1a1)]||_0x27cdfb(0x21e),_0x4cf58a),this['logger'][_0x27cdfb(0x174)](_0x27cdfb(0x149)+_0x44423d+_0x27cdfb(0x1e3)+_0x2a703e);return;}catch(_0x3b513a){this[_0x27cdfb(0x18c)][_0x27cdfb(0x167)]('Could\x20not\x20read/parse\x20'+_0x2a703e+':',_0x3b513a);}}this['logger'][_0x27cdfb(0x1fd)](_0x27cdfb(0x144)+_0x44423d+',\x20creating\x20empty\x20conversation'),await this['createConversation'](_0x44423d,'Conversation\x20resumed\x20without\x20history.');}catch(_0x32b1fa){this['logger']['error'](_0x27cdfb(0x1c2)+_0x32b1fa[_0x27cdfb(0x224)]),await this[_0x27cdfb(0x248)](_0x44423d,_0x27cdfb(0x247));}}async['saveConversationHistory'](_0x57f3c8){const _0x48829c=a0_0x58da6f;if(!this['sessionState']['projectDir'])return;const _0x210d2c=this['conversations'][_0x48829c(0x173)](_0x57f3c8);if(!_0x210d2c)return;const _0x4f838c=a0_0x2d3ef3['join'](this['sessionState']['projectDir'],CONVERSATION_CONSTANTS[_0x48829c(0x23b)]);await a0_0x3520d9[_0x48829c(0x20d)](_0x4f838c,{'recursive':!![]});const _0x1eaa4f={'id':_0x57f3c8,'originalId':_0x57f3c8,'systemPrompt':_0x210d2c[_0x48829c(0x1a1)],'messages':_0x210d2c['messages'],'contextWindow':_0x210d2c[_0x48829c(0x1df)],'lastUpdated':new Date()['toISOString']()},_0x5c9319=this['_getFileSafeConversationId'](_0x57f3c8),_0x49a3fc=a0_0x2d3ef3['join'](_0x4f838c,''+_0x5c9319+CONVERSATION_CONSTANTS['HISTORY_SUFFIX']);await a0_0x3520d9[_0x48829c(0x24c)](_0x49a3fc,JSON[_0x48829c(0x212)](_0x1eaa4f,null,0x2),'utf-8'),this['logger'][_0x48829c(0x174)](_0x48829c(0x1a8)+_0x57f3c8+'\x20(file:\x20'+_0x5c9319+')');}[a0_0x58da6f(0x171)](_0x5c9ece,_0x25da18){const _0x49d0e1=a0_0x58da6f;this['saveSessionState']()[_0x49d0e1(0x126)](_0x15d70d=>{const _0x25a1a2=_0x49d0e1;this[_0x25a1a2(0x18c)]['error'](_0x25a1a2(0x16c),_0x15d70d);}),this[_0x49d0e1(0x18c)]['error']('Critical\x20error:\x20Cannot\x20create\x20conversation\x20summary\x20for\x20'+_0x5c9ece+':',_0x25da18),console[_0x49d0e1(0x21f)]('\x0a'+a0_0x507ef5[_0x49d0e1(0x14e)](_0x49d0e1(0x1cc))),console[_0x49d0e1(0x21f)](a0_0x507ef5['yellow']('━'['repeat'](0x3c))),console['log'](a0_0x507ef5[_0x49d0e1(0x14e)]('✗\x20Failed\x20to\x20create\x20conversation\x20summary')),console['log'](a0_0x507ef5['gray'](_0x49d0e1(0x236))),console['log'](a0_0x507ef5['gray'](_0x49d0e1(0x15f))),console[_0x49d0e1(0x21f)](''),console[_0x49d0e1(0x21f)](a0_0x507ef5['bold'][_0x49d0e1(0x211)]('🔄\x20TO\x20CONTINUE\x20YOUR\x20WORK:')),console[_0x49d0e1(0x21f)](a0_0x507ef5[_0x49d0e1(0x132)]('\x20\x201.\x20Use\x20the\x20resume\x20command\x20to\x20continue\x20this\x20conversation:')),console[_0x49d0e1(0x21f)](a0_0x507ef5[_0x49d0e1(0x211)](_0x49d0e1(0x127))),console['log'](''),console[_0x49d0e1(0x21f)](a0_0x507ef5[_0x49d0e1(0x132)](_0x49d0e1(0x16b))),console[_0x49d0e1(0x21f)](a0_0x507ef5['cyan']('\x20\x20\x20\x20\x20loxia\x20do\x20\x22continue\x20the\x20previous\x20work\x20in\x20this\x20directory\x22')),console[_0x49d0e1(0x21f)](''),console['log'](a0_0x507ef5[_0x49d0e1(0x132)]('\x20\x203.\x20Or\x20modify\x20existing\x20content:')),console['log'](a0_0x507ef5[_0x49d0e1(0x211)](_0x49d0e1(0x1e4))),console['log'](''),console['log'](a0_0x507ef5[_0x49d0e1(0x240)]('💡\x20Your\x20project\x20files\x20have\x20been\x20saved\x20and\x20can\x20be\x20resumed.')),console[_0x49d0e1(0x21f)](a0_0x507ef5['yellow']('━'['repeat'](0x3c))),this[_0x49d0e1(0x18c)]['error'](_0x49d0e1(0x1eb),{'conversationId':_0x5c9ece,'error':_0x25da18['message'],'errorType':_0x25da18['errorType']||'unknown','originalError':_0x25da18['originalError']||null});const _0x9e421a=new Error('Unrecoverable\x20error\x20during\x20conversation\x20summary.\x20'+_0x49d0e1(0x214));_0x9e421a[_0x49d0e1(0x143)]=!![],_0x9e421a['originalError']=_0x25da18;throw _0x9e421a;}async[a0_0x58da6f(0x1ef)](){const _0x4fc190=a0_0x58da6f;if(!this[_0x4fc190(0x1b5)]['projectDir']){this[_0x4fc190(0x18c)]['warn'](_0x4fc190(0x1fe));return;}try{const _0x207ee9=a0_0x2d3ef3['join'](this[_0x4fc190(0x1b5)]['projectDir'],CONVERSATION_CONSTANTS[_0x4fc190(0x23b)]);await a0_0x3520d9[_0x4fc190(0x20d)](_0x207ee9,{'recursive':!![]}),this[_0x4fc190(0x18c)]['debug']('State\x20directory\x20created/verified:\x20'+_0x207ee9);const _0x1584c9=a0_0x2d3ef3['join'](_0x207ee9,CONVERSATION_CONSTANTS[_0x4fc190(0x159)]),_0x35d27f={'projectDir':this[_0x4fc190(0x1b5)]['projectDir'],'makerAgentId':this[_0x4fc190(0x1b5)]['makerAgentId'],'languageModelAgentId':this['sessionState'][_0x4fc190(0x22c)],'activeConversationIds':this[_0x4fc190(0x1b5)][_0x4fc190(0x131)]||[],'conversationHistory':this['sessionState']['conversationHistory']||{},'conversationIdMapping':Object[_0x4fc190(0x1ba)](this[_0x4fc190(0x156)]),'paused':this['sessionState'][_0x4fc190(0x223)]||![],'lastUpdated':new Date()['toISOString'](),'version':_0x4fc190(0x20a)};await a0_0x3520d9['writeFile'](_0x1584c9,JSON['stringify'](_0x35d27f,null,0x2),_0x4fc190(0x13b)),this['logger']['debug']('Session\x20state\x20saved\x20to:\x20'+_0x1584c9);const _0xc8ae7f=a0_0x2d3ef3[_0x4fc190(0x239)](_0x207ee9,CONVERSATION_CONSTANTS['INDEX_FILENAME']),_0x3ede2c={'projectDir':this[_0x4fc190(0x1b5)]['projectDir'],'lastUpdated':new Date()['toISOString'](),'makerAgentId':this['sessionState']['makerAgentId'],'languageModelAgentId':this['sessionState']['languageModelAgentId'],'activeConversationIds':this[_0x4fc190(0x1b5)]['activeConversationIds']||[],'conversationIdMapping':Object[_0x4fc190(0x1ba)](this['conversationIdMapping']),'sessionStateFile':CONVERSATION_CONSTANTS[_0x4fc190(0x159)],'version':_0x4fc190(0x20a)};await a0_0x3520d9[_0x4fc190(0x24c)](_0xc8ae7f,JSON['stringify'](_0x3ede2c,null,0x2),'utf-8'),this[_0x4fc190(0x18c)]['debug']('Index\x20file\x20saved\x20to:\x20'+_0xc8ae7f);const _0x3653cb=a0_0x2d3ef3['join'](_0x207ee9,CONVERSATION_CONSTANTS[_0x4fc190(0x176)]),_0x5258e4={'projectDir':this[_0x4fc190(0x1b5)][_0x4fc190(0x135)],'timestamp':new Date()[_0x4fc190(0x209)](),'makerAgentId':this[_0x4fc190(0x1b5)][_0x4fc190(0x24a)],'languageModelAgentId':this['sessionState'][_0x4fc190(0x22c)],'conversationIdMapping':Object[_0x4fc190(0x1ba)](this[_0x4fc190(0x156)]),'version':_0x4fc190(0x20a)};await a0_0x3520d9[_0x4fc190(0x24c)](_0x3653cb,JSON['stringify'](_0x5258e4,null,0x2),_0x4fc190(0x13b)),this['logger'][_0x4fc190(0x167)](_0x4fc190(0x153)+_0x3653cb),this['logger'][_0x4fc190(0x174)](_0x4fc190(0x179));}catch(_0x4c9411){this['logger']['error'](_0x4fc190(0x16c),_0x4c9411);throw new Error(_0x4fc190(0x1ac)+_0x4c9411['message']);}}async['resumeConversation'](_0x423296){const _0x340927=a0_0x58da6f;this['logger']['info']('Resuming\x20conversation\x20from:\x20'+_0x423296);try{const _0x26b81c=a0_0x2d3ef3[_0x340927(0x239)](_0x423296,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);try{await a0_0x3520d9[_0x340927(0x13a)](_0x26b81c);}catch(_0x575fab){throw new Error('State\x20directory\x20not\x20found:\x20'+_0x26b81c+'.\x20This\x20may\x20not\x20be\x20a\x20valid\x20Loxia\x20project.');}const _0x3ada51=a0_0x2d3ef3[_0x340927(0x239)](_0x26b81c,CONVERSATION_CONSTANTS['SESSION_STATE_FILENAME']);let _0x2320d3;try{const _0x22c5af=await a0_0x3520d9[_0x340927(0x1c1)](_0x3ada51,_0x340927(0x13b));_0x2320d3=JSON[_0x340927(0x15a)](_0x22c5af),_0x2320d3['conversationIdMapping']&&(this[_0x340927(0x156)]=new Map(Object[_0x340927(0x1cb)](_0x2320d3[_0x340927(0x156)])),this[_0x340927(0x18c)]['info']('Restored\x20'+this[_0x340927(0x156)][_0x340927(0x160)]+'\x20conversation\x20ID\x20mappings'));}catch(_0x47df55){this[_0x340927(0x18c)][_0x340927(0x1fd)]('Could\x20not\x20read\x20session\x20state\x20file:\x20'+_0x47df55[_0x340927(0x224)]);const _0x538eda=a0_0x2d3ef3['join'](_0x26b81c,CONVERSATION_CONSTANTS[_0x340927(0x230)]);try{const _0x4ce22c=await a0_0x3520d9['readFile'](_0x538eda,'utf-8'),_0x4ca4d1=JSON[_0x340927(0x15a)](_0x4ce22c);_0x2320d3={'projectDir':_0x4ca4d1[_0x340927(0x135)]||_0x423296,'makerAgentId':_0x4ca4d1['makerAgentId'],'languageModelAgentId':_0x4ca4d1['languageModelAgentId'],'activeConversationIds':_0x4ca4d1['activeConversationIds']||[],'conversationHistory':{},'conversationIdMapping':_0x4ca4d1['conversationIdMapping']||{}},_0x4ca4d1[_0x340927(0x156)]&&(this['conversationIdMapping']=new Map(Object['entries'](_0x4ca4d1[_0x340927(0x156)]))),this['logger']['info']('Recovered session state from index file');}catch(_0x4d1fd7){throw new Error('Could\x20not\x20read\x20session\x20state\x20or\x20index\x20file:\x20'+_0x47df55['message']);}}this['sessionState']={..._0x2320d3,'projectDir':_0x423296};const _0x39cde6=this['sessionState']['activeConversationIds']||[];for(const _0x2d95ff of _0x39cde6){try{await this[_0x340927(0x12f)](_0x26b81c,_0x2d95ff);}catch(_0x5c0b25){this[_0x340927(0x18c)]['warn'](_0x340927(0x166)+_0x2d95ff+':\x20'+_0x5c0b25['message']),await this[_0x340927(0x248)](_0x2d95ff,'Conversation\x20resumed\x20without\x20complete\x20history');}}this['logger']['info'](_0x340927(0x20b)+_0x39cde6[_0x340927(0x21b)]);}catch(_0x16baec){this['logger'][_0x340927(0x20f)](_0x340927(0x163),_0x16baec);throw new Error(_0x340927(0x202)+_0x16baec['message']);}}async['modifyExistingContent'](_0x39b75b,_0x4c444f){const _0x156f30=a0_0x58da6f;this[_0x156f30(0x18c)]['info'](_0x156f30(0x128)+_0x39b75b+_0x156f30(0x181)+_0x4c444f),this['sessionState']['projectDir']=_0x39b75b;const _0x57be5e=a0_0x2d3ef3['join'](_0x39b75b,CONVERSATION_CONSTANTS['STATE_DIR_NAME']);await a0_0x3520d9['mkdir'](_0x57be5e,{'recursive':!![]});const _0x5e2d93=this[_0x156f30(0x16e)](this['toolRegistry'][_0x156f30(0x1af)](),!![]),_0x15a389=CONVERSATION_CONSTANTS['PROMPT_ENGINEER_ID'];await this['createConversation'](_0x15a389,_0x5e2d93);const _0x274e3c=this['createInitialPromptForEngineer'](_0x4c444f,_0x39b75b,!![]),_0x416408=await this[_0x156f30(0x199)](_0x15a389,_0x274e3c),{role:_0x58fdba,systemPrompt:_0x47a33c}=this['parsePromptEngineerResponse'](_0x416408),_0x9b9c4d=_0x58fdba||'content-modifier';this[_0x156f30(0x1b5)][_0x156f30(0x24a)]=_0x9b9c4d;const _0x19cae7=this['enhanceSystemPrompt'](_0x47a33c,this[_0x156f30(0x151)][_0x156f30(0x1af)](),this[_0x156f30(0x1b5)][_0x156f30(0x135)],[CONVERSATION_CONSTANTS[_0x156f30(0x138)]]);await this['createConversation'](_0x9b9c4d,_0x19cae7);const _0x13d4d3=CONVERSATION_CONSTANTS[_0x156f30(0x138)];this['sessionState']['languageModelAgentId']=_0x13d4d3;const _0x3af6c7=this[_0x156f30(0x1c8)](this[_0x156f30(0x151)][_0x156f30(0x1af)](),_0x9b9c4d);await this['createConversation'](_0x13d4d3,_0x3af6c7),this['sessionState']['activeConversationIds']=[_0x9b9c4d,_0x13d4d3],await this[_0x156f30(0x199)](_0x9b9c4d,_0x156f30(0x136)+_0x39b75b),await this['saveSessionState']();}async['handleUserPrompt'](_0xc04204,_0x13a129){const _0x5bd04d=a0_0x58da6f;this[_0x5bd04d(0x18c)][_0x5bd04d(0x174)]('Handling\x20user\x20prompt:\x20'+_0x13a129[_0x5bd04d(0x140)]+'\x20from\x20'+_0xc04204);if(this['onUserPrompt']){const _0x1b067f=await this['onUserPrompt'](_0x13a129[_0x5bd04d(0x140)],_0x13a129['text'],_0x13a129['options']);await this[_0x5bd04d(0x199)](_0xc04204,'User\x20selected:\x20'+_0x1b067f);}else await this['sendMessageToConversation'](_0xc04204,'Cannot\x20display\x20prompt\x20to\x20user:\x20No\x20prompt\x20handler\x20is\x20registered.\x20'+'Please\x20implement\x20the\x20onUserPrompt\x20handler\x20in\x20the\x20CLI.');}async[a0_0x58da6f(0x1db)](_0x373233){const _0x20fd21=a0_0x58da6f;this[_0x20fd21(0x18c)][_0x20fd21(0x1fd)]('🚨\x20Prompt\x20too\x20long\x20detected\x20for\x20${conversationId}\x20-\x20performing\x20compactization'),await this[_0x20fd21(0x19d)](_0x373233);}async[a0_0x58da6f(0x199)](_0xdecd8a,_0x1acadd){const _0x5a0451=a0_0x58da6f;if(this[_0x5a0451(0x1b2)](_0xdecd8a,_0x1acadd))return this['logger']['info'](_0x5a0451(0x1ab)+displayOnly(_0x1acadd,0x64)),this[_0x5a0451(0x1fb)][_0x5a0451(0x246)]({'conversationId':_0xdecd8a,'message':_0x1acadd,'timestamp':Date['now']()}),_0x5a0451(0x1ce);const _0x1d6b4e=_0xdecd8a===CONVERSATION_CONSTANTS[_0x5a0451(0x138)],_0x4a7a1b=_0x1d6b4e?'waiting-for-llm':_0x5a0451(0x213);!this[_0x5a0451(0x184)]&&this[_0x5a0451(0x158)](_0x4a7a1b);this['logger'][_0x5a0451(0x174)](_0x5a0451(0x190)+_0xdecd8a+':\x0a'+displayOnly(_0x1acadd,0xff));if(!this[_0x5a0451(0x170)]['has'](_0xdecd8a)){!this['isWaitingForUserInput']&&this['updateMessageIndicator'](_0x5a0451(0x1d3));throw new Error('Conversation\x20'+_0xdecd8a+'\x20does\x20not\x20exist');}try{const _0x2f3e71=this[_0x5a0451(0x170)][_0x5a0451(0x173)](_0xdecd8a),_0x585852={'systemPrompt':_0x2f3e71[_0x5a0451(0x1a1)],'messages':_0x2f3e71[_0x5a0451(0x1f7)],'id':_0xdecd8a,'contextWindow':_0x2f3e71['contextWindow']},_0x40405c=await this[_0x5a0451(0x1ae)]['sendMessage'](_0xdecd8a,_0x1acadd,_0x585852);return await this[_0x5a0451(0x17b)](_0xdecd8a),await this[_0x5a0451(0x20c)](_0xdecd8a),this['sessionState']['activeConversationIds']['includes'](_0xdecd8a)&&await this['processAgentMessage'](_0xdecd8a,_0x40405c),!this['isWaitingForUserInput']&&this[_0x5a0451(0x158)]('idle'),_0x40405c;}catch(_0x572b48){!this['isWaitingForUserInput']&&this['updateMessageIndicator'](_0x5a0451(0x1d3));throw _0x572b48;}}async['createConversation'](_0x321496,_0x2f5c78,_0x2276df=[],_0x46892d=null){const _0x4fe202=a0_0x58da6f;this[_0x4fe202(0x18c)]['info'](_0x4fe202(0x233)+_0x321496),this[_0x4fe202(0x1f4)][_0x4fe202(0x18f)](_0x321496,_0x2f5c78);const _0x30c60f=this[_0x4fe202(0x13c)]==='auto'?this[_0x4fe202(0x228)](_0x2f5c78):_0x2f5c78;let _0x172d77=[];_0x2276df[_0x4fe202(0x21b)]>0x0&&(_0x172d77=_0x2276df['filter'](_0x80b857=>_0x80b857[_0x4fe202(0x1d7)]!=='system'));const _0x381663={'id':_0x321496,'systemPrompt':_0x30c60f,'messages':_0x172d77,'contextWindow':this['getContextWindowSize'](_0x321496)};this['conversations']['set'](_0x321496,_0x381663),await this[_0x4fe202(0x1ae)][_0x4fe202(0x1f6)](_0x321496,_0x30c60f,_0x46892d),_0x172d77[_0x4fe202(0x21b)]>0x0&&await this['llmService'][_0x4fe202(0x133)](_0x321496,_0x381663),this[_0x4fe202(0x1b5)][_0x4fe202(0x14b)][_0x321496]={'systemPrompt':_0x30c60f,'lastUpdateTime':new Date()['toISOString']()},await this['saveConversationHistory'](_0x321496);}['getListOfAvailableAgentIds'](_0x34b8be){const _0x2637d6=a0_0x58da6f,_0x11bd9b=Array['from'](this['conversations'][_0x2637d6(0x235)]())[_0x2637d6(0x24b)](_0x108ba3=>_0x108ba3!==_0x34b8be);return _0x11bd9b;}async['routeMessageToAgent'](_0x5b02cd,_0xb36785,_0x4d1a4f){const _0x576d6d=a0_0x58da6f;this['logger']['info']('Routing\x20message\x20from\x20'+_0x5b02cd+_0x576d6d(0x196)+_0xb36785);if(!this['conversations']['has'](_0xb36785)){const _0x55c4a1=_0x576d6d(0x150)+_0xb36785+_0x576d6d(0x177)+this['getListOfAvailableAgentIds'](_0x5b02cd)[_0x576d6d(0x239)](',\x20')+'.\x20if\x20you\x20wish\x20to\x20send\x20a\x20message\x20to\x20the\x20user\x20who\x20requested\x20this\x20task\x20use\x20the\x20[prompt]\x20tool\x20syntax';this['logger'][_0x576d6d(0x1fd)](_0x55c4a1),await this['sendMessageToConversation'](_0x5b02cd,_0x55c4a1);return;}const _0x3d5413='[From\x20'+_0x5b02cd+']:\x20'+_0x4d1a4f;await this['sendMessageToConversation'](_0xb36785,_0x3d5413);}async[a0_0x58da6f(0x21d)](_0xbf83dd,_0x30c498,_0xe6c2de){const _0x253fe7=a0_0x58da6f;this['logger'][_0x253fe7(0x174)]('Routing\x20message\x20from\x20'+_0xbf83dd+_0x253fe7(0x196)+_0x30c498);if(!this[_0x253fe7(0x170)][_0x253fe7(0x180)](_0x30c498)){this[_0x253fe7(0x18c)]['warn']('Agent\x20'+_0x30c498+_0x253fe7(0x229)),await this['sendMessageToConversation'](_0xbf83dd,_0x253fe7(0x1a4)+_0x30c498+':\x20Agent\x20does\x20not\x20exist');return;}const _0x5a2a43='[From\x20'+_0xbf83dd+']:\x20'+_0xe6c2de;await this[_0x253fe7(0x199)](_0x30c498,_0x5a2a43);}async['checkToolExecutionStatus'](){const _0x4502e4=a0_0x58da6f;for(const [_0x5f596a,_0x36f2e7]of this['activeTools']['entries']()){const _0x4cf940=Date['now']()-_0x36f2e7['startTime'];_0x4cf940>CONVERSATION_CONSTANTS['TOOL_STATUS_UPDATE_INTERVAL_MS']&&(await this['sendMessageToConversation'](_0x36f2e7['agentId'],'Tool\x20'+_0x36f2e7[_0x4502e4(0x14f)]+'\x20is\x20still\x20running\x20('+Math[_0x4502e4(0x216)](_0x4cf940/0x3e8)+_0x4502e4(0x1c3)+_0x5f596a),_0x36f2e7[_0x4502e4(0x1f3)]=Date[_0x4502e4(0x23f)]());}}[a0_0x58da6f(0x175)](_0x13e4d4){const _0x2e7855=a0_0x58da6f;this[_0x2e7855(0x145)]=_0x13e4d4;}async['sendUserInput'](_0x305f4f){const _0x15343d=a0_0x58da6f;this['logger']['info'](_0x15343d(0x1b4)+_0x305f4f),this[_0x15343d(0x249)](![]),this[_0x15343d(0x1b5)]['makerAgentId']?await this[_0x15343d(0x199)](this['sessionState'][_0x15343d(0x24a)],_0x15343d(0x169)+_0x305f4f):this['logger'][_0x15343d(0x1fd)](_0x15343d(0x18b));}async['checkAndPerformCompactization'](_0x155cbd){const _0x415a1a=a0_0x58da6f,_0x408c22=this[_0x415a1a(0x170)]['get'](_0x155cbd);if(!_0x408c22)return;const _0x5f42c2=await this['llmService'][_0x415a1a(0x238)](_0x155cbd),_0x15cd1a=_0x408c22[_0x415a1a(0x1df)];_0x5f42c2>_0x15cd1a*CONVERSATION_CONSTANTS['COMPACTIZATION_THRESHOLD_PERCENTAGE']&&(this[_0x415a1a(0x18c)]['info'](_0x415a1a(0x1b6)+_0x155cbd),await this['performCompactization'](_0x155cbd));}async[a0_0x58da6f(0x19d)](_0x29c2d9){const _0x46bad2=a0_0x58da6f,_0xef456c=this[_0x46bad2(0x170)][_0x46bad2(0x173)](_0x29c2d9);if(!_0xef456c||_0xef456c[_0x46bad2(0x1f7)]['length']<0x4)return;const _0x44382c=CONVERSATION_CONSTANTS['MIN_MESSAGES_TO_KEEP'],_0x55a069=_0xef456c['messages'][_0x46bad2(0x124)](0x0,_0x44382c),_0xb69812=_0xef456c[_0x46bad2(0x1df)],_0x58cae9=Math['floor'](_0xb69812*CONVERSATION_CONSTANTS[_0x46bad2(0x155)]),_0x3c411e=_0xb69812-_0x58cae9,_0x1f82f8=CONVERSATION_CONSTANTS['COMPACTIZATION_BEGIN_PERCENTAGE'],_0x3c7f83=CONVERSATION_CONSTANTS[_0x46bad2(0x186)],_0x1a4e6b=Math['max'](_0x44382c,Math['floor'](_0xef456c[_0x46bad2(0x1f7)][_0x46bad2(0x21b)]*_0x1f82f8)),_0x469fc9=Math[_0x46bad2(0x189)](_0xef456c[_0x46bad2(0x1f7)][_0x46bad2(0x21b)]-_0x1a4e6b,Math[_0x46bad2(0x216)](_0xef456c['messages'][_0x46bad2(0x21b)]*_0x3c7f83)),_0x366fef=_0xef456c['messages']['slice'](0x0,_0x1a4e6b),_0x513534=_0xef456c['messages'][_0x46bad2(0x124)](-_0x469fc9),_0x5d878b=_0xef456c['messages'][_0x46bad2(0x124)](_0x1a4e6b,_0xef456c['messages']['length']-_0x469fc9);if(_0x5d878b['length']===0x0)return;const _0xf34121=this[_0x46bad2(0x242)](_0x5d878b);this['logger']['info']('Compactization:\x20'+_0x1a4e6b+'\x20begin\x20+\x20'+_0x5d878b[_0x46bad2(0x21b)]+'\x20summarized\x20+\x20'+_0x469fc9+'\x20end\x20messages');try{const _0x3a3203=await this[_0x46bad2(0x1ae)]['getSummary'](_0x29c2d9,_0xf34121),_0x40bc92={'role':CONVERSATION_CONSTANTS[_0x46bad2(0x243)],'content':CONVERSATION_CONSTANTS['SUMMARY_MARKER_BEGIN']+'\x0a'+_0x3a3203+'\x0a'+CONVERSATION_CONSTANTS['SUMMARY_MARKER_END']};_0xef456c['messages']=[..._0x366fef,_0x40bc92,..._0x513534],await this[_0x46bad2(0x1ae)][_0x46bad2(0x133)](_0x29c2d9,_0xef456c),this['logger'][_0x46bad2(0x174)]('Compactization\x20completed\x20for\x20'+_0x29c2d9+_0x46bad2(0x1ed)+(_0x1a4e6b+_0x5d878b['length']+_0x469fc9)+'\x20to\x20'+(_0x366fef[_0x46bad2(0x21b)]+0x1+_0x513534[_0x46bad2(0x21b)]));}catch(_0x415fe0){this[_0x46bad2(0x18c)][_0x46bad2(0x20f)]('Critical\x20compactization\x20failure:',_0x415fe0),this[_0x46bad2(0x171)](_0x29c2d9,_0x415fe0);}}[a0_0x58da6f(0x242)](_0x37f45c){const _0x587533=a0_0x58da6f;return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20The\x20following\x20text\x20is\x20a\x20part\x20of\x20a\x20conversation.\x20It\x20is\x20very\x20long.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20Replace\x20this\x20part\x20of\x20the\x20conversation\x20with\x20a\x20concise\x20alternative\x20while\x20preserving\x20key\x20information,\x20decisions,\x20and\x20context\x0a\x20\x20\x20\x20\x20\x20\x20\x20Agent\x20should\x20be\x20able\x20to\x20proceed\x20with\x20its\x20task\x20by\x20using\x20this\x20shorter\x20summary\x20instead\x20of\x20the\x20original\x20long\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x37f45c[_0x587533(0x1e8)](_0xa3312=>_0xa3312['role']+':\x20'+_0xa3312['content'])[_0x587533(0x239)]('\x0a\x0a')+'\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20Provide\x20the\x20replacement\x20text.';}[a0_0x58da6f(0x154)](_0x584825){const _0x3aa73f=a0_0x58da6f,_0x1bea39=this['config'][_0x3aa73f(0x1c0)]?.['default']?.[_0x3aa73f(0x1df)]||CONVERSATION_CONSTANTS['DEFAULT_CONTEXT_WINDOW_SIZE'];if(_0x584825===CONVERSATION_CONSTANTS[_0x3aa73f(0x138)])return this[_0x3aa73f(0x220)]['models']?.[_0x3aa73f(0x193)]?.[_0x3aa73f(0x1df)]||_0x1bea39;return _0x1bea39;}['getPromptEngineerSystemPrompt'](_0x32ef55,_0x124c9a=![]){const _0x5757bd=a0_0x58da6f,_0xb3bcfd=_0x124c9a?'modifying\x20existing\x20content':'creating\x20new\x20content';return _0x5757bd(0x16f)+_0xb3bcfd+'\x20to\x20an\x20AI\x20agent.\x20\x0a\x20\x20\x20\x20For\x20that\x20we\x20need\x20to\x20write\x20a\x20comprehensive\x20SYSTEM\x20prompt\x20that\x20will\x20help\x20the\x20agent\x20make\x20smart\x20decisions.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20The\x20agent\x20will\x20need\x20to\x20know\x20the\x20task\x20and\x20the\x20tools\x20available\x20to\x20it,\x20but\x20will\x20also\x20need\x20to\x20think\x20like\x20a\x20professional\x20relevant\x20for\x20the\x20task\x20at\x20hand.\x0a\x0a\x20\x20\x20\x20Your\x20job\x20is\x20to\x20create\x20a\x20role\x20for\x20the\x20AI\x20agent\x20and\x20write\x20a\x20system\x20prompt\x20that\x20will\x20guide\x20it\x20to\x20successfully\x20complete\x20the\x20task.\x0a\x0a\x20\x20\x20\x20Embed\x20appropriate\x20guidelines\x5cprocess\x20description\x20into\x20the\x20system\x20prompt,\x20according\x20to\x20the\x20task\x20type:\x0a\x20\x20\x20\x201.\x20TASK\x20OF\x20DEVELOPING\x20CODE\x5cSOFTWARE:\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20AI\x20Agent\x20Development\x20Process\x20Guide\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Development\x20Stages\x20Overview\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20As\x20conversation\x20progresses,\x20context\x20window\x20will\x20be\x20filled\x20and\x20what\x20agent\x20rememebers\x20will\x20be\x20truncated/summarized.\x0a\x20\x20\x20\x20\x20\x20\x20\x20To\x20retain\x20the\x20context\x20of\x20the\x20project\x20agent\x20will\x20have\x20to\x20use\x20memory\x20tool\x20to\x20store\x20relevant\x20information\x20throughout\x20the\x20conversation.\x0a\x20\x20\x20\x20\x20\x20\x20\x20In\x20particular,\x20the\x20agent\x20should\x20store\x20a\x20summary\x20of\x20each\x20stage,\x20its\x20requirements,\x20and\x20any\x20important\x20decisions\x20made\x20during\x20the\x20development\x20process.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x201:\x20System\x20Functional\x20Description\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20what\x20the\x20system\x20does\x20at\x20a\x20high\x20level\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20a\x20clear\x20description\x20of\x20the\x20system\x27s\x20main\x20purpose\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20the\x20core\x20problem\x20the\x20system\x20solves\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20the\x20system\x27s\x20scope\x20and\x20boundaries\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x202:\x20Comprehensive\x20Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20what\x20the\x20system\x20must\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20List\x20specific\x20features\x20and\x20capabilities\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20interactions\x20and\x20system\x20behaviors\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20data\x20processing\x20requirements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x203:\x20Non-Functional\x20Requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20how\x20the\x20system\x20should\x20perform\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Performance\x20requirements\x20(speed,\x20response\x20time)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Scalability\x20needs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Usability\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x204:\x20System\x20Actors\x20and\x20Target\x20Devices\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Identify\x20who\x20uses\x20the\x20system\x20and\x20how\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20user\x20roles\x20and\x20permissions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20target\x20devices\x20(desktop,\x20mobile,\x20tablet)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20operating\x20system\x20requirements\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20browser\x20compatibility\x20needs\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x205:\x20Use\x20Cases\x20Development\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Document\x20user\x20workflows\x20and\x20interactions\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Write\x20detailed\x20user\x20stories\x20involving\x20system\x20features\x20as\x20previously\x20defined\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20user\x20journeys\x20through\x20the\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Connect\x20features\x20to\x20specific\x20user\x20goals\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Include\x20edge\x20cases\x20and\x20error\x20scenarios\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x206:\x20UX\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Create\x20intuitive,\x20user-friendly\x20interfaces\x20addressing\x20the\x20use\x20cases\x20and\x20features\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Apply\x20modern\x20UX/UI\x20best\x20practices\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Design\x20responsive\x20layouts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20user\x20flows\x20and\x20information\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Consider\x20accessibility\x20standards\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x207:\x20High-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Define\x20system\x20architecture\x20and\x20main\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20core\x20system\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20component\x20responsibilities,\x20inputs,\x20and\x20outputs\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Map\x20data\x20flow\x20between\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Analyze\x20alternatives,\x20choose\x20technology\x20stack\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x208:\x20Low-Level\x20Design\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Detail\x20implementation\x20specifics\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Define\x20database\x20design\x20and\x20schemas\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Specify\x20API\x20endpoints\x20and\x20contracts\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Detail\x20component\x20architecture\x20and\x20interfaces\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Plan\x20error\x20handling\x20strategies\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Security\x20implementation\x20plan\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20Stage\x209:\x20Implementation\x20according\x20to\x20previous\x20stages\x20(longest\x20and\x20most\x20important\x20stage,\x20dedicate\x20more\x20time\x20and\x20messages\x20to\x20this\x20stage)\x0a\x20\x20\x20\x20\x20\x20\x20\x20when\x20implementing\x20the\x20code,\x20make\x20sure\x20to\x20be\x20consider\x20memories\x20stored\x20in\x20memory\x20tool\x20and\x20guidelines\x20derived\x20in\x20previous\x20stages.\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Write\x20and\x20build\x20the\x20complete\x20application\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20In\x20a\x20test\x20driven\x20manner,\x20implement\x20all\x20features\x20and\x20components\x20code\x20as\x20defined\x20in\x20previous\x20stages\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20databases\x20if\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20necessary\x20assets\x20(graphics,\x20icons,\x20etc.)\x20and\x20embed\x20fontawesome\x20(or\x20its\x20alternatives)\x20where\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Implement\x20core\x20features,\x20UI\x20components\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Integrate\x20components\x20(e.g\x20frontend\x20and\x20backend)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Create\x20README.md\x20with\x20setup\x20instructions\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20at\x20this\x20point\x20INSTALL\x20DEPENDENCIES\x20and\x20run\x20project,\x20try\x20until\x20success.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20MULTI-MESSAGE\x20SESSIONS/STAGES:\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Stage\x2010:\x20Testing\x20and\x20Quality\x20Assurance\x0a\x20\x20\x20\x20\x20\x20\x20\x20**Purpose:**\x20Ensure\x20code\x20quality\x20and\x20functionality\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20static\x20code\x20analysis\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20execute\x20unit\x20tests\x20for\x20individual\x20components\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Execute\x20integration\x20tests\x20for\x20component\x20interactions\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Perform\x20end-to-end\x20tests\x20for\x20user\x20workflows\x20\x20-\x20REPAIR\x20UNTIL\x20NO\x20ERRORS\x20ARE\x20PRESENT\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Make\x20sure\x20no\x20errors\x20or\x20bugs\x20are\x20present\x20in\x20the\x20static\x20code\x20analysis,\x20tests,\x20terminal\x20output,\x20and\x20browser\x20testing\x20(console\x20+\x20visual\x20testing\x20using\x20vision\x20capabilities)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20This\x20stage\x20HAS\x20TO\x20BE\x20REPEATED\x20AND\x20RE-CHECKED\x20until\x20all\x20components\x20launch\x20without\x20errors\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20ONLY\x20AFTER\x20THIS\x20STAGE,\x20ONCE\x20TESTING\x20IS\x20COMPLETED\x20AND\x20PROGRAM\x20WAS\x20EXECUTED\x20WITH\x20NO\x20ERRORS,\x20YOU\x20ARE\x20ALLOWED\x20TO\x20ANNOUNCE\x20JOB\x20DONE.\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20##\x20Process\x20Guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Complete\x20each\x20stage\x20thoroughly\x20before\x20moving\x20to\x20the\x20next\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20(Important!)\x20Coversation\x20Dynamics\x20(different\x20stages\x20cannot\x20take\x20part\x20in\x20same\x20message):\x0a\x20\x20\x20\x20\x20\x20\x20\x201)\x20AGENT->LLM:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20identify\x20language-model\x20recipent\x20id,\x20direct\x20a\x20message\x20to\x20him\x20explaining\x20what\x20you\x20want\x20to\x20do\x0a\x20\x20\x20\x20\x20\x20\x20\x20[tool\x20id=\x22update-user\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...use\x20tool\x27s\x20syntax\x20to\x20update\x20the\x20supervising\x20user\x20on\x20what\x20you\x27re\x20doing\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/tool]\x0a\x20\x20\x20\x20\x20\x20\x20\x20[message\x20to=\x22language-model(or\x20any\x20other\x20suitable\x20recipent\x20id)\x22]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20the\x20llm\x20what\x20you\x27re\x20about\x20to\x20do\x20now,\x20ask\x20for\x20recommendations\x20or\x20scoring\x20rubrics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20that\x20would\x20assist\x20you\x20in\x20comleting\x20the\x20following\x20task\x5csub-task\x20with\x20great\x20success\x20and\x20quality\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20consult\x20about\x20challenges,\x20solutions,\x20guidelines\x20and\x20more.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20[/message]\x0a\x20\x20\x20\x20\x20\x20\x20\x202)\x20LLM->AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20llm\x20would\x20give\x20some\x20anwer,\x20agent\x20will\x20be\x20able\x20to\x20return\x20to\x20stage\x20one\x20and\x20continue\x20conversation\x20or\x20when\x20ready\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continuing\x20to\x20step\x203.\x0a\x20\x20\x20\x20\x20\x20\x20\x203)\x20AGENT\x20ACTION:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20agent\x20has\x20no\x20comments\x20regarding\x20llm\x20content,\x20the\x20agent\x20can\x20now\x20do\x20whatever\x20it\x20meant\x20to\x20do\x20(writing\x20content,\x20creating\x20things\x20will\x20tools\x20etc).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20this\x20dynamic\x20acts\x20like\x20a\x20meta-thinking\x20process.\x20Think\x20with\x20your\x20llm\x20-\x20at\x20least\x201\x20message\x20epr\x20thinking,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20act\x20-\x20with\x20the\x20use\x20of\x20tools\x20in\x20the\x20following\x20message,\x20repeat\x20this\x20process.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20always\x20start\x20a\x20message\x20by\x20updating\x20user\x20on\x20current\x20stages.\x20add\x20links\x20to\x20generated\x20files,\x20locations,\x20web\x20pages\x20when\x20needed.\x0a\x20\x20\x20\x20\x20\x20\x20\x204)\x20back\x20to\x20stage\x20one\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20###\x20Code\x20guidelines\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20No\x20magic\x20numbers,\x20use\x20constants\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Project\x20file\x20structure\x20must\x20follow\x20best\x20practices\x20and\x20serve\x20the\x20purpose\x20of\x20the\x20project\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20known\x20and\x20highly\x20maintained\x20packages\x20and\x20technologies\x20which\x20suits\x20the\x20project\x20goals)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Use\x20SecureCoding\x20best\x20practices.\x20if\x20needed\x20install\x20external\x20scanners\x20to\x20scan\x20the\x20files\x20before\x20you\x27re\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20Identify\x20common\x20logic,\x20values\x20and\x20functionality,\x20gather\x20them\x20under\x20suitable\x20project\x20files\x20as\x20dependencies\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20a\x20project\x20that\x20uses\x20package.json\x20or\x20package_lock.json,\x20use\x20seek\x20tool\x20to\x20search\x20for\x20import\x20lines,\x20then\x20use\x20the\x20result\x20to\x20analyze\x20needed\x20packages.\x20when\x20using\x20different\x20technologies\x20make\x20adaptations\x20to\x20acheive\x20same\x20goal.\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20when\x20creating\x20node\x20packages,\x20prefer\x20ESM\x20over\x20CommonJS\x20(unless\x20states\x20otherwise),\x20add\x20\x22type\x22:\x22module\x22\x20to\x20the\x20package.json\x20if\x20needed.\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20IF\x20THIS\x20SOFTWARE\x20IS\x20A\x20COMPUTER\x20GAME\x20COMPLEMENT\x20WITH\x20THE\x20FOLLOWING:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x201:\x20Basic\x20Concept\x20Definition**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Define\x20the\x20game\x27s\x20core\x20idea\x20and\x20desired\x20player\x20experience\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Choose\x20game\x20genre\x20(action,\x20strategy,\x20RPG,\x20puzzle,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20Define\x20target\x20audience\x20(age,\x20skill\x20level,\x20preferences)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x204.\x20Determine\x20target\x20platform\x20(PC,\x20console,\x20mobile)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x202:\x20Game\x20Mechanics\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205.\x20Develop\x20core\x20mechanics\x20(how\x20player\x20interacts\x20with\x20the\x20game)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x206.\x20Design\x20player\x20progression\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x207.\x20Define\x20game\x20rules,\x20limitations\x20and\x20challenges\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x208.\x20Design\x20scoring/reward\x20system\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x203:\x20Initial\x20Technical\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x209.\x20Choose\x20game\x20engine\x20(Unity,\x20Unreal,\x20Godot,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2010.\x20Identify\x20required\x20libraries\x20and\x20tools\x20(physics,\x20networking,\x20AI)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2011.\x20Plan\x20basic\x20code\x20architecture\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2012.\x20Assess\x20hardware\x20requirements\x20and\x20performance\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x204:\x20Visual\x20and\x20Artistic\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2013.\x20Determine\x20art\x20style\x20(realistic,\x20cartoon,\x20pixel\x20art,\x20etc.)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2014.\x20Design\x20color\x20palette\x20and\x20overall\x20atmosphere\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2015.\x20Plan\x20user\x20interface\x20(UI/UX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2016.\x20Create\x20artistic\x20style\x20guide\x20(Art\x20Bible)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x205:\x20Story\x20and\x20Plot\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2017.\x20Write\x20main\x20storyline\x20and\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2018.\x20Develop\x20main\x20and\x20secondary\x20characters\x20with\x20detailed\x20backgrounds\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2019.\x20Create\x20game\x20world\x20and\x20environment\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2020.\x20Write\x20dialogues\x20and\x20in-game\x20texts\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x206:\x20Level\x20and\x20Stage\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2021.\x20Plan\x20overall\x20structure\x20of\x20game\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2022.\x20Detailed\x20design\x20of\x20each\x20stage/level\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2023.\x20Determine\x20how\x20stages\x20connect\x20to\x20the\x20storyline\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2024.\x20Plan\x20difficulty\x20curve\x20and\x20challenge\x20progression\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x207:\x20Audio\x20and\x20Music\x20Design**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2025.\x20Determine\x20musical\x20style\x20and\x20artistic\x20direction\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2026.\x20Plan\x20background\x20music\x20for\x20different\x20stages\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2027.\x20Design\x20sound\x20effects\x20(SFX)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2028.\x20Plan\x20voice\x20acting\x20and\x20dubbing\x20if\x20required\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x208:\x20In-Game\x20Tools\x20and\x20Systems\x20Planning**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2029.\x20Define\x20tools/weapons/items\x20and\x20their\x20properties\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2030.\x20Design\x20acquisition\x20and\x20collection\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2031.\x20Plan\x20inventory\x20and\x20equipment\x20system\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2032.\x20Design\x20additional\x20game\x20systems\x20(trading,\x20crafting,\x20etc.)\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x209:\x20Prototype\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2033.\x20Create\x20basic\x20playable\x20version\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2034.\x20Test\x20core\x20mechanics\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2035.\x20Gather\x20initial\x20feedback\x20and\x20updates\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2036.\x20Validate\x20technical\x20concept\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2010:\x20Full\x20Development**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2037.\x20Develop\x20all\x20systems\x20and\x20content\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2038.\x20Create\x20all\x20artistic\x20assets\x20(graphics,\x20animations)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2039.\x20Record\x20and\x20produce\x20all\x20audio\x20materials\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2040.\x20Integration\x20of\x20all\x20components\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2011:\x20Testing\x20and\x20Bug\x20Fixes**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2041.\x20Comprehensive\x20functional\x20testing\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2042.\x20Performance\x20testing\x20and\x20optimization\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2043.\x20Usability\x20testing\x20with\x20players\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2044.\x20Bug\x20fixes\x20and\x20balance\x20improvements\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20**Stage\x2012:\x20Launch\x20and\x20Distribution**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2045.\x20Prepare\x20for\x20marketing\x20and\x20distribution\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2046.\x20Create\x20marketing\x20materials\x20(trailers,\x20screenshots)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2047.\x20Submit\x20to\x20distribution\x20platforms\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2048.\x20Launch\x20and\x20performance\x20monitoring\x0a\x0a\x20\x20\x20\x202.\x20TASK\x20OF\x20WRITING\x20A\x20BOOK\x5cSTORY:\x0a\x20\x20\x20\x20\x20\x20\x20\x202.1.\x20The\x20agent\x20should\x20create\x20criteria\x20for\x20qualitative\x20measurement\x20of\x20a\x20book/story\x20(general\x20or\x20of\x20the\x20described\x20type)\x0a\x20\x20\x20\x20\x20\x20\x20\x202.2.\x20Development\x20of\x20the\x20central\x20idea\x20along\x20with\x20the\x20main\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.3.\x20Development\x20of\x20secondary\x20plot\x20lines\x0a\x20\x20\x20\x20\x20\x20\x20\x202.4.\x20Development\x20of\x20key\x20points\x20in\x20each\x20plot,\x20central\x20dilemmas\x20and\x20unifying\x20logic\x20for\x20all\x20plots\x20-\x20if\x20there\x27s\x20a\x20need\x20to\x20change\x20or\x20adapt\x20part\x20of\x20the\x20plot\x20lines\x20at\x20this\x20stage,\x20it\x20should\x20be\x20done\x0a\x20\x20\x20\x20\x20\x20\x20\x202.5.\x20Criteria\x20should\x20be\x20written\x20for\x20developing\x20a\x20quality\x20character\x20in\x20the\x20story\x0a\x20\x20\x20\x20\x20\x20\x20\x202.6.\x20For\x20each\x20story,\x20main\x20and\x20secondary\x20characters\x20should\x20be\x20defined\x20along\x20with\x20their\x20role\x20in\x20the\x20plot\x20line\x0a\x20\x20\x20\x20\x20\x20\x20\x202.7.\x20For\x20each\x20character,\x20personal\x20background\x20and\x20living\x20environment\x20in\x20childhood\x20and\x20adulthood\x20should\x20be\x20defined,\x20including\x20beliefs,\x20significant\x20life\x20events,\x20vocabulary,\x20and\x20appearance\x20including\x20hairstyle,\x20clothing,\x20jewelry\x20if\x20any,\x20and\x20more\x20-\x20all\x20according\x20to\x20the\x20plot\x20line\x20and\x20the\x20character\x27s\x20role\x20in\x20the\x20plot\x0a\x20\x20\x20\x20\x20\x20\x20\x202.8.\x20The\x20appearance\x20of\x20each\x20character\x20should\x20be\x20saved\x20in\x20a\x20dedicated\x20place\x20with\x20great\x20detail,\x20it\x20will\x20serve\x20to\x20create\x20consistent\x20graphics\x20if\x20required\x0a\x20\x20\x20\x20\x20\x20\x20\x202.9.\x20For\x20each\x20character,\x20internet\x20research\x20should\x20be\x20conducted\x20to\x20refine\x20it\x20(clothing,\x20beliefs,\x20childhood\x20and\x20adulthood\x20events)\x20to\x20specify\x20events\x20in\x20the\x20environment\x20where\x20they\x20grew\x20up\x20or\x20draw\x20inspiration\x20from\x20areas\x20in\x20the\x20spirit\x20of\x20the\x20region\x20or\x20conditions\x20that\x20the\x20plot\x20unfolds\x0a\x20\x20\x20\x20\x20\x20\x20\x202.10.\x20Between\x20plot\x20lines,\x20intersection\x20points\x20should\x20be\x20created,\x20alternatives\x20examined\x20and\x20intersection\x20points\x20with\x20logic\x20should\x20be\x20chosen,\x20with\x20narrative\x20value\x20that\x20will\x20serve\x20the\x20story\x27s\x20purpose\x20and\x20the\x20reader\x27s\x20interest.\x20This\x20is\x20an\x20opportunity\x20to\x20refine\x20the\x20plot\x20lines,\x20twists\x20and\x20their\x20connection\x20to\x20the\x20characters.\x20This\x20is\x20an\x20opportunity\x20to\x20enrich\x20the\x20description\x20and\x20understanding\x20of\x20the\x20world\x20in\x20which\x20the\x20characters\x20live\x20before\x20actual\x20writing\x20-\x20smells,\x20emotions,\x20sights,\x20events,\x20worldviews,\x20technology,\x20communication,\x20global\x20and\x20national\x20trends\x20including\x20the\x20state\x20of\x20superpowers\x20in\x20the\x20described\x20world,\x20medical\x20and\x20scientific,\x20formative\x20historical\x20events\x20and\x20more\x20as\x20needed\x0a\x20\x20\x20\x20\x20\x20\x20\x202.11.\x20The\x20recurring\x20motifs\x20should\x20be\x20understood\x20if\x20there\x20are\x20any,\x20their\x20essence,\x20identifying\x20central\x20symbols\x20in\x20use,\x20leading\x20metaphors\x20if\x20they\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x202.12.\x20The\x20story\x20should\x20be\x20assigned\x20to\x20a\x20genre,\x20given\x20a\x20working\x20title,\x20locate\x20a\x20worthy\x20and\x20excellent\x20author\x20whose\x20writing\x20style\x20is\x20known\x20and\x20whose\x20writings\x20are\x20accessible\x20or\x20familiar\x20to\x20the\x20model,\x20and\x20choose\x20them\x20as\x20a\x20guiding\x20line\x20for\x20the\x20writing\x20style\x20unless\x20described\x20otherwise\x20in\x20the\x20task\x20description\x0a\x20\x20\x20\x20\x20\x20\x20\x202.13.\x20Begin\x20writing\x20the\x20book\x20-\x20chapter\x20by\x20chapter,\x20stop\x20between\x20chapters\x20and\x20let\x20the\x20user\x20examine\x20the\x20story\x20that\x20was\x20written\x0a\x0a\x20\x20\x20\x203.\x20TASK\x20OF\x20RESEARCHING\x5cINFORMATION\x20GATHERING:\x0a\x20\x20\x20\x20\x20\x20\x20\x203.1.\x20If\x20the\x20user\x20is\x20interested,\x20expand\x20or\x20assist\x20in\x20refining\x20the\x20research\x20question\x20or\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.2.\x20The\x20desired\x20output\x20should\x20be\x20specified\x20-\x20format,\x20file\x20type,\x20and\x20more\x0a\x20\x20\x20\x20\x20\x20\x20\x203.3.\x20Attempt\x20to\x20locate\x20names\x20of\x20websites\x20and\x20sources\x20for\x20the\x20requested\x20information\x0a\x20\x20\x20\x20\x20\x20\x20\x203.4.\x20Divide\x20information\x20sources\x20into\x20sources\x20with\x20direct\x20connection\x20to\x20the\x20task\x20or\x20those\x20that\x20may\x20provide\x20supplementary\x20information\x20-\x20this\x20is\x20an\x20opportunity\x20to\x20locate\x20additional\x20sources\x0a\x20\x20\x20\x20\x20\x20\x20\x203.5.\x20Search\x20these\x20sources\x20thoroughly\x20with\x20the\x20aspiration\x20to\x20locate\x20materials\x20from\x20at\x20least\x2020\x20sources\x20for\x20the\x20general\x20public\x20and\x2020\x20from\x20academic\x20sources,\x20and\x20at\x20least\x2010\x20recent\x20ones\x20from\x20dedicated\x20professional\x20sources\x20if\x20such\x20exist\x0a\x20\x20\x20\x20\x20\x20\x20\x203.6.\x20Design\x20a\x20guiding\x20principle\x20and\x20quality\x20structure\x20for\x20the\x20article/research\x20paper\x20or\x20follow\x20the\x20guidelines\x20given\x20in\x20the\x20task\x0a\x20\x20\x20\x20\x20\x20\x20\x203.7.\x20If\x20materials\x20or\x20support\x20for\x20certain\x20claims\x20or\x20connecting\x20materials\x20are\x20missing,\x20they\x20should\x20be\x20searched\x20for\x20at\x20this\x20stage\x0a\x20\x20\x20\x20\x20\x20\x20\x203.8.\x20Update\x20the\x20output\x20structure,\x20continue\x20writing\x20and\x20move\x20between\x20the\x20different\x20stages\x20as\x20needed\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x204.\x20OTHER\x20TASK\x20TYPES\x20-\x20write\x20such\x20guidlines\x20to\x20the\x20best\x20of\x20your\x20knowledge\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20The\x20next\x20message\x20will\x20describe\x20a\x20task\x20intended\x20for\x20the\x20newly\x20created\x20AI\x20agent\x20to\x20carry.\x0a\x20\x20\x20\x20Return\x20your\x20answer\x20in\x20the\x20following\x20format:\x0a\x20\x20\x20\x20[task-type]develop-software\x20|\x20story-telling\x20|\x20web-research\x20|\x20other[/task-type]\x0a\x20\x20\x20\x20[ai-role]<ai\x20agent\x20role\x20or\x20profession,\x20simple\x20text\x20no\x20slahes,\x20dashes\x20or\x20any\x20special\x20character>[/ai-role]\x0a\x20\x20\x20\x20[system-prompt]<A\x20system\x20prompt\x20which\x20will\x20guide\x20the\x20new\x20agent\x20to\x20handle\x20the\x20given\x20task\x20as\x20good\x20as\x20possible>[/system-prompt]';}[a0_0x58da6f(0x1c8)](_0x5c5208,_0x419f8d){const _0x8421a1=a0_0x58da6f;return _0x8421a1(0x22e)+_0x5c5208+'.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20You\x20are\x20expected\x20to\x20put\x20the\x20text\x20intended\x20for\x20the\x20other\x20agent\x20inside\x20[message\x20to=\x22'+_0x419f8d+_0x8421a1(0x1cd);}[a0_0x58da6f(0x21a)](_0x1d0406,_0x2ad28e=null,_0x8cf867=![]){const _0x4b27ea=a0_0x58da6f,_0x1a3ea8=a0_0x4a09cf();return _0x8cf867&&_0x2ad28e?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20The\x20task\x20is\x20to\x20modify\x20content\x20in\x20the\x20directory\x20\x27'+_0x2ad28e+_0x4b27ea(0x15b)+JSON[_0x4b27ea(0x212)](_0x1d0406):'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TASK\x20FOR\x20THE\x20FUTURE\x20AI\x20AGENT:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+JSON[_0x4b27ea(0x212)](_0x1d0406)+_0x4b27ea(0x244);}async['setBudgetLimit'](_0x4679b){const _0x3c952c=a0_0x58da6f;await this[_0x3c952c(0x1f0)][_0x3c952c(0x1cf)](_0x4679b);}async['getBudgetUsage'](){const _0x4adcc9=a0_0x58da6f;return await this['budgetService'][_0x4adcc9(0x1da)]();}async['setSessionOverrides'](_0x47938b){const _0x58fddf=a0_0x58da6f;this[_0x58fddf(0x23d)]=_0x47938b,this['logger']['info']('Session\x20overrides\x20set',_0x47938b);}async['pauseExecution'](){const _0x448873=a0_0x58da6f;this[_0x448873(0x18c)][_0x448873(0x174)](_0x448873(0x1b7));const _0xf18211='[System]:\x20Execution\x20has\x20been\x20paused\x20by\x20the\x20user.\x20Waiting\x20to\x20resume.';for(const _0x2a4e29 of this['sessionState']['activeConversationIds']){const _0x5eaac5=this[_0x448873(0x170)]['get'](_0x2a4e29);_0x5eaac5&&(_0x5eaac5['messages']['push']({'role':CONVERSATION_CONSTANTS['SYSTEM_MESSAGE_ROLE'],'content':_0xf18211}),await this[_0x448873(0x20c)](_0x2a4e29));}this['sessionState'][_0x448873(0x223)]=!![],await this[_0x448873(0x1ef)]();}async['resumeExecution'](){const _0x205390=a0_0x58da6f;this[_0x205390(0x18c)]['info'](_0x205390(0x218));const _0x36f179=_0x205390(0x1e7);for(const _0x2ed1f9 of this['sessionState'][_0x205390(0x131)]){const _0x4f9ff8=this[_0x205390(0x170)]['get'](_0x2ed1f9);_0x4f9ff8&&(_0x4f9ff8[_0x205390(0x1f7)]['push']({'role':CONVERSATION_CONSTANTS[_0x205390(0x243)],'content':_0x36f179}),await this[_0x205390(0x20c)](_0x2ed1f9));}this['sessionState'][_0x205390(0x223)]=![],await this['saveSessionState']();}['isPaused'](){const _0x593135=a0_0x58da6f;return this['sessionState'][_0x593135(0x223)]===!![];}async['processToolCommands'](_0x1aeb14,_0x59cdfd){const _0x3364f7=a0_0x58da6f;this['logger']['info'](_0x3364f7(0x183)+_0x59cdfd['length']+'\x20tool\x20commands\x20from\x20'+_0x1aeb14);const _0x1cc322=[],_0x6f54ec=[],_0x181aa9=[];for(const _0x59c1da of _0x59cdfd){const {toolId:_0x575f55}=_0x59c1da;this[_0x3364f7(0x18c)][_0x3364f7(0x174)]('Queuing\x20tool:\x20'+_0x575f55);if(!this['toolRegistry'][_0x3364f7(0x191)](_0x575f55)){_0x6f54ec['push']({'toolId':_0x575f55,'status':_0x3364f7(0x20f),'error':_0x3364f7(0x1ea)+_0x575f55+_0x3364f7(0x142)+this['toolRegistry'][_0x3364f7(0x13e)]()[_0x3364f7(0x239)](',\x20')});continue;}try{const _0x1dafb7=this[_0x3364f7(0x151)]['getTool'](_0x575f55),requiresResponse=_0x1dafb7['requiresResponse']!==![],_0x27b0bd=a0_0x4a09cf();_0x6f54ec['push']({'operationId':_0x27b0bd,'toolId':_0x575f55,'command':_0x59c1da,'status':_0x3364f7(0x1ec),'requiresResponse':requiresResponse});requiresResponse&&_0x181aa9[_0x3364f7(0x246)](_0x575f55);const _0x1dcba1=_0x1dafb7[_0x3364f7(0x1be)](_0x59c1da,this[_0x3364f7(0x1b5)]['projectDir'])['then'](_0x19536a=>{const _0x4766c4=_0x3364f7;this[_0x4766c4(0x18c)]['info'](_0x4766c4(0x12a)+_0x575f55+'\x20completed\x20with\x20result:',_0x19536a);const _0x296979=_0x6f54ec[_0x4766c4(0x1b3)](_0x3219db=>_0x3219db['operationId']===_0x27b0bd);return _0x296979&&(_0x296979['status']='success',_0x296979[_0x4766c4(0x1c4)]=_0x19536a),this['activeTools'][_0x4766c4(0x1a7)](_0x27b0bd),_0x19536a;})[_0x3364f7(0x126)](_0x366cdf=>{const _0x5bd1de=_0x3364f7;this[_0x5bd1de(0x18c)]['error'](_0x5bd1de(0x12a)+_0x575f55+_0x5bd1de(0x18a),_0x366cdf);const _0x485489=_0x6f54ec['find'](_0x3ca9f4=>_0x3ca9f4['operationId']===_0x27b0bd);_0x485489&&(_0x485489[_0x5bd1de(0x1d1)]='error',_0x485489['error']=_0x366cdf['message']);this['activeTools'][_0x5bd1de(0x1a7)](_0x27b0bd);throw _0x366cdf;});this['activeTools'][_0x3364f7(0x18f)](_0x27b0bd,{'promise':_0x1dcba1,'toolId':_0x575f55,'agentId':_0x1aeb14,'startTime':Date['now']()}),_0x1cc322['push'](_0x1dcba1);}catch(_0x33cbb0){this['logger'][_0x3364f7(0x20f)](_0x3364f7(0x1dd)+_0x575f55+':',_0x33cbb0),_0x6f54ec[_0x3364f7(0x246)]({'toolId':_0x575f55,'status':'error','error':'Failed\x20to\x20queue\x20tool\x20'+_0x575f55+':\x20'+_0x33cbb0['message'],'requiresResponse':!![]});}}const _0xf19b97=new Promise(_0x189c16=>setTimeout(_0x189c16,0x7d0));await Promise[_0x3364f7(0x1d8)]([_0xf19b97,Promise['allSettled'](_0x1cc322)]);const _0xdfeb96=_0x6f54ec['filter'](_0x1050fd=>(_0x1050fd['status']===_0x3364f7(0x1ee)||_0x1050fd[_0x3364f7(0x1d1)]===_0x3364f7(0x20f))&&_0x1050fd['requiresResponse']!==![]),_0x43f025=_0x6f54ec[_0x3364f7(0x24b)](_0x29e6b4=>_0x29e6b4[_0x3364f7(0x1d1)]===_0x3364f7(0x1ec)&&_0x29e6b4['requiresResponse']!==![]);if(_0xdfeb96[_0x3364f7(0x21b)]>0x0||_0x43f025[_0x3364f7(0x21b)]>0x0){let _0x3971c2='Tool\x20execution\x20report\x20('+_0xdfeb96[_0x3364f7(0x21b)]+'\x20completed,\x20'+_0x43f025[_0x3364f7(0x21b)]+_0x3364f7(0x234);if(_0xdfeb96[_0x3364f7(0x21b)]>0x0){_0x3971c2+=_0x3364f7(0x188);for(const _0x5e554c of _0xdfeb96){_0x5e554c[_0x3364f7(0x1d1)]===_0x3364f7(0x1ee)?(_0x3971c2+='\x0a✅\x20Tool\x20'+_0x5e554c[_0x3364f7(0x14f)]+'\x20completed\x20successfully.',_0x5e554c[_0x3364f7(0x1c4)]&&(_0x3971c2+=_0x3364f7(0x1d9)+JSON['stringify'](_0x5e554c[_0x3364f7(0x1c4)],null,0x2))):_0x3971c2+=_0x3364f7(0x194)+_0x5e554c[_0x3364f7(0x14f)]+'\x20failed:\x20'+_0x5e554c['error'];}}if(_0x43f025[_0x3364f7(0x21b)]>0x0){_0x3971c2+='\x0a\x0a==\x20Pending\x20Operations\x20==';for(const _0x2d547b of _0x43f025){_0x3971c2+='\x0a⏳\x20Tool\x20'+_0x2d547b[_0x3364f7(0x14f)]+_0x3364f7(0x208)+_0x2d547b[_0x3364f7(0x182)]+').'+'\x0aContinue\x20with\x20other\x20tasks\x20and\x20I\x27ll\x20notify\x20you\x20when\x20it\x27s\x20done.',this['trackPendingOperation'](_0x2d547b[_0x3364f7(0x182)],_0x1aeb14);}}await this['sendMessageToConversation'](_0x1aeb14,_0x3971c2);}else this[_0x3364f7(0x18c)][_0x3364f7(0x174)]('All\x20'+_0x59cdfd[_0x3364f7(0x21b)]+'\x20tools\x20were\x20fire-and-forget,\x20no\x20response\x20sent\x20to\x20agent');}['trackPendingOperation'](_0x46c1c6,_0x8ff7f){const _0x5f22ec=a0_0x58da6f,_0x4e2c43=this[_0x5f22ec(0x1c7)]['get'](_0x46c1c6);if(!_0x4e2c43)return;_0x4e2c43['promise']['then'](_0x215eae=>{const _0x521c58=_0x5f22ec;this['queuePendingResult'](_0x8ff7f,_0x4e2c43['toolId'],_0x46c1c6,_0x521c58(0x1ee),{'result':_0x215eae});})['catch'](_0x1b6884=>{const _0x5e4116=_0x5f22ec;this['queuePendingResult'](_0x8ff7f,_0x4e2c43['toolId'],_0x46c1c6,_0x5e4116(0x20f),{'error':_0x1b6884[_0x5e4116(0x224)]});});}['queuePendingResult'](_0x3b8dad,_0x58759a,_0x125087,_0x21d6e3,_0x1231db){const _0x88d016=a0_0x58da6f;!this[_0x88d016(0x19a)]&&(this['pendingResults']=new Map()),!this[_0x88d016(0x19a)][_0x88d016(0x180)](_0x3b8dad)&&this[_0x88d016(0x19a)][_0x88d016(0x18f)](_0x3b8dad,[]),this['pendingResults']['get'](_0x3b8dad)['push']({'toolId':_0x58759a,'operationId':_0x125087,'status':_0x21d6e3,'data':_0x1231db,'timestamp':Date[_0x88d016(0x23f)]()});}async[a0_0x58da6f(0x1db)](_0x5ec56b){const _0x4d53f3=a0_0x58da6f;this[_0x4d53f3(0x18c)]['warn'](_0x4d53f3(0x17f)+_0x5ec56b+'\x20-\x20performing\x20compactization');const _0x2f2c7b=this[_0x4d53f3(0x170)][_0x4d53f3(0x173)](_0x5ec56b);if(!_0x2f2c7b)throw new Error('Conversation\x20'+_0x5ec56b+_0x4d53f3(0x1fa));this[_0x4d53f3(0x18c)][_0x4d53f3(0x174)]('Before\x20compactization:\x20'+_0x2f2c7b[_0x4d53f3(0x1f7)]['length']+_0x4d53f3(0x121)),await this['performCompactization'](_0x5ec56b),this['logger']['info']('After\x20compactization:\x20'+_0x2f2c7b[_0x4d53f3(0x1f7)][_0x4d53f3(0x21b)]+_0x4d53f3(0x121)),this['logger']['info'](_0x4d53f3(0x20e)+_0x5ec56b);}async[a0_0x58da6f(0x19f)](){const _0x3579a3=a0_0x58da6f;this[_0x3579a3(0x18c)][_0x3579a3(0x174)]('Shutting\x20down\x20conversation\x20orchestrator'),this['isShuttingDown']=!![];this[_0x3579a3(0x130)]&&(clearInterval(this[_0x3579a3(0x130)]),this['idleCheckInterval']=null);this[_0x3579a3(0x241)]&&(clearTimeout(this[_0x3579a3(0x241)]),this['idleTimer']=null);clearInterval(this[_0x3579a3(0x225)]),await this[_0x3579a3(0x1ef)]();const _0x4eb567=Array['from'](this[_0x3579a3(0x1c7)]['values']());if(_0x4eb567[_0x3579a3(0x21b)]>0x0){this[_0x3579a3(0x18c)][_0x3579a3(0x174)]('Waiting\x20for\x20'+_0x4eb567[_0x3579a3(0x21b)]+_0x3579a3(0x122));const _0x137885=this[_0x3579a3(0x220)]['shutdownTimeout']||0x2710;try{await Promise[_0x3579a3(0x1d8)]([Promise[_0x3579a3(0x157)](_0x4eb567['map'](_0x1a8171=>_0x1a8171[_0x3579a3(0x205)])),new Promise(_0x55a065=>setTimeout(_0x55a065,_0x137885))]);}catch(_0x21609d){this['logger'][_0x3579a3(0x1fd)]('Error\x20waiting\x20for\x20pending\x20operations\x20during\x20shutdown:',_0x21609d);}for(const [_0x485f38,_0x4bca1]of this[_0x3579a3(0x1c7)]['entries']()){this[_0x3579a3(0x18c)]['info']('Cancelling\x20operation\x20'+_0x485f38+_0x3579a3(0x206)),this[_0x3579a3(0x1c7)][_0x3579a3(0x1a7)](_0x485f38);}}await this[_0x3579a3(0x1ae)]['shutdown'](),await this[_0x3579a3(0x151)][_0x3579a3(0x19f)](),await this['budgetService'][_0x3579a3(0x12d)](),this[_0x3579a3(0x18c)]['info'](_0x3579a3(0x1b0));}async['triggerProceed'](){const _0x275094=a0_0x58da6f;this[_0x275094(0x192)]===_0x275094(0x1d3)?await this[_0x275094(0x1d5)]():this[_0x275094(0x18c)][_0x275094(0x174)]('Cannot\x20proceed:\x20current\x20state\x20is\x20'+this[_0x275094(0x192)]);}[a0_0x58da6f(0x12b)](){const _0x1fa272=a0_0x58da6f;return{'state':this[_0x1fa272(0x192)],'lastActivity':this[_0x1fa272(0x245)],'timeSinceActivity':Date['now']()-this['lastActivityTime'],'willProceedIn':Math['max'](0x0,this['IDLE_TIMEOUT_MS']-(Date['now']()-this['lastActivityTime']))};}async['processMessage'](_0x3bb6c6,_0x1d3210={}){const _0x3d5d8e=a0_0x58da6f;try{this[_0x3d5d8e(0x18c)]['info'](_0x3d5d8e(0x1d4),_0x3bb6c6);!this[_0x3d5d8e(0x1ae)]&&await this[_0x3d5d8e(0x210)]();const _0x317a0a=[{'role':'system','content':'You\x20are\x20Loxia\x20AI,\x20a\x20helpful\x20coding\x20assistant.\x20You\x20are\x20integrated\x20into\x20VS\x20Code\x20and\x20can\x20help\x20with\x20code\x20analysis,\x20generation,\x20and\x20general\x20development\x20tasks.\x0a\x0aCurrent\x20workspace:\x20'+(_0x1d3210[_0x3d5d8e(0x1f8)]||_0x3d5d8e(0x1a6))+_0x3d5d8e(0x219)+(_0x1d3210[_0x3d5d8e(0x203)]||_0x3d5d8e(0x23e))+'\x0a\x0aProvide\x20helpful,\x20concise\x20responses.\x20When\x20showing\x20code,\x20use\x20appropriate\x20language\x20identifiers\x20in\x20code\x20blocks.'},{'role':'user','content':_0x3bb6c6}],_0x57aaac=await this[_0x3d5d8e(0x1ae)][_0x3d5d8e(0x207)](_0x317a0a,{'model':_0x1d3210[_0x3d5d8e(0x1aa)]||null,'stream':![]});return this[_0x3d5d8e(0x18c)][_0x3d5d8e(0x174)](_0x3d5d8e(0x123)),_0x57aaac[_0x3d5d8e(0x137)]||_0x57aaac;}catch(_0x4f78f0){this['logger'][_0x3d5d8e(0x20f)](_0x3d5d8e(0x17a),_0x4f78f0);throw new Error(_0x3d5d8e(0x1e9)+_0x4f78f0['message']);}}}