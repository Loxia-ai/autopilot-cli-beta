const a0_0x346f3f=a0_0xd7d6;(function(_0x9b575f,_0x398ac8){const _0x1a5496=a0_0xd7d6,_0x535579=_0x9b575f();while(!![]){try{const _0x13b737=parseInt(_0x1a5496(0x1d3))/0x1+-parseInt(_0x1a5496(0x1e7))/0x2*(parseInt(_0x1a5496(0x1c6))/0x3)+parseInt(_0x1a5496(0x1fa))/0x4+-parseInt(_0x1a5496(0x1f2))/0x5+parseInt(_0x1a5496(0x1f9))/0x6+parseInt(_0x1a5496(0x205))/0x7+parseInt(_0x1a5496(0x1cd))/0x8;if(_0x13b737===_0x398ac8)break;else _0x535579['push'](_0x535579['shift']());}catch(_0x4f5b5a){_0x535579['push'](_0x535579['shift']());}}}(a0_0x2864,0x31f0a));import{promises as a0_0x5df96a}from'fs';import a0_0x30fd2a from'path';import{TagParser}from'../utilities/tagParser.js';import{BaseTool}from'./baseTool.js';function a0_0xd7d6(_0x2c9734,_0x46d98b){const _0x28643f=a0_0x2864();return a0_0xd7d6=function(_0xd7d6c7,_0x56f6ca){_0xd7d6c7=_0xd7d6c7-0x1c5;let _0x1b24f5=_0x28643f[_0xd7d6c7];if(a0_0xd7d6['ZJQuNh']===undefined){var _0x4c1581=function(_0x5df96a){const _0x30fd2a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x118c7a='',_0x3179ac='';for(let _0x183b7d=0x0,_0x50ab4d,_0x38892f,_0x2b2197=0x0;_0x38892f=_0x5df96a['charAt'](_0x2b2197++);~_0x38892f&&(_0x50ab4d=_0x183b7d%0x4?_0x50ab4d*0x40+_0x38892f:_0x38892f,_0x183b7d++%0x4)?_0x118c7a+=String['fromCharCode'](0xff&_0x50ab4d>>(-0x2*_0x183b7d&0x6)):0x0){_0x38892f=_0x30fd2a['indexOf'](_0x38892f);}for(let _0x45f439=0x0,_0x55099f=_0x118c7a['length'];_0x45f439<_0x55099f;_0x45f439++){_0x3179ac+='%'+('00'+_0x118c7a['charCodeAt'](_0x45f439)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3179ac);};a0_0xd7d6['XkPFNb']=_0x4c1581,_0x2c9734=arguments,a0_0xd7d6['ZJQuNh']=!![];}const _0x611aea=_0x28643f[0x0],_0x197f07=_0xd7d6c7+_0x611aea,_0xb2014b=_0x2c9734[_0x197f07];return!_0xb2014b?(_0x1b24f5=a0_0xd7d6['XkPFNb'](_0x1b24f5),_0x2c9734[_0x197f07]=_0x1b24f5):_0x1b24f5=_0xb2014b,_0x1b24f5;},a0_0xd7d6(_0x2c9734,_0x46d98b);}export class FileTreeTool extends BaseTool{constructor(_0x118c7a,_0x3179ac){const _0x424c8e=a0_0xd7d6;super(_0x118c7a,_0x3179ac),this[_0x424c8e(0x1ee)]=['.loxia_state','node_modules',_0x424c8e(0x206),'dist',_0x424c8e(0x1d9),_0x424c8e(0x1d6),_0x424c8e(0x1c8),'.nuxt','.cache',_0x424c8e(0x1ca),_0x424c8e(0x1c9),'.vscode','.idea',_0x424c8e(0x1cb),'venv',_0x424c8e(0x1d4),'.env'],this['defaultIgnoreExts']=['.map',_0x424c8e(0x208),_0x424c8e(0x1f7),_0x424c8e(0x1ed),'.tmp',_0x424c8e(0x203)];}['getDescription'](){return'\x0aFile\x20Tree\x20Tool:\x20Generates\x20a\x20hierarchical\x20tree\x20representation\x20of\x20your\x20project\x27s\x20file\x20structure.\x0a\x0aUsage:\x0a[tool\x20id=\x22file-tree\x22]\x0a[generate-tree\x20\x0a\x20\x20dir=\x22path/to/directory\x22\x20\x0a\x20\x20max-depth=\x223\x22\x20\x0a\x20\x20ignore-dirs=\x22node_modules,dist,.git\x22\x20\x0a\x20\x20ignore-exts=\x22.map,.min.js\x22\x20\x0a\x20\x20show-files=\x22true\x22\x20\x0a\x20\x20pattern=\x22*.js,*.ts\x22\x0a/]\x0a[/tool]\x0a\x0aParameters:\x0a-\x20dir:\x20Directory\x20to\x20scan\x20(defaults\x20to\x20project\x20root)\x0a-\x20max-depth:\x20Maximum\x20depth\x20to\x20scan\x20(defaults\x20to\x203)\x0a-\x20ignore-dirs:\x20Comma-separated\x20list\x20of\x20directories\x20to\x20ignore\x0a-\x20ignore-exts:\x20Comma-separated\x20list\x20of\x20file\x20extensions\x20to\x20ignore\x0a-\x20show-files:\x20Whether\x20to\x20show\x20files\x20(defaults\x20to\x20true)\x0a-\x20pattern:\x20Optional\x20glob\x20pattern\x20to\x20filter\x20files\x20(e.g.,\x20\x22*.js,*.ts\x22)\x0a\x0aExamples:\x0a1.\x20Generate\x20a\x20basic\x20tree\x20of\x20the\x20project:\x0a[tool\x20id=\x22file-tree\x22]\x0a[generate-tree\x20/]\x0a[/tool]\x0a\x0a2.\x20Generate\x20a\x20detailed\x20tree\x20with\x20custom\x20options:\x0a[tool\x20id=\x22file-tree\x22]\x0a[generate-tree\x20\x0a\x20\x20dir=\x22src\x22\x20\x0a\x20\x20max-depth=\x224\x22\x20\x0a\x20\x20ignore-dirs=\x22tests,fixtures\x22\x20\x0a\x20\x20show-files=\x22true\x22\x20\x0a\x20\x20pattern=\x22*.js,*.jsx\x22\x0a/]\x0a[/tool]\x0a\x0aThe\x20tool\x20automatically\x20ignores\x20common\x20dependency\x20and\x20build\x20directories\x20like\x20node_modules,\x20.git,\x20dist,\x20etc.\x0a\x20\x20\x20\x20';}['parseParameters'](_0x183b7d){const _0x51daba=a0_0xd7d6;this['logger'][_0x51daba(0x1ea)](_0x51daba(0x1fd));const _0x50ab4d={'commands':[]};try{const _0x38892f=TagParser['query'](_0x183b7d,'generate-tree');for(const _0x2b2197 of _0x38892f){_0x50ab4d['commands'][_0x51daba(0x1f0)]({'action':'generate-tree','dir':_0x2b2197[_0x51daba(0x1eb)]['dir']||'.','maxDepth':parseInt(_0x2b2197['attributes']['max-depth']||'3',0xa),'ignoreDirs':(_0x2b2197[_0x51daba(0x1eb)][_0x51daba(0x1d1)]||'')['split'](',')['filter'](Boolean),'ignoreExts':(_0x2b2197[_0x51daba(0x1eb)][_0x51daba(0x1d8)]||'')['split'](',')[_0x51daba(0x202)](Boolean),'showFiles':_0x2b2197['attributes'][_0x51daba(0x1e6)]!==_0x51daba(0x1e4),'pattern':(_0x2b2197['attributes']['pattern']||'')['split'](',')[_0x51daba(0x202)](Boolean)});}return _0x50ab4d;}catch(_0x45f439){return this['logger'][_0x51daba(0x1ef)](_0x51daba(0x1fb),_0x45f439),{'commands':[]};}}async['executeWithParameters'](_0x55099f,_0x100f3d){const _0x21a47f=a0_0xd7d6;this[_0x21a47f(0x201)]['info']('Executing\x20file\x20tree\x20command\x20with\x20parameters:',_0x55099f);const _0x577032=[];if(!_0x55099f[_0x21a47f(0x1fc)]||_0x55099f[_0x21a47f(0x1fc)][_0x21a47f(0x1ff)]===0x0)throw new Error('No\x20file\x20tree\x20commands\x20specified');for(const _0x147d57 of _0x55099f[_0x21a47f(0x1fc)]){try{switch(_0x147d57['action']){case'generate-tree':_0x577032['push'](await this['generateTree'](_0x147d57[_0x21a47f(0x200)],_0x147d57[_0x21a47f(0x1cc)],_0x147d57['ignoreDirs'],_0x147d57['ignoreExts'],_0x147d57[_0x21a47f(0x1f8)],_0x147d57['pattern'],_0x100f3d));break;default:throw new Error(_0x21a47f(0x1e1)+_0x147d57[_0x21a47f(0x1f6)]);}}catch(_0x6a432){this[_0x21a47f(0x201)][_0x21a47f(0x1ef)](_0x21a47f(0x1dd)+_0x147d57[_0x21a47f(0x1f6)]+':',_0x6a432),_0x577032[_0x21a47f(0x1f0)]({'action':_0x147d57['action'],'success':![],'error':_0x6a432['message']});}}return{'results':_0x577032};}async[a0_0x346f3f(0x1df)](_0x55c17a,_0x4c3ddb,_0x7be720,_0x127bbe,_0x421217,_0x4fab1e,_0x2e32a6){const _0x558dc8=a0_0x346f3f;this['logger']['info']('Generating\x20file\x20tree\x20for:\x20'+_0x55c17a);const _0x4e87a4=this['resolvePath'](_0x55c17a,_0x2e32a6),_0x402a78=[...this['defaultIgnoreDirs'],..._0x7be720][_0x558dc8(0x202)](Boolean),_0x144ad5=[...this['defaultIgnoreExts'],..._0x127bbe][_0x558dc8(0x202)](Boolean),_0x4752f6=await this['buildTree'](_0x4e87a4,_0x4e87a4,0x0,_0x4c3ddb,_0x402a78,_0x144ad5,_0x421217,_0x4fab1e),_0xeeb2c0=this[_0x558dc8(0x1db)](_0x4752f6);return{'action':'generate-tree','path':_0x55c17a,'resolvedPath':_0x4e87a4,'tree':_0xeeb2c0,'success':!![]};}async[a0_0x346f3f(0x1dc)](_0x4c99e8,_0x397972,_0x11085a,_0x5e69b2,_0x463a71,_0x38f6fd,_0x4cb781,_0x46bcbd){const _0x58cd7a=a0_0x346f3f;if(_0x11085a>_0x5e69b2)return null;try{const _0x540454=await a0_0x5df96a[_0x58cd7a(0x1d2)](_0x397972,{'withFileTypes':!![]}),_0x408f6e={'name':a0_0x30fd2a['basename'](_0x397972),'path':a0_0x30fd2a[_0x58cd7a(0x1e0)](_0x4c99e8,_0x397972),'type':_0x58cd7a(0x207),'children':[]};for(const _0x1b929e of _0x540454){const _0x29a196=a0_0x30fd2a[_0x58cd7a(0x1d5)](_0x397972,_0x1b929e[_0x58cd7a(0x1d7)]),_0x5569b3=a0_0x30fd2a[_0x58cd7a(0x1e0)](_0x4c99e8,_0x29a196);if(_0x1b929e['isDirectory']()){if(_0x463a71[_0x58cd7a(0x1e3)](_0x12039b=>_0x1b929e['name']===_0x12039b||_0x5569b3[_0x58cd7a(0x204)](a0_0x30fd2a[_0x58cd7a(0x1fe)])['includes'](_0x12039b)))continue;const _0x4273a0=await this['buildTree'](_0x4c99e8,_0x29a196,_0x11085a+0x1,_0x5e69b2,_0x463a71,_0x38f6fd,_0x4cb781,_0x46bcbd);_0x4273a0&&(_0x4273a0[_0x58cd7a(0x1e2)]['length']>0x0||_0x11085a===0x0)&&_0x408f6e['children']['push'](_0x4273a0);}else{if(_0x1b929e[_0x58cd7a(0x1d0)]()&&_0x4cb781){const _0x4ffeea=a0_0x30fd2a['extname'](_0x1b929e['name']);if(_0x38f6fd['includes'](_0x4ffeea))continue;if(_0x46bcbd&&_0x46bcbd['length']>0x0){const _0x2e632b=_0x46bcbd['some'](_0x57997a=>{const _0x13e61d=_0x58cd7a;return _0x57997a[_0x13e61d(0x1f3)]('*.')?_0x1b929e['name'][_0x13e61d(0x1e8)](_0x57997a[_0x13e61d(0x1da)](0x1)):_0x1b929e[_0x13e61d(0x1d7)]['includes'](_0x57997a['replace']('*',''));});if(!_0x2e632b)continue;}_0x408f6e[_0x58cd7a(0x1e2)][_0x58cd7a(0x1f0)]({'name':_0x1b929e[_0x58cd7a(0x1d7)],'path':_0x5569b3,'type':_0x58cd7a(0x1de),'ext':_0x4ffeea});}}}return _0x408f6e['children'][_0x58cd7a(0x1c5)]((_0x58996b,_0x300139)=>{const _0x3e16f9=_0x58cd7a;if(_0x58996b[_0x3e16f9(0x1f5)]===_0x300139['type'])return _0x58996b['name'][_0x3e16f9(0x1e5)](_0x300139['name']);return _0x58996b[_0x3e16f9(0x1f5)]==='directory'?-0x1:0x1;}),_0x408f6e;}catch(_0x47c8fd){return this[_0x58cd7a(0x201)][_0x58cd7a(0x1ef)](_0x58cd7a(0x1e9)+_0x397972+':',_0x47c8fd),{'name':a0_0x30fd2a[_0x58cd7a(0x1ce)](_0x397972),'path':a0_0x30fd2a['relative'](_0x4c99e8,_0x397972),'type':'directory','error':_0x47c8fd[_0x58cd7a(0x1c7)],'children':[]};}}['formatTree'](_0x4de00c,_0x2fa022='',_0x31a2c5=!![]){const _0x11e867=a0_0x346f3f;if(!_0x4de00c)return'';const _0x4b826b=_0x11e867(0x1f4),_0x86d6a2='└──\x20',_0x4c4ff=_0x11e867(0x1cf),_0x473eae=_0x11e867(0x1f1);let _0x2b33e1=''+_0x2fa022+(_0x31a2c5?_0x86d6a2:_0x4b826b)+_0x4de00c['name']+'\x0a';if(_0x4de00c[_0x11e867(0x1e2)]&&_0x4de00c[_0x11e867(0x1e2)]['length']>0x0){const _0x3b5e56=_0x2fa022+(_0x31a2c5?_0x473eae:_0x4c4ff);_0x4de00c[_0x11e867(0x1e2)]['forEach']((_0x1f421d,_0x235bb1)=>{const _0x5b5080=_0x11e867,_0x46830b=_0x235bb1===_0x4de00c[_0x5b5080(0x1e2)]['length']-0x1;_0x2b33e1+=this[_0x5b5080(0x1db)](_0x1f421d,_0x3b5e56,_0x46830b);});}return _0x2b33e1;}['resolvePath'](_0xaf5406,_0x5d07e5){const _0x5aecda=a0_0x346f3f;if(a0_0x30fd2a[_0x5aecda(0x1ec)](_0xaf5406))return _0xaf5406;return a0_0x30fd2a['resolve'](_0x5d07e5,_0xaf5406);}}function a0_0x2864(){const _0x44a43d=['lM1PBI5QCW','C29YDa','mJCZvwf2yNvW','BwvZC2fNzq','lM5LEhq','yM93zxjFy29TCg9Uzw50CW','DMvUzg9Y','x19WEwnHy2HLx18','Bwf4rgvWDgG','mJK3mZK4ngruDxDpsa','yMfZzw5HBwu','4PscicaG','AxngAwXL','AwDUB3jLlwrPCNm','CMvHzgrPCG','mtq0mtLxueHksLm','zw52','AM9PBG','y292zxjHz2u','BMfTzq','AwDUB3jLlwv4Dhm','yNvPBgq','C3vIC3rYAw5N','zM9YBwf0vhjLzq','yNvPBgruCMvL','rxjYB3iGzxHLy3v0Aw5NigzPBguGDhjLzsbJB21Tyw5Kia','zMLSzq','z2vUzxjHDgvuCMvL','CMvSyxrPDMu','vw5RBM93BIbMAwXLihrYzwuGy29TBwfUzdOG','y2HPBgrYzw4','C29Tzq','zMfSC2u','Bg9JywXLq29TCgfYzq','C2HVDY1MAwXLCW','ntGXmNnnv3HIqG','zw5KC1DPDgG','rxjYB3iGyNvPBgrPBMCGDhjLzsbMB3iG','Aw5MBW','yxr0CMLIDxrLCW','AxnbyNnVBhv0zq','lMXVzW','zgvMyxvSDeLNBM9YzurPCNm','zxjYB3i','ChvZAa','icaGia','ntGZnta1tLreDLbs','C3rHCNrZv2L0Aa','4PsC4Psa4Psaia','DhLWzq','ywn0Aw9U','lM1PBI5JC3m','C2HVD0zPBgvZ','odC5otbZzNbWsKK','ndKYnJKYz3LoBuH5','rxjYB3iGCgfYC2LUzYbMAwXLihrYzwuGCgfYyw1LDgvYCZO','y29TBwfUzhm','ugfYC2LUzYbMAwXLihrYzwuGCgfYyw1LDgvYCYb3AxrOifrHz1bHCNnLCG','C2vW','BgvUz3rO','zgLY','Bg9Nz2vY','zMLSDgvY','lNrLBxa','C3bSAxq','ndmXodCYvNn6qvnV','lMDPDa','zgLYzwn0B3j5'];a0_0x2864=function(){return _0x44a43d;};return a0_0x2864();}