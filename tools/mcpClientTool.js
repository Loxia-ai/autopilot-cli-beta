function a0_0x5334(){const _0x3f3f9a=['Dg9VBf9JywXS','y2XLyxi','C2vUze1LC3nHz2vuB01JCa','CgfYC2u','C2vYDMvYrgLYzwn0B3j5','ChvZAa','ywrKlxnLCNzLCNm','rMfPBgvKihrVihnHDMuGtunqihnLCNzLCNmGDg8GzMLSztO','nde3ntGZAfDSAeP0','y29Kzq','Ahr0CdOVlW','z2v0qxzHAwXHyMXLvg9VBhm','zxjYB3i','sw52ywXPzcb0B29SieLeigzVCM1HDdOG','BwnWlxnLCNzLCNm','vw5ZDxbWB3j0zwqGC2vYDMvYihr5Cgu6ia','z2v0t3jdCMvHDgvdBgLLBNq','mty2mJK4m1HQuKPSqW','Dg9VBfnJAgvTyxm','vg9VBcbJywXSig11C3qGAgf2zsbUyw1LigfUzcbHCMD1BwvUDhm','rMfPBgvKihrVignVBM5Ly3qGDg8GC2vYDMvYoIa','BwvZC2fNzs10BY1Ty3a','y2XPzw50CW','BMfTzq','C2L6zq','u2vYDMvYig5HBwuGyw5KifvstcbHCMuGCMvXDwLYzwq','AgfZ','C2vYDMvYCW','rMfPBgvKihrVigfKzcbZzxj2zxiG','mZa4mJi0nevjCKzrCG','Ahr0Ca','y29UDgvUDa','C2vYDMvYCY5QC29U','y2f0y2G','rxjYB3iGzxHLy3v0Aw5Nie1ducbJBgLLBNqGy29TBwfUzca','DhjPBq','y2fSBfrVB2W','mJi5ndq1nfjzwenPAW','jYbKB2vZig5VDcbLEgLZDa','z2v0qxzHAwXHyMXLu2vYDMvYCW','mtq3nZyWnerABwncAa','Aw5PDgLHBgL6zvnLCNzLCKrPCMvJDg9YEq','z2v0rgvZy3jPChrPB24','D3jPDgvgAwXL','uMvTB3zPBMCGtunqihnLCNzLCJOG','z2v0lwf2ywLSywjSzs1Zzxj2zxjZ','mtqZmdu5nJHkzgHzyvu','Aw5MBW','rMfPBgvKihrVihbHCNnLie1ducbTzxnZywDLiePtt046','z2v0lxrVB2WTC2nOzw1H','DhLWzq','ywrKu2vYDMvYCW','zgvSzxrL','zw50CMLLCW','z2v0vg9VBfnJAgvTyq','zgLZy29UBMvJDa','u2vYDMvYicC','r2v0DgLUzYbZy2HLBweGzM9YihrVB2W6ia','rMfPBgvKihrVignYzwf0zsbnq1aGy2XPzw50igzVCIbZzxj2zxiGjW','C2f2zvnLCNzLCNm','C2v0','CMvTB3zLlxnLCNzLCG','Bg9Nz2vY','nvvtruDUAa','rxjYB3iGzgLZy29UBMvJDgLUzYbMCM9Tie1ducbZzxj2zxiG','ie1ducbZzxj2zxjZ','DxjS','u2f2zwqG','rMfPBgvKihrVignYzwf0zsbnq1aGC2vYDMvYigrPCMvJDg9YEtO','yxr0CMLIDxrLCW','BwvZC2fNzq','BgvUz3rO','vg9VBcaN','C3bSAxq','Dg9VBeLK','rxjYB3iGCgfYC2LUzYbnq1aGy2XPzw50ihbHCMfTzxrLCNm6','tM8GzgvZy3jPChrPB24','y29TBwfUzhm','mZiYmJGZn3LIuLnxvG','ru5pru5u','tg9HzgvKia','rMfPBgvKihrVignYzwf0zsbJBgLLBNq','CxvLCNK','z2v0','ywn0Aw9U','qwrKAw5Nia','lMXVEgLHlxn0yxrL','vw5RBM93BIbnq1aGy2XPzw50ignVBw1HBMq6ia','rxHLy3v0Aw5Nie1ducbJBgLLBNqGy29TBwfUzcb3AxrOihbHCMfTzxrLCNm6','AM9PBG','rMfPBgvKihrVigLUAxrPywXPEMuGtunqihnLCNzLCIbKAxjLy3rVCNK6','z2v0lwf2ywLSywjSzs10B29SCW'];a0_0x5334=function(){return _0x3f3f9a;};return a0_0x5334();}function a0_0x200e(_0x2e0396,_0x1fbb2f){const _0x533435=a0_0x5334();return a0_0x200e=function(_0x200e6a,_0x36c41a){_0x200e6a=_0x200e6a-0x108;let _0x3f682c=_0x533435[_0x200e6a];if(a0_0x200e['wwqFBF']===undefined){var _0x3f4af1=function(_0x1eed90){const _0xb8d71c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x333321='',_0x410bf2='';for(let _0x3ba932=0x0,_0x2687b3,_0x536b0a,_0x40ef2d=0x0;_0x536b0a=_0x1eed90['charAt'](_0x40ef2d++);~_0x536b0a&&(_0x2687b3=_0x3ba932%0x4?_0x2687b3*0x40+_0x536b0a:_0x536b0a,_0x3ba932++%0x4)?_0x333321+=String['fromCharCode'](0xff&_0x2687b3>>(-0x2*_0x3ba932&0x6)):0x0){_0x536b0a=_0xb8d71c['indexOf'](_0x536b0a);}for(let _0x3c768a=0x0,_0x1f7325=_0x333321['length'];_0x3c768a<_0x1f7325;_0x3c768a++){_0x410bf2+='%'+('00'+_0x333321['charCodeAt'](_0x3c768a)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x410bf2);};a0_0x200e['bMqSgN']=_0x3f4af1,_0x2e0396=arguments,a0_0x200e['wwqFBF']=!![];}const _0x282c1e=_0x533435[0x0],_0x58d68a=_0x200e6a+_0x282c1e,_0x5efb74=_0x2e0396[_0x58d68a];return!_0x5efb74?(_0x3f682c=a0_0x200e['bMqSgN'](_0x3f682c),_0x2e0396[_0x58d68a]=_0x3f682c):_0x3f682c=_0x5efb74,_0x3f682c;},a0_0x200e(_0x2e0396,_0x1fbb2f);}const a0_0x13920d=a0_0x200e;(function(_0x38730e,_0x24b267){const _0x106997=a0_0x200e,_0x13de8c=_0x38730e();while(!![]){try{const _0x345ecd=parseInt(_0x106997(0x12e))/0x1+-parseInt(_0x106997(0x14e))/0x2+-parseInt(_0x106997(0x118))/0x3+-parseInt(_0x106997(0x143))/0x4*(-parseInt(_0x106997(0x109))/0x5)+-parseInt(_0x106997(0x14b))/0x6+-parseInt(_0x106997(0x137))/0x7+parseInt(_0x106997(0x154))/0x8;if(_0x345ecd===_0x24b267)break;else _0x13de8c['push'](_0x13de8c['shift']());}catch(_0x326d5f){_0x13de8c['push'](_0x13de8c['shift']());}}}(a0_0x5334,0x84a63));import{Client}from'@modelcontextprotocol/sdk/client/index.js';import{StdioClientTransport}from'@modelcontextprotocol/sdk/client/stdio.js';import{StreamableHTTPClientTransport}from'@modelcontextprotocol/sdk/client/streamableHttp.js';import{BaseTool}from'./baseTool.js';import{TagParser}from'../utilities/tagParser.js';import a0_0x1eed90 from'path';import a0_0xb8d71c from'fs/promises';export class MCPClientTool extends BaseTool{constructor(_0x333321,_0x410bf2){const _0x164fe0=a0_0x200e;super(_0x333321,_0x410bf2),this['servers']=new Map(),this[_0x164fe0(0x13c)]=new Map(),this['toolSchemas']=new Map(),this['serverDirectory']=a0_0x1eed90[_0x164fe0(0x123)](process['cwd'](),_0x164fe0(0x120),_0x164fe0(0x134)),this['initializeServerDirectory']()[_0x164fe0(0x147)](_0x3ba932=>{const _0x4f534a=_0x164fe0;this['logger']['error'](_0x4f534a(0x124),_0x3ba932);});}async[a0_0x13920d(0x14f)](){const _0x344aec=a0_0x13920d;try{await a0_0xb8d71c['mkdir'](this[_0x344aec(0x12a)],{'recursive':!![]});try{const _0x2687b3=a0_0x1eed90[_0x344aec(0x123)](this[_0x344aec(0x12a)],'servers.json'),_0x536b0a=await a0_0xb8d71c['readFile'](_0x2687b3,'utf-8'),_0x40ef2d=JSON[_0x344aec(0x129)](_0x536b0a);for(const [_0x3c768a,_0x1f7325]of Object[_0x344aec(0x15b)](_0x40ef2d)){this['servers']['set'](_0x3c768a,_0x1f7325);}this[_0x344aec(0x108)]['info'](_0x344aec(0x11a)+this[_0x344aec(0x141)][_0x344aec(0x13e)]+'\x20saved\x20MCP\x20servers');}catch(_0x5c4c2c){_0x5c4c2c[_0x344aec(0x12f)]!==_0x344aec(0x119)&&this['logger']['warn']('Failed\x20to\x20load\x20saved\x20MCP\x20servers:',_0x5c4c2c);}}catch(_0x4b7f54){this[_0x344aec(0x108)]['error'](_0x344aec(0x10e),_0x4b7f54);}}[a0_0x13920d(0x150)](){return'\x0aMCP\x20Client\x20Tool:\x20Allows\x20you\x20to\x20interact\x20with\x20Model\x20Context\x20Protocol\x20(MCP)\x20servers\x20to\x20access\x20external\x20tools\x20and\x20resources.\x0a\x0aUsage:\x0a[tool\x20id=\x22mcp-client\x22]\x0a[get-available-servers\x20/]\x0a[get-available-tools\x20/]\x0a\x0a[add-servers]\x0a[s\x20name=\x22server-name\x22\x20url=\x22http://server-url\x22\x20/]\x0a[/add-servers]\x0a\x0a[remove-server]\x0aserver-name\x0a[/remove-server]\x0a\x0a[get-tool-schema]\x0aserver-name/tool-name\x0a[/get-tool-schema]\x0a\x0a[message-to-mcp]\x0a{\x0a\x20\x20\x22tool_call\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22server-name/tool-name\x22,\x0a\x20\x20\x20\x20\x22arguments\x22:\x20{\x20\x22param1\x22:\x20\x22value1\x22,\x20\x22param2\x22:\x20\x22value2\x22\x20}\x0a\x20\x20}\x0a}\x0a[/message-to-mcp]\x0a[/tool]\x0a\x0aExamples:\x0a1.\x20List\x20available\x20MCP\x20servers:\x0a[tool\x20id=\x22mcp-client\x22]\x0a[get-available-servers\x20/]\x0a[/tool]\x0a\x0a2.\x20List\x20available\x20tools\x20from\x20all\x20servers:\x0a[tool\x20id=\x22mcp-client\x22]\x0a[get-available-tools\x20/]\x0a[/tool]\x0a\x0a3.\x20Add\x20a\x20new\x20MCP\x20server:\x0a[tool\x20id=\x22mcp-client\x22]\x0a[add-servers]\x0a[s\x20name=\x22system-tools\x22\x20url=\x22http://localhost:3001\x22\x20/]\x0a[/add-servers]\x0a[/tool]\x0a\x0a4.\x20Remove\x20an\x20MCP\x20server:\x0a[tool\x20id=\x22mcp-client\x22]\x0a[remove-server]\x0asystem-tools\x0a[/remove-server]\x0a[/tool]\x0a\x0a5.\x20Get\x20the\x20schema\x20for\x20a\x20specific\x20tool:\x0a[tool\x20id=\x22mcp-client\x22]\x0a[get-tool-schema]\x0asystem-tools/runCommand\x0a[/get-tool-schema]\x0a[/tool]\x0a\x0a6.\x20Call\x20an\x20MCP\x20tool:\x0a[tool\x20id=\x22mcp-client\x22]\x0a[message-to-mcp]\x0a{\x0a\x20\x20\x22tool_call\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22system-tools/runCommand\x22,\x0a\x20\x20\x20\x20\x22arguments\x22:\x20{\x20\x22command\x22:\x20\x22ls\x20-la\x22\x20}\x0a\x20\x20}\x0a}\x0a[/message-to-mcp]\x0a[/tool]\x0a\x20\x20\x20\x20';}['parseParameters'](_0x59c698){const _0x5c5613=a0_0x13920d;this[_0x5c5613(0x108)]['info']('Parsing\x20MCP\x20client\x20parameters\x20with\x20TagParser');const _0x1eafb2={'commands':[]};try{const _0x2dacb4=TagParser[_0x5c5613(0x11c)](_0x59c698,'get-available-servers');_0x2dacb4[_0x5c5613(0x111)]>0x0&&_0x1eafb2['commands'][_0x5c5613(0x12b)]({'action':_0x5c5613(0x153)});const _0x5bda52=TagParser[_0x5c5613(0x11c)](_0x59c698,_0x5c5613(0x125));_0x5bda52['length']>0x0&&_0x1eafb2['commands']['push']({'action':'get-available-tools'});const _0x5f2070=TagParser[_0x5c5613(0x11c)](_0x59c698,_0x5c5613(0x12c));for(const _0x3ba8ca of _0x5f2070){const _0x44867d=TagParser[_0x5c5613(0x11c)](_0x3ba8ca[_0x5c5613(0x145)],'s'),_0x485a89=[];for(const _0x13ab84 of _0x44867d){const _0x44eca6=_0x13ab84['attributes'][_0x5c5613(0x13d)],_0x4650e0=_0x13ab84[_0x5c5613(0x10f)][_0x5c5613(0x10c)];_0x44eca6&&_0x4650e0&&_0x485a89['push']({'name':_0x44eca6,'url':_0x4650e0});}_0x485a89[_0x5c5613(0x111)]>0x0&&_0x1eafb2[_0x5c5613(0x117)][_0x5c5613(0x12b)]({'action':_0x5c5613(0x12c),'servers':_0x485a89});}const _0xc82b96=TagParser['query'](_0x59c698,'remove-server');for(const _0x2ef8a7 of _0xc82b96){const _0x32e6aa=_0x2ef8a7[_0x5c5613(0x145)][_0x5c5613(0x149)]();_0x32e6aa&&_0x1eafb2[_0x5c5613(0x117)]['push']({'action':_0x5c5613(0x163),'serverName':_0x32e6aa});}const _0x3e4425=TagParser['query'](_0x59c698,'get-tool-schema');for(const _0x4b54a9 of _0x3e4425){const _0x14b7ce=_0x4b54a9[_0x5c5613(0x145)][_0x5c5613(0x149)]();_0x14b7ce&&_0x1eafb2[_0x5c5613(0x117)]['push']({'action':'get-tool-schema','toolId':_0x14b7ce});}const _0x583e4c=TagParser[_0x5c5613(0x11c)](_0x59c698,'message-to-mcp');for(const _0x275301 of _0x583e4c){const _0x2d8a8e=_0x275301[_0x5c5613(0x145)]['trim']();if(_0x2d8a8e){let _0x12a00c;try{_0x12a00c=JSON[_0x5c5613(0x129)](_0x2d8a8e);}catch(_0x162d95){this['logger'][_0x5c5613(0x132)](_0x5c5613(0x156),_0x162d95);continue;}_0x1eafb2['commands']['push']({'action':'message-to-mcp','message':_0x12a00c});}}return _0x1eafb2;}catch(_0x303af1){return this['logger']['error'](_0x5c5613(0x115),_0x303af1),{'commands':[]};}}async['executeWithParameters'](_0x47f176,_0x23c1ee){const _0x37e2eb=a0_0x13920d;this['logger']['info'](_0x37e2eb(0x122),_0x47f176);const _0x23d3b5=[];if(!_0x47f176['commands']||_0x47f176['commands'][_0x37e2eb(0x111)]===0x0)throw new Error('No\x20MCP\x20client\x20commands\x20specified');for(const _0xc53d58 of _0x47f176[_0x37e2eb(0x117)]){try{let _0x11cae6;switch(_0xc53d58['action']){case _0x37e2eb(0x153):_0x11cae6=await this['getAvailableServers']();break;case _0x37e2eb(0x125):_0x11cae6=await this[_0x37e2eb(0x131)]();break;case'add-servers':_0x11cae6=await this[_0x37e2eb(0x159)](_0xc53d58[_0x37e2eb(0x141)]);break;case _0x37e2eb(0x163):_0x11cae6=await this['removeServer'](_0xc53d58['serverName']);break;case _0x37e2eb(0x157):_0x11cae6=await this[_0x37e2eb(0x15c)](_0xc53d58[_0x37e2eb(0x114)]);break;case _0x37e2eb(0x13b):_0x11cae6=await this[_0x37e2eb(0x128)](_0xc53d58['message']);break;default:throw new Error(_0x37e2eb(0x121)+_0xc53d58[_0x37e2eb(0x11e)]);}_0x23d3b5[_0x37e2eb(0x12b)](_0x11cae6);}catch(_0x21fa3e){this[_0x37e2eb(0x108)][_0x37e2eb(0x132)](_0x37e2eb(0x148)+_0xc53d58['action']+':',_0x21fa3e),_0x23d3b5['push']({'action':_0xc53d58[_0x37e2eb(0x11e)],'success':![],'error':_0x21fa3e[_0x37e2eb(0x110)]});}}return{'results':_0x23d3b5};}async[a0_0x13920d(0x14d)](){const _0x4f7a0b=a0_0x13920d;this[_0x4f7a0b(0x108)][_0x4f7a0b(0x155)]('Getting\x20available\x20MCP\x20servers');const _0x100197=[];for(const [_0x50bb97,_0x5aae37]of this['servers'][_0x4f7a0b(0x15b)]()){_0x100197['push']({'name':_0x50bb97,'url':_0x5aae37[_0x4f7a0b(0x10c)],'type':_0x5aae37[_0x4f7a0b(0x158)]||'http'});}return{'action':_0x4f7a0b(0x153),'servers':_0x100197,'success':!![]};}async['getAvailableTools'](){const _0x29b28f=a0_0x13920d;this[_0x29b28f(0x108)][_0x29b28f(0x155)]('Getting available tools from MCP servers');const _0x4aac24=[],_0x2e72ce=[];for(const [_0x251014,_0x12c359]of this[_0x29b28f(0x141)][_0x29b28f(0x15b)]()){try{const _0x5429a9=await this[_0x29b28f(0x136)](_0x251014);if(!_0x5429a9){_0x2e72ce[_0x29b28f(0x12b)]({'name':_0x251014,'error':_0x29b28f(0x11b)});continue;}const _0x25ce26=await _0x5429a9['listTools']();for(const _0xa0904a of _0x25ce26){_0x4aac24['push']({'name':_0x251014+'/'+_0xa0904a[_0x29b28f(0x13d)],'description':_0xa0904a['description']||_0x29b28f(0x116),'server':_0x251014}),this[_0x29b28f(0x138)][_0x29b28f(0x162)](_0x251014+'/'+_0xa0904a[_0x29b28f(0x13d)],_0xa0904a);}}catch(_0x2495e6){this[_0x29b28f(0x108)]['error']('Failed\x20to\x20get\x20tools\x20from\x20server\x20'+_0x251014+':',_0x2495e6),_0x2e72ce[_0x29b28f(0x12b)]({'name':_0x251014,'error':_0x2495e6['message']});}}return{'action':'get-available-tools','tools':_0x4aac24,'failedServers':_0x2e72ce,'success':!![]};}async['addServers'](_0x215568){const _0xae0f79=a0_0x13920d;this[_0xae0f79(0x108)]['info'](_0xae0f79(0x11f)+_0x215568['length']+_0xae0f79(0x10b));const _0xb26073=[],_0x383a49=[];for(const _0x3e5cd7 of _0x215568){try{if(!_0x3e5cd7[_0xae0f79(0x13d)]||!_0x3e5cd7['url'])throw new Error(_0xae0f79(0x13f));let _0x34432c=_0xae0f79(0x144);_0x3e5cd7['url']['startsWith'](_0xae0f79(0x130))||_0x3e5cd7['url']['startsWith']('https://')?_0x34432c='http':_0x34432c='stdio',this['servers']['set'](_0x3e5cd7[_0xae0f79(0x13d)],{'url':_0x3e5cd7[_0xae0f79(0x10c)],'type':_0x34432c}),_0xb26073['push'](_0x3e5cd7['name']);}catch(_0xdef5b2){this['logger'][_0xae0f79(0x132)](_0xae0f79(0x142)+_0x3e5cd7['name']+':',_0xdef5b2),_0x383a49[_0xae0f79(0x12b)]({'name':_0x3e5cd7[_0xae0f79(0x13d)],'error':_0xdef5b2['message']});}}return await this[_0xae0f79(0x161)](),{'action':'add-servers','addedServers':_0xb26073,'failedServers':_0x383a49,'success':_0xb26073[_0xae0f79(0x111)]>0x0};}async['removeServer'](_0xf0b6d8){const _0x584534=a0_0x13920d;this['logger']['info'](_0x584534(0x152)+_0xf0b6d8);if(!this['servers']['has'](_0xf0b6d8))return{'action':_0x584534(0x163),'serverName':_0xf0b6d8,'success':![],'error':'Server\x20\x27'+_0xf0b6d8+'\x27\x20does\x20not\x20exist'};if(this[_0x584534(0x13c)]['has'](_0xf0b6d8)){try{const _0x470130=this[_0x584534(0x13c)]['get'](_0xf0b6d8);await _0x470130['disconnect']();}catch(_0x3cdeec){this[_0x584534(0x108)]['warn']('Error\x20disconnecting\x20from\x20server\x20'+_0xf0b6d8+':',_0x3cdeec);}this[_0x584534(0x13c)]['delete'](_0xf0b6d8);}return this[_0x584534(0x141)][_0x584534(0x15a)](_0xf0b6d8),await this[_0x584534(0x161)](),{'action':'remove-server','serverName':_0xf0b6d8,'success':!![]};}async[a0_0x13920d(0x15c)](_0x3afa71){const _0x2cfe68=a0_0x13920d;this[_0x2cfe68(0x108)][_0x2cfe68(0x155)](_0x2cfe68(0x15f)+_0x3afa71);const [_0x359547,_0x467ba1]=_0x3afa71[_0x2cfe68(0x113)]('/');if(!_0x359547||!_0x467ba1)throw new Error(_0x2cfe68(0x133)+_0x3afa71+'.\x20Expected\x20format:\x20serverName/toolName');if(!this['servers']['has'](_0x359547))throw new Error('Server\x20\x27'+_0x359547+'\x27\x20does\x20not\x20exist');if(this[_0x2cfe68(0x138)][_0x2cfe68(0x140)](_0x3afa71))return{'action':_0x2cfe68(0x157),'toolId':_0x3afa71,'schema':this['toolSchemas'][_0x2cfe68(0x11d)](_0x3afa71),'success':!![]};const _0xa5355a=await this['getOrCreateClient'](_0x359547);if(!_0xa5355a)throw new Error(_0x2cfe68(0x13a)+_0x359547);const _0x265426=await _0xa5355a['listTools'](),_0x4a09ae=_0x265426['find'](_0x43f801=>_0x43f801[_0x2cfe68(0x13d)]===_0x467ba1);if(!_0x4a09ae)throw new Error(_0x2cfe68(0x112)+_0x467ba1+'\x27\x20not\x20found\x20on\x20server\x20\x27'+_0x359547+'\x27');return this[_0x2cfe68(0x138)]['set'](_0x3afa71,_0x4a09ae),{'action':_0x2cfe68(0x157),'toolId':_0x3afa71,'schema':_0x4a09ae,'success':!![]};}async['sendMessageToMcp'](_0x5231af){const _0x3cf98c=a0_0x13920d;this['logger'][_0x3cf98c(0x155)]('Sending\x20message\x20to\x20MCP\x20server');if(!_0x5231af||!_0x5231af[_0x3cf98c(0x126)])throw new Error('Invalid\x20MCP\x20message\x20format.\x20Expected\x20{\x20tool_call:\x20{\x20name,\x20arguments\x20}\x20}');const {name:_0x5579aa,arguments:_0x29d265}=_0x5231af[_0x3cf98c(0x126)];if(!_0x5579aa||!_0x29d265)throw new Error(_0x3cf98c(0x139));const [_0x29b862,_0x42d1a4]=_0x5579aa['split']('/');if(!_0x29b862||!_0x42d1a4)throw new Error('Invalid\x20tool\x20name\x20format:\x20'+_0x5579aa+'.\x20Expected\x20format:\x20serverName/toolName');if(!this[_0x3cf98c(0x141)][_0x3cf98c(0x140)](_0x29b862))throw new Error(_0x3cf98c(0x15e)+_0x29b862+_0x3cf98c(0x14c));const _0x37a894=await this['getOrCreateClient'](_0x29b862);if(!_0x37a894)throw new Error('Failed\x20to\x20connect\x20to\x20server:\x20'+_0x29b862);const _0x4fc799=await _0x37a894[_0x3cf98c(0x14a)]({'name':_0x42d1a4,'arguments':_0x29d265});return{'action':_0x3cf98c(0x13b),'toolCall':{'name':_0x5579aa,'arguments':_0x29d265},'result':_0x4fc799,'success':!![]};}async[a0_0x13920d(0x136)](_0x4e748a){const _0x207f6e=a0_0x13920d;if(this['clients']['has'](_0x4e748a))return this[_0x207f6e(0x13c)][_0x207f6e(0x11d)](_0x4e748a);const _0x19a9fe=this[_0x207f6e(0x141)][_0x207f6e(0x11d)](_0x4e748a);if(!_0x19a9fe)return this[_0x207f6e(0x108)]['error'](_0x207f6e(0x15e)+_0x4e748a+'\x27\x20not\x20found'),null;try{const _0x1ae9eb=new Client({'name':'loxia-mcp-client','version':'1.0.0'});let _0x34e854;if(_0x19a9fe[_0x207f6e(0x158)]===_0x207f6e(0x144))_0x34e854=new StreamableHTTPClientTransport(_0x19a9fe['url']);else{if(_0x19a9fe[_0x207f6e(0x158)]==='stdio'){const _0x15e59d=_0x19a9fe[_0x207f6e(0x10c)][_0x207f6e(0x113)]('\x20'),_0x92553c=_0x15e59d[0x0],_0x384723=_0x15e59d['slice'](0x1);_0x34e854=new StdioClientTransport({'command':_0x92553c,'args':_0x384723});}else throw new Error(_0x207f6e(0x135)+_0x19a9fe[_0x207f6e(0x158)]);}return await _0x1ae9eb['connect'](_0x34e854),this['clients'][_0x207f6e(0x162)](_0x4e748a,_0x1ae9eb),_0x1ae9eb;}catch(_0xe82d02){return this[_0x207f6e(0x108)][_0x207f6e(0x132)](_0x207f6e(0x160)+_0x4e748a+'\x27:',_0xe82d02),null;}}async['saveServers'](){const _0x4be7e0=a0_0x13920d;try{const _0x47e0ac=a0_0x1eed90[_0x4be7e0(0x123)](this[_0x4be7e0(0x12a)],_0x4be7e0(0x146)),_0x534232={};for(const [_0x3006b3,_0x35fece]of this['servers'][_0x4be7e0(0x15b)]()){_0x534232[_0x3006b3]=_0x35fece;}await a0_0xb8d71c[_0x4be7e0(0x151)](_0x47e0ac,JSON['stringify'](_0x534232,null,0x2),'utf-8'),this['logger'][_0x4be7e0(0x155)](_0x4be7e0(0x10d)+this[_0x4be7e0(0x141)]['size']+'\x20MCP\x20servers\x20to\x20file');}catch(_0xcd0d38){this[_0x4be7e0(0x108)]['error'](_0x4be7e0(0x12d),_0xcd0d38);}}async['shutdown'](){const _0x58a29b=a0_0x13920d;this[_0x58a29b(0x108)][_0x58a29b(0x155)]('Shutting\x20down\x20MCP\x20client\x20tool');for(const [_0x68a782,_0x140e0d]of this[_0x58a29b(0x13c)]['entries']()){try{await _0x140e0d[_0x58a29b(0x15d)](),this[_0x58a29b(0x108)][_0x58a29b(0x155)]('Disconnected\x20from\x20MCP\x20server:\x20'+_0x68a782);}catch(_0x21b9eb){this['logger']['warn'](_0x58a29b(0x10a)+_0x68a782+':',_0x21b9eb);}}this[_0x58a29b(0x13c)][_0x58a29b(0x127)]();}}