const a0_0x40c280=a0_0x15f4;function a0_0x15f4(_0x72c7c1,_0x5cd270){const _0x467d07=a0_0x467d();return a0_0x15f4=function(_0x15f449,_0x3a1cd0){_0x15f449=_0x15f449-0x11f;let _0xc743ba=_0x467d07[_0x15f449];if(a0_0x15f4['NOlLOy']===undefined){var _0x1cef08=function(_0x184ffe){const _0x127b56='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xf4ed2f='',_0x48eb56='';for(let _0x49b4c8=0x0,_0x3acf59,_0x35eed1,_0x3e6522=0x0;_0x35eed1=_0x184ffe['charAt'](_0x3e6522++);~_0x35eed1&&(_0x3acf59=_0x49b4c8%0x4?_0x3acf59*0x40+_0x35eed1:_0x35eed1,_0x49b4c8++%0x4)?_0xf4ed2f+=String['fromCharCode'](0xff&_0x3acf59>>(-0x2*_0x49b4c8&0x6)):0x0){_0x35eed1=_0x127b56['indexOf'](_0x35eed1);}for(let _0xae5750=0x0,_0x55345e=_0xf4ed2f['length'];_0xae5750<_0x55345e;_0xae5750++){_0x48eb56+='%'+('00'+_0xf4ed2f['charCodeAt'](_0xae5750)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x48eb56);};a0_0x15f4['pgTsqD']=_0x1cef08,_0x72c7c1=arguments,a0_0x15f4['NOlLOy']=!![];}const _0x2bded2=_0x467d07[0x0],_0x35ff6c=_0x15f449+_0x2bded2,_0x2650c6=_0x72c7c1[_0x35ff6c];return!_0x2650c6?(_0xc743ba=a0_0x15f4['pgTsqD'](_0xc743ba),_0x72c7c1[_0x35ff6c]=_0xc743ba):_0xc743ba=_0x2650c6,_0xc743ba;},a0_0x15f4(_0x72c7c1,_0x5cd270);}(function(_0xb30f40,_0x2c0ead){const _0x439d3f=a0_0x15f4,_0x42faff=_0xb30f40();while(!![]){try{const _0x5930c1=-parseInt(_0x439d3f(0x149))/0x1+-parseInt(_0x439d3f(0x13b))/0x2*(-parseInt(_0x439d3f(0x131))/0x3)+-parseInt(_0x439d3f(0x124))/0x4+-parseInt(_0x439d3f(0x158))/0x5*(parseInt(_0x439d3f(0x13c))/0x6)+-parseInt(_0x439d3f(0x13f))/0x7*(parseInt(_0x439d3f(0x12f))/0x8)+-parseInt(_0x439d3f(0x133))/0x9+-parseInt(_0x439d3f(0x128))/0xa*(-parseInt(_0x439d3f(0x14f))/0xb);if(_0x5930c1===_0x2c0ead)break;else _0x42faff['push'](_0x42faff['shift']());}catch(_0x555b7d){_0x42faff['push'](_0x42faff['shift']());}}}(a0_0x467d,0xe6122));import{promises as a0_0x184ffe}from'fs';import a0_0x127b56 from'path';function a0_0x467d(){const _0x3f4c10=['AxnbyNnVBhv0zq','yxbWBhLuCMLTtw9Kzq','BM9Uzq','ChvZAa','ywn0Aw9U','Bg9Nz2vY','mtuXndqZmKDAzg1iwq','D2fYBG','rMLSzsb0ywCGBwLZC2LUzYbWyxrOigf0DhjPyNv0zq','t2XKignVBNrLBNqGBM90igzVDw5KigLUigzPBguSig5VignOyw5NzxmGBwfKzq','mtC1mdm0mejos1DMDq','CMvZB2X2zq','DxrMltG','y29UDgvUDa','CMvWBgfJzq','rxjYB3iGzxHLy3v0Aw5NigzPBguGy29UDgvUDcbYzxbSywnLignVBw1HBMqG','CgfYC2vqyxjHBwv0zxjZ','otiXntjoreHyAxC','z2vUzxjHDgveAwzMuMvWB3j0','mtaWmJCYm3DVuK5gva','uMvWBgfJzsb0ywCGBwLZC2LUzYbVBgqTy29UDgvUDa','nteWndeXnNzfqMLMEq','ywrK','yxr0CMLIDxrLCW','rMLSzsa','tM8GCMvWBgfJzw1LBNrZig1HzguSig9SzcbJB250zw50ig5VDcbMB3vUzcbPBIb0AguGC3bLy2LMAwvKigXPBMvZ','DhjPBq','zNjVBq','BwvZC2fNzq','neTmv1Hwuq','mJu4B1nsDLj5','zMLSzvbHDgG','Bwf0y2G','mZCXy2vnCuf1','BgvUz3rO','rMfPBgvKihrVignYzwf0zsbIywnRDxaGzMLSztOG','Bwf4','C3bSAxq','B2XKlwnVBNrLBNq','zMLSzq','zxjYB3i','Bw9Kzq','AgfZ','mte2odK4n1jhse9vuG','BMv3q29UDgvUDa','Aw5JBhvKzxm','ywnJzxnZ','CxvLCNK','zxnJyxbLuMvNrxHW','mJuZEKD3C3Pi','B2XKq29UDgvUDa','CgfYC2vmAw5LuMfUz2vZ','BgLUzxmTBgLTAxq','D3jPDgvgAwXL','BMv3lwnVBNrLBNq','BwLU','ugvYzM9YBwLUzYbSAw5LlwXPBwL0zwqGCMvWBgfJzw1LBNqGAw4GBgLUzxm6ia','Aw5MBW','mte5mZGWz216qK9e','zxHLy3v0zvDPDgHqyxjHBwv0zxjZ','BgLUzxnmAw1PDa','y29TBwfUzhm'];a0_0x467d=function(){return _0x3f4c10;};return a0_0x467d();}import{TagParser}from'../utilities/tagParser.js';import{BaseTool}from'./baseTool.js';export class FileContentReplaceTool extends BaseTool{constructor(_0xf4ed2f,_0x48eb56){super(_0xf4ed2f,_0x48eb56);}['getDescription'](){return'\x0aFile\x20Content\x20Replace\x20Tool:\x20Allows\x20you\x20to\x20replace\x20specific\x20content\x20within\x20files\x20(use\x20after\x20searching\x20strings\x20with\x20the\x20seek\x20tool).\x0a\x0aUsage:\x0a[tool\x20id=\x22file-content-replace\x22]\x0a[file\x20path=\x22path/to/file.js\x22]\x0a[replace\x20lines-limit=\x223,5,7-9\x22\x20mode=\x22trim|newlines|none\x22]\x0a[old-content]\x0acontent\x20to\x20replace\x0a[/old-content]\x0a[new-content]\x0areplacement\x20content\x0a[/new-content]\x0a[/replace]\x0a[/file]\x0a[/tool]\x0a\x0aParameters:\x0a-\x20path:\x20Path\x20to\x20the\x20file\x20to\x20modify\x0a-\x20lines-limit:\x20Optional\x20comma-separated\x20list\x20of\x20line\x20numbers\x20or\x20ranges\x20to\x20limit\x20the\x20replacement.\x20Examples:\x20\x223,5,7-9\x22\x20will\x20only\x20replace\x20in\x20lines\x203,\x205,\x20and\x207\x20through\x209.\x0a-\x20mode:\x20Optional\x20trim\x20mode\x20for\x20old-content\x20and\x20new-content\x20strings:\x0a\x20\x20*\x20\x22trim\x22\x20(default,\x20recommended):\x20Trim\x20whitespace\x20from\x20both\x20ends\x20of\x20old-content\x20and\x20new-content\x0a\x20\x20*\x20\x22newlines\x22:\x20Only\x20trim\x20newline\x20characters\x20from\x20both\x20ends\x0a\x20\x20*\x20\x22none\x22:\x20Use\x20content\x20as-is\x20without\x20any\x20trimming\x0a-\x20old-content\x20(tag):\x20The\x20string\x20we\x20want\x20to\x20replace\x0a-\x20new-content\x20(tag):\x20The\x20new\x20string\x20we\x20want\x20to\x20put\x20instead\x20of\x20the\x20above\x0a\x0aExamples:\x0a1.\x20Replace\x20content\x20with\x20default\x20trimming:\x0a[tool\x20id=\x22file-content-replace\x22]\x0a[file\x20path=\x22src/components/Button.js\x22]\x0a[replace]\x0a[old-content]\x0a\x20\x20const\x20handleClick\x20=\x20(event)\x20=>\x20{\x0a\x20\x20\x20\x20console.log(\x27Button\x20clicked\x27);\x0a\x20\x20}\x0a[/old-content]\x0a[new-content]\x0a\x20\x20const\x20handleClick\x20=\x20(event)\x20=>\x20{\x0a\x20\x20\x20\x20console.log(\x27Button\x20clicked\x27);\x0a\x20\x20\x20\x20props.onClick\x20&&\x20props.onClick(event);\x0a\x20\x20}\x0a[/new-content]\x0a[/replace]\x0a[/file]\x0a[/tool]\x0a\x0a2.\x20Replace\x20content\x20without\x20any\x20trimming:\x0a[tool\x20id=\x22file-content-replace\x22]\x0a[file\x20path=\x22src/App.js\x22]\x0a[replace\x20mode=\x22none\x22]\x0a[old-content]\x0a\x20\x20return\x20(\x0a\x20\x20\x20\x20<div>Hello</div>\x0a\x20\x20);\x0a[/old-content]\x0a[new-content]\x0a\x20\x20return\x20(\x0a\x20\x20\x20\x20<div>Hello\x20World</div>\x0a\x20\x20);\x0a[/new-content]\x0a[/replace]\x0a[/file]\x0a[/tool]\x0a\x0aNotes:\x0a-\x20The\x20replacement\x20can\x20change\x20multiple\x20lines\x20at\x20once\x0a-\x20Default\x20behavior\x20trims\x20whitespace\x20from\x20old-content\x20and\x20new-content\x20for\x20easier\x20matching\x0a-\x20Use\x20mode=\x22none\x22\x20when\x20exact\x20whitespace\x20matching\x20is\x20required\x0a-\x20The\x20tool\x20will\x20create\x20a\x20backup\x20of\x20the\x20original\x20file\x20before\x20making\x20changes\x0a\x20\x20\x20\x20';}[a0_0x40c280(0x11f)](_0x49b4c8,_0x3acf59='trim'){const _0x481df9=a0_0x40c280;switch(_0x3acf59){case'newlines':return _0x49b4c8[_0x481df9(0x12c)](/^\n+|\n+$/g,'');case _0x481df9(0x120):return _0x49b4c8;case'trim':default:return _0x49b4c8['trim']();}}[a0_0x40c280(0x12e)](_0x35eed1){const _0x3e60cd=a0_0x40c280;this['logger']['info']('Parsing\x20file\x20content\x20replace\x20parameters\x20with\x20TagParser');const _0x3e6522={'commands':[]};try{const _0xae5750=TagParser['query'](_0x35eed1,_0x3e60cd(0x145));for(const _0x55345e of _0xae5750){const _0x372002=_0x55345e[_0x3e60cd(0x135)]['path'];if(!_0x372002){this['logger'][_0x3e60cd(0x125)](_0x3e60cd(0x126));continue;}const _0x355451=TagParser['query'](_0x55345e[_0x3e60cd(0x12b)],_0x3e60cd(0x12c));for(const _0x5bbacf of _0x355451){const _0x351af8=_0x5bbacf['attributes'][_0x3e60cd(0x152)],_0x3dee42=_0x5bbacf[_0x3e60cd(0x135)][_0x3e60cd(0x147)]||_0x3e60cd(0x138),_0x4181cf=TagParser['query'](_0x5bbacf[_0x3e60cd(0x12b)],_0x3e60cd(0x144));if(_0x4181cf['length']===0x0){this['logger'][_0x3e60cd(0x125)](_0x3e60cd(0x132));continue;}const _0x49b565=this['applyTrimMode'](_0x4181cf[0x0][_0x3e60cd(0x12b)],_0x3dee42),_0x34a4af=TagParser[_0x3e60cd(0x14d)](_0x5bbacf[_0x3e60cd(0x12b)],_0x3e60cd(0x154));if(_0x34a4af[_0x3e60cd(0x140)]===0x0){this[_0x3e60cd(0x123)]['warn']('Replace\x20tag\x20missing\x20new-content');continue;}const _0xcc6181=this[_0x3e60cd(0x11f)](_0x34a4af[0x0][_0x3e60cd(0x12b)],_0x3dee42);let _0x4460da=null;_0x351af8&&(_0x4460da=this[_0x3e60cd(0x151)](_0x351af8)),_0x3e6522['commands'][_0x3e60cd(0x121)]({'action':_0x3e60cd(0x12c),'filePath':_0x372002,'linesLimit':_0x4460da,'oldContent':_0x49b565,'newContent':_0xcc6181,'mode':_0x3dee42});}}return _0x3e6522;}catch(_0x38a5d0){return this[_0x3e60cd(0x123)][_0x3e60cd(0x146)]('Error\x20parsing\x20file\x20content\x20replace\x20parameters:',_0x38a5d0),{'commands':[]};}}['parseLineRanges'](_0x2ebddc){const _0x344fd2=a0_0x40c280,_0x520b7a=new Set();if(!_0x2ebddc||_0x2ebddc['trim']()==='')return _0x520b7a;const _0x3a8cc7=_0x2ebddc[_0x344fd2(0x143)](',');for(const _0x17f690 of _0x3a8cc7){const _0x5bb30c=_0x17f690['trim']();if(_0x5bb30c==='')continue;if(_0x5bb30c[_0x344fd2(0x14b)]('-')){const [_0x58b8ff,_0x2fdd72]=_0x5bb30c[_0x344fd2(0x143)]('-')['map'](_0x89d61f=>parseInt(_0x89d61f['trim'](),0xa));if(!isNaN(_0x58b8ff)&&!isNaN(_0x2fdd72))for(let _0x53ab25=_0x58b8ff;_0x53ab25<=_0x2fdd72;_0x53ab25++){_0x520b7a['add'](_0x53ab25);}}else{const _0x1ab490=parseInt(_0x5bb30c,0xa);!isNaN(_0x1ab490)&&_0x520b7a[_0x344fd2(0x134)](_0x1ab490);}}return _0x520b7a;}async[a0_0x40c280(0x159)](_0x38ea79,_0x213543){const _0x9aa5c6=a0_0x40c280;this['logger'][_0x9aa5c6(0x157)]('Executing\x20file\x20content\x20replace\x20command\x20with\x20parameters:',_0x38ea79);const _0x267b91=[];if(!_0x38ea79[_0x9aa5c6(0x15b)]||_0x38ea79[_0x9aa5c6(0x15b)][_0x9aa5c6(0x140)]===0x0)throw new Error('No\x20file\x20content\x20replace\x20commands\x20specified');for(const _0x125b7b of _0x38ea79[_0x9aa5c6(0x15b)]){try{switch(_0x125b7b[_0x9aa5c6(0x122)]){case _0x9aa5c6(0x12c):_0x267b91['push'](await this['replaceContent'](_0x125b7b[_0x9aa5c6(0x13d)],_0x125b7b[_0x9aa5c6(0x150)],_0x125b7b[_0x9aa5c6(0x14a)],_0x125b7b[_0x9aa5c6(0x15a)],_0x213543,_0x125b7b[_0x9aa5c6(0x147)]));break;default:throw new Error('Unknown\x20file\x20content\x20replace\x20command:\x20'+_0x125b7b['action']);}}catch(_0x346c24){this[_0x9aa5c6(0x123)][_0x9aa5c6(0x146)](_0x9aa5c6(0x12d)+_0x125b7b[_0x9aa5c6(0x122)]+':',_0x346c24),_0x267b91['push']({'action':_0x125b7b[_0x9aa5c6(0x122)],'filePath':_0x125b7b[_0x9aa5c6(0x13d)],'success':![],'error':_0x346c24[_0x9aa5c6(0x13a)]});}}return{'results':_0x267b91};}async['replaceContent'](_0x17eb21,_0x299904,_0x3c2f35,_0x231881,_0x235660,_0x2e911f='trim'){const _0x28aad0=a0_0x40c280;this['logger']['info']('Replacing\x20content\x20in\x20file:\x20'+_0x17eb21+'\x20(mode:\x20'+_0x2e911f+')');const _0x121d38=this['resolvePath'](_0x17eb21,_0x235660);try{await a0_0x184ffe[_0x28aad0(0x14c)](_0x121d38);}catch(_0x1545f3){throw new Error(_0x28aad0(0x136)+_0x17eb21+'\x20not\x20found:\x20'+_0x1545f3['message']);}let _0x2a7c41;try{_0x2a7c41=await a0_0x184ffe['readFile'](_0x121d38,_0x28aad0(0x12a));}catch(_0x7090c){throw new Error('Error\x20reading\x20file\x20'+_0x17eb21+':\x20'+_0x7090c[_0x28aad0(0x13a)]);}const _0x59ae5a=_0x121d38+'.bak';try{await a0_0x184ffe['writeFile'](_0x59ae5a,_0x2a7c41);}catch(_0x425cf1){this[_0x28aad0(0x123)]['warn'](_0x28aad0(0x141)+_0x425cf1[_0x28aad0(0x13a)]);}const _0x1a1a7b=_0x2a7c41['split']('\x0a');let _0x2f5993=0x0,_0x286a14=[];if(_0x231881){this['logger']['info'](_0x28aad0(0x156)+Array[_0x28aad0(0x139)](_0x231881)['join'](',\x20'));let _0x880cf9='',_0x47fb78=0x0;while(_0x47fb78<_0x1a1a7b['length']){const _0x34de4b=_0x47fb78+0x1;if(_0x231881[_0x28aad0(0x148)](_0x34de4b)){const _0x307e47=[];let _0x5cfd01=_0x47fb78;while(_0x5cfd01<_0x1a1a7b['length']&&_0x231881['has'](_0x5cfd01+0x1)){_0x307e47[_0x28aad0(0x121)](_0x1a1a7b[_0x5cfd01]),_0x5cfd01++;}const _0x303524=_0x307e47['join']('\x0a'),_0x51632d=_0x303524[_0x28aad0(0x14b)](_0x299904)?_0x303524['replace'](new RegExp(this[_0x28aad0(0x14e)](_0x299904),'g'),_0x3c2f35):_0x303524,_0x639192=_0x303524===_0x51632d?0x0:(_0x303524[_0x28aad0(0x13e)](new RegExp(this[_0x28aad0(0x14e)](_0x299904),'g'))||[])['length'];_0x2f5993+=_0x639192,_0x880cf9[_0x28aad0(0x140)]>0x0&&!_0x880cf9['endsWith']('\x0a')&&(_0x880cf9+='\x0a'),_0x880cf9+=_0x51632d,_0x47fb78=_0x5cfd01;}else _0x880cf9['length']>0x0&&!_0x880cf9['endsWith']('\x0a')&&(_0x880cf9+='\x0a'),_0x880cf9+=_0x1a1a7b[_0x47fb78],_0x47fb78++;}_0x2f5993>0x0&&await a0_0x184ffe[_0x28aad0(0x153)](_0x121d38,_0x880cf9),_0x286a14=_0x880cf9['split']('\x0a');}else{this['logger'][_0x28aad0(0x157)]('Performing\x20replacement\x20in\x20the\x20entire\x20file');if(!_0x2a7c41['includes'](_0x299904))return{'action':_0x28aad0(0x12c),'filePath':_0x17eb21,'resolvedPath':_0x121d38,'success':!![],'replacementCount':0x0,'mode':_0x2e911f,'message':_0x28aad0(0x127)};_0x2f5993=(_0x2a7c41[_0x28aad0(0x13e)](new RegExp(this[_0x28aad0(0x14e)](_0x299904),'g'))||[])['length'];const _0x37d805=_0x2a7c41[_0x28aad0(0x12c)](new RegExp(this[_0x28aad0(0x14e)](_0x299904),'g'),_0x3c2f35);await a0_0x184ffe['writeFile'](_0x121d38,_0x37d805),_0x286a14=_0x37d805['split']('\x0a');}const _0xdde304=this[_0x28aad0(0x130)](_0x1a1a7b,_0x286a14);return{'action':_0x28aad0(0x12c),'filePath':_0x17eb21,'resolvedPath':_0x121d38,'success':!![],'replacementCount':_0x2f5993,'linesLimit':_0x231881?Array[_0x28aad0(0x139)](_0x231881):null,'backupPath':_0x59ae5a,'diffReport':_0xdde304,'mode':_0x2e911f,'message':_0x2f5993>0x0?'Made\x20'+_0x2f5993+'\x20replacement'+(_0x2f5993>0x1?'s':'')+'\x20in\x20file\x20'+_0x17eb21+'\x20(mode:\x20'+_0x2e911f+')':_0x28aad0(0x137)};}[a0_0x40c280(0x130)](_0x5cce60,_0x16739e){const _0x2a352d=a0_0x40c280;let _0x152929='',_0x58b5d7=-0x1,_0x4d18c2=-0x1;const _0x47776e=Math[_0x2a352d(0x142)](_0x5cce60['length'],_0x16739e['length']);for(let _0x4bd4e5=0x0;_0x4bd4e5<_0x47776e;_0x4bd4e5++){const _0x40d62e=_0x4bd4e5<_0x5cce60[_0x2a352d(0x140)]?_0x5cce60[_0x4bd4e5]:null,_0x31af95=_0x4bd4e5<_0x16739e[_0x2a352d(0x140)]?_0x16739e[_0x4bd4e5]:null;_0x40d62e!==_0x31af95&&(_0x58b5d7===-0x1&&(_0x58b5d7=_0x4bd4e5),_0x4d18c2=_0x4bd4e5);}if(_0x58b5d7===-0x1)return'No\x20differences\x20found';const _0x3bc2e3=0x2,_0x44ff51=Math[_0x2a352d(0x142)](0x0,_0x58b5d7-_0x3bc2e3),_0x599cdf=Math[_0x2a352d(0x155)](_0x47776e-0x1,_0x4d18c2+_0x3bc2e3);_0x152929+='Diff\x20(lines\x20'+(_0x44ff51+0x1)+'\x20to\x20'+(_0x599cdf+0x1)+'):\x0a\x0a';for(let _0x1bf4c9=_0x44ff51;_0x1bf4c9<=_0x599cdf;_0x1bf4c9++){const _0x363b15=_0x1bf4c9<_0x5cce60['length']?_0x5cce60[_0x1bf4c9]:'',_0x20ba00=_0x1bf4c9<_0x16739e[_0x2a352d(0x140)]?_0x16739e[_0x1bf4c9]:'';_0x363b15===_0x20ba00?_0x152929+='\x20\x20'+(_0x1bf4c9+0x1)+':\x20'+_0x363b15+'\x0a':(_0x152929+='-\x20'+(_0x1bf4c9+0x1)+':\x20'+_0x363b15+'\x0a',_0x152929+='+\x20'+(_0x1bf4c9+0x1)+':\x20'+_0x20ba00+'\x0a');}return _0x152929;}['escapeRegExp'](_0x3c7cc6){const _0xac636a=a0_0x40c280;return _0x3c7cc6[_0xac636a(0x12c)](/[.*+?^${}()|[\]\\]/g,'\x5c$&');}['resolvePath'](_0x393556,_0x53d676){const _0xbb3c7c=a0_0x40c280;if(a0_0x127b56[_0xbb3c7c(0x15c)](_0x393556))return _0x393556;return a0_0x127b56[_0xbb3c7c(0x129)](_0x53d676,_0x393556);}}