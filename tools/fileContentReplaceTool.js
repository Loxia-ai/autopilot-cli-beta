function a0_0x3702(_0x3b67a3,_0x509847){const _0x3d09a4=a0_0x3d09();return a0_0x3702=function(_0x37029a,_0x3fa9d4){_0x37029a=_0x37029a-0xbe;let _0x51fe04=_0x3d09a4[_0x37029a];if(a0_0x3702['XHGZFw']===undefined){var _0x3294df=function(_0x3b5a2c){const _0x458ae5='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x29e55d='',_0x5ef956='';for(let _0x2d59fd=0x0,_0x2995,_0x44707a,_0x54ce95=0x0;_0x44707a=_0x3b5a2c['charAt'](_0x54ce95++);~_0x44707a&&(_0x2995=_0x2d59fd%0x4?_0x2995*0x40+_0x44707a:_0x44707a,_0x2d59fd++%0x4)?_0x29e55d+=String['fromCharCode'](0xff&_0x2995>>(-0x2*_0x2d59fd&0x6)):0x0){_0x44707a=_0x458ae5['indexOf'](_0x44707a);}for(let _0xebde7b=0x0,_0x316e62=_0x29e55d['length'];_0xebde7b<_0x316e62;_0xebde7b++){_0x5ef956+='%'+('00'+_0x29e55d['charCodeAt'](_0xebde7b)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5ef956);};a0_0x3702['KRkXvf']=_0x3294df,_0x3b67a3=arguments,a0_0x3702['XHGZFw']=!![];}const _0x29f9c1=_0x3d09a4[0x0],_0x379ed1=_0x37029a+_0x29f9c1,_0x1895e1=_0x3b67a3[_0x379ed1];return!_0x1895e1?(_0x51fe04=a0_0x3702['KRkXvf'](_0x51fe04),_0x3b67a3[_0x379ed1]=_0x51fe04):_0x51fe04=_0x1895e1,_0x51fe04;},a0_0x3702(_0x3b67a3,_0x509847);}const a0_0x53fd4d=a0_0x3702;function a0_0x3d09(){const _0x4ecbed=['ywnJzxnZ','ugvYzM9YBwLUzYbYzxbSywnLBwvUDcbPBIb0AguGzw50AxjLigzPBgu','y29UDgvUDa','zxnJyxbLuMvNrxHW','mtu2ndyZmLfrzuftvW','ywrK','C3bSAxq','Bwf4','ugfYC2LUzYbMAwXLignVBNrLBNqGCMvWBgfJzsbWyxjHBwv0zxjZihDPDgGGvgfNugfYC2vY','zw5KC1DPDgG','CMvWBgfJzq','z2vUzxjHDgveAwzMuMvWB3j0','Bwf0y2G','uMvWBgfJzsb0ywCGBwLZC2LUzYbUzxCTy29UDgvUDa','odyXmZbsrM9TCwi','AM9PBG','CgfYC2vmAw5LuMfUz2vZ','B2XKlwnVBNrLBNq','BgvUz3rO','mty5mtGYogXbsg5VEG','CMvZB2X2zvbHDgG','ihjLCgXHy2vTzw50','ChvZAa','nda2nJq3meTQuMHWvq','twfKzsa','CxvLCNK','mtuXmeLUwKTAEa','tM8GzgLMzMvYzw5JzxmGzM91BMq','BgLUzxmTBgLTAxq','uMvWBgfJAw5NignVBNrLBNqGAw4GzMLSztOG','y29TBwfUzhm','uMvWBgfJzsb0ywCGBwLZC2LUzYbVBgqTy29UDgvUDa','yxr0CMLIDxrLCW','mtuWBg1czxnk','ndC0owrTvfj2qG','odHjCenmwfe','ndKWmJK0qNnvs2He','Aw5MBW','ywn0Aw9U','rgLMzIaOBgLUzxmG','icHTB2rLoIa','DhjPBq','BMv3lwnVBNrLBNq','Bg9Nz2vY','zMLSzvbHDgG','CgfYC2vqyxjHBwv0zxjZ','BwvZC2fNzq','mtfgr1Lduu4','CMvWBgfJzunVBNrLBNq','zxjYB3i','yxbWBhLuCMLTtw9Kzq','rxjYB3iGCMvHzgLUzYbMAwXLia','BMv3BgLUzxm','Bw9Kzq','Aw5JBhvKzxm','mte5mti1Cxz3vvrk','BMv3q29UDgvUDa'];a0_0x3d09=function(){return _0x4ecbed;};return a0_0x3d09();}(function(_0xa59d9c,_0x413146){const _0x2f715f=a0_0x3702,_0xca25fd=_0xa59d9c();while(!![]){try{const _0x68eb95=parseInt(_0x2f715f(0xe4))/0x1+parseInt(_0x2f715f(0xc1))/0x2*(-parseInt(_0x2f715f(0xc9))/0x3)+parseInt(_0x2f715f(0xf3))/0x4+parseInt(_0x2f715f(0xde))/0x5*(parseInt(_0x2f715f(0xc8))/0x6)+-parseInt(_0x2f715f(0xcb))/0x7+-parseInt(_0x2f715f(0xca))/0x8*(parseInt(_0x2f715f(0xee))/0x9)+parseInt(_0x2f715f(0xbe))/0xa*(-parseInt(_0x2f715f(0xd6))/0xb);if(_0x68eb95===_0x413146)break;else _0xca25fd['push'](_0xca25fd['shift']());}catch(_0x2d7d43){_0xca25fd['push'](_0xca25fd['shift']());}}}(a0_0x3d09,0xc4cca));import{promises as a0_0x3b5a2c}from'fs';import a0_0x458ae5 from'path';import{TagParser}from'../utilities/tagParser.js';import{BaseTool}from'./baseTool.js';export class FileContentReplaceTool extends BaseTool{constructor(_0x29e55d,_0x5ef956){super(_0x29e55d,_0x5ef956);}['getDescription'](){return'\x0aFile\x20Content\x20Replace\x20Tool:\x20Allows\x20you\x20to\x20replace\x20specific\x20content\x20within\x20files\x20(use\x20after\x20searching\x20strings\x20with\x20the\x20seek\x20tool).\x0a\x0aUsage:\x0a[tool\x20id=\x22file-content-replace\x22]\x0a[file\x20path=\x22path/to/file.js\x22]\x0a[replace\x20lines-limit=\x223,5,7-9\x22\x20mode=\x22trim|newlines|none\x22]\x0a[old-content]\x0acontent\x20to\x20replace\x0a[/old-content]\x0a[new-content]\x0areplacement\x20content\x0a[/new-content]\x0a[/replace]\x0a[/file]\x0a[/tool]\x0a\x0aParameters:\x0a-\x20path:\x20Path\x20to\x20the\x20file\x20to\x20modify\x0a-\x20lines-limit:\x20Optional\x20comma-separated\x20list\x20of\x20line\x20numbers\x20or\x20ranges\x20to\x20limit\x20the\x20replacement.\x20Examples:\x20\x223,5,7-9\x22\x20will\x20only\x20replace\x20in\x20lines\x203,\x205,\x20and\x207\x20through\x209.\x0a-\x20mode:\x20Optional\x20trim\x20mode\x20for\x20old-content\x20and\x20new-content\x20strings:\x0a\x20\x20*\x20\x22trim\x22\x20(default,\x20recommended):\x20Trim\x20whitespace\x20from\x20both\x20ends\x20of\x20old-content\x20and\x20new-content\x0a\x20\x20*\x20\x22newlines\x22:\x20Only\x20trim\x20newline\x20characters\x20from\x20both\x20ends\x0a\x20\x20*\x20\x22none\x22:\x20Use\x20content\x20as-is\x20without\x20any\x20trimming\x0a-\x20old-content\x20(tag):\x20The\x20string\x20we\x20want\x20to\x20replace\x0a-\x20new-content\x20(tag):\x20The\x20new\x20string\x20we\x20want\x20to\x20put\x20instead\x20of\x20the\x20above\x0a\x0aExamples:\x0a1.\x20Replace\x20content\x20with\x20default\x20trimming:\x0a[tool\x20id=\x22file-content-replace\x22]\x0a[file\x20path=\x22src/components/Button.js\x22]\x0a[replace]\x0a[old-content]\x0a\x20\x20const\x20handleClick\x20=\x20(event)\x20=>\x20{\x0a\x20\x20\x20\x20console.log(\x27Button\x20clicked\x27);\x0a\x20\x20}\x0a[/old-content]\x0a[new-content]\x0a\x20\x20const\x20handleClick\x20=\x20(event)\x20=>\x20{\x0a\x20\x20\x20\x20console.log(\x27Button\x20clicked\x27);\x0a\x20\x20\x20\x20props.onClick\x20&&\x20props.onClick(event);\x0a\x20\x20}\x0a[/new-content]\x0a[/replace]\x0a[/file]\x0a[/tool]\x0a\x0a2.\x20Replace\x20content\x20without\x20any\x20trimming:\x0a[tool\x20id=\x22file-content-replace\x22]\x0a[file\x20path=\x22src/App.js\x22]\x0a[replace\x20mode=\x22none\x22]\x0a[old-content]\x0a\x20\x20return\x20(\x0a\x20\x20\x20\x20<div>Hello</div>\x0a\x20\x20);\x0a[/old-content]\x0a[new-content]\x0a\x20\x20return\x20(\x0a\x20\x20\x20\x20<div>Hello\x20World</div>\x0a\x20\x20);\x0a[/new-content]\x0a[/replace]\x0a[/file]\x0a[/tool]\x0a\x0aNotes:\x0a-\x20The\x20replacement\x20can\x20change\x20multiple\x20lines\x20at\x20once\x0a-\x20Default\x20behavior\x20trims\x20whitespace\x20from\x20old-content\x20and\x20new-content\x20for\x20easier\x20matching\x0a-\x20Use\x20mode=\x22none\x22\x20when\x20exact\x20whitespace\x20matching\x20is\x20required\x0a-\x20The\x20tool\x20will\x20create\x20a\x20backup\x20of\x20the\x20original\x20file\x20before\x20making\x20changes\x0a\x20\x20\x20\x20';}[a0_0x53fd4d(0xd9)](_0x2d59fd,_0x2995='trim'){const _0x2b8755=a0_0x53fd4d;switch(_0x2995){case _0x2b8755(0xdb):return _0x2d59fd['replace'](/^\n+|\n+$/g,'');case'none':return _0x2d59fd;case'trim':default:return _0x2d59fd['trim']();}}[a0_0x53fd4d(0xd4)](_0x44707a){const _0x5199b2=a0_0x53fd4d;this['logger']['info'](_0x5199b2(0xe8));const _0x54ce95={'commands':[]};try{const _0xebde7b=TagParser['query'](_0x44707a,'file');for(const _0x316e62 of _0xebde7b){const _0x2cb5be=_0x316e62['attributes']['path'];if(!_0x2cb5be){this[_0x5199b2(0xd2)]['warn']('File\x20tag\x20missing\x20path\x20attribute');continue;}const _0x56311f=TagParser[_0x5199b2(0xc0)](_0x316e62['content'],_0x5199b2(0xea));for(const _0x4daaaa of _0x56311f){const _0x4cd650=_0x4daaaa['attributes'][_0x5199b2(0xc3)],_0x270d8b=_0x4daaaa[_0x5199b2(0xc7)]['mode']||_0x5199b2(0xd0),_0x2ca99c=TagParser['query'](_0x4daaaa['content'],_0x5199b2(0xf1));if(_0x2ca99c[_0x5199b2(0xf2)]===0x0){this['logger']['warn'](_0x5199b2(0xc6));continue;}const _0x492a37=this['applyTrimMode'](_0x2ca99c[0x0][_0x5199b2(0xe2)],_0x270d8b),_0xec5176=TagParser['query'](_0x4daaaa['content'],_0x5199b2(0xd1));if(_0xec5176['length']===0x0){this['logger']['warn'](_0x5199b2(0xed));continue;}const _0x4ec195=this[_0x5199b2(0xd9)](_0xec5176[0x0]['content'],_0x270d8b);let _0x5047a2=null;_0x4cd650&&(_0x5047a2=this[_0x5199b2(0xf0)](_0x4cd650)),_0x54ce95[_0x5199b2(0xc5)]['push']({'action':_0x5199b2(0xea),'filePath':_0x2cb5be,'linesLimit':_0x5047a2,'oldContent':_0x492a37,'newContent':_0x4ec195,'mode':_0x270d8b});}}return _0x54ce95;}catch(_0x4531f4){return this['logger'][_0x5199b2(0xd8)]('Error\x20parsing\x20file\x20content\x20replace\x20parameters:',_0x4531f4),{'commands':[]};}}[a0_0x53fd4d(0xf0)](_0x152d14){const _0x41c192=a0_0x53fd4d,_0x309ead=new Set();if(!_0x152d14||_0x152d14['trim']()==='')return _0x309ead;const _0x55065c=_0x152d14[_0x41c192(0xe6)](',');for(const _0x4ecda0 of _0x55065c){const _0x2cb2f2=_0x4ecda0['trim']();if(_0x2cb2f2==='')continue;if(_0x2cb2f2['includes']('-')){const [_0x2314d6,_0x24ca79]=_0x2cb2f2['split']('-')['map'](_0x13004b=>parseInt(_0x13004b[_0x41c192(0xd0)](),0xa));if(!isNaN(_0x2314d6)&&!isNaN(_0x24ca79))for(let _0x4063db=_0x2314d6;_0x4063db<=_0x24ca79;_0x4063db++){_0x309ead[_0x41c192(0xe5)](_0x4063db);}}else{const _0x5d0843=parseInt(_0x2cb2f2,0xa);!isNaN(_0x5d0843)&&_0x309ead[_0x41c192(0xe5)](_0x5d0843);}}return _0x309ead;}async['executeWithParameters'](_0x57e198,_0x1d6b3d){const _0x16a6c1=a0_0x53fd4d;this['logger'][_0x16a6c1(0xcc)]('Executing\x20file\x20content\x20replace\x20command\x20with\x20parameters:',_0x57e198);const _0x59758b=[];if(!_0x57e198['commands']||_0x57e198['commands']['length']===0x0)throw new Error('No\x20file\x20content\x20replace\x20commands\x20specified');for(const _0x38ea88 of _0x57e198['commands']){try{switch(_0x38ea88['action']){case _0x16a6c1(0xea):_0x59758b['push'](await this[_0x16a6c1(0xd7)](_0x38ea88['filePath'],_0x38ea88['oldContent'],_0x38ea88[_0x16a6c1(0xdf)],_0x38ea88['linesLimit'],_0x1d6b3d,_0x38ea88[_0x16a6c1(0xdc)]));break;default:throw new Error('Unknown\x20file\x20content\x20replace\x20command:\x20'+_0x38ea88[_0x16a6c1(0xcd)]);}}catch(_0x3d597b){this['logger']['error']('Error\x20executing\x20file\x20content\x20replace\x20command\x20'+_0x38ea88[_0x16a6c1(0xcd)]+':',_0x3d597b),_0x59758b[_0x16a6c1(0xf6)]({'action':_0x38ea88[_0x16a6c1(0xcd)],'filePath':_0x38ea88[_0x16a6c1(0xd3)],'success':![],'error':_0x3d597b[_0x16a6c1(0xd5)]});}}return{'results':_0x59758b};}async[a0_0x53fd4d(0xd7)](_0x350db3,_0x4dba0a,_0x3916e4,_0xa64357,_0x38b078,_0x36db2e=a0_0x53fd4d(0xd0)){const _0x423041=a0_0x53fd4d;this[_0x423041(0xd2)]['info'](_0x423041(0xc4)+_0x350db3+'\x20(mode:\x20'+_0x36db2e+')');const _0x19124e=this[_0x423041(0xf4)](_0x350db3,_0x38b078);try{await a0_0x3b5a2c[_0x423041(0xe0)](_0x19124e);}catch(_0x47c691){throw new Error('File\x20'+_0x350db3+'\x20not\x20found:\x20'+_0x47c691['message']);}let _0x4df71b;try{_0x4df71b=await a0_0x3b5a2c['readFile'](_0x19124e,'utf-8');}catch(_0x4fbc7d){throw new Error(_0x423041(0xda)+_0x350db3+':\x20'+_0x4fbc7d['message']);}const _0x25a4d2=_0x19124e+'.bak';try{await a0_0x3b5a2c['writeFile'](_0x25a4d2,_0x4df71b);}catch(_0x571108){this[_0x423041(0xd2)]['warn']('Failed\x20to\x20create\x20backup\x20file:\x20'+_0x571108['message']);}const _0x2424fc=_0x4df71b['split']('\x0a');let _0x196107=0x0,_0x1b5abe=[];if(_0xa64357){this[_0x423041(0xd2)]['info']('Performing\x20line-limited\x20replacement\x20in\x20lines:\x20'+Array['from'](_0xa64357)[_0x423041(0xef)](',\x20'));let _0x2f3b3a='',_0x2c3dd6=0x0;while(_0x2c3dd6<_0x2424fc[_0x423041(0xf2)]){const _0x3ed679=_0x2c3dd6+0x1;if(_0xa64357['has'](_0x3ed679)){const _0x305b82=[];let _0x57ec10=_0x2c3dd6;while(_0x57ec10<_0x2424fc['length']&&_0xa64357['has'](_0x57ec10+0x1)){_0x305b82['push'](_0x2424fc[_0x57ec10]),_0x57ec10++;}const _0x147443=_0x305b82[_0x423041(0xef)]('\x0a'),_0x1d9f33=_0x147443[_0x423041(0xdd)](_0x4dba0a)?_0x147443['replace'](new RegExp(this[_0x423041(0xe3)](_0x4dba0a),'g'),_0x3916e4):_0x147443,_0x4cfc33=_0x147443===_0x1d9f33?0x0:(_0x147443[_0x423041(0xec)](new RegExp(this['escapeRegExp'](_0x4dba0a),'g'))||[])[_0x423041(0xf2)];_0x196107+=_0x4cfc33,_0x2f3b3a['length']>0x0&&!_0x2f3b3a[_0x423041(0xe9)]('\x0a')&&(_0x2f3b3a+='\x0a'),_0x2f3b3a+=_0x1d9f33,_0x2c3dd6=_0x57ec10;}else _0x2f3b3a['length']>0x0&&!_0x2f3b3a[_0x423041(0xe9)]('\x0a')&&(_0x2f3b3a+='\x0a'),_0x2f3b3a+=_0x2424fc[_0x2c3dd6],_0x2c3dd6++;}_0x196107>0x0&&await a0_0x3b5a2c['writeFile'](_0x19124e,_0x2f3b3a),_0x1b5abe=_0x2f3b3a[_0x423041(0xe6)]('\x0a');}else{this[_0x423041(0xd2)]['info'](_0x423041(0xe1));if(!_0x4df71b[_0x423041(0xdd)](_0x4dba0a))return{'action':_0x423041(0xea),'filePath':_0x350db3,'resolvedPath':_0x19124e,'success':!![],'replacementCount':0x0,'mode':_0x36db2e,'message':'Old\x20content\x20not\x20found\x20in\x20file,\x20no\x20changes\x20made'};_0x196107=(_0x4df71b[_0x423041(0xec)](new RegExp(this[_0x423041(0xe3)](_0x4dba0a),'g'))||[])['length'];const _0x17e645=_0x4df71b[_0x423041(0xea)](new RegExp(this[_0x423041(0xe3)](_0x4dba0a),'g'),_0x3916e4);await a0_0x3b5a2c['writeFile'](_0x19124e,_0x17e645),_0x1b5abe=_0x17e645['split']('\x0a');}const _0x43479c=this[_0x423041(0xeb)](_0x2424fc,_0x1b5abe);return{'action':_0x423041(0xea),'filePath':_0x350db3,'resolvedPath':_0x19124e,'success':!![],'replacementCount':_0x196107,'linesLimit':_0xa64357?Array['from'](_0xa64357):null,'backupPath':_0x25a4d2,'diffReport':_0x43479c,'mode':_0x36db2e,'message':_0x196107>0x0?_0x423041(0xbf)+_0x196107+_0x423041(0xf5)+(_0x196107>0x1?'s':'')+'\x20in\x20file\x20'+_0x350db3+_0x423041(0xcf)+_0x36db2e+')':'No\x20replacements\x20made,\x20old\x20content\x20not\x20found\x20in\x20the\x20specified\x20lines'};}[a0_0x53fd4d(0xeb)](_0x4ed98a,_0xe2d858){const _0x455fdb=a0_0x53fd4d;let _0x21ebbb='',_0x3527e6=-0x1,_0x56113e=-0x1;const _0x502e5a=Math[_0x455fdb(0xe7)](_0x4ed98a['length'],_0xe2d858['length']);for(let _0x5bd6c9=0x0;_0x5bd6c9<_0x502e5a;_0x5bd6c9++){const _0x19b554=_0x5bd6c9<_0x4ed98a[_0x455fdb(0xf2)]?_0x4ed98a[_0x5bd6c9]:null,_0x3c4218=_0x5bd6c9<_0xe2d858['length']?_0xe2d858[_0x5bd6c9]:null;_0x19b554!==_0x3c4218&&(_0x3527e6===-0x1&&(_0x3527e6=_0x5bd6c9),_0x56113e=_0x5bd6c9);}if(_0x3527e6===-0x1)return _0x455fdb(0xc2);const _0x31d6de=0x2,_0x58f464=Math[_0x455fdb(0xe7)](0x0,_0x3527e6-_0x31d6de),_0x4bde08=Math['min'](_0x502e5a-0x1,_0x56113e+_0x31d6de);_0x21ebbb+=_0x455fdb(0xce)+(_0x58f464+0x1)+'\x20to\x20'+(_0x4bde08+0x1)+'):\x0a\x0a';for(let _0x36917c=_0x58f464;_0x36917c<=_0x4bde08;_0x36917c++){const _0x117340=_0x36917c<_0x4ed98a['length']?_0x4ed98a[_0x36917c]:'',_0x408960=_0x36917c<_0xe2d858[_0x455fdb(0xf2)]?_0xe2d858[_0x36917c]:'';_0x117340===_0x408960?_0x21ebbb+='\x20\x20'+(_0x36917c+0x1)+':\x20'+_0x117340+'\x0a':(_0x21ebbb+='-\x20'+(_0x36917c+0x1)+':\x20'+_0x117340+'\x0a',_0x21ebbb+='+\x20'+(_0x36917c+0x1)+':\x20'+_0x408960+'\x0a');}return _0x21ebbb;}['escapeRegExp'](_0x5ee4f5){return _0x5ee4f5['replace'](/[.*+?^${}()|[\]\\]/g,'\x5c$&');}[a0_0x53fd4d(0xf4)](_0x268c3e,_0x50d58e){if(a0_0x458ae5['isAbsolute'](_0x268c3e))return _0x268c3e;return a0_0x458ae5['resolve'](_0x50d58e,_0x268c3e);}}